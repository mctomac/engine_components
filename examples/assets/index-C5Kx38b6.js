var gv=Object.defineProperty;var vv=(s,e,t)=>e in s?gv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var et=(s,e,t)=>(vv(s,typeof e!="symbol"?e+"":e,t),t);import{U as Pa,J as yv,p as Ev,s as bv,n as wv,u as zs,b as to,d as Iv,R as Cv,g as Hh}from"./index-BmA4XTIx.js";import{z as io,f as Ve,V as F,c as Ne,e as gt,A as ff,F as mf,P as an,r as Dt,p as Ke,M as le,T as Fn,E as gf,a as Ee,U as Yh,K as Fa,v as Vs,y as Gn,o as jn,Y as Ps,u as vf,C as Rt,d as Xt,Z as no,I as Kt,_ as On,B as ut,J as yf,$ as Ef,a0 as Gh,a1 as jh,a2 as Wh,a3 as Xh,a4 as cl,a5 as Kh,a6 as bf,a7 as hl,a8 as tn,k as za,a9 as wf,aa as If,ab as Wn,N as Va,ac as ii,ad as Tv,ae as Qo,af as zr,X as Cf,h as so,ag as Oa,n as Xn,l as Tf,m as ul,G as Fs,W as Ri,q as wt,g as st,L as Di,i as dl,ah as Ha,ai as Tt,O as kn,j as Si,aj as pl,ak as Qh,al as Zh,am as qh,an as xv,ao as Av,ap as Sv,aq as _v,Q as Vt,S as Rv,ar as ad,as as Pv,at as Fv,au as Ov,av as Mv,aw as Zo,ax as Lv,ay as pr,az as Dv,aA as Nv,aB as Kc,aC as xs,aD as Uv,D as kv,s as xf,x as Bv,H as Jh,t as zv,aE as fr,w as Ai,aF as Vv,aG as Hv,aH as Yv,aI as Gv,aJ as jv,aK as ld,aL as Wv,aM as Xv,aN as Kv,R as Af,aO as Qv,aP as Zv,aQ as Sf,aR as qv,aS as Jv,aT as _f,aU as Rf,aV as Pf,aW as $v}from"./web-ifc-api-BC8YMRiS.js";import{a as cd,L as ey,b as ty}from"./Line2-7GsqoD5b.js";import{M as iy}from"./mark--YNYmWZ2.js";import"./import-wrapper-prod-LhqN7JJy.js";const al=class al{constructor(e,t){et(this,"scene");et(this,"onSelect",new Pa);et(this,"type");et(this,"selectCurve");et(this,"selectPoints");et(this,"hoverCurve");et(this,"hoverPoints");et(this,"caster",new io);this.scene=e,this.type=t,this.hoverCurve=this.newCurve(.003,4473924,!1),this.hoverPoints=this.newPoints(5,4473924),this.selectCurve=this.newCurve(.005,16777215,!0),this.selectPoints=this.newPoints(7,16777215)}dispose(){this.selectCurve&&this.scene.remove(this.selectCurve),this.selectCurve.material.dispose(),this.selectCurve.geometry.dispose(),this.selectCurve=null,this.hoverCurve.material.dispose(),this.hoverCurve.geometry.dispose(),this.hoverCurve=null,this.hoverPoints.material.dispose(),this.hoverPoints.geometry.dispose(),this.selectPoints.material.dispose(),this.selectPoints.geometry.dispose(),this.scene=null}castRay(e,t,i,n){const r=new Ve,o=i.getBoundingClientRect();r.x=(e.clientX-o.left)/o.width*2-1,r.y=-((e.clientY-o.top)/o.height)*2+1,this.caster.setFromCamera(r,t);const a=this.caster.intersectObjects(n);return a.length?a[0]:null}select(e){this.highlight(e,this.selectCurve,this.selectPoints,!0),this.onSelect.trigger(e)}unSelect(){this.selectCurve.removeFromParent(),this.selectPoints.removeFromParent()}hover(e){this.highlight(e,this.hoverCurve,this.hoverPoints,!1)}unHover(){this.hoverCurve.removeFromParent(),this.hoverPoints.removeFromParent()}setResolution({x:e,y:t}){this.selectCurve.material.resolution.set(e/t,1),this.hoverCurve.material.resolution.set(e/t,1)}highlight(e,t,i,n){const{alignment:r}=e.curve;this.scene.add(t),this.scene.add(i);const o=[],a=[],l=[];for(const f of r[this.type]){const g=f.mesh.geometry.attributes.position;for(const T of g.array)o.push(T);if(n){let T;if(this.type==="absolute"){const{horizontal:_}=f.alignment;T=_[f.index].data.TYPE}else T=f.data.TYPE;const S=al.settings.colors[T]||[1,1,1];for(let _=0;_<g.count;_++)a.push(...S)}const[v,b,w]=g.array;l.push(new F(v,b,w))}const h=o[o.length-3],d=o[o.length-2],p=o[o.length-1];l.push(new F(h,d,p)),o.length/3>t.geometry.attributes.position.count&&(t.geometry.dispose(),t.geometry=new cd),t.geometry.setPositions(o),n&&t.geometry.setColors(a),i.geometry.setFromPoints(l)}newCurve(e,t,i){const n=new cd,r=new ey({color:t,linewidth:e,vertexColors:i,worldUnits:!1,depthTest:!1}),o=new ty(n,r);return this.scene.add(o),o}newPoints(e,t){const i=new Ne,n=new gt(new Float32Array,3);i.setAttribute("position",n);const r=new ff({size:e,color:t,sizeAttenuation:!1,depthTest:!1}),o=new mf(i,r);return o.frustumCulled=!1,this.scene.add(o),o}};et(al,"settings",{colors:{LINE:[213/255,0/255,255/255],CIRCULARARC:[0/255,46,255/255],CLOTHOID:[0/255,255/255,0/255],PARABOLICARC:[0/255,255/255,72/255],CONSTANTGRADIENT:[213/255,0/255,255/255]}});let Qc=al;const ll=class ll extends yv{constructor(t){super(t);et(this,"onHighlight",new Pa);et(this,"enabled",!0);et(this,"_highlighter");et(this,"mouseMarkers");et(this,"onMarkerChange",new Pa);et(this,"onMarkerHidden",new Pa);et(this,"_curves",[]);et(this,"_world",null);et(this,"updateLinesResolution",t=>{var i;(i=this.highlighter)==null||i.setResolution(t)});et(this,"onClick",t=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,n=this.world.camera.three,r=this._highlighter.castRay(t,n,i,this._curves);if(r){const o=r.object;this._highlighter.select(o),this.updateMarker(r,"select");const{point:a,index:l}=r;l!==void 0&&this.onHighlight.trigger({curve:o,point:a,index:l});return}this._highlighter.unSelect(),this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),this.onMarkerHidden.trigger({type:"hover"})});et(this,"onMouseMove",async t=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,n=this.world.camera.three,r=this._highlighter.castRay(t,n,i,this._curves);if(r){this._highlighter.hover(r.object),this.updateMarker(r,"hover");return}this._highlighter.unHover()});this.components.add(ll.uuid,this)}get world(){return this._world}set world(t){var n,r,o;if(t===this._world||(this._world&&this.setupEvents(!1),this._world=t,(n=this._highlighter)==null||n.dispose(),(r=this.mouseMarkers)==null||r.hover.dispose(),(o=this.mouseMarkers)==null||o.select.dispose(),!t))return;const i=t.scene.three;this._highlighter=new Qc(i,"absolute"),this.mouseMarkers={select:this.newMouseMarker("#ffffff",t),hover:this.newMouseMarker("#575757",t)},this.setupEvents(!0)}get highlighter(){if(!this._highlighter)throw new Error("Navigator not initialized!");return this._highlighter}draw(t){if(!t.civilData)throw new Error("Model must have civil data!");if(!this.world)throw new Error("A world must be given before drawing an alignment!");const i=this.world.scene.three;for(const[n,r]of t.civilData.alignments)for(const{mesh:o}of r.absolute)i.add(o),this._curves.push(o)}newMouseMarker(t,i){const n=i.scene.three,r=document.createElement("div");r.style.backgroundColor=t,r.style.width="1rem",r.style.height="1rem",r.style.borderRadius="1rem";const o=new iy(i,r,n);return o.visible=!1,o}setMarker(t,i,n){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const r=t.getPointAt(i,"absolute");this.mouseMarkers[n].visible=!0,this.mouseMarkers[n].three.position.copy(r)}hideMarker(t){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const i=this.mouseMarkers[t].three;i.visible=!1}setupEvents(t){var n,r;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement;(n=this.world.renderer)==null||n.onResize.remove(this.updateLinesResolution),i.removeEventListener("click",this.onClick),i.removeEventListener("mousemove",this.onMouseMove),t&&(i.addEventListener("click",this.onClick),i.addEventListener("mousemove",this.onMouseMove),(r=this.world.renderer)==null||r.onResize.add(this.updateLinesResolution))}updateMarker(t,i){if(!this.mouseMarkers)return;const{point:n,object:r}=t,o=r,a=o.curve,l=o.curve.alignment,h=l.getPercentageAt(n,"absolute");this.mouseMarkers[i].visible=!0,this.mouseMarkers[i].three.position.copy(n),h!==null&&this.onMarkerChange.trigger({alignment:l,percentage:h,type:i,curve:a})}};et(ll,"uuid","0a59c09e-2b49-474a-9320-99f51f40f182");let hd=ll;var ny=Object.defineProperty,sy=(s,e,t)=>e in s?ny(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,x=(s,e,t)=>(sy(s,typeof e!="symbol"?e+"":e,t),t),ry=Object.defineProperty,oy=(s,e,t)=>e in s?ry(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,A=(s,e,t)=>(oy(s,typeof e!="symbol"?e+"":e,t),t);const Ff=0,ay=1,ly=2,ud=2,yc=1.25,dd=1,Ma=6*4+4+4,fl=65535,cy=Math.pow(2,-24),Ec=Symbol("SKIP_GENERATION");function hy(s){return s.index?s.index.count:s.attributes.position.count}function Hs(s){return hy(s)/3}function uy(s,e=ArrayBuffer){return s>65535?new Uint32Array(new e(4*s)):new Uint16Array(new e(2*s))}function dy(s,e){if(!s.index){const t=s.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=uy(t,i);s.setIndex(new gt(n,1));for(let r=0;r<t;r++)n[r]=r}}function Of(s){const e=Hs(s),t=s.drawRange,i=t.start/3,n=(t.start+t.count)/3,r=Math.max(0,i),o=Math.min(e,n)-r;return[{offset:Math.floor(r),count:Math.floor(o)}]}function Mf(s){if(!s.groups||!s.groups.length)return Of(s);const e=[],t=new Set,i=s.drawRange,n=i.start/3,r=(i.start+i.count)/3;for(const a of s.groups){const l=a.start/3,h=(a.start+a.count)/3;t.add(Math.max(n,l)),t.add(Math.min(r,h))}const o=Array.from(t.values()).sort((a,l)=>a-l);for(let a=0;a<o.length-1;a++){const l=o[a],h=o[a+1];e.push({offset:Math.floor(l),count:Math.floor(h-l)})}return e}function py(s){if(s.groups.length===0)return!1;const e=Hs(s),t=Mf(s).sort((r,o)=>r.offset-o.offset),i=t[t.length-1];i.count=Math.min(e-i.offset,i.count);let n=0;return t.forEach(({count:r})=>n+=r),e!==n}function Je(s,e,t){return t.min.x=e[s],t.min.y=e[s+1],t.min.z=e[s+2],t.max.x=e[s+3],t.max.y=e[s+4],t.max.z=e[s+5],t}function fy(s){s[0]=s[1]=s[2]=1/0,s[3]=s[4]=s[5]=-1/0}function pd(s){let e=-1,t=-1/0;for(let i=0;i<3;i++){const n=s[i+3]-s[i];n>t&&(t=n,e=i)}return e}function fd(s,e){e.set(s)}function md(s,e,t){let i,n;for(let r=0;r<3;r++){const o=r+3;i=s[r],n=e[r],t[r]=i<n?i:n,i=s[o],n=e[o],t[o]=i>n?i:n}}function qo(s,e,t){for(let i=0;i<3;i++){const n=e[s+2*i],r=e[s+2*i+1],o=n-r,a=n+r;o<t[i]&&(t[i]=o),a>t[i+3]&&(t[i+3]=a)}}function mr(s){const e=s[3]-s[0],t=s[4]-s[1],i=s[5]-s[2];return 2*(e*t+t*i+i*e)}function bc(s,e,t,i,n=null){let r=1/0,o=1/0,a=1/0,l=-1/0,h=-1/0,d=-1/0,p=1/0,f=1/0,g=1/0,v=-1/0,b=-1/0,w=-1/0;const T=n!==null;for(let S=e*6,_=(e+t)*6;S<_;S+=6){const I=s[S+0],P=s[S+1],M=I-P,k=I+P;M<r&&(r=M),k>l&&(l=k),T&&I<p&&(p=I),T&&I>v&&(v=I);const V=s[S+2],W=s[S+3],j=V-W,Q=V+W;j<o&&(o=j),Q>h&&(h=Q),T&&V<f&&(f=V),T&&V>b&&(b=V);const $=s[S+4],ne=s[S+5],oe=$-ne,ve=$+ne;oe<a&&(a=oe),ve>d&&(d=ve),T&&$<g&&(g=$),T&&$>w&&(w=$)}i[0]=r,i[1]=o,i[2]=a,i[3]=l,i[4]=h,i[5]=d,T&&(n[0]=p,n[1]=f,n[2]=g,n[3]=v,n[4]=b,n[5]=w)}function my(s,e,t,i){let n=1/0,r=1/0,o=1/0,a=-1/0,l=-1/0,h=-1/0;for(let d=e*6,p=(e+t)*6;d<p;d+=6){const f=s[d+0];f<n&&(n=f),f>a&&(a=f);const g=s[d+2];g<r&&(r=g),g>l&&(l=g);const v=s[d+4];v<o&&(o=v),v>h&&(h=v)}i[0]=n,i[1]=r,i[2]=o,i[3]=a,i[4]=l,i[5]=h}function gy(s,e){fy(e);const t=s.attributes.position,i=s.index?s.index.array:null,n=Hs(s),r=new Float32Array(n*6),o=t.normalized,a=t.array,l=t.offset||0;let h=3;t.isInterleavedBufferAttribute&&(h=t.data.stride);const d=["getX","getY","getZ"];for(let p=0;p<n;p++){const f=p*3,g=p*6;let v=f+0,b=f+1,w=f+2;i&&(v=i[v],b=i[b],w=i[w]),o||(v=v*h+l,b=b*h+l,w=w*h+l);for(let T=0;T<3;T++){let S,_,I;o?(S=t[d[T]](v),_=t[d[T]](b),I=t[d[T]](w)):(S=a[v+T],_=a[b+T],I=a[w+T]);let P=S;_<P&&(P=_),I<P&&(P=I);let M=S;_>M&&(M=_),I>M&&(M=I);const k=(M-P)/2,V=T*2;r[g+V+0]=P+k,r[g+V+1]=k+(Math.abs(P)+k)*cy,P<e[T]&&(e[T]=P),M>e[T+3]&&(e[T+3]=M)}}return r}const Ti=32,vy=(s,e)=>s.candidate-e.candidate,Xi=new Array(Ti).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Jo=new Float32Array(6);function yy(s,e,t,i,n,r){let o=-1,a=0;if(r===Ff)o=pd(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(r===ay)o=pd(s),o!==-1&&(a=Ey(t,i,n,o));else if(r===ly){const l=mr(s);let h=yc*n;const d=i*6,p=(i+n)*6;for(let f=0;f<3;f++){const g=e[f],v=(e[f+3]-g)/Ti;if(n<Ti/4){const b=[...Xi];b.length=n;let w=0;for(let S=d;S<p;S+=6,w++){const _=b[w];_.candidate=t[S+2*f],_.count=0;const{bounds:I,leftCacheBounds:P,rightCacheBounds:M}=_;for(let k=0;k<3;k++)M[k]=1/0,M[k+3]=-1/0,P[k]=1/0,P[k+3]=-1/0,I[k]=1/0,I[k+3]=-1/0;qo(S,t,I)}b.sort(vy);let T=n;for(let S=0;S<T;S++){const _=b[S];for(;S+1<T&&b[S+1].candidate===_.candidate;)b.splice(S+1,1),T--}for(let S=d;S<p;S+=6){const _=t[S+2*f];for(let I=0;I<T;I++){const P=b[I];_>=P.candidate?qo(S,t,P.rightCacheBounds):(qo(S,t,P.leftCacheBounds),P.count++)}}for(let S=0;S<T;S++){const _=b[S],I=_.count,P=n-_.count,M=_.leftCacheBounds,k=_.rightCacheBounds;let V=0;I!==0&&(V=mr(M)/l);let W=0;P!==0&&(W=mr(k)/l);const j=dd+yc*(V*I+W*P);j<h&&(o=f,h=j,a=_.candidate)}}else{for(let T=0;T<Ti;T++){const S=Xi[T];S.count=0,S.candidate=g+v+T*v;const _=S.bounds;for(let I=0;I<3;I++)_[I]=1/0,_[I+3]=-1/0}for(let T=d;T<p;T+=6){let S=~~((t[T+2*f]-g)/v);S>=Ti&&(S=Ti-1);const _=Xi[S];_.count++,qo(T,t,_.bounds)}const b=Xi[Ti-1];fd(b.bounds,b.rightCacheBounds);for(let T=Ti-2;T>=0;T--){const S=Xi[T],_=Xi[T+1];md(S.bounds,_.rightCacheBounds,S.rightCacheBounds)}let w=0;for(let T=0;T<Ti-1;T++){const S=Xi[T],_=S.count,I=S.bounds,P=Xi[T+1].rightCacheBounds;_!==0&&(w===0?fd(I,Jo):md(I,Jo,Jo)),w+=_;let M=0,k=0;w!==0&&(M=mr(Jo)/l);const V=n-w;V!==0&&(k=mr(P)/l);const W=dd+yc*(M*w+k*V);W<h&&(o=f,h=W,a=S.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${r} used.`);return{axis:o,pos:a}}function Ey(s,e,t,i){let n=0;for(let r=e,o=e+t;r<o;r++)n+=s[r*6+i*2];return n/t}let $o=class{constructor(){}};function by(s,e,t,i,n,r){let o=i,a=i+n-1;const l=r.pos,h=r.axis*2;for(;;){for(;o<=a&&t[o*6+h]<l;)o++;for(;o<=a&&t[a*6+h]>=l;)a--;if(o<a){for(let d=0;d<3;d++){let p=e[o*3+d];e[o*3+d]=e[a*3+d],e[a*3+d]=p}for(let d=0;d<6;d++){let p=t[o*6+d];t[o*6+d]=t[a*6+d],t[a*6+d]=p}o++,a--}else return o}}function wy(s,e,t,i,n,r){let o=i,a=i+n-1;const l=r.pos,h=r.axis*2;for(;;){for(;o<=a&&t[o*6+h]<l;)o++;for(;o<=a&&t[a*6+h]>=l;)a--;if(o<a){let d=s[o];s[o]=s[a],s[a]=d;for(let p=0;p<6;p++){let f=t[o*6+p];t[o*6+p]=t[a*6+p],t[a*6+p]=f}o++,a--}else return o}}function Iy(s,e){const t=(s.index?s.index.count:s.attributes.position.count)/3,i=t>2**16,n=i?4:2,r=e?new SharedArrayBuffer(t*n):new ArrayBuffer(t*n),o=i?new Uint32Array(r):new Uint16Array(r);for(let a=0,l=o.length;a<l;a++)o[a]=a;return o}function Cy(s,e){const t=s.geometry,i=t.index?t.index.array:null,n=e.maxDepth,r=e.verbose,o=e.maxLeafTris,a=e.strategy,l=e.onProgress,h=Hs(t),d=s._indirectBuffer;let p=!1;const f=new Float32Array(6),g=new Float32Array(6),v=gy(t,f),b=e.indirect?wy:by,w=[],T=e.indirect?Of(t):Mf(t);if(T.length===1){const I=T[0],P=new $o;P.boundingData=f,my(v,I.offset,I.count,g),_(P,I.offset,I.count,g),w.push(P)}else for(let I of T){const P=new $o;P.boundingData=new Float32Array(6),bc(v,I.offset,I.count,P.boundingData,g),_(P,I.offset,I.count,g),w.push(P)}return w;function S(I){l&&l(I/h)}function _(I,P,M,k=null,V=0){if(!p&&V>=n&&(p=!0,r&&(console.warn(`MeshBVH: Max depth of ${n} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),M<=o||V>=n)return S(P+M),I.offset=P,I.count=M,I;const W=yy(I.boundingData,k,v,P,M,a);if(W.axis===-1)return S(P+M),I.offset=P,I.count=M,I;const j=b(d,i,v,P,M,W);if(j===P||j===P+M)S(P+M),I.offset=P,I.count=M;else{I.splitAxis=W.axis;const Q=new $o,$=P,ne=j-P;I.left=Q,Q.boundingData=new Float32Array(6),bc(v,$,ne,Q.boundingData,g),_(Q,$,ne,g,V+1);const oe=new $o,ve=j,re=M-ne;I.right=oe,oe.boundingData=new Float32Array(6),bc(v,ve,re,oe.boundingData,g),_(oe,ve,re,g,V+1)}return I}}function Ty(s,e){const t=s.geometry;e.indirect&&(s._indirectBuffer=Iy(t,e.useSharedArrayBuffer),py(t)&&!e.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),s._indirectBuffer||dy(t,e);const i=Cy(s,e);let n,r,o;const a=[],l=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let p=0;p<i.length;p++){const f=i[p];let g=h(f);const v=new l(Ma*g);n=new Float32Array(v),r=new Uint32Array(v),o=new Uint16Array(v),d(0,f),a.push(v)}s._roots=a;return;function h(p){return p.count?1:1+h(p.left)+h(p.right)}function d(p,f){const g=p/4,v=p/2,b=!!f.count,w=f.boundingData;for(let T=0;T<6;T++)n[g+T]=w[T];if(b){const T=f.offset,S=f.count;return r[g+6]=T,o[v+14]=S,o[v+15]=fl,p+Ma}else{const T=f.left,S=f.right,_=f.splitAxis;let I;if(I=d(p+Ma,T),I/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[g+6]=I/4,I=d(I,S),r[g+7]=_,I}}}let Fi=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,n=-1/0;for(let r=0,o=e.length;r<o;r++){const a=e[r][t];i=a<i?a:i,n=a>n?a:n}this.min=i,this.max=n}setFromPoints(e,t){let i=1/0,n=-1/0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=e.dot(a);i=l<i?l:i,n=l>n?l:n}this.min=i,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}};Fi.prototype.setFromBox=function(){const s=new F;return function(e,t){const i=t.min,n=t.max;let r=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){s.x=i.x*a+n.x*(1-a),s.y=i.y*l+n.y*(1-l),s.z=i.z*h+n.z*(1-h);const d=e.dot(s);r=Math.min(d,r),o=Math.max(d,o)}this.min=r,this.max=o}}();const xy=function(){const s=new F,e=new F,t=new F;return function(i,n,r){const o=i.start,a=s,l=n.start,h=e;t.subVectors(o,l),s.subVectors(i.end,i.start),e.subVectors(n.end,n.start);const d=t.dot(h),p=h.dot(a),f=h.dot(h),g=t.dot(a),v=a.dot(a)*f-p*p;let b,w;v!==0?b=(d*p-g*f)/v:b=0,w=(d+b*p)/f,r.x=b,r.y=w}}(),$h=function(){const s=new Ve,e=new F,t=new F;return function(i,n,r,o){xy(i,n,s);let a=s.x,l=s.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,r),n.at(l,o);return}else if(a>=0&&a<=1){l<0?n.at(0,o):n.at(1,o),i.closestPointToPoint(o,!0,r);return}else if(l>=0&&l<=1){a<0?i.at(0,r):i.at(1,r),n.closestPointToPoint(r,!0,o);return}else{let h;a<0?h=i.start:h=i.end;let d;l<0?d=n.start:d=n.end;const p=e,f=t;if(i.closestPointToPoint(d,!0,e),n.closestPointToPoint(h,!0,t),p.distanceToSquared(d)<=f.distanceToSquared(h)){r.copy(p),o.copy(d);return}else{r.copy(h),o.copy(f);return}}}}(),Ay=function(){const s=new F,e=new F,t=new an,i=new Dt;return function(n,r){const{radius:o,center:a}=n,{a:l,b:h,c:d}=r;if(i.start=l,i.end=h,i.closestPointToPoint(a,!0,s).distanceTo(a)<=o||(i.start=l,i.end=d,i.closestPointToPoint(a,!0,s).distanceTo(a)<=o)||(i.start=h,i.end=d,i.closestPointToPoint(a,!0,s).distanceTo(a)<=o))return!0;const p=r.getPlane(t);if(Math.abs(p.distanceToPoint(a))<=o){const f=p.projectPoint(a,e);if(r.containsPoint(f))return!0}return!1}}(),Sy=1e-15;function wc(s){return Math.abs(s)<Sy}let si=class extends Fn{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new F),this.satBounds=new Array(4).fill().map(()=>new Fi),this.points=[this.a,this.b,this.c],this.sphere=new Gn,this.plane=new an,this.needsUpdate=!0}intersectsSphere(e){return Ay(e,this)}update(){const e=this.a,t=this.b,i=this.c,n=this.points,r=this.satAxes,o=this.satBounds,a=r[0],l=o[0];this.getNormal(a),l.setFromPoints(a,n);const h=r[1],d=o[1];h.subVectors(e,t),d.setFromPoints(h,n);const p=r[2],f=o[2];p.subVectors(t,i),f.setFromPoints(p,n);const g=r[3],v=o[3];g.subVectors(i,e),v.setFromPoints(g,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};si.prototype.closestPointToSegment=function(){const s=new F,e=new F,t=new Dt;return function(i,n=null,r=null){const{start:o,end:a}=i,l=this.points;let h,d=1/0;for(let p=0;p<3;p++){const f=(p+1)%3;t.start.copy(l[p]),t.end.copy(l[f]),$h(t,i,s,e),h=s.distanceToSquared(e),h<d&&(d=h,n&&n.copy(s),r&&r.copy(e))}return this.closestPointToPoint(o,s),h=o.distanceToSquared(s),h<d&&(d=h,n&&n.copy(s),r&&r.copy(o)),this.closestPointToPoint(a,s),h=a.distanceToSquared(s),h<d&&(d=h,n&&n.copy(s),r&&r.copy(a)),Math.sqrt(d)}}();si.prototype.intersectsTriangle=function(){const s=new si,e=new Array(3),t=new Array(3),i=new Fi,n=new Fi,r=new F,o=new F,a=new F,l=new F,h=new F,d=new Dt,p=new Dt,f=new Dt,g=new F;function v(b,w,T){const S=b.points;let _=0,I=-1;for(let P=0;P<3;P++){const{start:M,end:k}=d;M.copy(S[P]),k.copy(S[(P+1)%3]),d.delta(o);const V=wc(w.distanceToPoint(M));if(wc(w.normal.dot(o))&&V){T.copy(d),_=2;break}const W=w.intersectLine(d,g);if(!W&&V&&g.copy(M),(W||V)&&!wc(g.distanceTo(k))){if(_<=1)(_===1?T.start:T.end).copy(g),V&&(I=_);else if(_>=2){(I===1?T.start:T.end).copy(g),_=2;break}if(_++,_===2&&I===-1)break}}return _}return function(b,w=null,T=!1){this.needsUpdate&&this.update(),b.isExtendedTriangle?b.needsUpdate&&b.update():(s.copy(b),s.update(),b=s);const S=this.plane,_=b.plane;if(Math.abs(S.normal.dot(_.normal))>1-1e-10){const I=this.satBounds,P=this.satAxes;t[0]=b.a,t[1]=b.b,t[2]=b.c;for(let V=0;V<4;V++){const W=I[V],j=P[V];if(i.setFromPoints(j,t),W.isSeparated(i))return!1}const M=b.satBounds,k=b.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let V=0;V<4;V++){const W=M[V],j=k[V];if(i.setFromPoints(j,e),W.isSeparated(i))return!1}for(let V=0;V<4;V++){const W=P[V];for(let j=0;j<4;j++){const Q=k[j];if(r.crossVectors(W,Q),i.setFromPoints(r,e),n.setFromPoints(r,t),i.isSeparated(n))return!1}}return w&&(T||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),w.start.set(0,0,0),w.end.set(0,0,0)),!0}else{const I=v(this,_,p);if(I===1&&b.containsPoint(p.end))return w&&(w.start.copy(p.end),w.end.copy(p.end)),!0;if(I!==2)return!1;const P=v(b,S,f);if(P===1&&this.containsPoint(f.end))return w&&(w.start.copy(f.end),w.end.copy(f.end)),!0;if(P!==2)return!1;if(p.delta(a),f.delta(l),a.dot(l)<0){let $=f.start;f.start=f.end,f.end=$}const M=p.start.dot(a),k=p.end.dot(a),V=f.start.dot(a),W=f.end.dot(a),j=k<V,Q=M<W;return M!==W&&V!==k&&j===Q?!1:(w&&(h.subVectors(p.start,f.start),h.dot(a)>0?w.start.copy(p.start):w.start.copy(f.start),h.subVectors(p.end,f.end),h.dot(a)<0?w.end.copy(p.end):w.end.copy(f.end)),!0)}}}();si.prototype.distanceToPoint=function(){const s=new F;return function(e){return this.closestPointToPoint(e,s),e.distanceTo(s)}}();si.prototype.distanceToTriangle=function(){const s=new F,e=new F,t=["a","b","c"],i=new Dt,n=new Dt;return function(r,o=null,a=null){const l=o||a?i:null;if(this.intersectsTriangle(r,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let h=1/0;for(let d=0;d<3;d++){let p;const f=t[d],g=r[f];this.closestPointToPoint(g,s),p=g.distanceToSquared(s),p<h&&(h=p,o&&o.copy(s),a&&a.copy(g));const v=this[f];r.closestPointToPoint(v,s),p=v.distanceToSquared(s),p<h&&(h=p,o&&o.copy(v),a&&a.copy(s))}for(let d=0;d<3;d++){const p=t[d],f=t[(d+1)%3];i.set(this[p],this[f]);for(let g=0;g<3;g++){const v=t[g],b=t[(g+1)%3];n.set(r[v],r[b]),$h(i,n,s,e);const w=s.distanceToSquared(e);w<h&&(h=w,o&&o.copy(s),a&&a.copy(e))}}return Math.sqrt(h)}}();let xt=class{constructor(e,t,i){this.isOrientedBox=!0,this.min=new F,this.max=new F,this.matrix=new Ee,this.invMatrix=new Ee,this.points=new Array(8).fill().map(()=>new F),this.satAxes=new Array(3).fill().map(()=>new F),this.satBounds=new Array(3).fill().map(()=>new Fi),this.alignedSatBounds=new Array(3).fill().map(()=>new Fi),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};xt.prototype.update=function(){return function(){const s=this.matrix,e=this.min,t=this.max,i=this.points;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let d=0;d<=1;d++){const p=1*l|2*h|4*d,f=i[p];f.x=l?t.x:e.x,f.y=h?t.y:e.y,f.z=d?t.z:e.z,f.applyMatrix4(s)}const n=this.satBounds,r=this.satAxes,o=i[0];for(let l=0;l<3;l++){const h=r[l],d=n[l],p=1<<l,f=i[p];h.subVectors(o,f),d.setFromPoints(h,i)}const a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();xt.prototype.intersectsBox=function(){const s=new Fi;return function(e){this.needsUpdate&&this.update();const t=e.min,i=e.max,n=this.satBounds,r=this.satAxes,o=this.alignedSatBounds;if(s.min=t.x,s.max=i.x,o[0].isSeparated(s)||(s.min=t.y,s.max=i.y,o[1].isSeparated(s))||(s.min=t.z,s.max=i.z,o[2].isSeparated(s)))return!1;for(let a=0;a<3;a++){const l=r[a],h=n[a];if(s.setFromBox(l,e),h.isSeparated(s))return!1}return!0}}();xt.prototype.intersectsTriangle=function(){const s=new si,e=new Array(3),t=new Fi,i=new Fi,n=new F;return function(r){this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(s.copy(r),s.update(),r=s);const o=this.satBounds,a=this.satAxes;e[0]=r.a,e[1]=r.b,e[2]=r.c;for(let p=0;p<3;p++){const f=o[p],g=a[p];if(t.setFromPoints(g,e),f.isSeparated(t))return!1}const l=r.satBounds,h=r.satAxes,d=this.points;for(let p=0;p<3;p++){const f=l[p],g=h[p];if(t.setFromPoints(g,d),f.isSeparated(t))return!1}for(let p=0;p<3;p++){const f=a[p];for(let g=0;g<4;g++){const v=h[g];if(n.crossVectors(f,v),t.setFromPoints(n,e),i.setFromPoints(n,d),t.isSeparated(i))return!1}}return!0}}();xt.prototype.closestPointToPoint=function(){return function(s,e){return this.needsUpdate&&this.update(),e.copy(s).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();xt.prototype.distanceToPoint=function(){const s=new F;return function(e){return this.closestPointToPoint(e,s),e.distanceTo(s)}}();xt.prototype.distanceToBox=function(){const s=["x","y","z"],e=new Array(12).fill().map(()=>new Dt),t=new Array(12).fill().map(()=>new Dt),i=new F,n=new F;return function(r,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(r))return(a||l)&&(r.getCenter(n),this.closestPointToPoint(n,i),r.closestPointToPoint(i,n),a&&a.copy(i),l&&l.copy(n)),0;const h=o*o,d=r.min,p=r.max,f=this.points;let g=1/0;for(let b=0;b<8;b++){const w=f[b];n.copy(w).clamp(d,p);const T=w.distanceToSquared(n);if(T<g&&(g=T,a&&a.copy(w),l&&l.copy(n),T<h))return Math.sqrt(T)}let v=0;for(let b=0;b<3;b++)for(let w=0;w<=1;w++)for(let T=0;T<=1;T++){const S=(b+1)%3,_=(b+2)%3,I=w<<S|T<<_,P=1<<b|w<<S|T<<_,M=f[I],k=f[P];e[v].set(M,k);const V=s[b],W=s[S],j=s[_],Q=t[v],$=Q.start,ne=Q.end;$[V]=d[V],$[W]=w?d[W]:p[W],$[j]=T?d[j]:p[W],ne[V]=p[V],ne[W]=w?d[W]:p[W],ne[j]=T?d[j]:p[W],v++}for(let b=0;b<=1;b++)for(let w=0;w<=1;w++)for(let T=0;T<=1;T++){n.x=b?p.x:d.x,n.y=w?p.y:d.y,n.z=T?p.z:d.z,this.closestPointToPoint(n,i);const S=n.distanceToSquared(i);if(S<g&&(g=S,a&&a.copy(i),l&&l.copy(n),S<h))return Math.sqrt(S)}for(let b=0;b<12;b++){const w=e[b];for(let T=0;T<12;T++){const S=t[T];$h(w,S,i,n);const _=i.distanceToSquared(n);if(_<g&&(g=_,a&&a.copy(i),l&&l.copy(n),_<h))return Math.sqrt(_)}}return Math.sqrt(g)}}();let eu=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};class _y extends eu{constructor(){super(()=>new si)}}const Yt=new _y;function Ot(s,e){return e[s+15]===65535}function Lt(s,e){return e[s+6]}function Gt(s,e){return e[s+14]}function jt(s){return s+8}function Wt(s,e){return e[s+6]}function Lf(s,e){return e[s+7]}class Ry{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let t=null;this.setBuffer=i=>{t&&e.push(t),t=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,e.length!==0&&this.setBuffer(e.pop())}}}const Qe=new Ry;let Ji,As;const os=[],ea=new eu(()=>new Ke);function Py(s,e,t,i,n,r){Ji=ea.getPrimitive(),As=ea.getPrimitive(),os.push(Ji,As),Qe.setBuffer(s._roots[e]);const o=Zc(0,s.geometry,t,i,n,r);Qe.clearBuffer(),ea.releasePrimitive(Ji),ea.releasePrimitive(As),os.pop(),os.pop();const a=os.length;return a>0&&(As=os[a-1],Ji=os[a-2]),o}function Zc(s,e,t,i,n=null,r=0,o=0){const{float32Array:a,uint16Array:l,uint32Array:h}=Qe;let d=s*2;if(Ot(d,l)){const p=Lt(s,h),f=Gt(d,l);return Je(s,a,Ji),i(p,f,!1,o,r+s,Ji)}else{let p=function(Q){const{uint16Array:$,uint32Array:ne}=Qe;let oe=Q*2;for(;!Ot(oe,$);)Q=jt(Q),oe=Q*2;return Lt(Q,ne)},f=function(Q){const{uint16Array:$,uint32Array:ne}=Qe;let oe=Q*2;for(;!Ot(oe,$);)Q=Wt(Q,ne),oe=Q*2;return Lt(Q,ne)+Gt(oe,$)};const g=jt(s),v=Wt(s,h);let b=g,w=v,T,S,_,I;if(n&&(_=Ji,I=As,Je(b,a,_),Je(w,a,I),T=n(_),S=n(I),S<T)){b=v,w=g;const Q=T;T=S,S=Q,_=I}_||(_=Ji,Je(b,a,_));const P=Ot(b*2,l),M=t(_,P,T,o+1,r+b);let k;if(M===ud){const Q=p(b),$=f(b)-Q;k=i(Q,$,!0,o+1,r+b,_)}else k=M&&Zc(b,e,t,i,n,r,o+1);if(k)return!0;I=As,Je(w,a,I);const V=Ot(w*2,l),W=t(I,V,S,o+1,r+w);let j;if(W===ud){const Q=p(w),$=f(w)-Q;j=i(Q,$,!0,o+1,r+w,I)}else j=W&&Zc(w,e,t,i,n,r,o+1);return!!j}}const gr=new F,Ic=new F;function Fy(s,e,t={},i=0,n=1/0){const r=i*i,o=n*n;let a=1/0,l=null;if(s.shapecast({boundsTraverseOrder:d=>(gr.copy(e).clamp(d.min,d.max),gr.distanceToSquared(e)),intersectsBounds:(d,p,f)=>f<a&&f<o,intersectsTriangle:(d,p)=>{d.closestPointToPoint(e,gr);const f=e.distanceToSquared(gr);return f<a&&(Ic.copy(gr),a=f,l=p),f<r}}),a===1/0)return null;const h=Math.sqrt(a);return t.point?t.point.copy(Ic):t.point=Ic.clone(),t.distance=h,t.faceIndex=l,t}const as=new F,ls=new F,cs=new F,ta=new Ve,ia=new Ve,na=new Ve,gd=new F,vd=new F,yd=new F,sa=new F;function Oy(s,e,t,i,n,r){let o;return r===Qv?o=s.intersectTriangle(i,t,e,!0,n):o=s.intersectTriangle(e,t,i,r!==no,n),o===null?null:{distance:s.origin.distanceTo(n),point:n.clone()}}function My(s,e,t,i,n,r,o,a,l){as.fromBufferAttribute(e,r),ls.fromBufferAttribute(e,o),cs.fromBufferAttribute(e,a);const h=Oy(s,as,ls,cs,sa,l);if(h){i&&(ta.fromBufferAttribute(i,r),ia.fromBufferAttribute(i,o),na.fromBufferAttribute(i,a),h.uv=Fn.getInterpolation(sa,as,ls,cs,ta,ia,na,new Ve)),n&&(ta.fromBufferAttribute(n,r),ia.fromBufferAttribute(n,o),na.fromBufferAttribute(n,a),h.uv1=Fn.getInterpolation(sa,as,ls,cs,ta,ia,na,new Ve)),t&&(gd.fromBufferAttribute(t,r),vd.fromBufferAttribute(t,o),yd.fromBufferAttribute(t,a),h.normal=Fn.getInterpolation(sa,as,ls,cs,gd,vd,yd,new F),h.normal.dot(s.direction)>0&&h.normal.multiplyScalar(-1));const d={a:r,b:o,c:a,normal:new F,materialIndex:0};Fn.getNormal(as,ls,cs,d.normal),h.face=d,h.faceIndex=r}return h}function ml(s,e,t,i,n){const r=i*3;let o=r+0,a=r+1,l=r+2;const h=s.index;s.index&&(o=h.getX(o),a=h.getX(a),l=h.getX(l));const{position:d,normal:p,uv:f,uv1:g}=s.attributes,v=My(t,d,p,f,g,o,a,l,e);return v?(v.faceIndex=i,n&&n.push(v),v):null}function ot(s,e,t,i){const n=s.a,r=s.b,o=s.c;let a=e,l=e+1,h=e+2;t&&(a=t.getX(a),l=t.getX(l),h=t.getX(h)),n.x=i.getX(a),n.y=i.getY(a),n.z=i.getZ(a),r.x=i.getX(l),r.y=i.getY(l),r.z=i.getZ(l),o.x=i.getX(h),o.y=i.getY(h),o.z=i.getZ(h)}function Ly(s,e,t,i,n,r){const{geometry:o,_indirectBuffer:a}=s;for(let l=i,h=i+n;l<h;l++)ml(o,e,t,l,r)}function Dy(s,e,t,i,n){const{geometry:r,_indirectBuffer:o}=s;let a=1/0,l=null;for(let h=i,d=i+n;h<d;h++){let p;p=ml(r,e,t,h),p&&p.distance<a&&(l=p,a=p.distance)}return l}function Ny(s,e,t,i,n,r,o){const{geometry:a}=t,{index:l}=a,h=a.attributes.position;for(let d=s,p=e+s;d<p;d++){let f;if(f=d,ot(o,f*3,l,h),o.needsUpdate=!0,i(o,f,n,r))return!0}return!1}function Uy(s,e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=s.geometry,i=t.index?t.index.array:null,n=t.attributes.position;let r,o,a,l,h=0;const d=s._roots;for(let f=0,g=d.length;f<g;f++)r=d[f],o=new Uint32Array(r),a=new Uint16Array(r),l=new Float32Array(r),p(0,h),h+=r.byteLength;function p(f,g,v=!1){const b=f*2;if(a[b+15]===fl){const w=o[f+6],T=a[b+14];let S=1/0,_=1/0,I=1/0,P=-1/0,M=-1/0,k=-1/0;for(let V=3*w,W=3*(w+T);V<W;V++){let j=i[V];const Q=n.getX(j),$=n.getY(j),ne=n.getZ(j);Q<S&&(S=Q),Q>P&&(P=Q),$<_&&(_=$),$>M&&(M=$),ne<I&&(I=ne),ne>k&&(k=ne)}return l[f+0]!==S||l[f+1]!==_||l[f+2]!==I||l[f+3]!==P||l[f+4]!==M||l[f+5]!==k?(l[f+0]=S,l[f+1]=_,l[f+2]=I,l[f+3]=P,l[f+4]=M,l[f+5]=k,!0):!1}else{const w=f+8,T=o[f+6],S=w+g,_=T+g;let I=v,P=!1,M=!1;e?I||(P=e.has(S),M=e.has(_),I=!P&&!M):(P=!0,M=!0);const k=I||P,V=I||M;let W=!1;k&&(W=p(w,g,I));let j=!1;V&&(j=p(T,g,I));const Q=W||j;if(Q)for(let $=0;$<3;$++){const ne=w+$,oe=T+$,ve=l[ne],re=l[ne+3],ge=l[oe],me=l[oe+3];l[f+$]=ve<ge?ve:ge,l[f+$+3]=re>me?re:me}return Q}}}const Ed=new Ke;function nn(s,e,t,i){return Je(s,e,Ed),t.intersectBox(Ed,i)}function ky(s,e,t,i,n,r){const{geometry:o,_indirectBuffer:a}=s;for(let l=i,h=i+n;l<h;l++){let d=a?a[l]:l;ml(o,e,t,d,r)}}function By(s,e,t,i,n){const{geometry:r,_indirectBuffer:o}=s;let a=1/0,l=null;for(let h=i,d=i+n;h<d;h++){let p;p=ml(r,e,t,o?o[h]:h),p&&p.distance<a&&(l=p,a=p.distance)}return l}function zy(s,e,t,i,n,r,o){const{geometry:a}=t,{index:l}=a,h=a.attributes.position;for(let d=s,p=e+s;d<p;d++){let f;if(f=t.resolveTriangleIndex(d),ot(o,f*3,l,h),o.needsUpdate=!0,i(o,f,n,r))return!0}return!1}const bd=new F;function Vy(s,e,t,i,n){Qe.setBuffer(s._roots[e]),qc(0,s,t,i,n),Qe.clearBuffer()}function qc(s,e,t,i,n){const{float32Array:r,uint16Array:o,uint32Array:a}=Qe,l=s*2;if(Ot(l,o)){const h=Lt(s,a),d=Gt(l,o);Ly(e,t,i,h,d,n)}else{const h=jt(s);nn(h,r,i,bd)&&qc(h,e,t,i,n);const d=Wt(s,a);nn(d,r,i,bd)&&qc(d,e,t,i,n)}}const wd=new F,Hy=["x","y","z"];function Yy(s,e,t,i){Qe.setBuffer(s._roots[e]);const n=Jc(0,s,t,i);return Qe.clearBuffer(),n}function Jc(s,e,t,i){const{float32Array:n,uint16Array:r,uint32Array:o}=Qe;let a=s*2;if(Ot(a,r)){const l=Lt(s,o),h=Gt(a,r);return Dy(e,t,i,l,h)}else{const l=Lf(s,o),h=Hy[l],d=i.direction[h]>=0;let p,f;d?(p=jt(s),f=Wt(s,o)):(p=Wt(s,o),f=jt(s));const g=nn(p,n,i,wd)?Jc(p,e,t,i):null;if(g){const b=g.point[h];if(d?b<=n[f+l]:b>=n[f+l+3])return g}const v=nn(f,n,i,wd)?Jc(f,e,t,i):null;return g&&v?g.distance<=v.distance?g:v:g||v||null}}const ra=new Ke,hs=new si,us=new si,vr=new Ee,Id=new xt,oa=new xt;function Gy(s,e,t,i){Qe.setBuffer(s._roots[e]);const n=$c(0,s,t,i);return Qe.clearBuffer(),n}function $c(s,e,t,i,n=null){const{float32Array:r,uint16Array:o,uint32Array:a}=Qe;let l=s*2;if(n===null&&(t.boundingBox||t.computeBoundingBox(),Id.set(t.boundingBox.min,t.boundingBox.max,i),n=Id),Ot(l,o)){const h=e.geometry,d=h.index,p=h.attributes.position,f=t.index,g=t.attributes.position,v=Lt(s,a),b=Gt(l,o);if(vr.copy(i).invert(),t.boundsTree)return Je(s,r,oa),oa.matrix.copy(vr),oa.needsUpdate=!0,t.boundsTree.shapecast({intersectsBounds:w=>oa.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let T=v*3,S=(b+v)*3;T<S;T+=3)if(ot(us,T,d,p),us.needsUpdate=!0,w.intersectsTriangle(us))return!0;return!1}});for(let w=v*3,T=(b+v)*3;w<T;w+=3){ot(hs,w,d,p),hs.a.applyMatrix4(vr),hs.b.applyMatrix4(vr),hs.c.applyMatrix4(vr),hs.needsUpdate=!0;for(let S=0,_=f.count;S<_;S+=3)if(ot(us,S,f,g),us.needsUpdate=!0,hs.intersectsTriangle(us))return!0}}else{const h=s+8,d=a[s+6];return Je(h,r,ra),!!(n.intersectsBox(ra)&&$c(h,e,t,i,n)||(Je(d,r,ra),n.intersectsBox(ra)&&$c(d,e,t,i,n)))}}const aa=new Ee,Cc=new xt,yr=new xt,jy=new F,Wy=new F,Xy=new F,Ky=new F;function Qy(s,e,t,i={},n={},r=0,o=1/0){e.boundingBox||e.computeBoundingBox(),Cc.set(e.boundingBox.min,e.boundingBox.max,t),Cc.needsUpdate=!0;const a=s.geometry,l=a.attributes.position,h=a.index,d=e.attributes.position,p=e.index,f=Yt.getPrimitive(),g=Yt.getPrimitive();let v=jy,b=Wy,w=null,T=null;n&&(w=Xy,T=Ky);let S=1/0,_=null,I=null;return aa.copy(t).invert(),yr.matrix.copy(aa),s.shapecast({boundsTraverseOrder:P=>Cc.distanceToBox(P),intersectsBounds:(P,M,k)=>k<S&&k<o?(M&&(yr.min.copy(P.min),yr.max.copy(P.max),yr.needsUpdate=!0),!0):!1,intersectsRange:(P,M)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:k=>yr.distanceToBox(k),intersectsBounds:(k,V,W)=>W<S&&W<o,intersectsRange:(k,V)=>{for(let W=k,j=k+V;W<j;W++){ot(g,3*W,p,d),g.a.applyMatrix4(t),g.b.applyMatrix4(t),g.c.applyMatrix4(t),g.needsUpdate=!0;for(let Q=P,$=P+M;Q<$;Q++){ot(f,3*Q,h,l),f.needsUpdate=!0;const ne=f.distanceToTriangle(g,v,w);if(ne<S&&(b.copy(v),T&&T.copy(w),S=ne,_=Q,I=W),ne<r)return!0}}}});{const k=Hs(e);for(let V=0,W=k;V<W;V++){ot(g,3*V,p,d),g.a.applyMatrix4(t),g.b.applyMatrix4(t),g.c.applyMatrix4(t),g.needsUpdate=!0;for(let j=P,Q=P+M;j<Q;j++){ot(f,3*j,h,l),f.needsUpdate=!0;const $=f.distanceToTriangle(g,v,w);if($<S&&(b.copy(v),T&&T.copy(w),S=$,_=j,I=V),$<r)return!0}}}}}),Yt.releasePrimitive(f),Yt.releasePrimitive(g),S===1/0?null:(i.point?i.point.copy(b):i.point=b.clone(),i.distance=S,i.faceIndex=_,n&&(n.point?n.point.copy(T):n.point=T.clone(),n.point.applyMatrix4(aa),b.applyMatrix4(aa),n.distance=b.sub(n.point).length(),n.faceIndex=I),i)}function Zy(s,e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=s.geometry,i=t.index?t.index.array:null,n=t.attributes.position;let r,o,a,l,h=0;const d=s._roots;for(let f=0,g=d.length;f<g;f++)r=d[f],o=new Uint32Array(r),a=new Uint16Array(r),l=new Float32Array(r),p(0,h),h+=r.byteLength;function p(f,g,v=!1){const b=f*2;if(a[b+15]===fl){const w=o[f+6],T=a[b+14];let S=1/0,_=1/0,I=1/0,P=-1/0,M=-1/0,k=-1/0;for(let V=w,W=w+T;V<W;V++){const j=3*s.resolveTriangleIndex(V);for(let Q=0;Q<3;Q++){let $=j+Q;$=i?i[$]:$;const ne=n.getX($),oe=n.getY($),ve=n.getZ($);ne<S&&(S=ne),ne>P&&(P=ne),oe<_&&(_=oe),oe>M&&(M=oe),ve<I&&(I=ve),ve>k&&(k=ve)}}return l[f+0]!==S||l[f+1]!==_||l[f+2]!==I||l[f+3]!==P||l[f+4]!==M||l[f+5]!==k?(l[f+0]=S,l[f+1]=_,l[f+2]=I,l[f+3]=P,l[f+4]=M,l[f+5]=k,!0):!1}else{const w=f+8,T=o[f+6],S=w+g,_=T+g;let I=v,P=!1,M=!1;e?I||(P=e.has(S),M=e.has(_),I=!P&&!M):(P=!0,M=!0);const k=I||P,V=I||M;let W=!1;k&&(W=p(w,g,I));let j=!1;V&&(j=p(T,g,I));const Q=W||j;if(Q)for(let $=0;$<3;$++){const ne=w+$,oe=T+$,ve=l[ne],re=l[ne+3],ge=l[oe],me=l[oe+3];l[f+$]=ve<ge?ve:ge,l[f+$+3]=re>me?re:me}return Q}}}const Cd=new F;function qy(s,e,t,i,n){Qe.setBuffer(s._roots[e]),eh(0,s,t,i,n),Qe.clearBuffer()}function eh(s,e,t,i,n){const{float32Array:r,uint16Array:o,uint32Array:a}=Qe,l=s*2;if(Ot(l,o)){const h=Lt(s,a),d=Gt(l,o);ky(e,t,i,h,d,n)}else{const h=jt(s);nn(h,r,i,Cd)&&eh(h,e,t,i,n);const d=Wt(s,a);nn(d,r,i,Cd)&&eh(d,e,t,i,n)}}const Td=new F,Jy=["x","y","z"];function $y(s,e,t,i){Qe.setBuffer(s._roots[e]);const n=th(0,s,t,i);return Qe.clearBuffer(),n}function th(s,e,t,i){const{float32Array:n,uint16Array:r,uint32Array:o}=Qe;let a=s*2;if(Ot(a,r)){const l=Lt(s,o),h=Gt(a,r);return By(e,t,i,l,h)}else{const l=Lf(s,o),h=Jy[l],d=i.direction[h]>=0;let p,f;d?(p=jt(s),f=Wt(s,o)):(p=Wt(s,o),f=jt(s));const g=nn(p,n,i,Td)?th(p,e,t,i):null;if(g){const b=g.point[h];if(d?b<=n[f+l]:b>=n[f+l+3])return g}const v=nn(f,n,i,Td)?th(f,e,t,i):null;return g&&v?g.distance<=v.distance?g:v:g||v||null}}const la=new Ke,ds=new si,ps=new si,Er=new Ee,xd=new xt,ca=new xt;function e1(s,e,t,i){Qe.setBuffer(s._roots[e]);const n=ih(0,s,t,i);return Qe.clearBuffer(),n}function ih(s,e,t,i,n=null){const{float32Array:r,uint16Array:o,uint32Array:a}=Qe;let l=s*2;if(n===null&&(t.boundingBox||t.computeBoundingBox(),xd.set(t.boundingBox.min,t.boundingBox.max,i),n=xd),Ot(l,o)){const h=e.geometry,d=h.index,p=h.attributes.position,f=t.index,g=t.attributes.position,v=Lt(s,a),b=Gt(l,o);if(Er.copy(i).invert(),t.boundsTree)return Je(s,r,ca),ca.matrix.copy(Er),ca.needsUpdate=!0,t.boundsTree.shapecast({intersectsBounds:w=>ca.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let T=v,S=b+v;T<S;T++)if(ot(ps,3*e.resolveTriangleIndex(T),d,p),ps.needsUpdate=!0,w.intersectsTriangle(ps))return!0;return!1}});for(let w=v,T=b+v;w<T;w++){const S=e.resolveTriangleIndex(w);ot(ds,3*S,d,p),ds.a.applyMatrix4(Er),ds.b.applyMatrix4(Er),ds.c.applyMatrix4(Er),ds.needsUpdate=!0;for(let _=0,I=f.count;_<I;_+=3)if(ot(ps,_,f,g),ps.needsUpdate=!0,ds.intersectsTriangle(ps))return!0}}else{const h=s+8,d=a[s+6];return Je(h,r,la),!!(n.intersectsBox(la)&&ih(h,e,t,i,n)||(Je(d,r,la),n.intersectsBox(la)&&ih(d,e,t,i,n)))}}const ha=new Ee,Tc=new xt,br=new xt,t1=new F,i1=new F,n1=new F,s1=new F;function r1(s,e,t,i={},n={},r=0,o=1/0){e.boundingBox||e.computeBoundingBox(),Tc.set(e.boundingBox.min,e.boundingBox.max,t),Tc.needsUpdate=!0;const a=s.geometry,l=a.attributes.position,h=a.index,d=e.attributes.position,p=e.index,f=Yt.getPrimitive(),g=Yt.getPrimitive();let v=t1,b=i1,w=null,T=null;n&&(w=n1,T=s1);let S=1/0,_=null,I=null;return ha.copy(t).invert(),br.matrix.copy(ha),s.shapecast({boundsTraverseOrder:P=>Tc.distanceToBox(P),intersectsBounds:(P,M,k)=>k<S&&k<o?(M&&(br.min.copy(P.min),br.max.copy(P.max),br.needsUpdate=!0),!0):!1,intersectsRange:(P,M)=>{if(e.boundsTree){const k=e.boundsTree;return k.shapecast({boundsTraverseOrder:V=>br.distanceToBox(V),intersectsBounds:(V,W,j)=>j<S&&j<o,intersectsRange:(V,W)=>{for(let j=V,Q=V+W;j<Q;j++){const $=k.resolveTriangleIndex(j);ot(g,3*$,p,d),g.a.applyMatrix4(t),g.b.applyMatrix4(t),g.c.applyMatrix4(t),g.needsUpdate=!0;for(let ne=P,oe=P+M;ne<oe;ne++){const ve=s.resolveTriangleIndex(ne);ot(f,3*ve,h,l),f.needsUpdate=!0;const re=f.distanceToTriangle(g,v,w);if(re<S&&(b.copy(v),T&&T.copy(w),S=re,_=ne,I=j),re<r)return!0}}}})}else{const k=Hs(e);for(let V=0,W=k;V<W;V++){ot(g,3*V,p,d),g.a.applyMatrix4(t),g.b.applyMatrix4(t),g.c.applyMatrix4(t),g.needsUpdate=!0;for(let j=P,Q=P+M;j<Q;j++){const $=s.resolveTriangleIndex(j);ot(f,3*$,h,l),f.needsUpdate=!0;const ne=f.distanceToTriangle(g,v,w);if(ne<S&&(b.copy(v),T&&T.copy(w),S=ne,_=j,I=V),ne<r)return!0}}}}}),Yt.releasePrimitive(f),Yt.releasePrimitive(g),S===1/0?null:(i.point?i.point.copy(b):i.point=b.clone(),i.distance=S,i.faceIndex=_,n&&(n.point?n.point.copy(T):n.point=T.clone(),n.point.applyMatrix4(ha),b.applyMatrix4(ha),n.distance=b.sub(n.point).length(),n.faceIndex=I),i)}function o1(){return typeof SharedArrayBuffer<"u"}const Mr=new Qe.constructor,Ya=new Qe.constructor,Zi=new eu(()=>new Ke),fs=new Ke,ms=new Ke,xc=new Ke,Ac=new Ke;let Sc=!1;function a1(s,e,t,i){if(Sc)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Sc=!0;const n=s._roots,r=e._roots;let o,a=0,l=0;const h=new Ee().copy(t).invert();for(let d=0,p=n.length;d<p;d++){Mr.setBuffer(n[d]),l=0;const f=Zi.getPrimitive();Je(0,Mr.float32Array,f),f.applyMatrix4(h);for(let g=0,v=r.length;g<v&&(Ya.setBuffer(r[d]),o=ei(0,0,t,h,i,a,l,0,0,f),Ya.clearBuffer(),l+=r[g].length,!o);g++);if(Zi.releasePrimitive(f),Mr.clearBuffer(),a+=n[d].length,o)break}return Sc=!1,o}function ei(s,e,t,i,n,r=0,o=0,a=0,l=0,h=null,d=!1){let p,f;d?(p=Ya,f=Mr):(p=Mr,f=Ya);const g=p.float32Array,v=p.uint32Array,b=p.uint16Array,w=f.float32Array,T=f.uint32Array,S=f.uint16Array,_=s*2,I=e*2,P=Ot(_,b),M=Ot(I,S);let k=!1;if(M&&P)d?k=n(Lt(e,T),Gt(e*2,S),Lt(s,v),Gt(s*2,b),l,o+e,a,r+s):k=n(Lt(s,v),Gt(s*2,b),Lt(e,T),Gt(e*2,S),a,r+s,l,o+e);else if(M){const V=Zi.getPrimitive();Je(e,w,V),V.applyMatrix4(t);const W=jt(s),j=Wt(s,v);Je(W,g,fs),Je(j,g,ms);const Q=V.intersectsBox(fs),$=V.intersectsBox(ms);k=Q&&ei(e,W,i,t,n,o,r,l,a+1,V,!d)||$&&ei(e,j,i,t,n,o,r,l,a+1,V,!d),Zi.releasePrimitive(V)}else{const V=jt(e),W=Wt(e,T);Je(V,w,xc),Je(W,w,Ac);const j=h.intersectsBox(xc),Q=h.intersectsBox(Ac);if(j&&Q)k=ei(s,V,t,i,n,r,o,a,l+1,h,d)||ei(s,W,t,i,n,r,o,a,l+1,h,d);else if(j)if(P)k=ei(s,V,t,i,n,r,o,a,l+1,h,d);else{const $=Zi.getPrimitive();$.copy(xc).applyMatrix4(t);const ne=jt(s),oe=Wt(s,v);Je(ne,g,fs),Je(oe,g,ms);const ve=$.intersectsBox(fs),re=$.intersectsBox(ms);k=ve&&ei(V,ne,i,t,n,o,r,l,a+1,$,!d)||re&&ei(V,oe,i,t,n,o,r,l,a+1,$,!d),Zi.releasePrimitive($)}else if(Q)if(P)k=ei(s,W,t,i,n,r,o,a,l+1,h,d);else{const $=Zi.getPrimitive();$.copy(Ac).applyMatrix4(t);const ne=jt(s),oe=Wt(s,v);Je(ne,g,fs),Je(oe,g,ms);const ve=$.intersectsBox(fs),re=$.intersectsBox(ms);k=ve&&ei(W,ne,i,t,n,o,r,l,a+1,$,!d)||re&&ei(W,oe,i,t,n,o,r,l,a+1,$,!d),Zi.releasePrimitive($)}}return k}const ua=new xt,Ad=new Ke;let l1=class Df{static serialize(e,t={}){t={cloneBuffers:!0,...t};const i=e.geometry,n=e._roots,r=e._indirectBuffer,o=i.getIndex();let a;return t.cloneBuffers?a={roots:n.map(l=>l.slice()),index:o.array.slice(),indirectBuffer:r?r.slice():null}:a={roots:n,index:o.array,indirectBuffer:r},a}static deserialize(e,t,i={}){i={setIndex:!0,indirect:!!e.indirectBuffer,...i};const{index:n,roots:r,indirectBuffer:o}=e,a=new Df(t,{...i,[Ec]:!0});if(a._roots=r,a._indirectBuffer=o||null,i.setIndex){const l=t.getIndex();if(l===null){const h=new gt(e.index,1,!1);t.setIndex(h)}else l.array!==n&&(l.array.set(n),l.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:Ff,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[Ec]:!1},t),t.useSharedArrayBuffer&&!o1())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[Ec]||(Ty(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Ke)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=t.indirect?n=>i[n]:n=>n}refit(e=null){return(this.indirect?Zy:Uy)(this,e)}traverse(e,t=0){const i=this._roots[t],n=new Uint32Array(i),r=new Uint16Array(i);o(0);function o(a,l=0){const h=a*2,d=r[h+15]===fl;if(d){const p=n[a+6],f=r[h+14];e(l,d,new Float32Array(i,a*4,6),p,f)}else{const p=a+Ma/4,f=n[a+6],g=n[a+7];e(l,d,new Float32Array(i,a*4,6),g)||(o(p,l+1),o(f,l+1))}}}raycast(e,t=ad){const i=this._roots,n=this.geometry,r=[],o=t.isMaterial,a=Array.isArray(t),l=n.groups,h=o?t.side:t,d=this.indirect?qy:Vy;for(let p=0,f=i.length;p<f;p++){const g=a?t[l[p].materialIndex].side:h,v=r.length;if(d(this,p,g,e,r),a){const b=l[p].materialIndex;for(let w=v,T=r.length;w<T;w++)r[w].face.materialIndex=b}}return r}raycastFirst(e,t=ad){const i=this._roots,n=this.geometry,r=t.isMaterial,o=Array.isArray(t);let a=null;const l=n.groups,h=r?t.side:t,d=this.indirect?$y:Yy;for(let p=0,f=i.length;p<f;p++){const g=o?t[l[p].materialIndex].side:h,v=d(this,p,g,e);v!=null&&(a==null||v.distance<a.distance)&&(a=v,o&&(v.face.materialIndex=l[p].materialIndex))}return a}intersectsGeometry(e,t){let i=!1;const n=this._roots,r=this.indirect?e1:Gy;for(let o=0,a=n.length;o<a&&(i=r(this,o,e,t),!i);o++);return i}shapecast(e){const t=Yt.getPrimitive(),i=this.indirect?zy:Ny;let{boundsTraverseOrder:n,intersectsBounds:r,intersectsRange:o,intersectsTriangle:a}=e;if(o&&a){const p=o;o=(f,g,v,b,w)=>p(f,g,v,b,w)?!0:i(f,g,this,a,v,b,t)}else o||(a?o=(p,f,g,v)=>i(p,f,this,a,g,v,t):o=(p,f,g)=>g);let l=!1,h=0;const d=this._roots;for(let p=0,f=d.length;p<f;p++){const g=d[p];if(l=Py(this,p,r,o,n,h),l)break;h+=g.byteLength}return Yt.releasePrimitive(t),l}bvhcast(e,t,i){let{intersectsRanges:n,intersectsTriangles:r}=i;const o=Yt.getPrimitive(),a=this.geometry.index,l=this.geometry.attributes.position,h=this.indirect?v=>{const b=this.resolveTriangleIndex(v);ot(o,b*3,a,l)}:v=>{ot(o,v*3,a,l)},d=Yt.getPrimitive(),p=e.geometry.index,f=e.geometry.attributes.position,g=e.indirect?v=>{const b=e.resolveTriangleIndex(v);ot(d,b*3,p,f)}:v=>{ot(d,v*3,p,f)};if(r){const v=(b,w,T,S,_,I,P,M)=>{for(let k=T,V=T+S;k<V;k++){g(k),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let W=b,j=b+w;W<j;W++)if(h(W),o.needsUpdate=!0,r(o,d,W,k,_,I,P,M))return!0}return!1};if(n){const b=n;n=function(w,T,S,_,I,P,M,k){return b(w,T,S,_,I,P,M,k)?!0:v(w,T,S,_,I,P,M,k)}}else n=v}return a1(this,e,t,n)}intersectsBox(e,t){return ua.set(e.min,e.max,t),ua.needsUpdate=!0,this.shapecast({intersectsBounds:i=>ua.intersectsBox(i),intersectsTriangle:i=>ua.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},n={},r=0,o=1/0){return(this.indirect?r1:Qy)(this,e,t,i,n,r,o)}closestPointToPoint(e,t={},i=0,n=1/0){return Fy(this,e,t,i,n)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Je(0,new Float32Array(t),Ad),e.union(Ad)}),e}};function Sd(s,e,t){return s===null||(s.point.applyMatrix4(e.matrixWorld),s.distance=s.point.distanceTo(t.ray.origin),s.object=e,s.distance<t.near||s.distance>t.far)?null:s}const _c=new Pv,_d=new Ee,c1=le.prototype.raycast;function h1(s,e){if(this.geometry.boundsTree){if(this.material===void 0)return;_d.copy(this.matrixWorld).invert(),_c.copy(s.ray).applyMatrix4(_d);const t=this.geometry.boundsTree;if(s.firstHitOnly===!0){const i=Sd(t.raycastFirst(_c,this.material),this,s);i&&e.push(i)}else{const i=t.raycast(_c,this.material);for(let n=0,r=i.length;n<r;n++){const o=Sd(i[n],this,s);o&&e.push(o)}}}else c1.call(this,s,e)}function u1(s){return this.boundsTree=new l1(this,s),this.boundsTree}function d1(){this.boundsTree=null}class ee{constructor(){A(this,"trigger",e=>{const t=this.handlers.slice(0);for(const i of t)i(e)}),A(this,"handlers",[])}add(e){this.handlers.push(e)}remove(e){this.handlers=this.handlers.filter(t=>t!==e)}reset(){this.handlers.length=0}}let $i=class{constructor(){A(this,"trigger",async e=>{const t=this.handlers.slice(0);for(const i of t)await i(e)}),A(this,"handlers",[])}add(e){this.handlers.push(e)}remove(e){this.handlers=this.handlers.filter(t=>t!==e)}reset(){this.handlers.length=0}},tu=class{constructor(e){A(this,"isDisposeable",()=>"dispose"in this&&"onDisposed"in this),A(this,"isResizeable",()=>"resize"in this&&"getSize"in this),A(this,"isUpdateable",()=>"onAfterUpdate"in this&&"onBeforeUpdate"in this&&"update"in this),A(this,"isHideable",()=>"visible"in this),A(this,"isConfigurable",()=>"setup"in this&&"config"in this&&"onSetup"in this),this.components=e}},Re=class extends tu{},Nf=class extends tu{constructor(e){super(e),A(this,"worlds",new Map),A(this,"onWorldChanged",new ee),A(this,"currentWorld",null),this.onWorldChanged.add(({world:t,action:i})=>{i==="removed"&&this.worlds.delete(t.uuid)})}};class p1 extends Nf{constructor(){super(...arguments),A(this,"hasCameraControls",()=>"controls"in this)}}class f1 extends Nf{constructor(){super(...arguments),A(this,"onAfterUpdate",new ee),A(this,"onBeforeUpdate",new ee),A(this,"onDisposed",new ee),A(this,"onResize",new ee),A(this,"onClippingPlanesUpdated",new ee),A(this,"clippingPlanes",[])}updateClippingPlanes(){this.onClippingPlanesUpdated.trigger()}setPlane(e,t,i){t.isLocal=i;const n=this.clippingPlanes.indexOf(t);e&&n===-1?this.clippingPlanes.push(t):!e&&n>-1&&this.clippingPlanes.splice(n,1),this.three.clippingPlanes=this.clippingPlanes.filter(r=>!r.isLocal)}}const Uf=class nh extends Re{constructor(e){super(e),A(this,"_disposedComponents",new Set),A(this,"enabled",!0),e.add(nh.uuid,this)}get(){return this._disposedComponents}destroy(e,t=!0,i=!0){e.removeFromParent();const n=e;n.dispose&&n.dispose(),this.disposeGeometryAndMaterials(e,t),i&&n.children&&n.children.length&&this.disposeChildren(n),e.children.length=0}disposeGeometry(e){const t=e;t.boundsTree&&t.disposeBoundsTree(),e.dispose()}disposeGeometryAndMaterials(e,t){const i=e;i.geometry&&this.disposeGeometry(i.geometry),t&&i.material&&nh.disposeMaterial(i),i.material=[],i.geometry=null}disposeChildren(e){for(const t of e.children)this.destroy(t)}static disposeMaterial(e){if(e.material)if(Array.isArray(e.material))for(const t of e.material)t.dispose();else e.material.dispose()}};A(Uf,"uuid","76e9cd8e-ad8f-4753-9ef6-cbc60f7247fe");let Oi=Uf;const La=0,m1=1,g1=new F,Rd=new Dt,Rc=new an,Pd=new F,da=new Fn;class v1{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new Fd,this.unassigned=new Fd,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.vertices.push(new y1(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse(function(i){const n=i.geometry;if(n!==void 0){const r=n.attributes.position;if(r!==void 0)for(let o=0,a=r.count;o<a;o++){const l=new F;l.fromBufferAttribute(r,o).applyMatrix4(i.matrixWorld),t.push(l)}}}),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let i=0,n=t.length;i<n;i++)if(t[i].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const i=this.faces;let n=-1/0,r=1/0;for(let o=0,a=i.length;o<a;o++){const l=i[o],h=l.distanceToPoint(e.origin),d=l.normal.dot(e.direction);if(h>0&&d>=0)return null;const p=d!==0?-h/d:0;if(!(p<=0)&&(d>0?r=Math.min(p,r):n=Math.max(p,n),n>r))return null}return n!==-1/0?e.at(n,t):e.at(r,t),t}intersectsRay(e){return this.intersectRay(e,g1)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,t.outside===null?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(e.next!==null&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(e.outside!==null){const t=e.outside;let i=e.outside;for(;i.next!==null&&i.next.face===e;)i=i.next;return this.assigned.removeSubList(t,i),t.prev=i.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const i=this.removeAllVerticesFromFace(e);if(i!==void 0)if(t===void 0)this.unassigned.appendChain(i);else{let n=i;do{const r=n.next;t.distanceToPoint(n.point)>this.tolerance?this.addVertexToFace(n,t):this.unassigned.append(n),n=r}while(n!==null)}return this}resolveUnassignedPoints(e){if(this.unassigned.isEmpty()===!1){let t=this.unassigned.first();do{const i=t.next;let n=this.tolerance,r=null;for(let o=0;o<e.length;o++){const a=e[o];if(a.mark===La){const l=a.distanceToPoint(t.point);if(l>n&&(n=l,r=a),n>1e3*this.tolerance)break}}r!==null&&this.addVertexToFace(t,r),t=i}while(t!==null)}return this}computeExtremes(){const e=new F,t=new F,i=[],n=[];for(let r=0;r<3;r++)i[r]=n[r]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let r=0,o=this.vertices.length;r<o;r++){const a=this.vertices[r],l=a.point;for(let h=0;h<3;h++)l.getComponent(h)<e.getComponent(h)&&(e.setComponent(h,l.getComponent(h)),i[h]=a);for(let h=0;h<3;h++)l.getComponent(h)>t.getComponent(h)&&(t.setComponent(h,l.getComponent(h)),n[h]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:i,max:n}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),i=t.min,n=t.max;let r=0,o=0;for(let f=0;f<3;f++){const g=n[f].point.getComponent(f)-i[f].point.getComponent(f);g>r&&(r=g,o=f)}const a=i[o],l=n[o];let h,d;r=0,Rd.set(a.point,l.point);for(let f=0,g=this.vertices.length;f<g;f++){const v=e[f];if(v!==a&&v!==l){Rd.closestPointToPoint(v.point,!0,Pd);const b=Pd.distanceToSquared(v.point);b>r&&(r=b,h=v)}}r=-1,Rc.setFromCoplanarPoints(a.point,l.point,h.point);for(let f=0,g=this.vertices.length;f<g;f++){const v=e[f];if(v!==a&&v!==l&&v!==h){const b=Math.abs(Rc.distanceToPoint(v.point));b>r&&(r=b,d=v)}}const p=[];if(Rc.distanceToPoint(d.point)<0){p.push(Ci.create(a,l,h),Ci.create(d,l,a),Ci.create(d,h,l),Ci.create(d,a,h));for(let f=0;f<3;f++){const g=(f+1)%3;p[f+1].getEdge(2).setTwin(p[0].getEdge(g)),p[f+1].getEdge(1).setTwin(p[g+1].getEdge(0))}}else{p.push(Ci.create(a,h,l),Ci.create(d,a,l),Ci.create(d,l,h),Ci.create(d,h,a));for(let f=0;f<3;f++){const g=(f+1)%3;p[f+1].getEdge(2).setTwin(p[0].getEdge((3-f)%3)),p[f+1].getEdge(0).setTwin(p[g+1].getEdge(1))}}for(let f=0;f<4;f++)this.faces.push(p[f]);for(let f=0,g=e.length;f<g;f++){const v=e[f];if(v!==a&&v!==l&&v!==h&&v!==d){r=this.tolerance;let b=null;for(let w=0;w<4;w++){const T=this.faces[w].distanceToPoint(v.point);T>r&&(r=T,b=this.faces[w])}b!==null&&this.addVertexToFace(v,b)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const i=this.faces[t];i.mark===La&&e.push(i)}return this.faces=e,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let e,t=0;const i=this.assigned.first().face;let n=i.outside;do{const r=i.distanceToPoint(n.point);r>t&&(t=r,e=n),n=n.next}while(n!==null&&n.face===i);return e}}computeHorizon(e,t,i,n){this.deleteFaceVertices(i),i.mark=m1;let r;t===null?r=t=i.getEdge(0):r=t.next;do{const o=r.twin,a=o.face;a.mark===La&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,a,n):n.push(r)),r=r.next}while(r!==t);return this}addAdjoiningFace(e,t){const i=Ci.create(e,t.tail(),t.head());return this.faces.push(i),i.getEdge(-1).setTwin(t.twin),i.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let i=null,n=null;for(let r=0;r<t.length;r++){const o=t[r],a=this.addAdjoiningFace(e,o);i===null?i=a:a.next.setTwin(n),this.newFaces.push(a.face),n=a}return i.next.setTwin(n),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();(e=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}let Ci=class kf{constructor(){this.normal=new F,this.midpoint=new F,this.area=0,this.constant=0,this.outside=null,this.mark=La,this.edge=null}static create(e,t,i){const n=new kf,r=new Pc(e,n),o=new Pc(t,n),a=new Pc(i,n);return r.next=a.prev=o,o.next=r.prev=a,a.next=o.prev=r,n.edge=r,n.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),i=this.edge.next.head();return da.set(e.point,t.point,i.point),da.getNormal(this.normal),da.getMidpoint(this.midpoint),this.area=da.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}},Pc=class{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return t!==null?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return t!==null?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}};class y1{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}let Fd=class{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,t.prev===null?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,t.next===null?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail;e.next!==null;)e=e.next;return this.tail=e,this}remove(e){return e.prev===null?this.head=e.next:e.prev.next=e.next,e.next===null?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return e.prev===null?this.head=t.next:e.prev.next=t.next,t.next===null?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return this.head===null}};const sh=[2,2,1],rh=[1,0,0];function gi(s,e){return s*3+e}function E1(s){const e=s.elements;let t=0;for(let i=0;i<9;i++)t+=e[i]*e[i];return Math.sqrt(t)}function b1(s){const e=s.elements;let t=0;for(let i=0;i<3;i++){const n=e[gi(sh[i],rh[i])];t+=2*n*n}return Math.sqrt(t)}function w1(s,e){let t=0,i=1;const n=s.elements;for(let h=0;h<3;h++){const d=Math.abs(n[gi(sh[h],rh[h])]);d>t&&(t=d,i=h)}let r=1,o=0;const a=rh[i],l=sh[i];if(Math.abs(n[gi(l,a)])>Number.EPSILON){const h=n[gi(l,l)],d=n[gi(a,a)],p=n[gi(l,a)],f=(h-d)/2/p;let g;f<0?g=-1/(-f+Math.sqrt(1+f*f)):g=1/(f+Math.sqrt(1+f*f)),r=1/Math.sqrt(1+g*g),o=g*r}return e.identity(),e.elements[gi(a,a)]=r,e.elements[gi(l,l)]=r,e.elements[gi(l,a)]=o,e.elements[gi(a,l)]=-o,e}function I1(s,e){let t=0,i=0;const n=10;e.unitary.identity(),e.diagonal.copy(s);const r=e.unitary,o=e.diagonal,a=new On,l=new On,h=Number.EPSILON*E1(o);for(;i<n&&b1(o)>h;)w1(o,a),l.copy(a).transpose(),o.multiply(a),o.premultiply(l),r.multiply(a),++t>2&&(i++,t=0);return e}function C1(s){const e=[];for(let He=0;He<s.length-2;He+=3){const fe=s[He],We=s[He+1],qt=s[He+2];e.push(new F(fe,We,qt))}const t=new v1;t.setFromPoints(e);const i={unitary:new On,diagonal:new On},n=t.faces,r=[],o=[];for(let He=0,fe=n.length;He<fe;He++){const We=n[He];let qt=We.edge;r.length=0;do r.push(qt),qt=qt.next;while(qt!==We.edge);const Le=r.length-2;for(let ai=1,Ml=Le;ai<=Ml;ai++){const Jt=r[0].vertex,Js=r[ai+0].vertex,$s=r[ai+1].vertex;o.push(Jt.point.x,Jt.point.y,Jt.point.z),o.push(Js.point.x,Js.point.y,Js.point.z),o.push($s.point.x,$s.point.y,$s.point.z)}}const a=new F,l=new F,h=new F,d=new F,p=new F,f=new F,g=new F,v=new F;let b=0,w=0,T=0,S=0,_=0,I=0,P=0;for(let He=0,fe=o.length;He<fe;He+=9){a.fromArray(o,He),l.fromArray(o,He+3),h.fromArray(o,He+6),g.set(0,0,0),g.add(a).add(l).add(h).divideScalar(3),d.subVectors(l,a),p.subVectors(h,a);const We=f.crossVectors(d,p).length()/2;v.add(f.copy(g).multiplyScalar(We)),b+=We,w+=(9*g.x*g.x+a.x*a.x+l.x*l.x+h.x*h.x)*(We/12),T+=(9*g.x*g.y+a.x*a.y+l.x*l.y+h.x*h.y)*(We/12),S+=(9*g.x*g.z+a.x*a.z+l.x*l.z+h.x*h.z)*(We/12),_+=(9*g.y*g.y+a.y*a.y+l.y*l.y+h.y*h.y)*(We/12),I+=(9*g.y*g.z+a.y*a.z+l.y*l.z+h.y*h.z)*(We/12),P+=(9*g.z*g.z+a.z*a.z+l.z*l.z+h.z*h.z)*(We/12)}v.divideScalar(b),w/=b,T/=b,S/=b,_/=b,I/=b,P/=b,w-=v.x*v.x,T-=v.x*v.y,S-=v.x*v.z,_-=v.y*v.y,I-=v.y*v.z,P-=v.z*v.z;const M=new On;M.elements[0]=w,M.elements[1]=T,M.elements[2]=S,M.elements[3]=T,M.elements[4]=_,M.elements[5]=I,M.elements[6]=S,M.elements[7]=I,M.elements[8]=P,I1(M,i);const k=i.unitary,V=new F,W=new F,j=new F;k.extractBasis(V,W,j);let Q=-1/0,$=-1/0,ne=-1/0,oe=1/0,ve=1/0,re=1/0;for(let He=0,fe=e.length;He<fe;He++){const We=e[He];Q=Math.max(V.dot(We),Q),$=Math.max(W.dot(We),$),ne=Math.max(j.dot(We),ne),oe=Math.min(V.dot(We),oe),ve=Math.min(W.dot(We),ve),re=Math.min(j.dot(We),re)}V.multiplyScalar(.5*(oe+Q)),W.multiplyScalar(.5*(ve+$)),j.multiplyScalar(.5*(re+ne));const ge=new F,me=new F,we=new On;ge.add(V).add(W).add(j),me.x=Q-oe,me.y=$-ve,me.z=ne-re,me.multiplyScalar(.5),we.copy(k);const{x:Ge,y:Pt,z:Bi}=me,At=new Ee;At.makeScale(Ge*2,Pt*2,Bi*2);const fn=new Ee;fn.makeTranslation(-Ge,-Pt,-Bi);const je=new Ee;je.makeTranslation(ge.x,ge.y,ge.z);const ke=new Ee;ke.setFromMatrix3(we);const It=new Ee;return It.multiply(je),It.multiply(ke),It.multiply(fn),It.multiply(At),{center:ge,halfSizes:me,rotation:we,transformation:It}}function T1(s,e,t){const i=[s[0]-e[0],s[1]-e[1],s[2]-e[2]];return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]>0}let Od=class{static isTransparent(e){return e.transparent&&e.opacity<1}};const oh=class ht{static create(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return`${ht._lut[e&255]+ht._lut[e>>8&255]+ht._lut[e>>16&255]+ht._lut[e>>24&255]}-${ht._lut[t&255]}${ht._lut[t>>8&255]}-${ht._lut[t>>16&15|64]}${ht._lut[t>>24&255]}-${ht._lut[i&63|128]}${ht._lut[i>>8&255]}-${ht._lut[i>>16&255]}${ht._lut[i>>24&255]}${ht._lut[n&255]}${ht._lut[n>>8&255]}${ht._lut[n>>16&255]}${ht._lut[n>>24&255]}`.toLowerCase()}static validate(e){if(!ht._pattern.test(e))throw new Error(`${e} is not a valid UUID v4.

- If you're the tool creator, you can take one from https://www.uuidgenerator.net/.

- If you're using a platform tool, verify the uuid isn't misspelled or contact the tool creator.`)}};A(oh,"_pattern",/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/),A(oh,"_lut",["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"]);let iu=oh;class x1 extends Re{constructor(e,t){super(e),A(this,"onVertexFound",new ee),A(this,"onVertexLost",new ee),A(this,"components"),A(this,"_pickedPoint",null),A(this,"_config"),A(this,"_enabled",!1),A(this,"_workingPlane",null),this.components=e,this.config={snapDistance:.25,showOnlyVertex:!1,...t},this.enabled=!1}set enabled(e){this._enabled=e,e||(this._pickedPoint=null)}get enabled(){return this._enabled}set workingPlane(e){this._workingPlane=e}get workingPlane(){return this._workingPlane}set config(e){this._config={...this._config,...e}}get config(){return this._config}dispose(){this.onVertexFound.reset(),this.onVertexLost.reset(),this.components=null}get(e){if(!this.enabled)return this._pickedPoint;const t=this.components.get(ni).get(e).castRay();if(!t)return this._pickedPoint!==null&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint;const i=this.getClosestVertex(t);return i?!this.workingPlane||Math.abs(this.workingPlane.distanceToPoint(i))<.001?((this._pickedPoint===null||!this._pickedPoint.equals(i))&&(this._pickedPoint=i.clone(),this.onVertexFound.trigger(this._pickedPoint)),this._pickedPoint):(this._pickedPoint=null,this._pickedPoint):(this._pickedPoint!==null&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint)}getClosestVertex(e){let t=new F,i=!1,n=Number.MAX_SAFE_INTEGER;const r=this.getVertices(e);return r==null||r.forEach(o=>{if(!o)return;const a=e.point.distanceTo(o);a>n||a>this._config.snapDistance||(i=!0,t=o,n=e.point.distanceTo(o))}),i?t:this.config.showOnlyVertex?null:e.point}getVertices(e){const t=e.object;if(!e.face||!t)return null;const i=t.geometry;return[this.getVertex(e.face.a,i),this.getVertex(e.face.b,i),this.getVertex(e.face.c,i)].map(n=>n==null?void 0:n.applyMatrix4(t.matrixWorld))}getVertex(e,t){if(e===void 0)return null;const i=t.attributes.position;return new F(i.getX(e),i.getY(e),i.getZ(e))}}const Bf=class zf{constructor(){A(this,"onDisposed",new ee),A(this,"list",new Map),A(this,"enabled",!1),A(this,"_clock"),A(this,"update",()=>{if(!this.enabled)return;const e=this._clock.getDelta();for(const[t,i]of this.list)i.enabled&&i.isUpdateable()&&i.update(e);requestAnimationFrame(this.update)}),this._clock=new vf,zf.setupBVH()}add(e,t){if(this.list.has(e))throw new Error("You're trying to add a component that already exists in the components intance. Use Components.get() instead.");iu.validate(e),this.list.set(e,t)}get(e){const t=e.uuid;if(!this.list.has(t)){const i=new e(this);return this.list.has(t)||this.add(t,i),i}return this.list.get(t)}init(){this.enabled=!0,this._clock.start(),this.update()}dispose(){this.enabled=!1;for(const[e,t]of this.list)t.enabled=!1,t.isDisposeable()&&t.dispose();this._clock.stop(),this.onDisposed.trigger(),this.onDisposed.reset()}static setupBVH(){Ne.prototype.computeBoundsTree=u1,Ne.prototype.disposeBoundsTree=d1,le.prototype.raycast=h1}};A(Bf,"release","1.4.21");let A1=Bf;class S1{constructor(e){A(this,"_event"),A(this,"_position",new Ve),A(this,"onDisposed",new ee),A(this,"updateMouseInfo",t=>{this._event=t}),this.dom=e,this.setupEvents(!0)}get position(){if(this._event){const e=this.dom.getBoundingClientRect();this._position.x=this.getPositionX(e,this._event),this._position.y=this.getPositionY(e,this._event)}return this._position}dispose(){this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset()}getPositionY(e,t){return-((t.clientY-e.top)/(e.bottom-e.top))*2+1}getPositionX(e,t){return(t.clientX-e.left)/(e.right-e.left)*2-1}setupEvents(e){e?this.dom.addEventListener("mousemove",this.updateMouseInfo):this.dom.removeEventListener("mousemove",this.updateMouseInfo)}}class _1{constructor(e,t){A(this,"enabled",!0),A(this,"components"),A(this,"onDisposed",new ee),A(this,"mouse"),A(this,"three",new io),A(this,"world");const i=t.renderer;if(!i)throw new Error("A renderer is needed for the raycaster to work!");this.world=t,this.mouse=new S1(i.three.domElement),this.components=e}dispose(){this.mouse.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}castRay(e=Array.from(this.world.meshes)){if(!this.world)throw new Error("A world is needed to cast rays!");const t=this.world.camera.three;return this.three.setFromCamera(this.mouse.position,t),this.intersect(e)}castRayFromVector(e,t,i=Array.from(this.world.meshes)){return this.three.set(e,t),this.intersect(i)}intersect(e=Array.from(this.world.meshes)){const t=this.three.intersectObjects(e),i=this.filterClippingPlanes(t);return i.length>0?i[0]:null}filterClippingPlanes(e){if(!this.world.renderer)throw new Error("Renderer not found!");const t=this.world.renderer.three;if(!t.clippingPlanes)return e;const i=t.clippingPlanes;return e.length<=0||!i||(i==null?void 0:i.length)<=0?e:e.filter(n=>i.every(r=>r.distanceToPoint(n.point)>0))}}const Vf=class Hf extends Re{constructor(e){super(e),A(this,"enabled",!0),A(this,"list",new Map),A(this,"onDisposed",new ee),e.add(Hf.uuid,this)}get(e){if(this.list.has(e.uuid))return this.list.get(e.uuid);const t=new _1(this.components,e);return this.list.set(e.uuid,t),e.onDisposed.add(()=>{this.delete(e)}),t}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}};A(Vf,"uuid","d5d8bdf0-db25-4952-b951-b643af207ace");let ni=Vf;class R1 extends tu{constructor(e){super(e),A(this,"meshes",new Set),A(this,"onAfterUpdate",new ee),A(this,"onBeforeUpdate",new ee),A(this,"enabled",!0),A(this,"uuid",iu.create()),A(this,"onDisposed",new ee),A(this,"_scene"),A(this,"_camera"),A(this,"_renderer",null)}get scene(){if(!this._scene)throw new Error("No scene initialized!");return this._scene}set scene(e){this._scene=e,e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"})}get camera(){if(!this._camera)throw new Error("No camera initialized!");return this._camera}set camera(e){this._camera=e,e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"})}get renderer(){return this._renderer}set renderer(e){this._renderer=e,e&&(e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"}))}update(e){this.enabled&&(!this._scene||!this._camera||(this.scene.currentWorld=this,this.camera.currentWorld=this,this.renderer&&(this.renderer.currentWorld=this),this.onBeforeUpdate.trigger(),this.scene.isUpdateable()&&this.scene.update(e),this.camera.isUpdateable()&&this.camera.update(e),this.renderer&&this.renderer.update(e),this.onAfterUpdate.trigger()))}dispose(e=!0){if(this.enabled=!1,this.scene.onWorldChanged.trigger({world:this,action:"removed"}),this.camera.onWorldChanged.trigger({world:this,action:"removed"}),this.renderer&&this.renderer.onWorldChanged.trigger({world:this,action:"removed"}),e){const t=this.components.get(Oi);this.scene.dispose(),this.camera.isDisposeable()&&this.camera.dispose(),this.renderer&&this.renderer.dispose();for(const i of this.meshes)t.destroy(i);this.meshes.clear()}this._scene=null,this._camera=null,this._renderer=null,this.onDisposed.trigger()}}class P1 extends f1{constructor(e,t,i){super(e),A(this,"enabled",!0),A(this,"container"),A(this,"three"),A(this,"_canvas"),A(this,"_parameters"),A(this,"_resizeObserver",null),A(this,"onContainerUpdated",new ee),A(this,"_resizing",!1),A(this,"resize",o=>{if(this._resizing)return;this._resizing=!0,this.onContainerUpdated.trigger();const a=o?o.x:this.container.clientWidth,l=o?o.y:this.container.clientHeight;this.three.setSize(a,l),this.onResize.trigger(new Ve(a,l)),this._resizing=!1}),A(this,"resizeEvent",()=>{this.resize()}),A(this,"onContextLost",o=>{o.preventDefault(),this.enabled=!1}),A(this,"onContextBack",()=>{this.three.setRenderTarget(null),this.three.dispose(),this.three=new Ha({canvas:this._canvas,antialias:!0,alpha:!0,...this._parameters}),this.enabled=!0}),this.container=t,this._parameters=i,this.three=new Ha({antialias:!0,alpha:!0,...i}),this.three.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.setupRenderer(),this.setupEvents(!0),this.resize(),this._canvas=this.three.domElement;const n=this.three.getContext(),{canvas:r}=n;r.addEventListener("webglcontextlost",this.onContextLost,!1),r.addEventListener("webglcontextrestored",this.onContextBack,!1)}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger(this);const e=this.currentWorld.scene.three,t=this.currentWorld.camera.three;this.three.render(e,t),this.onAfterUpdate.trigger(this)}dispose(){this.enabled=!1,this.setupEvents(!1),this.three.domElement.remove(),this.three.dispose(),this.onResize.reset(),this.onAfterUpdate.reset(),this.onBeforeUpdate.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}getSize(){return new Ve(this.three.domElement.clientWidth,this.three.domElement.clientHeight)}setupEvents(e){const t=this.three.domElement.parentElement;if(!t)throw new Error("This renderer needs to have an HTML container!");this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),window.removeEventListener("resize",this.resizeEvent),e&&(this._resizeObserver=new ResizeObserver(this.resizeEvent),this._resizeObserver.observe(t),window.addEventListener("resize",this.resizeEvent))}setupRenderer(){this.three.localClippingEnabled=!0,this.container&&this.container.appendChild(this.three.domElement),this.onContainerUpdated.trigger()}}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Ce={LEFT:1,RIGHT:2,MIDDLE:4},J=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),gs={NONE:0,IN:1,OUT:-1};function Cn(s){return s.isPerspectiveCamera}function Qi(s){return s.isOrthographicCamera}const vs=Math.PI*2,Md=Math.PI/2,Yf=1e-5,wr=Math.PI/180;function ti(s,e,t){return Math.max(e,Math.min(t,s))}function Ye(s,e=Yf){return Math.abs(s)<e}function De(s,e,t=Yf){return Ye(s-e,t)}function Ld(s,e){return Math.round(s/e)*e}function Ir(s){return isFinite(s)?s:s<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Cr(s){return Math.abs(s)<Number.MAX_VALUE?s:s*(1/0)}function pa(s,e,t,i,n=1/0,r){i=Math.max(1e-4,i);const o=2/i,a=o*r,l=1/(1+a+.48*a*a+.235*a*a*a);let h=s-e;const d=e,p=n*i;h=ti(h,-p,p),e=s-h;const f=(t.value+o*h)*r;t.value=(t.value-o*f)*l;let g=e+(h+f)*l;return d-s>0==g>d&&(g=d,t.value=(g-d)/r),g}function Dd(s,e,t,i,n=1/0,r,o){i=Math.max(1e-4,i);const a=2/i,l=a*r,h=1/(1+l+.48*l*l+.235*l*l*l);let d=e.x,p=e.y,f=e.z,g=s.x-d,v=s.y-p,b=s.z-f;const w=d,T=p,S=f,_=n*i,I=_*_,P=g*g+v*v+b*b;if(P>I){const ve=Math.sqrt(P);g=g/ve*_,v=v/ve*_,b=b/ve*_}d=s.x-g,p=s.y-v,f=s.z-b;const M=(t.x+a*g)*r,k=(t.y+a*v)*r,V=(t.z+a*b)*r;t.x=(t.x-a*M)*h,t.y=(t.y-a*k)*h,t.z=(t.z-a*V)*h,o.x=d+(g+M)*h,o.y=p+(v+k)*h,o.z=f+(b+V)*h;const W=w-s.x,j=T-s.y,Q=S-s.z,$=o.x-w,ne=o.y-T,oe=o.z-S;return W*$+j*ne+Q*oe>0&&(o.x=w,o.y=T,o.z=S,t.x=(o.x-w)/r,t.y=(o.y-T)/r,t.z=(o.z-S)/r),o}function Fc(s,e){e.set(0,0),s.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=s.length,e.y/=s.length}function Oc(s,e){return Qi(s)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class F1{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners[e];if(i!==void 0){const n=i.indexOf(t);n!==-1&&i.splice(n,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const t=this._listeners[e.type];if(t!==void 0){e.target=this;const i=t.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}const O1="2.7.3",fa=1/8,Gf=typeof window<"u",M1=Gf&&/Mac/.test(navigator.platform),L1=!(Gf&&"PointerEvent"in window);let be,Nd,ma,Mc,St,Te,Fe,ys,Tr,ui,di,Tn,Ud,kd,zt,xr,Es,Bd,Lc,zd,Dc,Nc,ga,Mt=class ah extends F1{static install(e){be=e.THREE,Nd=Object.freeze(new be.Vector3(0,0,0)),ma=Object.freeze(new be.Vector3(0,1,0)),Mc=Object.freeze(new be.Vector3(0,0,1)),St=new be.Vector2,Te=new be.Vector3,Fe=new be.Vector3,ys=new be.Vector3,Tr=new be.Vector3,ui=new be.Vector3,di=new be.Vector3,Tn=new be.Vector3,Ud=new be.Vector3,kd=new be.Vector3,zt=new be.Spherical,xr=new be.Spherical,Es=new be.Box3,Bd=new be.Box3,Lc=new be.Sphere,zd=new be.Quaternion,Dc=new be.Quaternion,Nc=new be.Matrix4,ga=new be.Raycaster}static get ACTION(){return J}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=J.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=gs.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new be.Vector3,this._focalOffsetVelocity=new be.Vector3,this._zoomVelocity={value:0},this._truckInternal=(I,P,M)=>{let k,V;if(Cn(this._camera)){const W=Te.copy(this._camera.position).sub(this._target),j=this._camera.getEffectiveFOV()*wr,Q=W.length()*Math.tan(j*.5);k=this.truckSpeed*I*Q/this._elementRect.height,V=this.truckSpeed*P*Q/this._elementRect.height}else if(Qi(this._camera)){const W=this._camera;k=I*(W.right-W.left)/W.zoom/this._elementRect.width,V=P*(W.top-W.bottom)/W.zoom/this._elementRect.height}else return;this.verticalDragToForward?(M?this.setFocalOffset(this._focalOffsetEnd.x+k,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(k,0,!0),this.forward(-V,!0)):M?this.setFocalOffset(this._focalOffsetEnd.x+k,this._focalOffsetEnd.y+V,this._focalOffsetEnd.z,!0):this.truck(k,V,!0)},this._rotateInternal=(I,P)=>{const M=vs*this.azimuthRotateSpeed*I/this._elementRect.height,k=vs*this.polarRotateSpeed*P/this._elementRect.height;this.rotate(M,k,!0)},this._dollyInternal=(I,P,M)=>{const k=Math.pow(.95,-I*this.dollySpeed),V=this._sphericalEnd.radius,W=this._sphericalEnd.radius*k,j=ti(W,this.minDistance,this.maxDistance),Q=j-W;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(W,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(Q,!0),this._dollyToNoClamp(j,!0)):this._dollyToNoClamp(j,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?W:j)-V,this._dollyControlCoord.set(P,M)),this._lastDollyDirection=Math.sign(-I)},this._zoomInternal=(I,P,M)=>{const k=Math.pow(.95,I*this.dollySpeed),V=this._zoom,W=this._zoom*k;this.zoomTo(W,!0),this.dollyToCursor&&(this._changedZoom+=W-V,this._dollyControlCoord.set(P,M))},typeof be>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new be.Quaternion().setFromUnitVectors(this._camera.up,ma),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=J.NONE,this._target=new be.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new be.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new be.Spherical().setFromVector3(Te.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new be.Vector3,new be.Vector3,new be.Vector3,new be.Vector3],this._updateNearPlaneCorners(),this._boundary=new be.Box3(new be.Vector3(-1/0,-1/0,-1/0),new be.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new be.Vector2,this.mouseButtons={left:J.ROTATE,middle:J.DOLLY,right:J.TRUCK,wheel:Cn(this._camera)?J.DOLLY:Qi(this._camera)?J.ZOOM:J.NONE},this.touches={one:J.TOUCH_ROTATE,two:Cn(this._camera)?J.TOUCH_DOLLY_TRUCK:Qi(this._camera)?J.TOUCH_ZOOM_TRUCK:J.NONE,three:J.TOUCH_TRUCK};const i=new be.Vector2,n=new be.Vector2,r=new be.Vector2,o=I=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const k=this._domElement.getBoundingClientRect(),V=I.clientX/k.width,W=I.clientY/k.height;if(V<this._interactiveArea.left||V>this._interactiveArea.right||W<this._interactiveArea.top||W>this._interactiveArea.bottom)return}const P=I.pointerType!=="mouse"?null:(I.buttons&Ce.LEFT)===Ce.LEFT?Ce.LEFT:(I.buttons&Ce.MIDDLE)===Ce.MIDDLE?Ce.MIDDLE:(I.buttons&Ce.RIGHT)===Ce.RIGHT?Ce.RIGHT:null;if(P!==null){const k=this._findPointerByMouseButton(P);k&&this._disposePointer(k)}if((I.buttons&Ce.LEFT)===Ce.LEFT&&this._lockedPointer)return;const M={pointerId:I.pointerId,clientX:I.clientX,clientY:I.clientY,deltaX:0,deltaY:0,mouseButton:P};this._activePointers.push(M),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),this._isDragging=!0,b(I)},a=I=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const k=this._domElement.getBoundingClientRect(),V=I.clientX/k.width,W=I.clientY/k.height;if(V<this._interactiveArea.left||V>this._interactiveArea.right||W<this._interactiveArea.top||W>this._interactiveArea.bottom)return}const P=(I.buttons&Ce.LEFT)===Ce.LEFT?Ce.LEFT:(I.buttons&Ce.MIDDLE)===Ce.MIDDLE?Ce.MIDDLE:(I.buttons&Ce.RIGHT)===Ce.RIGHT?Ce.RIGHT:null;if(P!==null){const k=this._findPointerByMouseButton(P);k&&this._disposePointer(k)}const M={pointerId:1,clientX:I.clientX,clientY:I.clientY,deltaX:0,deltaY:0,mouseButton:(I.buttons&Ce.LEFT)===Ce.LEFT?Ce.LEFT:(I.buttons&Ce.MIDDLE)===Ce.LEFT?Ce.MIDDLE:(I.buttons&Ce.RIGHT)===Ce.LEFT?Ce.RIGHT:null};this._activePointers.push(M),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("mouseup",p),this._domElement.ownerDocument.addEventListener("mousemove",h),this._domElement.ownerDocument.addEventListener("mouseup",p),this._isDragging=!0,b(I)},l=I=>{I.cancelable&&I.preventDefault();const P=I.pointerId,M=this._lockedPointer||this._findPointerById(P);if(M){if(M.clientX=I.clientX,M.clientY=I.clientY,M.deltaX=I.movementX,M.deltaY=I.movementY,this._state=0,I.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(I.buttons&Ce.LEFT)===Ce.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(I.buttons&Ce.MIDDLE)===Ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(I.buttons&Ce.RIGHT)===Ce.RIGHT&&(this._state=this._state|this.mouseButtons.right);w()}},h=I=>{const P=this._lockedPointer||this._findPointerById(1);P&&(P.clientX=I.clientX,P.clientY=I.clientY,P.deltaX=I.movementX,P.deltaY=I.movementY,this._state=0,(this._lockedPointer||(I.buttons&Ce.LEFT)===Ce.LEFT)&&(this._state=this._state|this.mouseButtons.left),(I.buttons&Ce.MIDDLE)===Ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(I.buttons&Ce.RIGHT)===Ce.RIGHT&&(this._state=this._state|this.mouseButtons.right),w())},d=I=>{const P=this._findPointerById(I.pointerId);if(!(P&&P===this._lockedPointer)){if(P&&this._disposePointer(P),I.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=J.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=J.NONE;T()}},p=()=>{const I=this._findPointerById(1);I&&I===this._lockedPointer||(I&&this._disposePointer(I),this._state=J.NONE,T())};let f=-1;const g=I=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===J.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const W=this._domElement.getBoundingClientRect(),j=I.clientX/W.width,Q=I.clientY/W.height;if(j<this._interactiveArea.left||j>this._interactiveArea.right||Q<this._interactiveArea.top||Q>this._interactiveArea.bottom)return}if(I.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===J.ROTATE||this.mouseButtons.wheel===J.TRUCK){const W=performance.now();f-W<1e3&&this._getClientRect(this._elementRect),f=W}const P=M1?-1:-3,M=I.deltaMode===1?I.deltaY/P:I.deltaY/(P*10),k=this.dollyToCursor?(I.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,V=this.dollyToCursor?(I.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case J.ROTATE:{this._rotateInternal(I.deltaX,I.deltaY),this._isUserControllingRotate=!0;break}case J.TRUCK:{this._truckInternal(I.deltaX,I.deltaY,!1),this._isUserControllingTruck=!0;break}case J.OFFSET:{this._truckInternal(I.deltaX,I.deltaY,!0),this._isUserControllingOffset=!0;break}case J.DOLLY:{this._dollyInternal(-M,k,V),this._isUserControllingDolly=!0;break}case J.ZOOM:{this._zoomInternal(-M,k,V),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},v=I=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===ah.ACTION.NONE){const P=I instanceof PointerEvent?I.pointerId:0,M=this._findPointerById(P);M&&this._disposePointer(M),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("mouseup",p);return}I.preventDefault()}},b=I=>{if(this._enabled){if(Fc(this._activePointers,St),this._getClientRect(this._elementRect),i.copy(St),n.copy(St),this._activePointers.length>=2){const P=St.x-this._activePointers[1].clientX,M=St.y-this._activePointers[1].clientY,k=Math.sqrt(P*P+M*M);r.set(0,k);const V=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,W=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(V,W)}if(this._state=0,!I)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in I&&I.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(I.buttons&Ce.LEFT)===Ce.LEFT&&(this._state=this._state|this.mouseButtons.left),(I.buttons&Ce.MIDDLE)===Ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(I.buttons&Ce.RIGHT)===Ce.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&J.ROTATE)===J.ROTATE||(this._state&J.TOUCH_ROTATE)===J.TOUCH_ROTATE||(this._state&J.TOUCH_DOLLY_ROTATE)===J.TOUCH_DOLLY_ROTATE||(this._state&J.TOUCH_ZOOM_ROTATE)===J.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&J.TRUCK)===J.TRUCK||(this._state&J.TOUCH_TRUCK)===J.TOUCH_TRUCK||(this._state&J.TOUCH_DOLLY_TRUCK)===J.TOUCH_DOLLY_TRUCK||(this._state&J.TOUCH_ZOOM_TRUCK)===J.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&J.DOLLY)===J.DOLLY||(this._state&J.TOUCH_DOLLY)===J.TOUCH_DOLLY||(this._state&J.TOUCH_DOLLY_TRUCK)===J.TOUCH_DOLLY_TRUCK||(this._state&J.TOUCH_DOLLY_OFFSET)===J.TOUCH_DOLLY_OFFSET||(this._state&J.TOUCH_DOLLY_ROTATE)===J.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&J.ZOOM)===J.ZOOM||(this._state&J.TOUCH_ZOOM)===J.TOUCH_ZOOM||(this._state&J.TOUCH_ZOOM_TRUCK)===J.TOUCH_ZOOM_TRUCK||(this._state&J.TOUCH_ZOOM_OFFSET)===J.TOUCH_ZOOM_OFFSET||(this._state&J.TOUCH_ZOOM_ROTATE)===J.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&J.OFFSET)===J.OFFSET||(this._state&J.TOUCH_OFFSET)===J.TOUCH_OFFSET||(this._state&J.TOUCH_DOLLY_OFFSET)===J.TOUCH_DOLLY_OFFSET||(this._state&J.TOUCH_ZOOM_OFFSET)===J.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},w=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Fc(this._activePointers,St);const I=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,P=I?-I.deltaX:n.x-St.x,M=I?-I.deltaY:n.y-St.y;if(n.copy(St),((this._state&J.ROTATE)===J.ROTATE||(this._state&J.TOUCH_ROTATE)===J.TOUCH_ROTATE||(this._state&J.TOUCH_DOLLY_ROTATE)===J.TOUCH_DOLLY_ROTATE||(this._state&J.TOUCH_ZOOM_ROTATE)===J.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(P,M),this._isUserControllingRotate=!0),(this._state&J.DOLLY)===J.DOLLY||(this._state&J.ZOOM)===J.ZOOM){const k=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,V=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,W=this.dollyDragInverted?-1:1;(this._state&J.DOLLY)===J.DOLLY?(this._dollyInternal(W*M*fa,k,V),this._isUserControllingDolly=!0):(this._zoomInternal(W*M*fa,k,V),this._isUserControllingZoom=!0)}if((this._state&J.TOUCH_DOLLY)===J.TOUCH_DOLLY||(this._state&J.TOUCH_ZOOM)===J.TOUCH_ZOOM||(this._state&J.TOUCH_DOLLY_TRUCK)===J.TOUCH_DOLLY_TRUCK||(this._state&J.TOUCH_ZOOM_TRUCK)===J.TOUCH_ZOOM_TRUCK||(this._state&J.TOUCH_DOLLY_OFFSET)===J.TOUCH_DOLLY_OFFSET||(this._state&J.TOUCH_ZOOM_OFFSET)===J.TOUCH_ZOOM_OFFSET||(this._state&J.TOUCH_DOLLY_ROTATE)===J.TOUCH_DOLLY_ROTATE||(this._state&J.TOUCH_ZOOM_ROTATE)===J.TOUCH_ZOOM_ROTATE){const k=St.x-this._activePointers[1].clientX,V=St.y-this._activePointers[1].clientY,W=Math.sqrt(k*k+V*V),j=r.y-W;r.set(0,W);const Q=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,$=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&J.TOUCH_DOLLY)===J.TOUCH_DOLLY||(this._state&J.TOUCH_DOLLY_ROTATE)===J.TOUCH_DOLLY_ROTATE||(this._state&J.TOUCH_DOLLY_TRUCK)===J.TOUCH_DOLLY_TRUCK||(this._state&J.TOUCH_DOLLY_OFFSET)===J.TOUCH_DOLLY_OFFSET?(this._dollyInternal(j*fa,Q,$),this._isUserControllingDolly=!0):(this._zoomInternal(j*fa,Q,$),this._isUserControllingZoom=!0)}((this._state&J.TRUCK)===J.TRUCK||(this._state&J.TOUCH_TRUCK)===J.TOUCH_TRUCK||(this._state&J.TOUCH_DOLLY_TRUCK)===J.TOUCH_DOLLY_TRUCK||(this._state&J.TOUCH_ZOOM_TRUCK)===J.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(P,M,!1),this._isUserControllingTruck=!0),((this._state&J.OFFSET)===J.OFFSET||(this._state&J.TOUCH_OFFSET)===J.TOUCH_OFFSET||(this._state&J.TOUCH_DOLLY_OFFSET)===J.TOUCH_DOLLY_OFFSET||(this._state&J.TOUCH_ZOOM_OFFSET)===J.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(P,M,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},T=()=>{Fc(this._activePointers,St),n.copy(St),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("mouseup",p),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",S),this._domElement.ownerDocument.addEventListener("pointerlockerror",_),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",d),b())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",S),this._domElement.ownerDocument.removeEventListener("pointerlockerror",_))};const S=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},_=()=>{this.unlockPointer()};this._addAllEventListeners=I=>{this._domElement=I,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),L1&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",d),this._domElement.addEventListener("wheel",g,{passive:!1}),this._domElement.addEventListener("contextmenu",v)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",d),this._domElement.removeEventListener("wheel",g,{passive:!1}),this._domElement.removeEventListener("contextmenu",v),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("pointerup",d),this._domElement.ownerDocument.removeEventListener("mouseup",p),this._domElement.ownerDocument.removeEventListener("pointerlockchange",S),this._domElement.ownerDocument.removeEventListener("pointerlockerror",_))},this.cancel=()=>{this._state!==J.NONE&&(this._state=J.NONE,this._activePointers.length=0,T())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=ti(e.width,0,1),this._interactiveArea.height=ti(e.height,0,1),this._interactiveArea.x=ti(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=ti(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,i)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,i=!1){this._isUserControllingRotate=!1;const n=ti(e,this.minAzimuthAngle,this.maxAzimuthAngle),r=ti(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!i||De(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&De(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=gs.NONE,this._changedDolly=0,this._dollyToNoClamp(ti(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const r=this._collisionTest(),o=De(r,this._spherical.radius);if(!(i>e)&&o)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,r)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const n=!t||De(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(n)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Tr).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const i=!t||De(this._target.x,this._targetEnd.x,this.restThreshold)&&De(this._target.y,this._targetEnd.y,this.restThreshold)&&De(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=ti(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const i=!t||De(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(e,t,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,i)}truck(e,t,i=!1){this._camera.updateMatrix(),ui.setFromMatrixColumn(this._camera.matrix,0),di.setFromMatrixColumn(this._camera.matrix,1),ui.multiplyScalar(e),di.multiplyScalar(-t);const n=Te.copy(ui).add(di),r=Fe.copy(this._targetEnd).add(n);return this.moveTo(r.x,r.y,r.z,i)}forward(e,t=!1){Te.setFromMatrixColumn(this._camera.matrix,0),Te.crossVectors(this._camera.up,Te),Te.multiplyScalar(e);const i=Fe.copy(this._targetEnd).add(Te);return this.moveTo(i.x,i.y,i.z,t)}elevate(e,t=!1){return Te.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Te.x,this._targetEnd.y+Te.y,this._targetEnd.z+Te.z,t)}moveTo(e,t,i,n=!1){this._isUserControllingTruck=!1;const r=Te.set(e,t,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);const o=!n||De(this._target.x,this._targetEnd.x,this.restThreshold)&&De(this._target.y,this._targetEnd.y,this.restThreshold)&&De(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,i,n=!1){const r=Te.set(e,t,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(r.x,r.y,r.z,n)}fitToBox(e,t,{cover:i=!1,paddingLeft:n=0,paddingRight:r=0,paddingBottom:o=0,paddingTop:a=0}={}){const l=[],h=e.isBox3?Es.copy(e):Es.setFromObject(e);h.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const d=Ld(this._sphericalEnd.theta,Md),p=Ld(this._sphericalEnd.phi,Md);l.push(this.rotateTo(d,p,t));const f=Te.setFromSpherical(this._sphericalEnd).normalize(),g=zd.setFromUnitVectors(f,Mc),v=De(Math.abs(f.y),1);v&&g.multiply(Dc.setFromAxisAngle(ma,d)),g.multiply(this._yAxisUpSpaceInverse);const b=Bd.makeEmpty();Fe.copy(h.min).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.min).setX(h.max.x).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.min).setY(h.max.y).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.max).setZ(h.min.z).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.min).setZ(h.max.z).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.max).setY(h.min.y).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.max).setX(h.min.x).applyQuaternion(g),b.expandByPoint(Fe),Fe.copy(h.max).applyQuaternion(g),b.expandByPoint(Fe),b.min.x-=n,b.min.y-=o,b.max.x+=r,b.max.y+=a,g.setFromUnitVectors(Mc,f),v&&g.premultiply(Dc.invert()),g.premultiply(this._yAxisUpSpace);const w=b.getSize(Te),T=b.getCenter(Fe).applyQuaternion(g);if(Cn(this._camera)){const S=this.getDistanceToFitBox(w.x,w.y,w.z,i);l.push(this.moveTo(T.x,T.y,T.z,t)),l.push(this.dollyTo(S,t)),l.push(this.setFocalOffset(0,0,0,t))}else if(Qi(this._camera)){const S=this._camera,_=S.right-S.left,I=S.top-S.bottom,P=i?Math.max(_/w.x,I/w.y):Math.min(_/w.x,I/w.y);l.push(this.moveTo(T.x,T.y,T.z,t)),l.push(this.zoomTo(P,t)),l.push(this.setFocalOffset(0,0,0,t))}return Promise.all(l)}fitToSphere(e,t){const i=[],n=e instanceof be.Sphere?Lc.copy(e):ah.createBoundingSphere(e,Lc);if(i.push(this.moveTo(n.center.x,n.center.y,n.center.z,t)),Cn(this._camera)){const r=this.getDistanceToFitSphere(n.radius);i.push(this.dollyTo(r,t))}else if(Qi(this._camera)){const r=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,a=2*n.radius,l=Math.min(r/a,o/a);i.push(this.zoomTo(l,t))}return i.push(this.setFocalOffset(0,0,0,t)),Promise.all(i)}setLookAt(e,t,i,n,r,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=gs.NONE,this._changedDolly=0;const l=Fe.set(n,r,o),h=Te.set(e,t,i);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(h.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const d=!a||De(this._target.x,this._targetEnd.x,this.restThreshold)&&De(this._target.y,this._targetEnd.y,this.restThreshold)&&De(this._target.z,this._targetEnd.z,this.restThreshold)&&De(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&De(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&De(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(d)}lerpLookAt(e,t,i,n,r,o,a,l,h,d,p,f,g,v=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=gs.NONE,this._changedDolly=0;const b=Te.set(n,r,o),w=Fe.set(e,t,i);zt.setFromVector3(w.sub(b).applyQuaternion(this._yAxisUpSpace));const T=ys.set(d,p,f),S=Fe.set(a,l,h);xr.setFromVector3(S.sub(T).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(b.lerp(T,g));const _=xr.theta-zt.theta,I=xr.phi-zt.phi,P=xr.radius-zt.radius;this._sphericalEnd.set(zt.radius+P*g,zt.phi+I*g,zt.theta+_*g),this.normalizeRotations(),this._needsUpdate=!0,v||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const M=!v||De(this._target.x,this._targetEnd.x,this.restThreshold)&&De(this._target.y,this._targetEnd.y,this.restThreshold)&&De(this._target.z,this._targetEnd.z,this.restThreshold)&&De(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&De(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&De(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(M)}setPosition(e,t,i,n=!1){return this.setLookAt(e,t,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,i,n=!1){const r=this.getPosition(Te),o=this.setLookAt(r.x,r.y,r.z,e,t,i,n);return this._sphericalEnd.phi=ti(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,i,n=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,i),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);const r=!n||De(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&De(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&De(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(e,t,i){this._camera.updateMatrixWorld(),ui.setFromMatrixColumn(this._camera.matrixWorldInverse,0),di.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Tn.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const n=Te.set(e,t,i),r=n.distanceTo(this._camera.position),o=n.sub(this._camera.position);ui.multiplyScalar(o.x),di.multiplyScalar(o.y),Tn.multiplyScalar(o.z),Te.copy(ui).add(di).add(Tn),Te.z=Te.z+r,this.dollyTo(r,!1),this.setFocalOffset(-Te.x,Te.y,-Te.z,!1),this.moveTo(e,t,i,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,i,n){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new be.Vector4,typeof e=="number"?this._viewport.set(e,t,i,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,i,n=!1){if(Oc(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const r=e/t,o=this._camera.getEffectiveFOV()*wr,a=this._camera.aspect;return((n?r>a:r<a)?t:e/a)*.5/Math.tan(o*.5)+i*.5}getDistanceToFitSphere(e){if(Oc(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*wr,i=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,n=1<this._camera.aspect?t:i;return e/Math.sin(n*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new be.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new be.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof be.Spherical?e:new be.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new be.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%vs,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=vs),this._spherical.theta+=vs*Math.round((this._sphericalEnd.theta-this._spherical.theta)/vs)}reset(e=!1){if(!De(this._camera.up.x,this._cameraUp0.x)||!De(this._camera.up.y,this._cameraUp0.y)||!De(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(Te);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,ma),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Te.subVectors(this._target,this._camera.position).normalize(),t=Fe.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(Te);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,r=Ud.subVectors(this._targetEnd,this._target),o=kd.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(Ye(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const d=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=pa(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,d,1/0,e),this._needsUpdate=!0}if(Ye(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const d=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=pa(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,d,1/0,e),this._needsUpdate=!0}if(Ye(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const d=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=pa(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,d,this.maxSpeed,e),this._needsUpdate=!0}if(Ye(r.x)&&Ye(r.y)&&Ye(r.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const d=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;Dd(this._target,this._targetEnd,this._targetVelocity,d,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Ye(o.x)&&Ye(o.y)&&Ye(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const d=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;Dd(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,d,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Ye(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const d=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=pa(this._zoom,this._zoomEnd,this._zoomVelocity,d,1/0,e)}if(this.dollyToCursor){if(Cn(this._camera)&&this._changedDolly!==0){const d=this._spherical.radius-this._lastDistance,p=this._camera,f=this._getCameraDirection(Tr),g=Te.copy(f).cross(p.up).normalize();g.lengthSq()===0&&(g.x=1);const v=Fe.crossVectors(g,f),b=this._sphericalEnd.radius*Math.tan(p.getEffectiveFOV()*wr*.5),w=(this._sphericalEnd.radius-d-this._sphericalEnd.radius)/this._sphericalEnd.radius,T=ys.copy(this._targetEnd).add(g.multiplyScalar(this._dollyControlCoord.x*b*p.aspect)).add(v.multiplyScalar(this._dollyControlCoord.y*b)),S=Te.copy(this._targetEnd).lerp(T,w),_=this._lastDollyDirection===gs.IN&&this._spherical.radius<=this.minDistance,I=this._lastDollyDirection===gs.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(_||I)){this._sphericalEnd.radius-=d,this._spherical.radius-=d;const M=Fe.copy(f).multiplyScalar(-d);S.add(M)}this._boundary.clampPoint(S,S);const P=Fe.subVectors(S,this._targetEnd);this._targetEnd.copy(S),this._target.add(P),this._changedDolly-=d,Ye(this._changedDolly)&&(this._changedDolly=0)}else if(Qi(this._camera)&&this._changedZoom!==0){const d=this._zoom-this._lastZoom,p=this._camera,f=Te.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(p.near+p.far)/(p.near-p.far)).unproject(p),g=Fe.set(0,0,-1).applyQuaternion(p.quaternion),v=ys.copy(f).add(g.multiplyScalar(-f.dot(p.up))),b=-(this._zoom-d-this._zoom)/this._zoom,w=this._getCameraDirection(Tr),T=this._targetEnd.dot(w),S=Te.copy(this._targetEnd).lerp(v,b),_=S.dot(w),I=w.multiplyScalar(_-T);S.sub(I),this._boundary.clampPoint(S,S);const P=Fe.subVectors(S,this._targetEnd);this._targetEnd.copy(S),this._target.add(P),this._changedZoom-=d,Ye(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const l=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,l),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Ye(this._focalOffset.x)||!Ye(this._focalOffset.y)||!Ye(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),ui.setFromMatrixColumn(this._camera.matrix,0),di.setFromMatrixColumn(this._camera.matrix,1),Tn.setFromMatrixColumn(this._camera.matrix,2),ui.multiplyScalar(this._focalOffset.x),di.multiplyScalar(-this._focalOffset.y),Tn.multiplyScalar(this._focalOffset.z),Te.copy(ui).add(di).add(Tn),this._camera.position.add(Te)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Te.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const h=this._needsUpdate;return h&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):h?(this.dispatchEvent({type:"update"}),Ye(t,this.restThreshold)&&Ye(i,this.restThreshold)&&Ye(n,this.restThreshold)&&Ye(r.x,this.restThreshold)&&Ye(r.y,this.restThreshold)&&Ye(r.z,this.restThreshold)&&Ye(o.x,this.restThreshold)&&Ye(o.y,this.restThreshold)&&Ye(o.z,this.restThreshold)&&Ye(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!h&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=h,this._needsUpdate=!1,h}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Ir(this.maxDistance),minZoom:this.minZoom,maxZoom:Ir(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Ir(this.maxPolarAngle),minAzimuthAngle:Ir(this.minAzimuthAngle),maxAzimuthAngle:Ir(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Te.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const i=JSON.parse(e);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=Cr(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=Cr(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=Cr(i.maxPolarAngle),this.minAzimuthAngle=Cr(i.minAzimuthAngle),this.maxAzimuthAngle=Cr(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],t),zt.setFromVector3(Te.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(zt.theta,zt.phi,t),this.dollyTo(zt.radius,t),this.zoomTo(i.zoom,t),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",O1),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,i){const n=t.lengthSq();if(n===0)return e;const r=Fe.copy(t).add(e),o=this._boundary.clampPoint(r,ys).sub(r),a=o.lengthSq();if(a===0)return e.add(t);if(a===n)return e;if(i===0)return e.add(t).add(o);{const l=1+i*a/t.dot(o);return e.add(Fe.copy(t).multiplyScalar(l)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(Cn(this._camera)){const e=this._camera,t=e.near,i=e.getEffectiveFOV()*wr,n=Math.tan(i*.5)*t,r=n*e.aspect;this._nearPlaneCorners[0].set(-r,-n,0),this._nearPlaneCorners[1].set(r,-n,0),this._nearPlaneCorners[2].set(r,n,0),this._nearPlaneCorners[3].set(-r,n,0)}else if(Qi(this._camera)){const e=this._camera,t=1/e.zoom,i=e.left*t,n=e.right*t,r=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(i,r,0),this._nearPlaneCorners[1].set(n,r,0),this._nearPlaneCorners[2].set(n,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Oc(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(Tr);Nc.lookAt(Nd,t,this._camera.up);for(let i=0;i<4;i++){const n=Fe.copy(this._nearPlaneCorners[i]);n.applyMatrix4(Nc);const r=ys.addVectors(this._target,n);ga.set(r,t),ga.far=this._spherical.radius+1;const o=ga.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const i=()=>{this.removeEventListener("rest",i),t()};this.addEventListener("rest",i)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new be.Sphere){const i=t,n=i.center;Es.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&Es.expandByObject(o)}),Es.getCenter(n);let r=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const a=o,l=a.geometry.clone();l.applyMatrix4(a.matrixWorld);const h=l.attributes.position;for(let d=0,p=h.count;d<p;d++)Te.fromBufferAttribute(h,d),r=Math.max(r,n.distanceToSquared(Te))}),i.radius=Math.sqrt(r),i}},lh=class jf extends p1{constructor(e){super(e),A(this,"onBeforeUpdate",new ee),A(this,"onAfterUpdate",new ee),A(this,"onAspectUpdated",new ee),A(this,"onDisposed",new ee),A(this,"three"),A(this,"_allControls",new Map),A(this,"updateAspect",()=>{var t;if(!(!this.currentWorld||!this.currentWorld.renderer)){if(this.three instanceof jn){this.onAspectUpdated.trigger();return}if((t=this.currentWorld.renderer)!=null&&t.isResizeable()){const i=this.currentWorld.renderer.getSize();this.three.aspect=i.width/i.height,this.three.updateProjectionMatrix(),this.onAspectUpdated.trigger()}}}),this.three=this.setupCamera(),this.setupEvents(!0),this.onWorldChanged.add(({action:t,world:i})=>{if(t==="added"){const n=this.newCameraControls();this._allControls.set(i.uuid,n)}if(t==="removed"){const n=this._allControls.get(i.uuid);n&&(n.dispose(),this._allControls.delete(i.uuid))}})}get controls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");const e=this._allControls.get(this.currentWorld.uuid);if(!e)throw new Error("Controls not found!");return e}get enabled(){return this.currentWorld===null?!1:this.controls.enabled}set enabled(e){this.controls.enabled=e}dispose(){this.setupEvents(!1),this.enabled=!1,this.onAspectUpdated.reset(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.three.removeFromParent(),this.onDisposed.trigger(),this.onDisposed.reset();for(const[e,t]of this._allControls)t.dispose()}update(e){this.enabled&&(this.onBeforeUpdate.trigger(this),this.controls.update(e),this.onAfterUpdate.trigger(this))}setupCamera(){const e=window.innerWidth/window.innerHeight,t=new Fv(60,e,1,1e3);return t.position.set(50,50,50),t.lookAt(new F(0,0,0)),t}newCameraControls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");if(!this.currentWorld.renderer)throw new Error("This camera needs a renderer to work!");Mt.install({THREE:jf.getSubsetOfThree()});const{domElement:e}=this.currentWorld.renderer.three,t=new Mt(this.three,e);return t.smoothTime=.2,t.dollyToCursor=!0,t.infinityDolly=!0,t}setupEvents(e){e?window.addEventListener("resize",this.updateAspect):window.removeEventListener("resize",this.updateAspect)}static getSubsetOfThree(){return{MOUSE:Ov,Vector2:Ve,Vector3:F,Vector4:Vs,Quaternion:Vt,Matrix4:Ee,Spherical:Mv,Box3:Ke,Sphere:Gn,Raycaster:io,MathUtils:so}}};const Wf=class Xf extends Re{constructor(e){super(e),A(this,"onAfterUpdate",new ee),A(this,"onBeforeUpdate",new ee),A(this,"onDisposed",new ee),A(this,"list",new Map),A(this,"enabled",!0),e.add(Xf.uuid,this)}create(){const e=new R1(this.components),t=e.uuid;if(this.list.has(t))throw new Error("There is already a world with this name!");return this.list.set(t,e),e}delete(e){this.list.delete(e.uuid),e.dispose()}dispose(){this.enabled=!1;for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}update(e){if(this.enabled)for(const[t,i]of this.list)i.update(e)}};A(Wf,"uuid","fdb61dc4-2ec1-4966-b83d-54ea795fad4a");let D1=Wf;class N1{constructor(e,t,i){A(this,"onDisposed",new ee),A(this,"world"),A(this,"components"),A(this,"three"),A(this,"_fade",3),A(this,"updateZoom",()=>{this.world.camera instanceof lh&&(this.material.uniforms.uZoom.value=this.world.camera.three.zoom)}),this.world=t;const{color:n,size1:r,size2:o,distance:a}=i;this.components=e;const l=new ul(2,2,1,1),h=new wt({side:no,uniforms:{uSize1:{value:r},uSize2:{value:o},uColor:{value:n},uDistance:{value:a},uFade:{value:this._fade},uZoom:{value:1}},transparent:!0,vertexShader:`
            
            varying vec3 worldPosition;
            
            uniform float uDistance;
            
            void main() {
            
                    vec3 pos = position.xzy * uDistance;
                    pos.xz += cameraPosition.xz;
                    
                    worldPosition = pos;
                    
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
            
            }
            `,fragmentShader:`
            
            varying vec3 worldPosition;
            
            uniform float uZoom;
            uniform float uFade;
            uniform float uSize1;
            uniform float uSize2;
            uniform vec3 uColor;
            uniform float uDistance;
                
                
                
                float getGrid(float size) {
                
                    vec2 r = worldPosition.xz / size;
                    
                    
                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
                    float line = min(grid.x, grid.y);
                    
                
                    return 1.0 - min(line, 1.0);
                }
                
            void main() {
            
                    
                    float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);
                    
                    float g1 = getGrid(uSize1);
                    float g2 = getGrid(uSize2);
                    
                    // Ortho camera fades the grid away when zooming out
                    float minZoom = step(0.2, uZoom);
                    float zoomFactor = pow(min(uZoom, 1.), 2.) * minZoom;
                    
                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, uFade));
                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2) * zoomFactor;
                    
                    if ( gl_FragColor.a <= 0.0 ) discard;
                    
            
            }
            
            `,extensions:{derivatives:!0}});this.three=new le(l,h),this.three.frustumCulled=!1,t.scene.three.add(this.three),this.setupEvents(!0)}get visible(){return this.three.visible}set visible(e){e?this.world.scene.three.add(this.three):this.three.removeFromParent()}get material(){return this.three.material}get fade(){return this._fade===3}set fade(e){this._fade=e?3:0,this.material.uniforms.uFade.value=this._fade}[Symbol.dispose](){throw new Error("Method not implemented.")}dispose(){this.setupEvents(!1),this.components.get(Oi).destroy(this.three),this.onDisposed.trigger(),this.onDisposed.reset(),this.world=null,this.components=null}setupEvents(e){if(!(this.world.camera instanceof lh))return;const t=this.world.camera.controls;e?t.addEventListener("update",this.updateZoom):t.removeEventListener("update",this.updateZoom)}}class U1 extends Re{constructor(){super(...arguments),A(this,"list",new Map),A(this,"onDisposed",new ee),A(this,"config",{color:new Rt(12303291),size1:1,size2:10,distance:500}),A(this,"enabled",!0)}create(e){if(this.list.has(e.uuid))throw new Error("This world already has a grid!");const t=new N1(this.components,e,this.config);return this.list.set(e.uuid,t),e.onDisposed.add(()=>{this.delete(e)}),t}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}}A(U1,"uuid","d1e814d5-b81c-4452-87a2-f039375e0489");const xn=new io,bt=new F,Ki=new F,qe=new Vt,Vd={X:new F(1,0,0),Y:new F(0,1,0),Z:new F(0,0,1)},Uc={type:"change"},Hd={type:"mouseDown"},Yd={type:"mouseUp",mode:null},Gd={type:"objectChange"};class k1 extends kn{constructor(e,t){super(),t===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new G1;this._gizmo=i,this.add(i);const n=new j1;this._plane=n,this.add(n);const r=this;function o(S,_){let I=_;Object.defineProperty(r,S,{get:function(){return I!==void 0?I:_},set:function(P){I!==P&&(I=P,n[S]=P,i[S]=P,r.dispatchEvent({type:S+"-changed",value:P}),r.dispatchEvent(Uc))}}),r[S]=_,n[S]=_,i[S]=_}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new F,l=new F,h=new Vt,d=new Vt,p=new F,f=new Vt,g=new F,v=new F,b=new F,w=0,T=new F;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",h),o("worldQuaternionStart",d),o("cameraPosition",p),o("cameraQuaternion",f),o("pointStart",g),o("pointEnd",v),o("rotationAxis",b),o("rotationAngle",w),o("eye",T),this._offset=new F,this._startNorm=new F,this._endNorm=new F,this._cameraScale=new F,this._parentPosition=new F,this._parentQuaternion=new Vt,this._parentQuaternionInv=new Vt,this._parentScale=new F,this._worldScaleStart=new F,this._worldQuaternionInv=new Vt,this._worldScale=new F,this._positionStart=new F,this._quaternionStart=new Vt,this._scaleStart=new F,this._getPointer=B1.bind(this),this._onPointerDown=V1.bind(this),this._onPointerHover=z1.bind(this),this._onPointerMove=H1.bind(this),this._onPointerUp=Y1.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;xn.setFromCamera(e,this.camera);const t=kc(this._gizmo.picker[this.mode],xn);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e.button!==0)&&this.axis!==null){xn.setFromCamera(e,this.camera);const t=kc(this._plane,xn,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Hd.mode=this.mode,this.dispatchEvent(Hd)}}pointerMove(e){const t=this.axis,i=this.mode,n=this.object;let r=this.space;if(i==="scale"?r="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(r="world"),n===void 0||t===null||this.dragging===!1||e.button!==-1)return;xn.setFromCamera(e,this.camera);const o=kc(this._plane,xn,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),r==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),r==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),n.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(r==="local"&&(n.position.applyQuaternion(qe.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this._quaternionStart)),r==="world"&&(n.parent&&n.position.add(bt.setFromMatrixPosition(n.parent.matrixWorld)),t.search("X")!==-1&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(bt.setFromMatrixPosition(n.parent.matrixWorld))));else if(i==="scale"){if(t.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Ki.set(a,a,a)}else bt.copy(this.pointStart),Ki.copy(this.pointEnd),bt.applyQuaternion(this._worldQuaternionInv),Ki.applyQuaternion(this._worldQuaternionInv),Ki.divide(bt),t.search("X")===-1&&(Ki.x=1),t.search("Y")===-1&&(Ki.y=1),t.search("Z")===-1&&(Ki.z=1);n.scale.copy(this._scaleStart).multiply(Ki),this.scaleSnap&&(t.search("X")!==-1&&(n.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(bt.setFromMatrixPosition(this.camera.matrixWorld));let l=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(bt.copy(this.rotationAxis).cross(this.eye))*a):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(Vd[t]),bt.copy(Vd[t]),r==="local"&&bt.applyQuaternion(this.worldQuaternion),bt.cross(this.eye),bt.length()===0?l=!0:this.rotationAngle=this._offset.dot(bt.normalize())*a),(t==="E"||l)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),r==="local"&&t!=="E"&&t!=="XYZE"?(n.quaternion.copy(this._quaternionStart),n.quaternion.multiply(qe.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),n.quaternion.copy(qe.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Uc),this.dispatchEvent(Gd)}}pointerUp(e){e.button===0&&(this.dragging&&this.axis!==null&&(Yd.mode=this.mode,this.dispatchEvent(Yd)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Uc),this.dispatchEvent(Gd),this.pointStart.copy(this.pointEnd))}getRaycaster(){return xn}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function B1(s){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:s.button};{const e=this.domElement.getBoundingClientRect();return{x:(s.clientX-e.left)/e.width*2-1,y:-(s.clientY-e.top)/e.height*2+1,button:s.button}}}function z1(s){if(this.enabled)switch(s.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(s));break}}function V1(s){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(s)),this.pointerDown(this._getPointer(s)))}function H1(s){this.enabled&&this.pointerMove(this._getPointer(s))}function Y1(s){this.enabled&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(s)))}function kc(s,e,t){const i=e.intersectObject(s,!0);for(let n=0;n<i.length;n++)if(i[n].object.visible||t)return i[n];return!1}const va=new gf,ze=new F(0,1,0),jd=new F(0,0,0),Wd=new Ee,ya=new Vt,Da=new Vt,pi=new F,Xd=new Ee,Fr=new F(1,0,0),Pn=new F(0,1,0),Or=new F(0,0,1),Ea=new F,Ar=new F,Sr=new F;class G1 extends kn{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new Xt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Di({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const n=t.clone();n.opacity=.5;const r=e.clone();r.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const h=e.clone();h.color.setHex(65280),h.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const p=e.clone();p.opacity=.25;const f=e.clone();f.color.setHex(16776960),f.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const v=new Tt(0,.04,.1,12);v.translate(0,.05,0);const b=new ut(.08,.08,.08);b.translate(0,.04,0);const w=new Ne;w.setAttribute("position",new Ps([0,0,0,1,0,0],3));const T=new Tt(.0075,.0075,.5,3);T.translate(0,.25,0);function S(oe,ve){const re=new pr(oe,.0075,3,64,ve*Math.PI*2);return re.rotateY(Math.PI/2),re.rotateX(Math.PI/2),re}function _(){const oe=new Ne;return oe.setAttribute("position",new Ps([0,0,0,1,1,1],3)),oe}const I={X:[[new le(v,r),[.5,0,0],[0,0,-Math.PI/2]],[new le(v,r),[-.5,0,0],[0,0,Math.PI/2]],[new le(T,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new le(v,o),[0,.5,0]],[new le(v,o),[0,-.5,0],[Math.PI,0,0]],[new le(T,o)]],Z:[[new le(v,a),[0,0,.5],[Math.PI/2,0,0]],[new le(v,a),[0,0,-.5],[-Math.PI/2,0,0]],[new le(T,a),null,[Math.PI/2,0,0]]],XYZ:[[new le(new Zo(.1,0),p.clone()),[0,0,0]]],XY:[[new le(new ut(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new le(new ut(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new le(new ut(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},P={X:[[new le(new Tt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new le(new Tt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new le(new Tt(.2,0,.6,4),i),[0,.3,0]],[new le(new Tt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new le(new Tt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new le(new Tt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new le(new Zo(.2,0),i)]],XY:[[new le(new ut(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new le(new ut(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new le(new ut(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},M={START:[[new le(new Zo(.01,2),n),null,null,null,"helper"]],END:[[new le(new Zo(.01,2),n),null,null,null,"helper"]],DELTA:[[new st(_(),n),null,null,null,"helper"]],X:[[new st(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new st(w,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new st(w,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},k={XYZE:[[new le(S(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new le(S(.5,.5),r)]],Y:[[new le(S(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new le(S(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new le(S(.75,1),f),null,[0,Math.PI/2,0]]]},V={AXIS:[[new st(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},W={XYZE:[[new le(new Lv(.25,10,8),i)]],X:[[new le(new pr(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new le(new pr(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new le(new pr(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new le(new pr(.75,.1,2,24),i)]]},j={X:[[new le(b,r),[.5,0,0],[0,0,-Math.PI/2]],[new le(T,r),[0,0,0],[0,0,-Math.PI/2]],[new le(b,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new le(b,o),[0,.5,0]],[new le(T,o)],[new le(b,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new le(b,a),[0,0,.5],[Math.PI/2,0,0]],[new le(T,a),[0,0,0],[Math.PI/2,0,0]],[new le(b,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new le(new ut(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new le(new ut(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new le(new ut(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new le(new ut(.1,.1,.1),p.clone())]]},Q={X:[[new le(new Tt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new le(new Tt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new le(new Tt(.2,0,.6,4),i),[0,.3,0]],[new le(new Tt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new le(new Tt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new le(new Tt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new le(new ut(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new le(new ut(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new le(new ut(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new le(new ut(.2,.2,.2),i),[0,0,0]]]},$={X:[[new st(w,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new st(w,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new st(w,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function ne(oe){const ve=new kn;for(const re in oe)for(let ge=oe[re].length;ge--;){const me=oe[re][ge][0].clone(),we=oe[re][ge][1],Ge=oe[re][ge][2],Pt=oe[re][ge][3],Bi=oe[re][ge][4];me.name=re,me.tag=Bi,we&&me.position.set(we[0],we[1],we[2]),Ge&&me.rotation.set(Ge[0],Ge[1],Ge[2]),Pt&&me.scale.set(Pt[0],Pt[1],Pt[2]),me.updateMatrix();const At=me.geometry.clone();At.applyMatrix4(me.matrix),me.geometry=At,me.renderOrder=1/0,me.position.set(0,0,0),me.rotation.set(0,0,0),me.scale.set(1,1,1),ve.add(me)}return ve}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ne(I)),this.add(this.gizmo.rotate=ne(k)),this.add(this.gizmo.scale=ne(j)),this.add(this.picker.translate=ne(P)),this.add(this.picker.rotate=ne(W)),this.add(this.picker.scale=ne(Q)),this.add(this.helper.translate=ne(M)),this.add(this.helper.rotate=ne(V)),this.add(this.helper.scale=ne($)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Da;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let n=0;n<i.length;n++){const r=i[n];r.visible=!0,r.rotation.set(0,0,0),r.position.copy(this.worldPosition);let o;if(this.camera.isOrthographicCamera?o=(this.camera.top-this.camera.bottom)/this.camera.zoom:o=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),r.scale.set(1,1,1).multiplyScalar(o*this.size/4),r.tag==="helper"){r.visible=!1,r.name==="AXIS"?(r.visible=!!this.axis,this.axis==="X"&&(qe.setFromEuler(va.set(0,0,0)),r.quaternion.copy(t).multiply(qe),Math.abs(ze.copy(Fr).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="Y"&&(qe.setFromEuler(va.set(0,0,Math.PI/2)),r.quaternion.copy(t).multiply(qe),Math.abs(ze.copy(Pn).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="Z"&&(qe.setFromEuler(va.set(0,Math.PI/2,0)),r.quaternion.copy(t).multiply(qe),Math.abs(ze.copy(Or).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="XYZE"&&(qe.setFromEuler(va.set(0,Math.PI/2,0)),ze.copy(this.rotationAxis),r.quaternion.setFromRotationMatrix(Wd.lookAt(jd,ze,Pn)),r.quaternion.multiply(qe),r.visible=this.dragging),this.axis==="E"&&(r.visible=!1)):r.name==="START"?(r.position.copy(this.worldPositionStart),r.visible=this.dragging):r.name==="END"?(r.position.copy(this.worldPosition),r.visible=this.dragging):r.name==="DELTA"?(r.position.copy(this.worldPositionStart),r.quaternion.copy(this.worldQuaternionStart),bt.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),bt.applyQuaternion(this.worldQuaternionStart.clone().invert()),r.scale.copy(bt),r.visible=this.dragging):(r.quaternion.copy(t),this.dragging?r.position.copy(this.worldPositionStart):r.position.copy(this.worldPosition),this.axis&&(r.visible=this.axis.search(r.name)!==-1));continue}r.quaternion.copy(t),this.mode==="translate"||this.mode==="scale"?(r.name==="X"&&Math.abs(ze.copy(Fr).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="Y"&&Math.abs(ze.copy(Pn).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="Z"&&Math.abs(ze.copy(Or).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="XY"&&Math.abs(ze.copy(Or).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="YZ"&&Math.abs(ze.copy(Fr).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="XZ"&&Math.abs(ze.copy(Pn).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1)):this.mode==="rotate"&&(ya.copy(t),ze.copy(this.eye).applyQuaternion(qe.copy(t).invert()),r.name.search("E")!==-1&&r.quaternion.setFromRotationMatrix(Wd.lookAt(this.eye,jd,Pn)),r.name==="X"&&(qe.setFromAxisAngle(Fr,Math.atan2(-ze.y,ze.z)),qe.multiplyQuaternions(ya,qe),r.quaternion.copy(qe)),r.name==="Y"&&(qe.setFromAxisAngle(Pn,Math.atan2(ze.x,ze.z)),qe.multiplyQuaternions(ya,qe),r.quaternion.copy(qe)),r.name==="Z"&&(qe.setFromAxisAngle(Or,Math.atan2(ze.y,ze.x)),qe.multiplyQuaternions(ya,qe),r.quaternion.copy(qe))),r.visible=r.visible&&(r.name.indexOf("X")===-1||this.showX),r.visible=r.visible&&(r.name.indexOf("Y")===-1||this.showY),r.visible=r.visible&&(r.name.indexOf("Z")===-1||this.showZ),r.visible=r.visible&&(r.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),r.material._color=r.material._color||r.material.color.clone(),r.material._opacity=r.material._opacity||r.material.opacity,r.material.color.copy(r.material._color),r.material.opacity=r.material._opacity,this.enabled&&this.axis&&(r.name===this.axis||this.axis.split("").some(function(a){return r.name===a}))&&(r.material.color.setHex(16776960),r.material.opacity=1)}super.updateMatrixWorld(e)}}class j1 extends le{constructor(){super(new ul(1e5,1e5,2,2),new Xt({visible:!1,wireframe:!0,side:no,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),Ea.copy(Fr).applyQuaternion(t==="local"?this.worldQuaternion:Da),Ar.copy(Pn).applyQuaternion(t==="local"?this.worldQuaternion:Da),Sr.copy(Or).applyQuaternion(t==="local"?this.worldQuaternion:Da),ze.copy(Ar),this.mode){case"translate":case"scale":switch(this.axis){case"X":ze.copy(this.eye).cross(Ea),pi.copy(Ea).cross(ze);break;case"Y":ze.copy(this.eye).cross(Ar),pi.copy(Ar).cross(ze);break;case"Z":ze.copy(this.eye).cross(Sr),pi.copy(Sr).cross(ze);break;case"XY":pi.copy(Sr);break;case"YZ":pi.copy(Ea);break;case"XZ":ze.copy(Sr),pi.copy(Ar);break;case"XYZ":case"E":pi.set(0,0,0);break}break;case"rotate":default:pi.set(0,0,0)}pi.length()===0?this.quaternion.copy(this.cameraQuaternion):(Xd.lookAt(bt.set(0,0,0),pi,ze),this.quaternion.setFromRotationMatrix(Xd)),super.updateMatrixWorld(e)}}let Kf=class Qf{constructor(e,t,i,n,r,o=5,a=!0){if(A(this,"onDraggingStarted",new ee),A(this,"onDraggingEnded",new ee),A(this,"onDisposed",new ee),A(this,"normal"),A(this,"origin"),A(this,"three",new an),A(this,"_helper"),A(this,"_visible",!0),A(this,"_enabled",!0),A(this,"components"),A(this,"world"),A(this,"_controlsActive",!1),A(this,"_arrowBoundBox",new le),A(this,"_planeMesh"),A(this,"_controls"),A(this,"_hiddenMaterial",new Xt({visible:!1})),A(this,"update",()=>{this._enabled&&this.three.setFromNormalAndCoplanarPoint(this.normal,this._helper.position)}),A(this,"changeDrag",l=>{this._visible=!l.value,this.preventCameraMovement(),this.notifyDraggingChanged(l)}),this.components=e,this.world=t,!t.renderer)throw new Error("The given world must have a renderer!");this.normal=n,this.origin=i,t.renderer.setPlane(!0,this.three),this._planeMesh=Qf.newPlaneMesh(o,r),this._helper=this.newHelper(),this._controls=this.newTransformControls(),this.three.setFromNormalAndCoplanarPoint(n,i),a&&this.toggleControls(!0)}get enabled(){return this._enabled}set enabled(e){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");this._enabled=e,this.world.renderer.setPlane(e,this.three)}get visible(){return this._visible}set visible(e){this._visible=e,this._controls.visible=e,this._helper.visible=e,this.toggleControls(e)}get meshes(){return[this._planeMesh,this._arrowBoundBox]}get planeMaterial(){return this._planeMesh.material}set planeMaterial(e){this._planeMesh.material=e}get size(){return this._planeMesh.scale.x}set size(e){this._planeMesh.scale.set(e,e,e)}get helper(){return this._helper}setFromNormalAndCoplanarPoint(e,t){this.reset(),this.normal.equals(e)||(this.normal.copy(e),this._helper.lookAt(e)),this.origin.copy(t),this._helper.position.copy(t),this._helper.updateMatrix(),this.update()}dispose(){this._enabled=!1,this.onDraggingStarted.reset(),this.onDraggingEnded.reset(),this._helper.removeFromParent(),this.world.renderer&&this.world.renderer.setPlane(!1,this.three),this._arrowBoundBox.removeFromParent(),this._arrowBoundBox.geometry.dispose(),this._planeMesh.geometry.dispose(),this._controls.removeFromParent(),this._controls.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}reset(){const e=new F(1,0,0),t=new F;this.normal.equals(e)||(this.normal.copy(e),this._helper.lookAt(e)),this.origin.copy(t),this._helper.position.copy(t),this._helper.updateMatrix()}toggleControls(e){if(e){if(this._controlsActive)return;this._controls.addEventListener("change",this.update),this._controls.addEventListener("dragging-changed",this.changeDrag)}else this._controls.removeEventListener("change",this.update),this._controls.removeEventListener("dragging-changed",this.changeDrag);this._controlsActive=e}newTransformControls(){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");const e=this.world.camera.three,t=this.world.renderer.three.domElement,i=new k1(e,t);return this.initializeControls(i),this.world.scene.three.add(i),i}initializeControls(e){e.attach(this._helper),e.showX=!1,e.showY=!1,e.setSpace("local"),this.createArrowBoundingBox(),e.children[0].children[0].add(this._arrowBoundBox)}createArrowBoundingBox(){this._arrowBoundBox.geometry=new Tt(.18,.18,1.2),this._arrowBoundBox.material=this._hiddenMaterial,this._arrowBoundBox.rotateX(Math.PI/2),this._arrowBoundBox.updateMatrix(),this._arrowBoundBox.geometry.applyMatrix4(this._arrowBoundBox.matrix)}notifyDraggingChanged(e){e.value?this.onDraggingStarted.trigger():this.onDraggingEnded.trigger()}preventCameraMovement(){this.world.camera.enabled=this._visible}newHelper(){const e=new kn;return e.lookAt(this.normal),e.position.copy(this.origin),this._planeMesh.position.z+=.01,e.add(this._planeMesh),this.world.scene.three.add(e),e}static newPlaneMesh(e,t){const i=new ul(1),n=new le(i,t);return n.scale.set(e,e,e),n}};const Zf=class ch extends Re{constructor(e){super(e),A(this,"onAfterCreate",new ee),A(this,"onAfterDelete",new ee),A(this,"onBeforeDrag",new ee),A(this,"onAfterDrag",new ee),A(this,"onBeforeCreate",new ee),A(this,"onBeforeCancel",new ee),A(this,"onAfterCancel",new ee),A(this,"onBeforeDelete",new ee),A(this,"onDisposed",new ee),A(this,"orthogonalY",!1),A(this,"toleranceOrthogonalY",.7),A(this,"Type",Kf),A(this,"list",[]),A(this,"_material",new Xt({color:12255487,side:no,transparent:!0,opacity:.2})),A(this,"_size",5),A(this,"_enabled",!1),A(this,"_visible",!0),A(this,"_onStartDragging",()=>{this.onBeforeDrag.trigger()}),A(this,"_onEndDragging",()=>{this.onAfterDrag.trigger()}),this.components.add(ch.uuid,this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e;for(const t of this.list)t.enabled=e;this.updateMaterialsAndPlanes()}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this.list)t.visible=e}get material(){return this._material}set material(e){this._material=e;for(const t of this.list)t.planeMaterial=e}get size(){return this._size}set size(e){this._size=e;for(const t of this.list)t.size=e}dispose(){this._enabled=!1;for(const e of this.list)e.dispose();this.list.length=0,this._material.dispose(),this.onBeforeCreate.reset(),this.onBeforeCancel.reset(),this.onBeforeDelete.reset(),this.onBeforeDrag.reset(),this.onAfterCreate.reset(),this.onAfterCancel.reset(),this.onAfterDelete.reset(),this.onAfterDrag.reset(),this.onDisposed.trigger(ch.uuid),this.onDisposed.reset()}create(e){if(!this.enabled)return;const t=this.components.get(ni).get(e).castRay();t&&this.createPlaneFromIntersection(e,t)}createFromNormalAndCoplanarPoint(e,t,i){const n=this.newPlane(e,i,t);return this.updateMaterialsAndPlanes(),n}delete(e,t){this.enabled&&(t||(t=this.pickPlane(e)),t&&this.deletePlane(t))}deleteAll(){for(;this.list.length>0;){const e=this.list[0];this.delete(e.world,e)}}deletePlane(e){const t=this.list.indexOf(e);if(t!==-1){if(this.list.splice(t,1),!e.world.renderer)throw new Error("Renderer not found for this plane's world!");e.world.renderer.setPlane(!1,e.three),e.dispose(),this.updateMaterialsAndPlanes(),this.onAfterDelete.trigger(e)}}pickPlane(e){const t=this.components.get(ni).get(e),i=this.getAllPlaneMeshes(),n=t.castRay(i);if(n){const r=n.object;return this.list.find(o=>o.meshes.includes(r))}}getAllPlaneMeshes(){const e=[];for(const t of this.list)e.push(...t.meshes);return e}createPlaneFromIntersection(e,t){var i;if(!e.renderer)throw new Error("The given world must have a renderer!");const n=t.point.distanceTo(new F(0,0,0)),r=(i=t.face)==null?void 0:i.normal;if(!n||!r)return;const o=this.getWorldNormal(t,r),a=this.newPlane(e,t.point,o.negate());a.visible=this._visible,a.size=this._size,e.renderer.setPlane(!0,a.three),this.updateMaterialsAndPlanes()}getWorldNormal(e,t){const i=e.object;let n=e.object.matrixWorld.clone();if(i instanceof Kt&&e.instanceId!==void 0){const a=new Ee;i.getMatrixAt(e.instanceId,a),n=a.multiply(n)}const r=new On().getNormalMatrix(n),o=t.clone().applyMatrix3(r).normalize();return this.normalizePlaneDirectionY(o),o}normalizePlaneDirectionY(e){this.orthogonalY&&(e.y>this.toleranceOrthogonalY&&(e.x=0,e.y=1,e.z=0),e.y<-this.toleranceOrthogonalY&&(e.x=0,e.y=-1,e.z=0))}newPlane(e,t,i){const n=new this.Type(this.components,e,t,i,this._material);return n.onDraggingStarted.add(this._onStartDragging),n.onDraggingEnded.add(this._onEndDragging),this.list.push(n),this.onAfterCreate.trigger(n),n}updateMaterialsAndPlanes(){const e=this.components.get(D1);for(const[t,i]of e.list){if(!i.renderer)continue;i.renderer.updateClippingPlanes();const{clippingPlanes:n}=i.renderer;for(const r of i.meshes)if(Array.isArray(r.material))for(const o of r.material)o.clippingPlanes=n;else r.material.clippingPlanes=n}}};A(Zf,"uuid","66290bc5-18c4-4cd1-9379-2e17a0617611");let Ga=Zf;function W1(s,e,t,i){return new Promise((n,r)=>{function o(){const a=s.clientWaitSync(e,t,0);if(a===s.WAIT_FAILED){r();return}if(a===s.TIMEOUT_EXPIRED){setTimeout(o,i);return}n()}o()})}async function X1(s,e,t,i,n,r,o){const a=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);s.flush(),await W1(s,a,0,10),s.deleteSync(a),s.bindBuffer(e,t),s.getBufferSubData(e,i,n,r,o),s.bindBuffer(e,null)}async function K1(s,e,t,i,n,r,o,a){const l=s.createBuffer();return s.bindBuffer(s.PIXEL_PACK_BUFFER,l),s.bufferData(s.PIXEL_PACK_BUFFER,a.byteLength,s.STREAM_READ),s.readPixels(e,t,i,n,r,o,0),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),await X1(s,s.PIXEL_PACK_BUFFER,l,0,a),s.deleteBuffer(l),a}let qf=class{constructor(e,t,i){if(A(this,"onDisposed",new ee),A(this,"onViewUpdated",new $i),A(this,"enabled",!0),A(this,"needsUpdate",!1),A(this,"renderDebugFrame",!1),A(this,"components"),A(this,"world"),A(this,"renderer"),A(this,"autoUpdate",!0),A(this,"updateInterval",1e3),A(this,"worker"),A(this,"scene",new Xn),A(this,"_width",512),A(this,"_height",512),A(this,"_availableColor",1),A(this,"renderTarget"),A(this,"bufferSize"),A(this,"_buffer"),A(this,"_isWorkerBusy",!1),A(this,"updateVisibility",async o=>{if(!this.enabled||!this.needsUpdate&&!o||this._isWorkerBusy)return;this._isWorkerBusy=!0;const a=this.world.camera.three;a.updateMatrix(),this.renderer.setSize(this._width,this._height),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,a);const l=this.renderer.getContext();await K1(l,0,0,this._width,this._height,l.RGBA,l.UNSIGNED_BYTE,this._buffer),this.renderer.setRenderTarget(null),this.renderDebugFrame&&this.renderer.render(this.scene,a),this.worker.postMessage({buffer:this._buffer}),this.needsUpdate=!1}),!t.renderer)throw new Error("The given world must have a renderer!");this.components=e,this.applySettings(i),this.world=t,this.renderer=new Ha,this.renderTarget=new Ri(this._width,this._height),this.bufferSize=this._width*this._height*4,this._buffer=new Uint8Array(this.bufferSize),this.renderer.clippingPlanes=t.renderer.clippingPlanes;const n=`
      addEventListener("message", (event) => {
        const { buffer } = event.data;
        const colors = new Map();
        for (let i = 0; i < buffer.length; i += 4) {
          const r = buffer[i];
          const g = buffer[i + 1];
          const b = buffer[i + 2];
          const code = "" + r + "-" + g + "-" + b;
          if(colors.has(code)) {
            colors.set(code, colors.get(code) + 1);
          } else {
            colors.set(code, 1);
          }
        }
        postMessage({ colors });
      });
    `,r=new Blob([n],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(r))}dispose(){this.enabled=!1;for(const e of this.scene.children)e.removeFromParent();this.onViewUpdated.reset(),this.worker.terminate(),this.renderer.dispose(),this.renderTarget.dispose(),this._buffer=null,this.onDisposed.reset()}getAvailableColor(){let e=BigInt(this._availableColor.toString());const t=[];do t.unshift(Number(e%256n)),e/=256n;while(e);for(;t.length!==3;)t.unshift(0);const[i,n,r]=t,o=`${i}-${n}-${r}`;return{r:i,g:n,b:r,code:o}}increaseColor(){if(this._availableColor===256*256*256){console.warn("Color can't be increased over 256 x 256 x 256!");return}this._availableColor++}decreaseColor(){if(this._availableColor===1){console.warn("Color can't be decreased under 0!");return}this._availableColor--}applySettings(e){e&&(e.updateInterval!==void 0&&(this.updateInterval=e.updateInterval),e.height!==void 0&&(this._height=e.height),e.width!==void 0&&(this._width=e.width),e.autoUpdate!==void 0&&(this.autoUpdate=e.autoUpdate))}};class Q1 extends qf{constructor(e,t,i){super(e,t,i),A(this,"threshold",100),A(this,"onViewUpdated",new ee),A(this,"colorMeshes",new Map),A(this,"isProcessing",!1),A(this,"_colorCodeMeshMap",new Map),A(this,"_meshIDColorCodeMap",new Map),A(this,"_currentVisibleMeshes",new Set),A(this,"_recentlyHiddenMeshes",new Set),A(this,"_intervalID",null),A(this,"_transparentMat",new Xt({transparent:!0,opacity:0})),A(this,"handleWorkerMessage",async n=>{if(this.isProcessing)return;const r=n.data.colors;this._recentlyHiddenMeshes=new Set(this._currentVisibleMeshes),this._currentVisibleMeshes.clear();for(const[o,a]of r){if(a<this.threshold)continue;const l=this._colorCodeMeshMap.get(o);l&&(this._currentVisibleMeshes.add(l),this._recentlyHiddenMeshes.delete(l))}this.onViewUpdated.trigger({seen:this._currentVisibleMeshes,unseen:this._recentlyHiddenMeshes}),this._isWorkerBusy=!1}),this.worker.addEventListener("message",this.handleWorkerMessage),this.autoUpdate&&window.setInterval(async()=>{this.isProcessing||await this.updateVisibility()},this.updateInterval),this.onViewUpdated.add(({seen:n,unseen:r})=>{for(const o of n)o.visible=!0;for(const o of r)o.visible=!1})}dispose(){super.dispose(),this._intervalID!==null&&(window.clearInterval(this._intervalID),this._intervalID=null),this._currentVisibleMeshes.clear(),this._recentlyHiddenMeshes.clear(),this._meshIDColorCodeMap.clear(),this._transparentMat.dispose(),this._colorCodeMeshMap.clear();const e=this.components.get(Oi);for(const t in this.colorMeshes){const i=this.colorMeshes.get(t);i&&e.destroy(i,!0)}this.colorMeshes.clear()}add(e){if(!this.enabled)return;if(this.isProcessing){console.log("Culler processing not finished yet.");return}this.isProcessing=!0;const t=e instanceof Kt,{geometry:i,material:n}=e,{colorMaterial:r,code:o}=this.getAvailableMaterial();let a;if(Array.isArray(n)){let d=!0;const p=[];for(const f of n)Od.isTransparent(f)?p.push(this._transparentMat):(d=!1,p.push(r));if(d){r.dispose(),this.isProcessing=!1;return}a=p}else if(Od.isTransparent(n)){r.dispose(),this.isProcessing=!1;return}else a=r;this._colorCodeMeshMap.set(o,e),this._meshIDColorCodeMap.set(e.uuid,o);const l=t?e.count:1,h=new Kt(i,a,l);t?h.instanceMatrix=e.instanceMatrix:h.setMatrixAt(0,new Ee),e.visible=!1,h.applyMatrix4(e.matrix),h.updateMatrix(),this.scene.add(h),this.colorMeshes.set(e.uuid,h),this.increaseColor(),this.isProcessing=!1}remove(e){if(this.isProcessing){console.log("Culler processing not finished yet.");return}this.isProcessing=!0;const t=this.components.get(Oi);this._currentVisibleMeshes.delete(e),this._recentlyHiddenMeshes.delete(e);const i=this.colorMeshes.get(e.uuid),n=this._meshIDColorCodeMap.get(e.uuid);if(!i||!n){this.isProcessing=!1,console.log(e.visible);return}this._colorCodeMeshMap.delete(n),this._meshIDColorCodeMap.delete(e.uuid),this.colorMeshes.delete(e.uuid),i.geometry=void 0,i.material=[],t.destroy(i,!0),this._recentlyHiddenMeshes.delete(e),this._currentVisibleMeshes.delete(e),this.isProcessing=!1}getAvailableMaterial(){const{r:e,g:t,b:i,code:n}=this.getAvailableColor(),r=Si.enabled;Si.enabled=!1;const o=new Rt(`rgb(${e}, ${t}, ${i})`);if(!this.world.renderer)throw new Error("Renderer not found in the world!");const a=this.world.renderer.clippingPlanes,l=new Xt({color:o,clippingPlanes:a,side:no});return Si.enabled=r,{colorMaterial:l,code:n}}}const Jf=class hh extends Re{constructor(e){super(e),A(this,"_enabled",!0),A(this,"list",new Map),A(this,"onDisposed",new ee),e.add(hh.uuid,this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e;for(const[t,i]of this.list)i.enabled=e}create(e,t){if(this.list.has(e.uuid))return this.list.get(e.uuid);const i=new Q1(this.components,e,t);return this.list.set(e.uuid,i),i}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){this.enabled=!1,this.onDisposed.trigger(hh.uuid),this.onDisposed.reset();for(const[e,t]of this.list)t.dispose();this.list.clear()}};A(Jf,"uuid","69f2a50d-c266-44fc-b1bd-fa4d34be89e6");let Z1=Jf;class q1{constructor(e){if(A(this,"onDisposed",new ee),A(this,"onAfterUpdate",new ee),A(this,"onBeforeUpdate",new ee),A(this,"onResize",new ee),A(this,"frontOffset",0),A(this,"overrideMaterial",new Tf),A(this,"backgroundColor",new Rt(395274)),A(this,"renderer"),A(this,"enabled",!0),A(this,"world"),A(this,"_lockRotation",!0),A(this,"_camera"),A(this,"_plane"),A(this,"_size",new Ve(320,160)),A(this,"_tempVector1",new F),A(this,"_tempVector2",new F),A(this,"_tempTarget",new F),A(this,"down",new F(0,-1,0)),A(this,"updatePlanes",()=>{if(!this.world.renderer)throw new Error("The given world must have a renderer!");const n=[],r=this.world.renderer.three;for(const o of r.clippingPlanes)n.push(o);n.push(this._plane),this.renderer.clippingPlanes=n}),this.world=e,!this.world.renderer)throw new Error("The given world must have a renderer!");this.renderer=new Ha,this.renderer.setSize(this._size.x,this._size.y);const t=1,i=this._size.x/this._size.y;this._camera=new jn(t*i/-2,t*i/2,t/2,t/-2),this.world.renderer.onClippingPlanesUpdated.add(this.updatePlanes),this._camera.position.set(0,200,0),this._camera.zoom=.1,this._camera.rotation.x=-Math.PI/2,this._plane=new an(this.down,200),this.updatePlanes()}get lockRotation(){return this._lockRotation}set lockRotation(e){this._lockRotation=e,e&&(this._camera.rotation.z=0)}get zoom(){return this._camera.zoom}set zoom(e){this._camera.zoom=e,this._camera.updateProjectionMatrix()}dispose(){this.enabled=!1,this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.onResize.reset(),this.overrideMaterial.dispose(),this.renderer.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return this._camera}update(){if(!this.enabled)return;this.onBeforeUpdate.trigger();const e=this.world.scene.three,t=this.world.camera;if(!t.hasCameraControls())throw new Error("The given world must use camera controls!");if(!(e instanceof Xn))throw new Error("The given world must have a THREE.Scene as a root!");const i=t.controls;if(i.getPosition(this._tempVector1),this._camera.position.x=this._tempVector1.x,this._camera.position.z=this._tempVector1.z,this.frontOffset!==0&&(i.getTarget(this._tempVector2),this._tempVector2.sub(this._tempVector1),this._tempVector2.normalize().multiplyScalar(this.frontOffset),this._camera.position.x+=this._tempVector2.x,this._camera.position.z+=this._tempVector2.z),!this._lockRotation){i.getTarget(this._tempTarget);const r=Math.atan2(this._tempTarget.x-this._tempVector1.x,this._tempTarget.z-this._tempVector1.z);this._camera.rotation.z=r+Math.PI}this._plane.set(this.down,this._tempVector1.y);const n=e.background;e.background=this.backgroundColor,this.renderer.render(e,this._camera),e.background=n,this.onAfterUpdate.trigger()}getSize(){return this._size}resize(e){if(e){this._size.copy(e),this.renderer.setSize(e.x,e.y);const t=e.x/e.y,i=1;this._camera.left=i*t/-2,this._camera.right=i*t/2,this._camera.top=i/2,this._camera.bottom=-i/2,this._camera.updateProjectionMatrix(),this.onResize.trigger(e)}}}const J1=class $f extends Re{constructor(e){super(e),A(this,"onAfterUpdate",new ee),A(this,"onBeforeUpdate",new ee),A(this,"onDisposed",new ee),A(this,"enabled",!0),A(this,"list",new Map),this.components.add($f.uuid,this)}create(e){if(this.list.has(e.uuid))throw new Error("This world already has a minimap!");const t=new q1(e);return this.list.set(e.uuid,t),t}delete(e){const t=this.list.get(e);t&&t.dispose(),this.list.delete(e)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}update(){for(const[e,t]of this.list)t.update()}};A(J1,"uuid","39ad6aad-84c8-4adf-a1e0-7f25313a9e7f");class $1{constructor(e){A(this,"enabled",!1),A(this,"id","FirstPerson"),this.camera=e}set(e){if(this.enabled=e,e){if(this.camera.projection.current!=="Perspective"){this.camera.set("Orbit");return}this.setupFirstPersonCamera()}}setupFirstPersonCamera(){const e=this.camera.controls,t=new F;e.distance--,e.getPosition(t),e.minDistance=1,e.maxDistance=1,e.distance=1,e.moveTo(t.x,t.y,t.z),e.truckSpeed=50,e.mouseButtons.wheel=Mt.ACTION.DOLLY,e.touches.two=Mt.ACTION.TOUCH_ZOOM_TRUCK}}class eE{constructor(e){A(this,"enabled",!0),A(this,"id","Orbit"),this.camera=e,this.activateOrbitControls()}set(e){this.enabled=e,e&&this.activateOrbitControls()}activateOrbitControls(){const e=this.camera.controls;e.minDistance=1,e.maxDistance=300;const t=new F;e.getPosition(t);const i=t.length();e.distance=i,e.truckSpeed=2;const{rotation:n}=this.camera.three,r=new F(0,0,-1).applyEuler(n),o=t.addScaledVector(r,i);e.moveTo(o.x,o.y,o.z)}}class tE{constructor(e){A(this,"enabled",!1),A(this,"id","Plan"),A(this,"mouseAction1"),A(this,"mouseAction2"),A(this,"mouseInitialized",!1),A(this,"defaultAzimuthSpeed"),A(this,"defaultPolarSpeed"),this.camera=e,this.defaultAzimuthSpeed=e.controls.azimuthRotateSpeed,this.defaultPolarSpeed=e.controls.polarRotateSpeed}set(e){this.enabled=e;const t=this.camera.controls;t.azimuthRotateSpeed=e?0:this.defaultAzimuthSpeed,t.polarRotateSpeed=e?0:this.defaultPolarSpeed,this.mouseInitialized||(this.mouseAction1=t.touches.one,this.mouseAction2=t.touches.two,this.mouseInitialized=!0),e?(t.mouseButtons.left=Mt.ACTION.TRUCK,t.touches.one=Mt.ACTION.TOUCH_TRUCK,t.touches.two=Mt.ACTION.TOUCH_ZOOM):(t.mouseButtons.left=Mt.ACTION.ROTATE,t.touches.one=this.mouseAction1,t.touches.two=this.mouseAction2)}}class iE{constructor(e){A(this,"onChanged",new ee),A(this,"current","Perspective"),A(this,"camera"),A(this,"_component"),A(this,"_previousDistance",-1),A(this,"matchOrthoDistanceEnabled",!1),this._component=e,this.camera=e.three}async set(e){this.current!==e&&(e==="Orthographic"?this.setOrthoCamera():await this.setPerspectiveCamera(),this.onChanged.trigger(this.camera))}async toggle(){const e=this.current==="Perspective"?"Orthographic":"Perspective";await this.set(e)}setOrthoCamera(){if(this._component.mode===null||this._component.mode.id==="FirstPerson")return;this._previousDistance=this._component.controls.distance,this._component.controls.distance=200;const e=this.getPerspectiveDims();if(!e)return;const{width:t,height:i}=e;this.setupOrthoCamera(i,t),this.camera=this._component.threeOrtho,this.current="Orthographic"}getPerspectiveDims(){const e=this._component.currentWorld;if(!e||!e.renderer)return null;const t=new F;this._component.threePersp.getWorldDirection(t);const i=new F;this._component.controls.getTarget(i);const n=i.clone().sub(this._component.threePersp.position).dot(t),r=e.renderer.getSize(),o=r.x/r.y,a=this._component.threePersp,l=n*2*Math.atan(a.fov*(Math.PI/180)/2);return{width:l*o,height:l}}setupOrthoCamera(e,t){this._component.controls.mouseButtons.wheel=Mt.ACTION.ZOOM,this._component.controls.mouseButtons.middle=Mt.ACTION.ZOOM;const i=this._component.threePersp,n=this._component.threeOrtho;n.zoom=1,n.left=t/-2,n.right=t/2,n.top=e/2,n.bottom=e/-2,n.updateProjectionMatrix(),n.position.copy(i.position),n.quaternion.copy(i.quaternion),this._component.controls.camera=n}getDistance(){const e=this._component.threePersp,t=this._component.threeOrtho;return(t.top-t.bottom)/t.zoom/(2*Math.atan(e.fov*(Math.PI/180)/2))}async setPerspectiveCamera(){this._component.controls.mouseButtons.wheel=Mt.ACTION.DOLLY,this._component.controls.mouseButtons.middle=Mt.ACTION.DOLLY;const e=this._component.threePersp,t=this._component.threeOrtho;e.position.copy(t.position),e.quaternion.copy(t.quaternion),this._component.controls.mouseButtons.wheel=Mt.ACTION.DOLLY,this.matchOrthoDistanceEnabled?this._component.controls.distance=this.getDistance():this._component.controls.distance=this._previousDistance,await this._component.controls.zoomTo(1),e.updateProjectionMatrix(),this._component.controls.camera=e,this.camera=e,this.current="Perspective"}}class nE extends lh{constructor(e){super(e),A(this,"_mode",null),A(this,"projection"),A(this,"threeOrtho"),A(this,"threePersp"),A(this,"_userInputButtons",{}),A(this,"_frustumSize",50),A(this,"_navigationModes",new Map),A(this,"previousSize",null),this.threePersp=this.three,this.threeOrtho=this.newOrthoCamera(),this.projection=new iE(this),this.onAspectUpdated.add(()=>{this.setOrthoPerspCameraAspect()}),this.projection.onChanged.add(t=>{this.three=t,this.updateAspect()}),this.onWorldChanged.add(()=>{this._navigationModes.clear(),this._navigationModes.set("Orbit",new eE(this)),this._navigationModes.set("FirstPerson",new $1(this)),this._navigationModes.set("Plan",new tE(this)),this._mode=this._navigationModes.get("Orbit"),this.mode.set(!0,{preventTargetAdjustment:!0}),this.currentWorld&&this.currentWorld.renderer&&(this.previousSize=this.currentWorld.renderer.getSize().clone())})}get mode(){if(!this._mode)throw new Error("Mode not found, camera not initialized");return this._mode}dispose(){super.dispose(),this.threeOrtho.removeFromParent()}set(e){if(this.mode!==null&&this.mode.id!==e){if(this.mode.set(!1),!this._navigationModes.has(e))throw new Error("The specified mode does not exist!");this._mode=this._navigationModes.get(e),this.mode.set(!0)}}async fit(e,t=1.5){if(!this.enabled)return;const i=Number.MAX_VALUE,n=Number.MIN_VALUE,r=new F(i,i,i),o=new F(n,n,n);for(const f of e){const g=new Ke().setFromObject(f);g.min.x<r.x&&(r.x=g.min.x),g.min.y<r.y&&(r.y=g.min.y),g.min.z<r.z&&(r.z=g.min.z),g.max.x>o.x&&(o.x=g.max.x),g.max.y>o.y&&(o.y=g.max.y),g.max.z>o.z&&(o.z=g.max.z)}const a=new Ke(r,o),l=new F;a.getSize(l);const h=new F;a.getCenter(h);const d=Math.max(l.x,l.y,l.z)*t,p=new Gn(h,d);await this.controls.fitToSphere(p,!0)}setUserInput(e){e?this.enableUserInput():this.disableUserInput()}disableUserInput(){this._userInputButtons.left=this.controls.mouseButtons.left,this._userInputButtons.right=this.controls.mouseButtons.right,this._userInputButtons.middle=this.controls.mouseButtons.middle,this._userInputButtons.wheel=this.controls.mouseButtons.wheel,this.controls.mouseButtons.left=0,this.controls.mouseButtons.right=0,this.controls.mouseButtons.middle=0,this.controls.mouseButtons.wheel=0}enableUserInput(){Object.keys(this._userInputButtons).length!==0&&(this.controls.mouseButtons.left=this._userInputButtons.left,this.controls.mouseButtons.right=this._userInputButtons.right,this.controls.mouseButtons.middle=this._userInputButtons.middle,this.controls.mouseButtons.wheel=this._userInputButtons.wheel)}newOrthoCamera(){const e=window.innerWidth/window.innerHeight;return new jn(this._frustumSize*e/-2,this._frustumSize*e/2,this._frustumSize/2,this._frustumSize/-2,.1,1e3)}setOrthoPerspCameraAspect(){if(!this.currentWorld||!this.currentWorld.renderer||!this.previousSize)return;const e=this.currentWorld.renderer.getSize(),t=this.threeOrtho.top,i=this.threeOrtho.right,n=e.y/this.previousSize.y,r=e.x/this.previousSize.x,o=t*n,a=i*r;this.threeOrtho.left=-a,this.threeOrtho.right=a,this.threeOrtho.top=o,this.threeOrtho.bottom=-o,this.threeOrtho.updateProjectionMatrix(),this.previousSize.copy(e)}}const em=class xi extends Re{constructor(e){super(e),A(this,"enabled",!0),A(this,"onDisposed",new ee),A(this,"_absoluteMin"),A(this,"_absoluteMax"),A(this,"_meshes",[]),this.components.add(xi.uuid,this),this._absoluteMin=xi.newBound(!0),this._absoluteMax=xi.newBound(!1)}static getDimensions(e){const{min:t,max:i}=e,n=Math.abs(i.x-t.x),r=Math.abs(i.y-t.y),o=Math.abs(i.z-t.z),a=new F;return a.subVectors(i,t).divideScalar(2).add(t),{width:n,height:r,depth:o,center:a}}static newBound(e){const t=e?1:-1;return new F(t*Number.MAX_VALUE,t*Number.MAX_VALUE,t*Number.MAX_VALUE)}static getBounds(e,t,i){const n=i||this.newBound(!1),r=t||this.newBound(!0);for(const o of e)o.x<r.x&&(r.x=o.x),o.y<r.y&&(r.y=o.y),o.z<r.z&&(r.z=o.z),o.x>n.x&&(n.x=o.x),o.y>n.y&&(n.y=o.y),o.z>n.z&&(n.z=o.z);return new Ke(t,i)}dispose(){const e=this.components.get(Oi);for(const t of this._meshes)e.destroy(t);this._meshes=[],this.onDisposed.trigger(xi.uuid),this.onDisposed.reset()}get(){const e=this._absoluteMin.clone(),t=this._absoluteMax.clone();return new Ke(e,t)}getSphere(){const e=this._absoluteMin.clone(),t=this._absoluteMax.clone(),i=Math.abs((t.x-e.x)/2),n=Math.abs((t.y-e.y)/2),r=Math.abs((t.z-e.z)/2),o=new F(e.x+i,e.y+n,e.z+r),a=o.distanceTo(e);return new Gn(o,a)}getMesh(){const e=new Ke(this._absoluteMin,this._absoluteMax),t=xi.getDimensions(e),{width:i,height:n,depth:r,center:o}=t,a=new ut(i,n,r),l=new le(a);return this._meshes.push(l),l.position.copy(o),l}reset(){this._absoluteMin=xi.newBound(!0),this._absoluteMax=xi.newBound(!1)}add(e){for(const t of e.items)this.addMesh(t.mesh)}addMesh(e,t){if(!e.geometry.index)return;const i=xi.getFragmentBounds(e);e.updateMatrixWorld();const n=e.matrixWorld,r=new Ee,o=e instanceof Kt,a=new Set;if(t&&e instanceof yf)for(const l of t){const h=e.fragment.getInstancesIDs(l);if(h)for(const d of h)a.add(d)}else a.add(0);for(const l of a){const h=i.min.clone(),d=i.max.clone();o&&(e.getMatrixAt(l,r),h.applyMatrix4(r),d.applyMatrix4(r)),h.applyMatrix4(n),d.applyMatrix4(n),h.x<this._absoluteMin.x&&(this._absoluteMin.x=h.x),h.y<this._absoluteMin.y&&(this._absoluteMin.y=h.y),h.z<this._absoluteMin.z&&(this._absoluteMin.z=h.z),h.x>this._absoluteMax.x&&(this._absoluteMax.x=h.x),h.y>this._absoluteMax.y&&(this._absoluteMax.y=h.y),h.z>this._absoluteMax.z&&(this._absoluteMax.z=h.z),d.x>this._absoluteMax.x&&(this._absoluteMax.x=d.x),d.y>this._absoluteMax.y&&(this._absoluteMax.y=d.y),d.z>this._absoluteMax.z&&(this._absoluteMax.z=d.z),d.x<this._absoluteMin.x&&(this._absoluteMin.x=d.x),d.y<this._absoluteMin.y&&(this._absoluteMin.y=d.y),d.z<this._absoluteMin.z&&(this._absoluteMin.z=d.z)}}static getFragmentBounds(e){const t=e.geometry.attributes.position,i=Number.MAX_VALUE,n=-i,r=new F(i,i,i),o=new F(n,n,n);if(!e.geometry.index)throw new Error("Geometry must be indexed!");const a=Array.from(e.geometry.index.array);for(let l=0;l<a.length;l++){if(l%3===0&&a[l]===0&&a[l+1]===0&&a[l+2]===0){l+=2;continue}const h=a[l],d=t.getX(h),p=t.getY(h),f=t.getZ(h);d<r.x&&(r.x=d),p<r.y&&(r.y=p),f<r.z&&(r.z=f),d>o.x&&(o.x=d),p>o.y&&(o.y=p),f>o.z&&(o.z=f)}return new Ke(r,o)}};A(em,"uuid","d1444724-dba6-4cdd-a0c7-68ee1450d166");let tm=em;const nu=new Set([1123145078,574549367,1675464909,2059837836,3798115385,32440307,3125803723,3207858831,2740243338,2624227202,4240577450,3615266464,3724593414,220341763,477187591,1878645084,1300840506,3303107099,1607154358,1878645084,846575682,1351298697,2417041796,3049322572,3331915920,1416205885,776857604,3285139300,3958052878,2827736869,2732653382,673634403,3448662350,4142052618,2924175390,803316827,2556980723,1809719519,2205249479,807026263,3737207727,1660063152,2347385850,3940055652,2705031697,3732776249,2485617015,2611217952,1704287377,2937912522,2770003689,1281925730,1484403080,3448662350,4142052618,3800577675,4006246654,3590301190,1383045692,2775532180,2047409740,370225590,3593883385,2665983363,4124623270,812098782,3649129432,987898635,1105321065,3510044353,1635779807,2603310189,3406155212,1310608509,4261334040,2736907675,3649129432,1136057603,1260505505,4182860854,2713105998,2898889636,59481748,3749851601,3486308946,3150382593,1062206242,3264961684,15328376,1485152156,370225590,1981873012,2859738748,45288368,2614616156,2732653382,775493141,2147822146,2601014836,2629017746,1186437898,2367409068,1213902940,3632507154,3900360178,476780140,1472233963,2804161546,3008276851,738692330,374418227,315944413,3905492369,3570813810,2571569899,178912537,2294589976,1437953363,2133299955,572779678,3092502836,388784114,2624227202,1425443689,3057273783,2347385850,1682466193,2519244187,2839578677,3958567839,2513912981,2830218821,427810014]),im=class nm extends Re{constructor(e){super(e),A(this,"enabled",!0),e.add(nm.uuid,this)}async export(e,t,i=!1,n=!0){const r={},o=new Set(e.GetIfcEntityList(t)),a=new Set([pl,Qh,Zh,dl,Wn]);for(const l of a)o.add(l);for(const l of o){if(nu.has(l))continue;const h=a.has(l)&&n,d=e.GetLineIDsWithType(t,l);for(const p of d){const f=e.GetLine(0,p,h,i);r[f.expressID]=f}}return r}};A(im,"uuid","b32c4332-cd67-436e-ba7f-196646c7a635");let sE=im;const sm=class rm extends Re{constructor(e){super(e),A(this,"onDisposed",new ee),A(this,"onFragmentsLoaded",new ee),A(this,"onFragmentsDisposed",new ee),A(this,"list",new Map),A(this,"groups",new Map),A(this,"enabled",!0),A(this,"baseCoordinationModel",""),A(this,"_loader",new Ef),this.components.add(rm.uuid,this)}get meshes(){const e=[];for(const[t,i]of this.list)e.push(i.mesh);return e}dispose(){for(const[e,t]of this.groups)t.dispose(!0);this.baseCoordinationModel="",this.groups.clear(),this.list.clear(),this.onFragmentsLoaded.reset(),this.onFragmentsDisposed.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}disposeGroup(e){const{uuid:t}=e,i=[];for(const n of e.items)i.push(n.id),this.list.delete(n.id);e.dispose(!0),this.groups.delete(e.uuid),this.onFragmentsDisposed.trigger({groupID:t,fragmentIDs:i})}load(e,t){const i={coordinate:!0,...t},{coordinate:n,properties:r,relationsMap:o}=i,a=this._loader.import(e);for(const l of a.items)l.group=a,this.list.set(l.id,l);return n&&this.coordinate([a]),this.groups.set(a.uuid,a),r&&a.setLocalProperties(r),o&&this.components.get(su).setRelationMap(a,o),this.onFragmentsLoaded.trigger(a),a}export(e){return this._loader.export(e)}coordinate(e=Array.from(this.groups.values())){if(this.baseCoordinationModel.length===0){const i=e.pop();if(!i)return;this.baseCoordinationModel=i.uuid}if(!e.length)return;const t=this.groups.get(this.baseCoordinationModel);if(!t){console.log("No base model found for coordination!");return}for(const i of e)i!==t&&(i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),i.updateMatrix(),i.applyMatrix4(i.coordinationMatrix.clone().invert()),i.applyMatrix4(t.coordinationMatrix))}};A(sm,"uuid","fef46874-46a3-461b-8c44-2922ab77c806");let rt=sm;const om={950732822:"IFCURIREFERENCE",4075327185:"IFCTIME",1209108979:"IFCTEMPERATURERATEOFCHANGEMEASURE",3457685358:"IFCSOUNDPRESSURELEVELMEASURE",4157543285:"IFCSOUNDPOWERLEVELMEASURE",2798247006:"IFCPROPERTYSETDEFINITIONSET",1790229001:"IFCPOSITIVEINTEGER",525895558:"IFCNONNEGATIVELENGTHMEASURE",1774176899:"IFCLINEINDEX",1275358634:"IFCLANGUAGEID",2541165894:"IFCDURATION",3701338814:"IFCDAYINWEEKNUMBER",2195413836:"IFCDATETIME",937566702:"IFCDATE",1683019596:"IFCCARDINALPOINTREFERENCE",2314439260:"IFCBINARY",1500781891:"IFCAREADENSITYMEASURE",3683503648:"IFCARCINDEX",4065007721:"IFCYEARNUMBER",1718600412:"IFCWARPINGMOMENTMEASURE",51269191:"IFCWARPINGCONSTANTMEASURE",2593997549:"IFCVOLUMETRICFLOWRATEMEASURE",3458127941:"IFCVOLUMEMEASURE",3345633955:"IFCVAPORPERMEABILITYMEASURE",1278329552:"IFCTORQUEMEASURE",2591213694:"IFCTIMESTAMP",2726807636:"IFCTIMEMEASURE",743184107:"IFCTHERMODYNAMICTEMPERATUREMEASURE",2016195849:"IFCTHERMALTRANSMITTANCEMEASURE",857959152:"IFCTHERMALRESISTANCEMEASURE",2281867870:"IFCTHERMALEXPANSIONCOEFFICIENTMEASURE",2645777649:"IFCTHERMALCONDUCTIVITYMEASURE",232962298:"IFCTHERMALADMITTANCEMEASURE",296282323:"IFCTEXTTRANSFORMATION",603696268:"IFCTEXTFONTNAME",3490877962:"IFCTEXTDECORATION",1460886941:"IFCTEXTALIGNMENT",2801250643:"IFCTEXT",58845555:"IFCTEMPERATUREGRADIENTMEASURE",361837227:"IFCSPECULARROUGHNESS",2757832317:"IFCSPECULAREXPONENT",3477203348:"IFCSPECIFICHEATCAPACITYMEASURE",993287707:"IFCSOUNDPRESSUREMEASURE",846465480:"IFCSOUNDPOWERMEASURE",3471399674:"IFCSOLIDANGLEMEASURE",408310005:"IFCSHEARMODULUSMEASURE",2190458107:"IFCSECTIONALAREAINTEGRALMEASURE",3467162246:"IFCSECTIONMODULUSMEASURE",2766185779:"IFCSECONDINMINUTE",3211557302:"IFCROTATIONALSTIFFNESSMEASURE",1755127002:"IFCROTATIONALMASSMEASURE",2133746277:"IFCROTATIONALFREQUENCYMEASURE",200335297:"IFCREAL",96294661:"IFCRATIOMEASURE",3972513137:"IFCRADIOACTIVITYMEASURE",3665567075:"IFCPRESSUREMEASURE",2169031380:"IFCPRESENTABLETEXT",1364037233:"IFCPOWERMEASURE",1245737093:"IFCPOSITIVERATIOMEASURE",3054510233:"IFCPOSITIVEPLANEANGLEMEASURE",2815919920:"IFCPOSITIVELENGTHMEASURE",4042175685:"IFCPLANEANGLEMEASURE",2642773653:"IFCPLANARFORCEMEASURE",2260317790:"IFCPARAMETERVALUE",929793134:"IFCPHMEASURE",2395907400:"IFCNUMERICMEASURE",2095195183:"IFCNORMALISEDRATIOMEASURE",765770214:"IFCMONTHINYEARNUMBER",2615040989:"IFCMONETARYMEASURE",3114022597:"IFCMOMENTOFINERTIAMEASURE",1648970520:"IFCMOLECULARWEIGHTMEASURE",3177669450:"IFCMOISTUREDIFFUSIVITYMEASURE",1753493141:"IFCMODULUSOFSUBGRADEREACTIONMEASURE",1052454078:"IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE",2173214787:"IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE",3341486342:"IFCMODULUSOFELASTICITYMEASURE",102610177:"IFCMINUTEINHOUR",3531705166:"IFCMASSPERLENGTHMEASURE",3124614049:"IFCMASSMEASURE",4017473158:"IFCMASSFLOWRATEMEASURE",1477762836:"IFCMASSDENSITYMEASURE",2486716878:"IFCMAGNETICFLUXMEASURE",286949696:"IFCMAGNETICFLUXDENSITYMEASURE",151039812:"IFCLUMINOUSINTENSITYMEASURE",2755797622:"IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE",2095003142:"IFCLUMINOUSFLUXMEASURE",503418787:"IFCLOGICAL",3086160713:"IFCLINEARVELOCITYMEASURE",1307019551:"IFCLINEARSTIFFNESSMEASURE",2128979029:"IFCLINEARMOMENTMEASURE",191860431:"IFCLINEARFORCEMEASURE",1243674935:"IFCLENGTHMEASURE",3258342251:"IFCLABEL",2054016361:"IFCKINEMATICVISCOSITYMEASURE",3192672207:"IFCISOTHERMALMOISTURECAPACITYMEASURE",3686016028:"IFCIONCONCENTRATIONMEASURE",3809634241:"IFCINTEGERCOUNTRATEMEASURE",1939436016:"IFCINTEGER",2679005408:"IFCINDUCTANCEMEASURE",3358199106:"IFCILLUMINANCEMEASURE",983778844:"IFCIDENTIFIER",2589826445:"IFCHOURINDAY",1158859006:"IFCHEATINGVALUEMEASURE",3113092358:"IFCHEATFLUXDENSITYMEASURE",3064340077:"IFCGLOBALLYUNIQUEID",3044325142:"IFCFREQUENCYMEASURE",1361398929:"IFCFORCEMEASURE",2590844177:"IFCFONTWEIGHT",2715512545:"IFCFONTVARIANT",1102727119:"IFCFONTSTYLE",2078135608:"IFCENERGYMEASURE",2506197118:"IFCELECTRICVOLTAGEMEASURE",2951915441:"IFCELECTRICRESISTANCEMEASURE",3790457270:"IFCELECTRICCURRENTMEASURE",2093906313:"IFCELECTRICCONDUCTANCEMEASURE",3818826038:"IFCELECTRICCHARGEMEASURE",1827137117:"IFCELECTRICCAPACITANCEMEASURE",69416015:"IFCDYNAMICVISCOSITYMEASURE",524656162:"IFCDOSEEQUIVALENTMEASURE",4134073009:"IFCDIMENSIONCOUNT",1514641115:"IFCDESCRIPTIVEMEASURE",300323983:"IFCDAYLIGHTSAVINGHOUR",86635668:"IFCDAYINMONTHNUMBER",94842927:"IFCCURVATUREMEASURE",1778710042:"IFCCOUNTMEASURE",3238673880:"IFCCONTEXTDEPENDENTMEASURE",3812528620:"IFCCOMPOUNDPLANEANGLEMEASURE",2991860651:"IFCCOMPLEXNUMBER",1867003952:"IFCBOXALIGNMENT",2735952531:"IFCBOOLEAN",2650437152:"IFCAREAMEASURE",632304761:"IFCANGULARVELOCITYMEASURE",360377573:"IFCAMOUNTOFSUBSTANCEMEASURE",4182062534:"IFCACCELERATIONMEASURE",3699917729:"IFCABSORBEDDOSEMEASURE",1971632696:"IFCGEOSLICE",2680139844:"IFCGEOMODEL",24726584:"IFCELECTRICFLOWTREATMENTDEVICE",3693000487:"IFCDISTRIBUTIONBOARD",3460952963:"IFCCONVEYORSEGMENT",3999819293:"IFCCAISSONFOUNDATION",3314249567:"IFCBOREHOLE",4196446775:"IFCBEARING",325726236:"IFCALIGNMENT",3425753595:"IFCTRACKELEMENT",991950508:"IFCSIGNAL",3798194928:"IFCREINFORCEDSOIL",3290496277:"IFCRAIL",1383356374:"IFCPAVEMENT",2182337498:"IFCNAVIGATIONELEMENT",234836483:"IFCMOORINGDEVICE",2078563270:"IFCMOBILETELECOMMUNICATIONSAPPLIANCE",1638804497:"IFCLIQUIDTERMINAL",1154579445:"IFCLINEARPOSITIONINGELEMENT",2696325953:"IFCKERB",2713699986:"IFCGEOTECHNICALASSEMBLY",2142170206:"IFCELECTRICFLOWTREATMENTDEVICETYPE",3376911765:"IFCEARTHWORKSFILL",1077100507:"IFCEARTHWORKSELEMENT",3071239417:"IFCEARTHWORKSCUT",479945903:"IFCDISTRIBUTIONBOARDTYPE",3426335179:"IFCDEEPFOUNDATION",1502416096:"IFCCOURSE",2940368186:"IFCCONVEYORSEGMENTTYPE",3203706013:"IFCCAISSONFOUNDATIONTYPE",3862327254:"IFCBUILTSYSTEM",1876633798:"IFCBUILTELEMENT",963979645:"IFCBRIDGEPART",644574406:"IFCBRIDGE",3649138523:"IFCBEARINGTYPE",1662888072:"IFCALIGNMENTVERTICAL",317615605:"IFCALIGNMENTSEGMENT",1545765605:"IFCALIGNMENTHORIZONTAL",4266260250:"IFCALIGNMENTCANT",3956297820:"IFCVIBRATIONDAMPERTYPE",1530820697:"IFCVIBRATIONDAMPER",840318589:"IFCVEHICLE",1953115116:"IFCTRANSPORTATIONDEVICE",618700268:"IFCTRACKELEMENTTYPE",2281632017:"IFCTENDONCONDUITTYPE",3663046924:"IFCTENDONCONDUIT",42703149:"IFCSINESPIRAL",1894708472:"IFCSIGNALTYPE",3599934289:"IFCSIGNTYPE",33720170:"IFCSIGN",1027922057:"IFCSEVENTHORDERPOLYNOMIALSPIRAL",544395925:"IFCSEGMENTEDREFERENCECURVE",3649235739:"IFCSECONDORDERPOLYNOMIALSPIRAL",550521510:"IFCROADPART",146592293:"IFCROAD",3818125796:"IFCRELADHERESTOELEMENT",4021432810:"IFCREFERENT",1891881377:"IFCRAILWAYPART",3992365140:"IFCRAILWAY",1763565496:"IFCRAILTYPE",1946335990:"IFCPOSITIONINGELEMENT",514975943:"IFCPAVEMENTTYPE",506776471:"IFCNAVIGATIONELEMENTTYPE",710110818:"IFCMOORINGDEVICETYPE",1950438474:"IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE",976884017:"IFCMARINEPART",525669439:"IFCMARINEFACILITY",1770583370:"IFCLIQUIDTERMINALTYPE",2176059722:"IFCLINEARELEMENT",679976338:"IFCKERBTYPE",3948183225:"IFCIMPACTPROTECTIONDEVICETYPE",2568555532:"IFCIMPACTPROTECTIONDEVICE",2898700619:"IFCGRADIENTCURVE",1594536857:"IFCGEOTECHNICALSTRATUM",4230923436:"IFCGEOTECHNICALELEMENT",4228831410:"IFCFACILITYPARTCOMMON",1310830890:"IFCFACILITYPART",24185140:"IFCFACILITY",4234616927:"IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID",1306400036:"IFCDEEPFOUNDATIONTYPE",4189326743:"IFCCOURSETYPE",2000195564:"IFCCOSINESPIRAL",3497074424:"IFCCLOTHOID",1626504194:"IFCBUILTELEMENTTYPE",3651464721:"IFCVEHICLETYPE",1229763772:"IFCTRIANGULATEDIRREGULARNETWORK",3665877780:"IFCTRANSPORTATIONDEVICETYPE",782932809:"IFCTHIRDORDERPOLYNOMIALSPIRAL",2735484536:"IFCSPIRAL",1356537516:"IFCSECTIONEDSURFACE",1290935644:"IFCSECTIONEDSOLIDHORIZONTAL",1862484736:"IFCSECTIONEDSOLID",1441486842:"IFCRELPOSITIONS",1033248425:"IFCRELASSOCIATESPROFILEDEF",3381221214:"IFCPOLYNOMIALCURVE",2485787929:"IFCOFFSETCURVEBYDISTANCES",590820931:"IFCOFFSETCURVE",3465909080:"IFCINDEXEDPOLYGONALTEXTUREMAP",593015953:"IFCDIRECTRIXCURVESWEPTAREASOLID",4212018352:"IFCCURVESEGMENT",3425423356:"IFCAXIS2PLACEMENTLINEAR",823603102:"IFCSEGMENT",2165702409:"IFCPOINTBYDISTANCEEXPRESSION",182550632:"IFCOPENCROSSPROFILEDEF",388784114:"IFCLINEARPLACEMENT",536804194:"IFCALIGNMENTHORIZONTALSEGMENT",3752311538:"IFCALIGNMENTCANTSEGMENT",1010789467:"IFCTEXTURECOORDINATEINDICESWITHVOIDS",222769930:"IFCTEXTURECOORDINATEINDICES",2691318326:"IFCQUANTITYNUMBER",3633395639:"IFCALIGNMENTVERTICALSEGMENT",2879124712:"IFCALIGNMENTPARAMETERSEGMENT",25142252:"IFCCONTROLLER",3087945054:"IFCALARM",4288193352:"IFCACTUATOR",630975310:"IFCUNITARYCONTROLELEMENT",4086658281:"IFCSENSOR",2295281155:"IFCPROTECTIVEDEVICETRIPPINGUNIT",182646315:"IFCFLOWINSTRUMENT",1426591983:"IFCFIRESUPPRESSIONTERMINAL",819412036:"IFCFILTER",3415622556:"IFCFAN",1003880860:"IFCELECTRICTIMECONTROL",402227799:"IFCELECTRICMOTOR",264262732:"IFCELECTRICGENERATOR",3310460725:"IFCELECTRICFLOWSTORAGEDEVICE",862014818:"IFCELECTRICDISTRIBUTIONBOARD",1904799276:"IFCELECTRICAPPLIANCE",1360408905:"IFCDUCTSILENCER",3518393246:"IFCDUCTSEGMENT",342316401:"IFCDUCTFITTING",562808652:"IFCDISTRIBUTIONCIRCUIT",4074379575:"IFCDAMPER",3640358203:"IFCCOOLINGTOWER",4136498852:"IFCCOOLEDBEAM",2272882330:"IFCCONDENSER",3571504051:"IFCCOMPRESSOR",3221913625:"IFCCOMMUNICATIONSAPPLIANCE",639361253:"IFCCOIL",3902619387:"IFCCHILLER",4217484030:"IFCCABLESEGMENT",1051757585:"IFCCABLEFITTING",3758799889:"IFCCABLECARRIERSEGMENT",635142910:"IFCCABLECARRIERFITTING",2938176219:"IFCBURNER",32344328:"IFCBOILER",2906023776:"IFCBEAMSTANDARDCASE",277319702:"IFCAUDIOVISUALAPPLIANCE",2056796094:"IFCAIRTOAIRHEATRECOVERY",177149247:"IFCAIRTERMINALBOX",1634111441:"IFCAIRTERMINAL",486154966:"IFCWINDOWSTANDARDCASE",4237592921:"IFCWASTETERMINAL",4156078855:"IFCWALLELEMENTEDCASE",4207607924:"IFCVALVE",4292641817:"IFCUNITARYEQUIPMENT",3179687236:"IFCUNITARYCONTROLELEMENTTYPE",3026737570:"IFCTUBEBUNDLE",3825984169:"IFCTRANSFORMER",812556717:"IFCTANK",1162798199:"IFCSWITCHINGDEVICE",385403989:"IFCSTRUCTURALLOADCASE",1404847402:"IFCSTACKTERMINAL",1999602285:"IFCSPACEHEATER",3420628829:"IFCSOLARDEVICE",3027962421:"IFCSLABSTANDARDCASE",3127900445:"IFCSLABELEMENTEDCASE",1329646415:"IFCSHADINGDEVICE",3053780830:"IFCSANITARYTERMINAL",2572171363:"IFCREINFORCINGBARTYPE",1232101972:"IFCRATIONALBSPLINECURVEWITHKNOTS",90941305:"IFCPUMP",655969474:"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE",738039164:"IFCPROTECTIVEDEVICE",1156407060:"IFCPLATESTANDARDCASE",3612865200:"IFCPIPESEGMENT",310824031:"IFCPIPEFITTING",3694346114:"IFCOUTLET",144952367:"IFCOUTERBOUNDARYCURVE",2474470126:"IFCMOTORCONNECTION",1911478936:"IFCMEMBERSTANDARDCASE",1437502449:"IFCMEDICALDEVICE",629592764:"IFCLIGHTFIXTURE",76236018:"IFCLAMP",2176052936:"IFCJUNCTIONBOX",4175244083:"IFCINTERCEPTOR",2068733104:"IFCHUMIDIFIER",3319311131:"IFCHEATEXCHANGER",2188021234:"IFCFLOWMETER",1209101575:"IFCEXTERNALSPATIALELEMENT",484807127:"IFCEVAPORATOR",3747195512:"IFCEVAPORATIVECOOLER",2814081492:"IFCENGINE",2417008758:"IFCELECTRICDISTRIBUTIONBOARDTYPE",3242481149:"IFCDOORSTANDARDCASE",3205830791:"IFCDISTRIBUTIONSYSTEM",400855858:"IFCCOMMUNICATIONSAPPLIANCETYPE",905975707:"IFCCOLUMNSTANDARDCASE",1677625105:"IFCCIVILELEMENT",3296154744:"IFCCHIMNEY",2674252688:"IFCCABLEFITTINGTYPE",2188180465:"IFCBURNERTYPE",1177604601:"IFCBUILDINGSYSTEM",39481116:"IFCBUILDINGELEMENTPARTTYPE",1136057603:"IFCBOUNDARYCURVE",2461110595:"IFCBSPLINECURVEWITHKNOTS",1532957894:"IFCAUDIOVISUALAPPLIANCETYPE",4088093105:"IFCWORKCALENDAR",4009809668:"IFCWINDOWTYPE",926996030:"IFCVOIDINGFEATURE",2391383451:"IFCVIBRATIONISOLATOR",2415094496:"IFCTENDONTYPE",3081323446:"IFCTENDONANCHORTYPE",413509423:"IFCSYSTEMFURNITUREELEMENT",3101698114:"IFCSURFACEFEATURE",3657597509:"IFCSTRUCTURALSURFACEACTION",2757150158:"IFCSTRUCTURALCURVEREACTION",1004757350:"IFCSTRUCTURALCURVEACTION",338393293:"IFCSTAIRTYPE",1072016465:"IFCSOLARDEVICETYPE",4074543187:"IFCSHADINGDEVICETYPE",2157484638:"IFCSEAMCURVE",2781568857:"IFCROOFTYPE",2310774935:"IFCREINFORCINGMESHTYPE",964333572:"IFCREINFORCINGELEMENTTYPE",683857671:"IFCRATIONALBSPLINESURFACEWITHKNOTS",1469900589:"IFCRAMPTYPE",2839578677:"IFCPOLYGONALFACESET",1158309216:"IFCPILETYPE",3079942009:"IFCOPENINGSTANDARDCASE",1114901282:"IFCMEDICALDEVICETYPE",3113134337:"IFCINTERSECTIONCURVE",3946677679:"IFCINTERCEPTORTYPE",2571569899:"IFCINDEXEDPOLYCURVE",3493046030:"IFCGEOGRAPHICELEMENT",1509553395:"IFCFURNITURE",1893162501:"IFCFOOTINGTYPE",2853485674:"IFCEXTERNALSPATIALSTRUCTUREELEMENT",4148101412:"IFCEVENT",132023988:"IFCENGINETYPE",2397081782:"IFCELEMENTASSEMBLYTYPE",2323601079:"IFCDOORTYPE",1213902940:"IFCCYLINDRICALSURFACE",1525564444:"IFCCONSTRUCTIONPRODUCTRESOURCETYPE",4105962743:"IFCCONSTRUCTIONMATERIALRESOURCETYPE",2185764099:"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE",15328376:"IFCCOMPOSITECURVEONSURFACE",3875453745:"IFCCOMPLEXPROPERTYTEMPLATE",3893394355:"IFCCIVILELEMENTTYPE",2197970202:"IFCCHIMNEYTYPE",167062518:"IFCBSPLINESURFACEWITHKNOTS",2887950389:"IFCBSPLINESURFACE",2603310189:"IFCADVANCEDBREPWITHVOIDS",1635779807:"IFCADVANCEDBREP",2916149573:"IFCTRIANGULATEDFACESET",1935646853:"IFCTOROIDALSURFACE",2387106220:"IFCTESSELLATEDFACESET",3206491090:"IFCTASKTYPE",699246055:"IFCSURFACECURVE",4095615324:"IFCSUBCONTRACTRESOURCETYPE",603775116:"IFCSTRUCTURALSURFACEREACTION",4015995234:"IFCSPHERICALSURFACE",2481509218:"IFCSPATIALZONETYPE",463610769:"IFCSPATIALZONE",710998568:"IFCSPATIALELEMENTTYPE",1412071761:"IFCSPATIALELEMENT",3663146110:"IFCSIMPLEPROPERTYTEMPLATE",3243963512:"IFCREVOLVEDAREASOLIDTAPERED",816062949:"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT",1521410863:"IFCRELSPACEBOUNDARY2NDLEVEL",3523091289:"IFCRELSPACEBOUNDARY1STLEVEL",427948657:"IFCRELINTERFERESELEMENTS",307848117:"IFCRELDEFINESBYTEMPLATE",1462361463:"IFCRELDEFINESBYOBJECT",2565941209:"IFCRELDECLARES",1027710054:"IFCRELASSIGNSTOGROUPBYFACTOR",3521284610:"IFCPROPERTYTEMPLATE",492091185:"IFCPROPERTYSETTEMPLATE",653396225:"IFCPROJECTLIBRARY",569719735:"IFCPROCEDURETYPE",3967405729:"IFCPREDEFINEDPROPERTYSET",1682466193:"IFCPCURVE",428585644:"IFCLABORRESOURCETYPE",2294589976:"IFCINDEXEDPOLYGONALFACEWITHVOIDS",178912537:"IFCINDEXEDPOLYGONALFACE",4095422895:"IFCGEOGRAPHICELEMENTTYPE",2652556860:"IFCFIXEDREFERENCESWEPTAREASOLID",2804161546:"IFCEXTRUDEDAREASOLIDTAPERED",4024345920:"IFCEVENTTYPE",2629017746:"IFCCURVEBOUNDEDSURFACE",1815067380:"IFCCREWRESOURCETYPE",3419103109:"IFCCONTEXT",2574617495:"IFCCONSTRUCTIONRESOURCETYPE",2059837836:"IFCCARTESIANPOINTLIST3D",1675464909:"IFCCARTESIANPOINTLIST2D",574549367:"IFCCARTESIANPOINTLIST",3406155212:"IFCADVANCEDFACE",3698973494:"IFCTYPERESOURCE",3736923433:"IFCTYPEPROCESS",901063453:"IFCTESSELLATEDITEM",1096409881:"IFCSWEPTDISKSOLIDPOLYGONAL",1042787934:"IFCRESOURCETIME",1608871552:"IFCRESOURCECONSTRAINTRELATIONSHIP",2943643501:"IFCRESOURCEAPPROVALRELATIONSHIP",2090586900:"IFCQUANTITYSET",1482703590:"IFCPROPERTYTEMPLATEDEFINITION",3778827333:"IFCPREDEFINEDPROPERTIES",2998442950:"IFCMIRROREDPROFILEDEF",853536259:"IFCMATERIALRELATIONSHIP",3404854881:"IFCMATERIALPROFILESETUSAGETAPERING",3079605661:"IFCMATERIALPROFILESETUSAGE",2852063980:"IFCMATERIALCONSTITUENTSET",3708119e3:"IFCMATERIALCONSTITUENT",1585845231:"IFCLAGTIME",2133299955:"IFCINDEXEDTRIANGLETEXTUREMAP",1437953363:"IFCINDEXEDTEXTUREMAP",3570813810:"IFCINDEXEDCOLOURMAP",1437805879:"IFCEXTERNALREFERENCERELATIONSHIP",297599258:"IFCEXTENDEDPROPERTIES",211053100:"IFCEVENTTIME",2713554722:"IFCCONVERSIONBASEDUNITWITHOFFSET",3285139300:"IFCCOLOURRGBLIST",1236880293:"IFCWORKTIME",1199560280:"IFCTIMEPERIOD",3611470254:"IFCTEXTUREVERTEXLIST",2771591690:"IFCTASKTIMERECURRING",1549132990:"IFCTASKTIME",2043862942:"IFCTABLECOLUMN",2934153892:"IFCSURFACEREINFORCEMENTAREA",609421318:"IFCSTRUCTURALLOADORRESULT",3478079324:"IFCSTRUCTURALLOADCONFIGURATION",1054537805:"IFCSCHEDULINGTIME",2439245199:"IFCRESOURCELEVELRELATIONSHIP",2433181523:"IFCREFERENCE",3915482550:"IFCRECURRENCEPATTERN",986844984:"IFCPROPERTYABSTRACTION",3843373140:"IFCPROJECTEDCRS",677532197:"IFCPRESENTATIONITEM",1507914824:"IFCMATERIALUSAGEDEFINITION",552965576:"IFCMATERIALPROFILEWITHOFFSETS",164193824:"IFCMATERIALPROFILESET",2235152071:"IFCMATERIALPROFILE",1847252529:"IFCMATERIALLAYERWITHOFFSETS",760658860:"IFCMATERIALDEFINITION",3057273783:"IFCMAPCONVERSION",4294318154:"IFCEXTERNALINFORMATION",1466758467:"IFCCOORDINATEREFERENCESYSTEM",1785450214:"IFCCOORDINATEOPERATION",775493141:"IFCCONNECTIONVOLUMEGEOMETRY",979691226:"IFCREINFORCINGBAR",3700593921:"IFCELECTRICDISTRIBUTIONPOINT",1062813311:"IFCDISTRIBUTIONCONTROLELEMENT",1052013943:"IFCDISTRIBUTIONCHAMBERELEMENT",578613899:"IFCCONTROLLERTYPE",2454782716:"IFCCHAMFEREDGEFEATURE",753842376:"IFCBEAM",3001207471:"IFCALARMTYPE",2874132201:"IFCACTUATORTYPE",3304561284:"IFCWINDOW",3512223829:"IFCWALLSTANDARDCASE",2391406946:"IFCWALL",3313531582:"IFCVIBRATIONISOLATORTYPE",2347447852:"IFCTENDONANCHOR",3824725483:"IFCTENDON",2515109513:"IFCSTRUCTURALANALYSISMODEL",4252922144:"IFCSTAIRFLIGHT",331165859:"IFCSTAIR",1529196076:"IFCSLAB",1783015770:"IFCSENSORTYPE",1376911519:"IFCROUNDEDEDGEFEATURE",2016517767:"IFCROOF",2320036040:"IFCREINFORCINGMESH",3027567501:"IFCREINFORCINGELEMENT",3055160366:"IFCRATIONALBEZIERCURVE",3283111854:"IFCRAMPFLIGHT",3024970846:"IFCRAMP",2262370178:"IFCRAILING",3171933400:"IFCPLATE",1687234759:"IFCPILE",1073191201:"IFCMEMBER",900683007:"IFCFOOTING",3508470533:"IFCFLOWTREATMENTDEVICE",2223149337:"IFCFLOWTERMINAL",707683696:"IFCFLOWSTORAGEDEVICE",987401354:"IFCFLOWSEGMENT",3132237377:"IFCFLOWMOVINGDEVICE",4037862832:"IFCFLOWINSTRUMENTTYPE",4278956645:"IFCFLOWFITTING",2058353004:"IFCFLOWCONTROLLER",4222183408:"IFCFIRESUPPRESSIONTERMINALTYPE",1810631287:"IFCFILTERTYPE",346874300:"IFCFANTYPE",1658829314:"IFCENERGYCONVERSIONDEVICE",857184966:"IFCELECTRICALELEMENT",1634875225:"IFCELECTRICALCIRCUIT",712377611:"IFCELECTRICTIMECONTROLTYPE",1217240411:"IFCELECTRICMOTORTYPE",1365060375:"IFCELECTRICHEATERTYPE",1534661035:"IFCELECTRICGENERATORTYPE",3277789161:"IFCELECTRICFLOWSTORAGEDEVICETYPE",663422040:"IFCELECTRICAPPLIANCETYPE",855621170:"IFCEDGEFEATURE",2030761528:"IFCDUCTSILENCERTYPE",3760055223:"IFCDUCTSEGMENTTYPE",869906466:"IFCDUCTFITTINGTYPE",395920057:"IFCDOOR",3041715199:"IFCDISTRIBUTIONPORT",3040386961:"IFCDISTRIBUTIONFLOWELEMENT",1945004755:"IFCDISTRIBUTIONELEMENT",2063403501:"IFCDISTRIBUTIONCONTROLELEMENTTYPE",1599208980:"IFCDISTRIBUTIONCHAMBERELEMENTTYPE",2635815018:"IFCDISCRETEACCESSORYTYPE",1335981549:"IFCDISCRETEACCESSORY",4147604152:"IFCDIAMETERDIMENSION",3961806047:"IFCDAMPERTYPE",3495092785:"IFCCURTAINWALL",1973544240:"IFCCOVERING",2954562838:"IFCCOOLINGTOWERTYPE",335055490:"IFCCOOLEDBEAMTYPE",488727124:"IFCCONSTRUCTIONPRODUCTRESOURCE",1060000209:"IFCCONSTRUCTIONMATERIALRESOURCE",3898045240:"IFCCONSTRUCTIONEQUIPMENTRESOURCE",1163958913:"IFCCONDITIONCRITERION",2188551683:"IFCCONDITION",2816379211:"IFCCONDENSERTYPE",3850581409:"IFCCOMPRESSORTYPE",843113511:"IFCCOLUMN",2301859152:"IFCCOILTYPE",2611217952:"IFCCIRCLE",2951183804:"IFCCHILLERTYPE",1285652485:"IFCCABLESEGMENTTYPE",3293546465:"IFCCABLECARRIERSEGMENTTYPE",395041908:"IFCCABLECARRIERFITTINGTYPE",1909888760:"IFCBUILDINGELEMENTPROXYTYPE",1095909175:"IFCBUILDINGELEMENTPROXY",2979338954:"IFCBUILDINGELEMENTPART",52481810:"IFCBUILDINGELEMENTCOMPONENT",3299480353:"IFCBUILDINGELEMENT",231477066:"IFCBOILERTYPE",1916977116:"IFCBEZIERCURVE",819618141:"IFCBEAMTYPE",1967976161:"IFCBSPLINECURVE",3460190687:"IFCASSET",2470393545:"IFCANGULARDIMENSION",1871374353:"IFCAIRTOAIRHEATRECOVERYTYPE",3352864051:"IFCAIRTERMINALTYPE",1411407467:"IFCAIRTERMINALBOXTYPE",3821786052:"IFCACTIONREQUEST",1213861670:"IFC2DCOMPOSITECURVE",1033361043:"IFCZONE",3342526732:"IFCWORKSCHEDULE",4218914973:"IFCWORKPLAN",1028945134:"IFCWORKCONTROL",1133259667:"IFCWASTETERMINALTYPE",1898987631:"IFCWALLTYPE",2769231204:"IFCVIRTUALELEMENT",728799441:"IFCVALVETYPE",1911125066:"IFCUNITARYEQUIPMENTTYPE",1600972822:"IFCTUBEBUNDLETYPE",3593883385:"IFCTRIMMEDCURVE",1620046519:"IFCTRANSPORTELEMENT",1692211062:"IFCTRANSFORMERTYPE",1637806684:"IFCTIMESERIESSCHEDULE",5716631:"IFCTANKTYPE",2254336722:"IFCSYSTEM",2315554128:"IFCSWITCHINGDEVICETYPE",148013059:"IFCSUBCONTRACTRESOURCE",1975003073:"IFCSTRUCTURALSURFACECONNECTION",2986769608:"IFCSTRUCTURALRESULTGROUP",1235345126:"IFCSTRUCTURALPOINTREACTION",734778138:"IFCSTRUCTURALPOINTCONNECTION",2082059205:"IFCSTRUCTURALPOINTACTION",3987759626:"IFCSTRUCTURALPLANARACTIONVARYING",1621171031:"IFCSTRUCTURALPLANARACTION",1252848954:"IFCSTRUCTURALLOADGROUP",1721250024:"IFCSTRUCTURALLINEARACTIONVARYING",1807405624:"IFCSTRUCTURALLINEARACTION",2445595289:"IFCSTRUCTURALCURVEMEMBERVARYING",214636428:"IFCSTRUCTURALCURVEMEMBER",4243806635:"IFCSTRUCTURALCURVECONNECTION",1179482911:"IFCSTRUCTURALCONNECTION",682877961:"IFCSTRUCTURALACTION",1039846685:"IFCSTAIRFLIGHTTYPE",3112655638:"IFCSTACKTERMINALTYPE",3812236995:"IFCSPACETYPE",652456506:"IFCSPACEPROGRAM",1305183839:"IFCSPACEHEATERTYPE",3856911033:"IFCSPACE",2533589738:"IFCSLABTYPE",4097777520:"IFCSITE",4105383287:"IFCSERVICELIFE",3517283431:"IFCSCHEDULETIMECONTROL",1768891740:"IFCSANITARYTERMINALTYPE",2863920197:"IFCRELASSIGNSTASKS",160246688:"IFCRELAGGREGATES",2324767716:"IFCRAMPFLIGHTTYPE",2893384427:"IFCRAILINGTYPE",3248260540:"IFCRADIUSDIMENSION",2250791053:"IFCPUMPTYPE",1842657554:"IFCPROTECTIVEDEVICETYPE",3651124850:"IFCPROJECTIONELEMENT",3642467123:"IFCPROJECTORDERRECORD",2904328755:"IFCPROJECTORDER",2744685151:"IFCPROCEDURE",3740093272:"IFCPORT",3724593414:"IFCPOLYLINE",4017108033:"IFCPLATETYPE",4231323485:"IFCPIPESEGMENTTYPE",804291784:"IFCPIPEFITTINGTYPE",3327091369:"IFCPERMIT",2382730787:"IFCPERFORMANCEHISTORY",2837617999:"IFCOUTLETTYPE",3425660407:"IFCORDERACTION",3588315303:"IFCOPENINGELEMENT",4143007308:"IFCOCCUPANT",1916936684:"IFCMOVE",977012517:"IFCMOTORCONNECTIONTYPE",3181161470:"IFCMEMBERTYPE",2108223431:"IFCMECHANICALFASTENERTYPE",377706215:"IFCMECHANICALFASTENER",2506943328:"IFCLINEARDIMENSION",1161773419:"IFCLIGHTFIXTURETYPE",1051575348:"IFCLAMPTYPE",3827777499:"IFCLABORRESOURCE",4288270099:"IFCJUNCTIONBOXTYPE",2391368822:"IFCINVENTORY",1806887404:"IFCHUMIDIFIERTYPE",1251058090:"IFCHEATEXCHANGERTYPE",2706460486:"IFCGROUP",3009204131:"IFCGRID",200128114:"IFCGASTERMINALTYPE",814719939:"IFCFURNITURESTANDARD",263784265:"IFCFURNISHINGELEMENT",3009222698:"IFCFLOWTREATMENTDEVICETYPE",2297155007:"IFCFLOWTERMINALTYPE",1339347760:"IFCFLOWSTORAGEDEVICETYPE",1834744321:"IFCFLOWSEGMENTTYPE",1482959167:"IFCFLOWMOVINGDEVICETYPE",3815607619:"IFCFLOWMETERTYPE",3198132628:"IFCFLOWFITTINGTYPE",3907093117:"IFCFLOWCONTROLLERTYPE",1287392070:"IFCFEATUREELEMENTSUBTRACTION",2143335405:"IFCFEATUREELEMENTADDITION",2827207264:"IFCFEATUREELEMENT",2489546625:"IFCFASTENERTYPE",647756555:"IFCFASTENER",3737207727:"IFCFACETEDBREPWITHVOIDS",807026263:"IFCFACETEDBREP",3390157468:"IFCEVAPORATORTYPE",3174744832:"IFCEVAPORATIVECOOLERTYPE",3272907226:"IFCEQUIPMENTSTANDARD",1962604670:"IFCEQUIPMENTELEMENT",2107101300:"IFCENERGYCONVERSIONDEVICETYPE",1704287377:"IFCELLIPSE",2590856083:"IFCELEMENTCOMPONENTTYPE",1623761950:"IFCELEMENTCOMPONENT",4123344466:"IFCELEMENTASSEMBLY",1758889154:"IFCELEMENT",360485395:"IFCELECTRICALBASEPROPERTIES",3849074793:"IFCDISTRIBUTIONFLOWELEMENTTYPE",3256556792:"IFCDISTRIBUTIONELEMENTTYPE",681481545:"IFCDIMENSIONCURVEDIRECTEDCALLOUT",1457835157:"IFCCURTAINWALLTYPE",3295246426:"IFCCREWRESOURCE",1916426348:"IFCCOVERINGTYPE",1419761937:"IFCCOSTSCHEDULE",3895139033:"IFCCOSTITEM",3293443760:"IFCCONTROL",2559216714:"IFCCONSTRUCTIONRESOURCE",2510884976:"IFCCONIC",3732776249:"IFCCOMPOSITECURVE",300633059:"IFCCOLUMNTYPE",2937912522:"IFCCIRCLEHOLLOWPROFILEDEF",3124254112:"IFCBUILDINGSTOREY",1950629157:"IFCBUILDINGELEMENTTYPE",4031249490:"IFCBUILDING",1260505505:"IFCBOUNDEDCURVE",3649129432:"IFCBOOLEANCLIPPINGRESULT",1334484129:"IFCBLOCK",3207858831:"IFCASYMMETRICISHAPEPROFILEDEF",1674181508:"IFCANNOTATION",2296667514:"IFCACTOR",2097647324:"IFCTRANSPORTELEMENTTYPE",3473067441:"IFCTASK",1580310250:"IFCSYSTEMFURNITUREELEMENTTYPE",4124788165:"IFCSURFACEOFREVOLUTION",2809605785:"IFCSURFACEOFLINEAREXTRUSION",2028607225:"IFCSURFACECURVESWEPTAREASOLID",4070609034:"IFCSTRUCTUREDDIMENSIONCALLOUT",2218152070:"IFCSTRUCTURALSURFACEMEMBERVARYING",3979015343:"IFCSTRUCTURALSURFACEMEMBER",3689010777:"IFCSTRUCTURALREACTION",530289379:"IFCSTRUCTURALMEMBER",3136571912:"IFCSTRUCTURALITEM",3544373492:"IFCSTRUCTURALACTIVITY",451544542:"IFCSPHERE",3893378262:"IFCSPATIALSTRUCTUREELEMENTTYPE",2706606064:"IFCSPATIALSTRUCTUREELEMENT",3626867408:"IFCRIGHTCIRCULARCYLINDER",4158566097:"IFCRIGHTCIRCULARCONE",1856042241:"IFCREVOLVEDAREASOLID",2914609552:"IFCRESOURCE",1401173127:"IFCRELVOIDSELEMENT",3451746338:"IFCRELSPACEBOUNDARY",366585022:"IFCRELSERVICESBUILDINGS",4122056220:"IFCRELSEQUENCE",1058617721:"IFCRELSCHEDULESCOSTITEMS",1245217292:"IFCRELREFERENCEDINSPATIALSTRUCTURE",750771296:"IFCRELPROJECTSELEMENT",202636808:"IFCRELOVERRIDESPROPERTIES",2051452291:"IFCRELOCCUPIESSPACES",3268803585:"IFCRELNESTS",4189434867:"IFCRELINTERACTIONREQUIREMENTS",279856033:"IFCRELFLOWCONTROLELEMENTS",3940055652:"IFCRELFILLSELEMENT",781010003:"IFCRELDEFINESBYTYPE",4186316022:"IFCRELDEFINESBYPROPERTIES",693640335:"IFCRELDEFINES",2551354335:"IFCRELDECOMPOSES",2802773753:"IFCRELCOVERSSPACES",886880790:"IFCRELCOVERSBLDGELEMENTS",3242617779:"IFCRELCONTAINEDINSPATIALSTRUCTURE",3678494232:"IFCRELCONNECTSWITHREALIZINGELEMENTS",504942748:"IFCRELCONNECTSWITHECCENTRICITY",1638771189:"IFCRELCONNECTSSTRUCTURALMEMBER",3912681535:"IFCRELCONNECTSSTRUCTURALELEMENT",2127690289:"IFCRELCONNECTSSTRUCTURALACTIVITY",3190031847:"IFCRELCONNECTSPORTS",4201705270:"IFCRELCONNECTSPORTTOELEMENT",3945020480:"IFCRELCONNECTSPATHELEMENTS",1204542856:"IFCRELCONNECTSELEMENTS",826625072:"IFCRELCONNECTS",2851387026:"IFCRELASSOCIATESPROFILEPROPERTIES",2655215786:"IFCRELASSOCIATESMATERIAL",3840914261:"IFCRELASSOCIATESLIBRARY",982818633:"IFCRELASSOCIATESDOCUMENT",2728634034:"IFCRELASSOCIATESCONSTRAINT",919958153:"IFCRELASSOCIATESCLASSIFICATION",4095574036:"IFCRELASSOCIATESAPPROVAL",1327628568:"IFCRELASSOCIATESAPPLIEDVALUE",1865459582:"IFCRELASSOCIATES",205026976:"IFCRELASSIGNSTORESOURCE",3372526763:"IFCRELASSIGNSTOPROJECTORDER",2857406711:"IFCRELASSIGNSTOPRODUCT",4278684876:"IFCRELASSIGNSTOPROCESS",1307041759:"IFCRELASSIGNSTOGROUP",2495723537:"IFCRELASSIGNSTOCONTROL",1683148259:"IFCRELASSIGNSTOACTOR",3939117080:"IFCRELASSIGNS",3454111270:"IFCRECTANGULARTRIMMEDSURFACE",2798486643:"IFCRECTANGULARPYRAMID",2770003689:"IFCRECTANGLEHOLLOWPROFILEDEF",3219374653:"IFCPROXY",1451395588:"IFCPROPERTYSET",4194566429:"IFCPROJECTIONCURVE",103090709:"IFCPROJECT",4208778838:"IFCPRODUCT",2945172077:"IFCPROCESS",220341763:"IFCPLANE",603570806:"IFCPLANARBOX",3566463478:"IFCPERMEABLECOVERINGPROPERTIES",3505215534:"IFCOFFSETCURVE3D",3388369263:"IFCOFFSETCURVE2D",3888040117:"IFCOBJECT",1425443689:"IFCMANIFOLDSOLIDBREP",1281925730:"IFCLINE",572779678:"IFCLSHAPEPROFILEDEF",1484403080:"IFCISHAPEPROFILEDEF",987898635:"IFCGEOMETRICCURVESET",1268542332:"IFCFURNITURETYPE",4238390223:"IFCFURNISHINGELEMENTTYPE",3455213021:"IFCFLUIDFLOWPROPERTIES",315944413:"IFCFILLAREASTYLETILES",4203026998:"IFCFILLAREASTYLETILESYMBOLWITHSTYLE",374418227:"IFCFILLAREASTYLEHATCHING",2047409740:"IFCFACEBASEDSURFACEMODEL",477187591:"IFCEXTRUDEDAREASOLID",80994333:"IFCENERGYPROPERTIES",2835456948:"IFCELLIPSEPROFILEDEF",2777663545:"IFCELEMENTARYSURFACE",339256511:"IFCELEMENTTYPE",1883228015:"IFCELEMENTQUANTITY",1472233963:"IFCEDGELOOP",4006246654:"IFCDRAUGHTINGPREDEFINEDCURVEFONT",445594917:"IFCDRAUGHTINGPREDEFINEDCOLOUR",3073041342:"IFCDRAUGHTINGCALLOUT",526551008:"IFCDOORSTYLE",1714330368:"IFCDOORPANELPROPERTIES",2963535650:"IFCDOORLININGPROPERTIES",32440307:"IFCDIRECTION",4054601972:"IFCDIMENSIONCURVETERMINATOR",606661476:"IFCDIMENSIONCURVE",693772133:"IFCDEFINEDSYMBOL",2827736869:"IFCCURVEBOUNDEDPLANE",2601014836:"IFCCURVE",2147822146:"IFCCSGSOLID",2506170314:"IFCCSGPRIMITIVE3D",194851669:"IFCCRANERAILFSHAPEPROFILEDEF",4133800736:"IFCCRANERAILASHAPEPROFILEDEF",2485617015:"IFCCOMPOSITECURVESEGMENT",2205249479:"IFCCLOSEDSHELL",1383045692:"IFCCIRCLEPROFILEDEF",1416205885:"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM",3331915920:"IFCCARTESIANTRANSFORMATIONOPERATOR3D",3486308946:"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM",3749851601:"IFCCARTESIANTRANSFORMATIONOPERATOR2D",59481748:"IFCCARTESIANTRANSFORMATIONOPERATOR",1123145078:"IFCCARTESIANPOINT",2898889636:"IFCCSHAPEPROFILEDEF",2713105998:"IFCBOXEDHALFSPACE",2581212453:"IFCBOUNDINGBOX",4182860854:"IFCBOUNDEDSURFACE",2736907675:"IFCBOOLEANRESULT",2740243338:"IFCAXIS2PLACEMENT3D",3125803723:"IFCAXIS2PLACEMENT2D",4261334040:"IFCAXIS1PLACEMENT",1302238472:"IFCANNOTATIONSURFACE",2265737646:"IFCANNOTATIONFILLAREAOCCURRENCE",669184980:"IFCANNOTATIONFILLAREA",3288037868:"IFCANNOTATIONCURVEOCCURRENCE",2543172580:"IFCZSHAPEPROFILEDEF",1299126871:"IFCWINDOWSTYLE",512836454:"IFCWINDOWPANELPROPERTIES",336235671:"IFCWINDOWLININGPROPERTIES",2759199220:"IFCVERTEXLOOP",1417489154:"IFCVECTOR",427810014:"IFCUSHAPEPROFILEDEF",2347495698:"IFCTYPEPRODUCT",1628702193:"IFCTYPEOBJECT",1345879162:"IFCTWODIRECTIONREPEATFACTOR",2715220739:"IFCTRAPEZIUMPROFILEDEF",3124975700:"IFCTEXTLITERALWITHEXTENT",4282788508:"IFCTEXTLITERAL",3028897424:"IFCTERMINATORSYMBOL",3071757647:"IFCTSHAPEPROFILEDEF",230924584:"IFCSWEPTSURFACE",1260650574:"IFCSWEPTDISKSOLID",2247615214:"IFCSWEPTAREASOLID",1878645084:"IFCSURFACESTYLERENDERING",2513912981:"IFCSURFACE",2233826070:"IFCSUBEDGE",3653947884:"IFCSTRUCTURALSTEELPROFILEPROPERTIES",3843319758:"IFCSTRUCTURALPROFILEPROPERTIES",1190533807:"IFCSTRUCTURALLOADSINGLEFORCEWARPING",1597423693:"IFCSTRUCTURALLOADSINGLEFORCE",1973038258:"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION",2473145415:"IFCSTRUCTURALLOADSINGLEDISPLACEMENT",2668620305:"IFCSTRUCTURALLOADPLANARFORCE",1595516126:"IFCSTRUCTURALLOADLINEARFORCE",390701378:"IFCSPACETHERMALLOADPROPERTIES",1202362311:"IFCSOUNDVALUE",2485662743:"IFCSOUNDPROPERTIES",723233188:"IFCSOLIDMODEL",2609359061:"IFCSLIPPAGECONNECTIONCONDITION",4124623270:"IFCSHELLBASEDSURFACEMODEL",2411513650:"IFCSERVICELIFEFACTOR",1509187699:"IFCSECTIONEDSPINE",2778083089:"IFCROUNDEDRECTANGLEPROFILEDEF",478536968:"IFCRELATIONSHIP",3765753017:"IFCREINFORCEMENTDEFINITIONPROPERTIES",3413951693:"IFCREGULARTIMESERIES",3615266464:"IFCRECTANGLEPROFILEDEF",110355661:"IFCPROPERTYTABLEVALUE",3650150729:"IFCPROPERTYSINGLEVALUE",3357820518:"IFCPROPERTYSETDEFINITION",941946838:"IFCPROPERTYREFERENCEVALUE",2752243245:"IFCPROPERTYLISTVALUE",4166981789:"IFCPROPERTYENUMERATEDVALUE",1680319473:"IFCPROPERTYDEFINITION",871118103:"IFCPROPERTYBOUNDEDVALUE",673634403:"IFCPRODUCTDEFINITIONSHAPE",179317114:"IFCPREDEFINEDPOINTMARKERSYMBOL",433424934:"IFCPREDEFINEDDIMENSIONSYMBOL",2559016684:"IFCPREDEFINEDCURVEFONT",759155922:"IFCPREDEFINEDCOLOUR",2775532180:"IFCPOLYGONALBOUNDEDHALFSPACE",2924175390:"IFCPOLYLOOP",1423911732:"IFCPOINTONSURFACE",4022376103:"IFCPOINTONCURVE",2067069095:"IFCPOINT",1663979128:"IFCPLANAREXTENT",2004835150:"IFCPLACEMENT",597895409:"IFCPIXELTEXTURE",3021840470:"IFCPHYSICALCOMPLEXQUANTITY",2519244187:"IFCPATH",2529465313:"IFCPARAMETERIZEDPROFILEDEF",1029017970:"IFCORIENTEDEDGE",2665983363:"IFCOPENSHELL",2833995503:"IFCONEDIRECTIONREPEATFACTOR",219451334:"IFCOBJECTDEFINITION",1430189142:"IFCMECHANICALCONCRETEMATERIALPROPERTIES",2022407955:"IFCMATERIALDEFINITIONREPRESENTATION",2347385850:"IFCMAPPEDITEM",1008929658:"IFCLOOP",2624227202:"IFCLOCALPLACEMENT",3422422726:"IFCLIGHTSOURCESPOT",1520743889:"IFCLIGHTSOURCEPOSITIONAL",4266656042:"IFCLIGHTSOURCEGONIOMETRIC",2604431987:"IFCLIGHTSOURCEDIRECTIONAL",125510826:"IFCLIGHTSOURCEAMBIENT",1402838566:"IFCLIGHTSOURCE",3741457305:"IFCIRREGULARTIMESERIES",3905492369:"IFCIMAGETEXTURE",2445078500:"IFCHYGROSCOPICMATERIALPROPERTIES",812098782:"IFCHALFSPACESOLID",178086475:"IFCGRIDPLACEMENT",3590301190:"IFCGEOMETRICSET",4142052618:"IFCGEOMETRICREPRESENTATIONSUBCONTEXT",2453401579:"IFCGEOMETRICREPRESENTATIONITEM",3448662350:"IFCGEOMETRICREPRESENTATIONCONTEXT",1446786286:"IFCGENERALPROFILEPROPERTIES",803998398:"IFCGENERALMATERIALPROPERTIES",3857492461:"IFCFUELPROPERTIES",738692330:"IFCFILLAREASTYLE",4219587988:"IFCFAILURECONNECTIONCONDITION",3008276851:"IFCFACESURFACE",803316827:"IFCFACEOUTERBOUND",1809719519:"IFCFACEBOUND",2556980723:"IFCFACE",1860660968:"IFCEXTENDEDMATERIALPROPERTIES",476780140:"IFCEDGECURVE",3900360178:"IFCEDGE",4170525392:"IFCDRAUGHTINGPREDEFINEDTEXTFONT",3732053477:"IFCDOCUMENTREFERENCE",1694125774:"IFCDIMENSIONPAIR",2273265877:"IFCDIMENSIONCALLOUTRELATIONSHIP",3632507154:"IFCDERIVEDPROFILEDEF",3800577675:"IFCCURVESTYLE",2889183280:"IFCCONVERSIONBASEDUNIT",3050246964:"IFCCONTEXTDEPENDENTUNIT",45288368:"IFCCONNECTIONPOINTECCENTRICITY",1981873012:"IFCCONNECTIONCURVEGEOMETRY",370225590:"IFCCONNECTEDFACESET",1485152156:"IFCCOMPOSITEPROFILEDEF",2542286263:"IFCCOMPLEXPROPERTY",776857604:"IFCCOLOURRGB",647927063:"IFCCLASSIFICATIONREFERENCE",3150382593:"IFCCENTERLINEPROFILEDEF",616511568:"IFCBLOBTEXTURE",2705031697:"IFCARBITRARYPROFILEDEFWITHVOIDS",1310608509:"IFCARBITRARYOPENPROFILEDEF",3798115385:"IFCARBITRARYCLOSEDPROFILEDEF",2297822566:"IFCANNOTATIONTEXTOCCURRENCE",3612888222:"IFCANNOTATIONSYMBOLOCCURRENCE",962685235:"IFCANNOTATIONSURFACEOCCURRENCE",2442683028:"IFCANNOTATIONOCCURRENCE",1065908215:"IFCWATERPROPERTIES",891718957:"IFCVIRTUALGRIDINTERSECTION",1907098498:"IFCVERTEXPOINT",3304826586:"IFCVERTEXBASEDTEXTUREMAP",2799835756:"IFCVERTEX",180925521:"IFCUNITASSIGNMENT",1735638870:"IFCTOPOLOGYREPRESENTATION",1377556343:"IFCTOPOLOGICALREPRESENTATIONITEM",581633288:"IFCTIMESERIESVALUE",1718945513:"IFCTIMESERIESREFERENCERELATIONSHIP",3101149627:"IFCTIMESERIES",3317419933:"IFCTHERMALMATERIALPROPERTIES",1210645708:"IFCTEXTUREVERTEX",2552916305:"IFCTEXTUREMAP",1742049831:"IFCTEXTURECOORDINATEGENERATOR",280115917:"IFCTEXTURECOORDINATE",1484833681:"IFCTEXTSTYLEWITHBOXCHARACTERISTICS",1640371178:"IFCTEXTSTYLETEXTMODEL",2636378356:"IFCTEXTSTYLEFORDEFINEDFONT",1983826977:"IFCTEXTSTYLEFONTMODEL",1447204868:"IFCTEXTSTYLE",912023232:"IFCTELECOMADDRESS",531007025:"IFCTABLEROW",985171141:"IFCTABLE",1290481447:"IFCSYMBOLSTYLE",626085974:"IFCSURFACETEXTURE",1351298697:"IFCSURFACESTYLEWITHTEXTURES",846575682:"IFCSURFACESTYLESHADING",1607154358:"IFCSURFACESTYLEREFRACTION",3303107099:"IFCSURFACESTYLELIGHTING",1300840506:"IFCSURFACESTYLE",3049322572:"IFCSTYLEDREPRESENTATION",3958052878:"IFCSTYLEDITEM",2830218821:"IFCSTYLEMODEL",3408363356:"IFCSTRUCTURALLOADTEMPERATURE",2525727697:"IFCSTRUCTURALLOADSTATIC",2162789131:"IFCSTRUCTURALLOAD",2273995522:"IFCSTRUCTURALCONNECTIONCONDITION",3692461612:"IFCSIMPLEPROPERTY",4240577450:"IFCSHAPEREPRESENTATION",3982875396:"IFCSHAPEMODEL",867548509:"IFCSHAPEASPECT",4165799628:"IFCSECTIONREINFORCEMENTPROPERTIES",2042790032:"IFCSECTIONPROPERTIES",448429030:"IFCSIUNIT",2341007311:"IFCROOT",3679540991:"IFCRIBPLATEPROFILEPROPERTIES",1660063152:"IFCREPRESENTATIONMAP",3008791417:"IFCREPRESENTATIONITEM",3377609919:"IFCREPRESENTATIONCONTEXT",1076942058:"IFCREPRESENTATION",1222501353:"IFCRELAXATION",1580146022:"IFCREINFORCEMENTBARPROPERTIES",2692823254:"IFCREFERENCESVALUEDOCUMENT",825690147:"IFCQUANTITYWEIGHT",2405470396:"IFCQUANTITYVOLUME",3252649465:"IFCQUANTITYTIME",931644368:"IFCQUANTITYLENGTH",2093928680:"IFCQUANTITYCOUNT",2044713172:"IFCQUANTITYAREA",3710013099:"IFCPROPERTYENUMERATION",148025276:"IFCPROPERTYDEPENDENCYRELATIONSHIP",3896028662:"IFCPROPERTYCONSTRAINTRELATIONSHIP",2598011224:"IFCPROPERTY",2802850158:"IFCPROFILEPROPERTIES",3958567839:"IFCPROFILEDEF",2267347899:"IFCPRODUCTSOFCOMBUSTIONPROPERTIES",2095639259:"IFCPRODUCTREPRESENTATION",2417041796:"IFCPRESENTATIONSTYLEASSIGNMENT",3119450353:"IFCPRESENTATIONSTYLE",1304840413:"IFCPRESENTATIONLAYERWITHSTYLE",2022622350:"IFCPRESENTATIONLAYERASSIGNMENT",1775413392:"IFCPREDEFINEDTEXTFONT",3213052703:"IFCPREDEFINEDTERMINATORSYMBOL",990879717:"IFCPREDEFINEDSYMBOL",3727388367:"IFCPREDEFINEDITEM",3355820592:"IFCPOSTALADDRESS",2226359599:"IFCPHYSICALSIMPLEQUANTITY",2483315170:"IFCPHYSICALQUANTITY",101040310:"IFCPERSONANDORGANIZATION",2077209135:"IFCPERSON",1207048766:"IFCOWNERHISTORY",1411181986:"IFCORGANIZATIONRELATIONSHIP",4251960020:"IFCORGANIZATION",1227763645:"IFCOPTICALMATERIALPROPERTIES",2251480897:"IFCOBJECTIVE",3701648758:"IFCOBJECTPLACEMENT",1918398963:"IFCNAMEDUNIT",2706619895:"IFCMONETARYUNIT",3368373690:"IFCMETRIC",677618848:"IFCMECHANICALSTEELMATERIALPROPERTIES",4256014907:"IFCMECHANICALMATERIALPROPERTIES",2597039031:"IFCMEASUREWITHUNIT",3265635763:"IFCMATERIALPROPERTIES",2199411900:"IFCMATERIALLIST",1303795690:"IFCMATERIALLAYERSETUSAGE",3303938423:"IFCMATERIALLAYERSET",248100487:"IFCMATERIALLAYER",1847130766:"IFCMATERIALCLASSIFICATIONRELATIONSHIP",1838606355:"IFCMATERIAL",30780891:"IFCLOCALTIME",1566485204:"IFCLIGHTINTENSITYDISTRIBUTION",4162380809:"IFCLIGHTDISTRIBUTIONDATA",3452421091:"IFCLIBRARYREFERENCE",2655187982:"IFCLIBRARYINFORMATION",3020489413:"IFCIRREGULARTIMESERIESVALUE",852622518:"IFCGRIDAXIS",3548104201:"IFCEXTERNALLYDEFINEDTEXTFONT",3207319532:"IFCEXTERNALLYDEFINEDSYMBOL",1040185647:"IFCEXTERNALLYDEFINEDSURFACESTYLE",2242383968:"IFCEXTERNALLYDEFINEDHATCHSTYLE",3200245327:"IFCEXTERNALREFERENCE",1648886627:"IFCENVIRONMENTALIMPACTVALUE",3796139169:"IFCDRAUGHTINGCALLOUTRELATIONSHIP",770865208:"IFCDOCUMENTINFORMATIONRELATIONSHIP",1154170062:"IFCDOCUMENTINFORMATION",1376555844:"IFCDOCUMENTELECTRONICFORMAT",2949456006:"IFCDIMENSIONALEXPONENTS",1045800335:"IFCDERIVEDUNITELEMENT",1765591967:"IFCDERIVEDUNIT",1072939445:"IFCDATEANDTIME",3510044353:"IFCCURVESTYLEFONTPATTERN",2367409068:"IFCCURVESTYLEFONTANDSCALING",1105321065:"IFCCURVESTYLEFONT",539742890:"IFCCURRENCYRELATIONSHIP",602808272:"IFCCOSTVALUE",1065062679:"IFCCOORDINATEDUNIVERSALTIMEOFFSET",347226245:"IFCCONSTRAINTRELATIONSHIP",613356794:"IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP",1658513725:"IFCCONSTRAINTAGGREGATIONRELATIONSHIP",1959218052:"IFCCONSTRAINT",2732653382:"IFCCONNECTIONSURFACEGEOMETRY",4257277454:"IFCCONNECTIONPORTGEOMETRY",2614616156:"IFCCONNECTIONPOINTGEOMETRY",2859738748:"IFCCONNECTIONGEOMETRY",3264961684:"IFCCOLOURSPECIFICATION",3639012971:"IFCCLASSIFICATIONNOTATIONFACET",938368621:"IFCCLASSIFICATIONNOTATION",1098599126:"IFCCLASSIFICATIONITEMRELATIONSHIP",1767535486:"IFCCLASSIFICATIONITEM",747523909:"IFCCLASSIFICATION",622194075:"IFCCALENDARDATE",2069777674:"IFCBOUNDARYNODECONDITIONWARPING",1387855156:"IFCBOUNDARYNODECONDITION",3367102660:"IFCBOUNDARYFACECONDITION",1560379544:"IFCBOUNDARYEDGECONDITION",4037036970:"IFCBOUNDARYCONDITION",3869604511:"IFCAPPROVALRELATIONSHIP",390851274:"IFCAPPROVALPROPERTYRELATIONSHIP",2080292479:"IFCAPPROVALACTORRELATIONSHIP",130549933:"IFCAPPROVAL",1110488051:"IFCAPPLIEDVALUERELATIONSHIP",411424972:"IFCAPPLIEDVALUE",639542469:"IFCAPPLICATION",618182010:"IFCADDRESS",3630933823:"IFCACTORROLE",599546466:"FILE_DESCRIPTION",1390159747:"FILE_NAME",1109904537:"FILE_SCHEMA"};let Dn=class am{static async getUnits(e){var t;const{IFCUNITASSIGNMENT:i}=ii,n=await e.getAllPropertiesOfType(i);if(!n)return 1;const r=Object.keys(n),o=n[parseInt(r[0],10)];for(const a of o.Units){if(a.value===void 0||a.value===null)continue;const l=await e.getProperties(a.value);if(!l||!l.UnitType||!l.UnitType.value||l.UnitType.value!=="LENGTHUNIT")continue;let h=1,d=1;return l.Name.value==="METRE"&&(d=1),l.Name.value==="FOOT"&&(d=.3048),((t=l.Prefix)==null?void 0:t.value)==="MILLI"&&(h=.001),d*h}return 1}static async findItemByGuid(e,t){var i;const n=e.getAllPropertiesIDs();for(const r of n){const o=await e.getProperties(r);if(o&&((i=o.GlobalId)==null?void 0:i.value)===t)return o}return null}static async getRelationMap(e,t,i){var n;const r=i??(()=>{}),o={},a=e.getAllPropertiesIDs();for(const l of a){const h=await e.getProperties(l);if(!h)continue;const d=h.type===t,p=Object.keys(h).find(w=>w.startsWith("Relating")),f=Object.keys(h).find(w=>w.startsWith("Related"));if(!(d&&p&&f))continue;const g=await e.getProperties((n=h[p])==null?void 0:n.value),v=h[f];if(!g||!v||!(v&&Array.isArray(v)))continue;const b=v.map(w=>w.value);r(g.expressID,b),o[g.expressID]=b}return o}static async getQsetQuantities(e,t,i){const n=i??(()=>{}),r=await e.getProperties(t);return!r||r.type!==qh?null:(r.Quantities??[{}]).map(o=>(o.value&&n(o.value),o.value)).filter(o=>o!==null)}static async getPsetProps(e,t,i){const n=i??(()=>{}),r=await e.getProperties(t);return!r||r.type!==zr?null:(r.HasProperties??[{}]).map(o=>(o.value&&n(o.value),o.value)).filter(o=>o!==null)}static async getPsetRel(e,t){var i;if(!await e.getProperties(t))return null;const n=await e.getAllPropertiesOfType(cl);if(!n)return null;const r=Object.values(n);let o=null;for(const a of r)((i=a.RelatingPropertyDefinition)==null?void 0:i.value)===t&&(o=a.expressID);return o}static async getQsetRel(e,t){return am.getPsetRel(e,t)}static async getEntityName(e,t){var i;const n=await e.getProperties(t);if(!n)return{key:null,name:null};const r=Object.keys(n).find(a=>a.endsWith("Name"))??null,o=r?(i=n[r])==null?void 0:i.value:null;return{key:r,name:o}}static async getQuantityValue(e,t){const i=await e.getProperties(t);if(!i)return{key:null,value:null};const n=Object.keys(i).find(o=>o.endsWith("Value"))??null;let r;return n===null||i[n]===void 0||i[n]===null?r=null:r=i[n].value,{key:n,value:r}}static isRel(e){return om[e].startsWith("IFCREL")}static async attributeExists(e,t,i){const n=await e.getProperties(t);return n?Object.keys(n).includes(i):!1}static async groupEntitiesByType(e,t){var i;const n=new Map;for(const r of t){const o=await e.getProperties(r);if(!o)continue;const a=o.type;n.get(a)||n.set(a,new Set),(i=n.get(a))==null||i.add(r)}return n}};const rE=new Map([[Gh,{forRelating:"IsDecomposedBy",forRelated:"Decomposes"}],[jh,{forRelating:"AssociatedTo",forRelated:"HasAssociations"}],[Wh,{forRelating:"ClassificationForObjects",forRelated:"HasAssociations"}],[Xh,{forRelating:"IsGroupedBy",forRelated:"HasAssignments"}],[cl,{forRelated:"IsDefinedBy",forRelating:"DefinesOcurrence"}],[Kh,{forRelated:"IsTypedBy",forRelating:"Types"}],[bf,{forRelated:"IsDefinedBy",forRelating:"Defines"}],[hl,{forRelated:"ContainedInStructure",forRelating:"ContainsElements"}]]),lm=class uh extends Re{constructor(e){super(e),A(this,"onDisposed",new ee),A(this,"enabled",!0),A(this,"onRelationsIndexed",new ee),A(this,"_relToAttributesMap",rE),A(this,"_inverseAttributes",["IsDecomposedBy","Decomposes","AssociatedTo","HasAssociations","ClassificationForObjects","IsGroupedBy","HasAssignments","IsDefinedBy","DefinesOcurrence","IsTypedBy","Types","Defines","ContainedInStructure","ContainsElements"]),A(this,"_ifcRels",[Gh,jh,Wh,Xh,cl,Kh,bf,hl]),A(this,"relationMaps",{}),A(this,"onFragmentsDisposed",t=>{delete this.relationMaps[t.groupID]}),this.components.add(uh.uuid,this),e.get(rt).onFragmentsDisposed.add(this.onFragmentsDisposed)}setRelationMap(e,t){this.relationMaps[e.uuid]=t,this.onRelationsIndexed.trigger({modelID:e.uuid,relationsMap:t})}async process(e){if(!e.hasProperties)throw new Error("FragmentsGroup properties not found");let t=this.relationMaps[e.uuid];if(t)return t;t=new Map;for(const i of this._ifcRels)await Dn.getRelationMap(e,i,async(n,r)=>{const o=this._relToAttributesMap.get(i);if(!o)return;const{forRelated:a,forRelating:l}=o,h=t.get(n)??new Map,d=this._inverseAttributes.indexOf(l);h.set(d,r),t.set(n,h);for(const p of r){const f=t.get(p)??new Map,g=this._inverseAttributes.indexOf(a),v=f.get(g)??[];v.push(n),f.set(g,v),t.set(p,f)}});return this.setRelationMap(e,t),t}async processFromWebIfc(e,t){const i=new Map;for(const n of this._ifcRels){const r=this._relToAttributesMap.get(n);if(!r)continue;const{forRelated:o,forRelating:a}=r,l=e.GetLineIDsWithType(t,n);for(let h=0;h<l.size();h++){const d=await e.properties.getItemProperties(t,l.get(h)),p=Object.keys(d).find(T=>T.startsWith("Relating")),f=Object.keys(d).find(T=>T.startsWith("Related"));if(!(p&&f))continue;const g=d[p].value,v=d[f].map(T=>T.value),b=i.get(g)??new Map,w=this._inverseAttributes.indexOf(a);b.set(w,v),i.set(g,b);for(const T of v){const S=i.get(T)??new Map,_=this._inverseAttributes.indexOf(o),I=S.get(_)??[];I.push(g),S.set(_,I),i.set(T,S)}}}return this.onRelationsIndexed.trigger({modelID:t.toString(),relationsMap:i}),i}getEntityRelations(e,t,i){const n=this.relationMaps[e.uuid];if(!n)return null;const r=n.get(t),o=this._inverseAttributes.indexOf(i);return!r||o===-1?null:r.get(o)||null}serializeRelations(e){const t={};for(const[i,n]of e.entries()){t[i]||(t[i]={});for(const[r,o]of n.entries())t[i][r]=o}return JSON.stringify(t)}serializeModelRelations(e){const t=this.relationMaps[e.uuid];return t?this.serializeRelations(t):null}serializeAllRelations(){const e={};for(const t in this.relationMaps){const i=this.relationMaps[t],n={};for(const[r,o]of i.entries()){n[r]||(n[r]={});for(const[a,l]of o.entries())n[r][a]=l}e[t]=n}return JSON.stringify(e)}getRelationsMapFromJSON(e){const t=JSON.parse(e),i=new Map;for(const n in t){const r=t[n],o=new Map;for(const a in r)o.set(Number(a),r[a]);i.set(Number(n),o)}return i}dispose(){this.relationMaps={},this.components.get(rt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(uh.uuid),this.onDisposed.reset()}};A(lm,"uuid","23a889ab-83b3-44a4-8bee-ead83438370b");let su=lm;class oE{constructor(){A(this,"factor",1),A(this,"complement",1)}apply(e){const t=this.getScaleMatrix().multiply(e);e.copy(t)}setUp(e){var t;this.factor=1;const i=this.getLengthUnits(e);if(!i)return;const n=i==null,r=i.Name===void 0||i.Name===null;n||r||(i.Name.value==="FOOT"?this.factor=.3048:((t=i.Prefix)==null?void 0:t.value)==="MILLI"&&(this.complement=.001))}getLengthUnits(e){try{const t=e.GetLineIDsWithType(0,Dv).get(0),i=e.GetLine(0,t);for(const n of i.Units){if(!n||n.value===null||n.value===void 0)continue;const r=e.GetLine(0,n.value);if(r.UnitType&&r.UnitType.value==="LENGTHUNIT")return r}return null}catch{return console.log("Could not get units"),null}}getScaleMatrix(){const e=this.factor;return new Ee().fromArray([e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1])}}let cm=class{constructor(){A(this,"itemsByFloor",{}),A(this,"_units",new oE)}setUp(e){this._units.setUp(e),this.cleanUp();try{const t=e.GetLineIDsWithType(0,hl),i=new Set,n=e.GetLineIDsWithType(0,Wn);for(let h=0;h<n.size();h++)i.add(n.get(h));const r=e.GetLineIDsWithType(0,Gh),o=r.size();for(let h=0;h<o;h++){const d=r.get(h),p=e.GetLine(0,d);if(!p||!p.RelatingObject||!p.RelatedObjects)continue;const f=p.RelatingObject.value,g=p.RelatedObjects;for(const v of g){const b=v.value;i.has(b)&&(this.itemsByFloor[b]=f)}}const a={},l=t.size();for(let h=0;h<l;h++){const d=t.get(h),p=e.GetLine(0,d);if(!p||!p.RelatingStructure||!p.RelatedElements)continue;const f=p.RelatingStructure.value,g=p.RelatedElements;if(i.has(f))for(const v of g){a[f]||(a[f]=[]);const b=v.value;a[f].push(b)}else for(const v of g){const b=v.value;this.itemsByFloor[b]=f}}for(const h in a){const d=this.itemsByFloor[h];if(d!==void 0){const p=a[h];for(const f of p)this.itemsByFloor[f]=d}}for(let h=0;h<o;h++){const d=r.get(h),p=e.GetLine(0,d);if(!p||!p.RelatingObject||!p.RelatedObjects)continue;const f=p.RelatingObject.value,g=p.RelatedObjects;for(const v of g){const b=v.value,w=this.itemsByFloor[f];w!==void 0&&(this.itemsByFloor[b]=w)}}}catch{console.log("Could not get floors.")}}cleanUp(){this.itemsByFloor={}}},ru=class{constructor(){A(this,"includeProperties",!0),A(this,"optionalCategories",[Wn]),A(this,"coordinate",!0),A(this,"wasm",{path:"",absolute:!1,logLevel:xv.LOG_LEVEL_OFF}),A(this,"excludedCategories",new Set),A(this,"saveLocations",!1),A(this,"webIfc",{COORDINATE_TO_ORIGIN:!0,OPTIMIZE_PROFILES:!0}),A(this,"autoSetWasm",!0),A(this,"customLocateFileHandler",null)}},hm=class{constructor(){A(this,"defLineMat",new Di({color:16777215}))}read(e){const t=e.GetAllAlignments(0),i=e.GetAllCrossSections2D(0),n=e.GetAllCrossSections3D(0),r={IfcAlignment:t,IfcCrossSection2D:i,IfcCrossSection3D:n};return this.get(r)}get(e){if(e.IfcAlignment){const t=new Map;for(const i of e.IfcAlignment){const n=new Av;n.absolute=this.getCurves(i.curve3D,n),n.horizontal=this.getCurves(i.horizontal,n),n.vertical=this.getCurves(i.vertical,n),t.set(t.size,n)}return{alignments:t,coordinationMatrix:new Ee}}}getCurves(e,t){const i=[];let n=0;for(const r of e){const o={};if(r.data)for(const f of r.data){const[g,v]=f.split(": "),b=parseFloat(v);o[g]=b||v}const{points:a}=r,l=new Float32Array(a.length*3);for(let f=0;f<a.length;f++){const{x:g,y:v,z:b}=a[f];l[f*3]=g,l[f*3+1]=v,l[f*3+2]=b||0}const h=new gt(l,3),d=new Sv;d.setAttribute("position",h);const p=new _v(n,o,t,d,this.defLineMat);i.push(p.curve),n++}return i}},um=class{get(e,t){let i="";const n=e.GetHeaderLine(0,t)||"";if(!n)return i;for(const r of n.arguments)if(r!=null)if(Array.isArray(r))for(const o of r)i+=`${o.value}|`;else i+=`${r.value}|`;return i}};const dm=class dh extends Re{constructor(e){super(e),A(this,"onIfcStartedLoading",new ee),A(this,"onSetup",new ee),A(this,"onDisposed",new ee),A(this,"settings",new ru),A(this,"enabled",!0),A(this,"webIfc",new tn),A(this,"_material",new za),A(this,"_spatialTree",new cm),A(this,"_metaData",new um),A(this,"_fragmentInstances",new Map),A(this,"_civil",new hm),A(this,"_visitedFragments",new Map),A(this,"_materialT",new za({transparent:!0,opacity:.5})),this.components.add(dh.uuid,this),this.settings.excludedCategories.add(wf)}dispose(){this.webIfc=null,this.onDisposed.trigger(dh.uuid),this.onDisposed.reset()}async setup(e){this.settings={...this.settings,...e},this.settings.autoSetWasm&&await this.autoSetWasm(),this.onSetup.trigger()}async load(e,t=!0){const i=performance.now();this.onIfcStartedLoading.trigger(),await this.readIfcFile(e);const n=await this.getAllGeometries(),r=await this.components.get(sE).export(this.webIfc,0);n.setLocalProperties(r),this.cleanUp();const o=this.components.get(rt);o.groups.set(n.uuid,n);for(const a of n.items)o.list.set(a.id,a),a.mesh.uuid=a.id,a.group=n;return o.onFragmentsLoaded.trigger(n),t&&o.coordinate([n]),console.log(`Streaming the IFC took ${performance.now()-i} ms!`),n}async readIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;return this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModel(e,this.settings.webIfc)}async getAllGeometries(){this._spatialTree.setUp(this.webIfc);const e=this.webIfc.GetIfcEntityList(0),t=new If,{FILE_NAME:i,FILE_DESCRIPTION:n}=ii;t.ifcMetadata={name:this._metaData.get(this.webIfc,i),description:this._metaData.get(this.webIfc,n),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};const r=[];for(const a of e){if(!this.webIfc.IsIfcElement(a)&&a!==Wn||this.settings.excludedCategories.has(a))continue;const l=this.webIfc.GetLineIDsWithType(0,a),h=l.size();for(let d=0;d<h;d++){const p=l.get(d);r.push(p);const f=this._spatialTree.itemsByFloor[p]||0;t.data.set(p,[[],[f,a]])}}this._spatialTree.cleanUp(),this.webIfc.StreamMeshes(0,r,a=>{this.getMesh(a,t)});for(const a of this._visitedFragments){const{index:l,fragment:h}=a[1];t.keyFragments.set(l,h.id)}for(const a of t.items){const l=this._fragmentInstances.get(a.id);if(!l)throw new Error("Fragment not found!");const h=[];for(const[d,p]of l)h.push(p);a.add(h)}const o=this.webIfc.GetCoordinationMatrix(0);return t.coordinationMatrix.fromArray(o),t.civilData=this._civil.read(this.webIfc),t}cleanUp(){this.webIfc=null,this.webIfc=new tn,this._visitedFragments.clear(),this._fragmentInstances.clear()}getMesh(e,t){const i=e.geometries.size(),n=e.expressID;for(let r=0;r<i;r++){const o=e.geometries.get(r),{x:a,y:l,z:h,w:d}=o.color,p=d!==1,{geometryExpressID:f}=o,g=`${f}-${p}`;if(!this._visitedFragments.has(g)){const I=this.getGeometry(this.webIfc,f),P=p?this._materialT:this._material,M=new Va(I,P,1);t.add(M.mesh),t.items.push(M);const k=this._visitedFragments.size;this._visitedFragments.set(g,{index:k,fragment:M})}const v=new Rt().setRGB(a,l,h,"srgb"),b=new Ee;b.fromArray(o.flatTransformation);const w=this._visitedFragments.get(g);if(w===void 0)throw new Error("Error getting geometry data for streaming!");const T=t.data.get(n);if(!T)throw new Error("Data not found!");T[0].push(w.index);const{fragment:S}=w;this._fragmentInstances.has(S.id)||this._fragmentInstances.set(S.id,new Map);const _=this._fragmentInstances.get(S.id);if(!_)throw new Error("Instances not found!");if(_.has(n)){const I=_.get(n);if(!I)throw new Error("Instance not found!");I.transforms.push(b),I.colors&&I.colors.push(v)}else _.set(n,{id:n,transforms:[b],colors:[v]})}}getGeometry(e,t){const i=e.GetGeometry(0,t),n=e.GetIndexArray(i.GetIndexData(),i.GetIndexDataSize()),r=e.GetVertexArray(i.GetVertexData(),i.GetVertexDataSize()),o=new Float32Array(r.length/2),a=new Float32Array(r.length/2);for(let p=0;p<r.length;p+=6)o[p/2]=r[p],o[p/2+1]=r[p+1],o[p/2+2]=r[p+2],a[p/2]=r[p+3],a[p/2+1]=r[p+4],a[p/2+2]=r[p+5];const l=new Ne,h=new gt(o,3),d=new gt(a,3);return l.setAttribute("position",h),l.setAttribute("normal",d),l.setIndex(Array.from(n)),i.delete(),l}async autoSetWasm(){const e=await fetch(`https://unpkg.com/openbim-components@${A1.release}/package.json`);if(!e.ok){console.warn("Couldn't get openbim-components package.json. Set wasm settings manually.");return}const t=await e.json();if(!("web-ifc"in t.peerDependencies))console.warn("Couldn't get web-ifc from peer dependencies in openbim-components. Set wasm settings manually.");else{const i=t.peerDependencies["web-ifc"];this.settings.wasm.path=`https://unpkg.com/web-ifc@${i}/`,this.settings.wasm.absolute=!0}}};A(dm,"uuid","a659add7-1418-4771-a0d6-7d4d438e4624");let aE=dm;const lE=class ws extends Re{constructor(e){super(e),A(this,"onDisposed",new ee),A(this,"onRequestFile",new ee),A(this,"ifcToExport",null),A(this,"onElementToPset",new ee),A(this,"onPropToPset",new ee),A(this,"onPsetRemoved",new ee),A(this,"onDataChanged",new ee),A(this,"wasm",{path:"/",absolute:!1}),A(this,"enabled",!0),A(this,"attributeListeners",{}),A(this,"selectedModel"),A(this,"changeMap",{}),this.components.add(ws.uuid,this)}dispose(){this.selectedModel=void 0,this.attributeListeners={},this.changeMap={},this.onElementToPset.reset(),this.onPropToPset.reset(),this.onPsetRemoved.reset(),this.onDataChanged.reset(),this.onDisposed.trigger(ws.uuid),this.onDisposed.reset()}increaseMaxID(e){return e.ifcMetadata.maxExpressID++,e.ifcMetadata.maxExpressID}static getIFCSchema(e){const t=e.ifcMetadata.schema;if(!t)throw new Error("IFC Schema not found");return t}newGUID(e){const t=ws.getIFCSchema(e);return new ii[t].IfcGloballyUniqueId(iu.create())}async getOwnerHistory(e){const t=await e.getAllPropertiesOfType(Tv);if(!t)throw new Error("No OwnerHistory was found.");const i=Object.keys(t).map(o=>parseInt(o,10)),n=t[i[0]],r=new Qo(n.expressID);return{ownerHistory:n,ownerHistoryHandle:r}}registerChange(e,...t){this.changeMap[e.uuid]||(this.changeMap[e.uuid]=new Set);for(const i of t)this.changeMap[e.uuid].add(i),this.onDataChanged.trigger({model:e,expressID:i})}async setData(e,...t){for(const i of t){const n=i.expressID;n&&(await e.setProperties(n,i),this.registerChange(e,n))}}async newPset(e,t,i){const n=ws.getIFCSchema(e),{ownerHistoryHandle:r}=await this.getOwnerHistory(e),o=this.newGUID(e),a=new ii[n].IfcLabel(t),l=i?new ii[n].IfcText(i):null,h=new ii[n].IfcPropertySet(o,r,a,l,[]);h.expressID=this.increaseMaxID(e);const d=this.newGUID(e),p=new ii[n].IfcRelDefinesByProperties(d,r,null,null,[],new Qo(h.expressID));return p.expressID=this.increaseMaxID(e),await this.setData(e,h,p),{pset:h,rel:p}}async removePset(e,...t){for(const i of t){const n=await e.getProperties(i);if((n==null?void 0:n.type)!==zr)continue;const r=await Dn.getPsetRel(e,i);if(r&&(await e.setProperties(r,null),this.registerChange(e,r)),n){for(const o of n.HasProperties)await e.setProperties(o.value,null);await e.setProperties(i,null),this.onPsetRemoved.trigger({model:e,psetID:i}),this.registerChange(e,i)}}}async newSingleProperty(e,t,i,n){const r=ws.getIFCSchema(e),o=new ii[r].IfcIdentifier(i),a=new ii[r][t](n),l=new ii[r].IfcPropertySingleValue(o,null,a,null);return l.expressID=this.increaseMaxID(e),await this.setData(e,l),l}newSingleStringProperty(e,t,i,n){return this.newSingleProperty(e,t,i,n)}newSingleNumericProperty(e,t,i,n){return this.newSingleProperty(e,t,i,n)}newSingleBooleanProperty(e,t,i,n){return this.newSingleProperty(e,t,i,n)}async removePsetProp(e,t,i){const n=await e.getProperties(t),r=await e.getProperties(i);!n||!r||n.type===zr&&r&&(n.HasProperties=n.HasProperties.filter(o=>o.value!==i),await e.setProperties(i,null),this.registerChange(e,t,i))}async addElementToPset(e,t,...i){const n=await Dn.getPsetRel(e,t);if(!n)return;const r=await e.getProperties(n);if(r){for(const o of i){const a=new Qo(o);r.RelatedObjects.push(a),this.onElementToPset.trigger({model:e,psetID:t,elementID:o})}this.registerChange(e,t)}}async addPropToPset(e,t,...i){const n=await e.getProperties(t);if(n){for(const r of i){if(n.HasProperties.includes(r))continue;const o=new Qo(r);n.HasProperties.push(o),this.onPropToPset.trigger({model:e,psetID:t,propID:r})}this.registerChange(e,t)}}async saveToIfc(e,t){const i=this.components.get(aE),n=i.webIfc,r=await i.readIfcFile(t),o=this.changeMap[e.uuid]??[];for(const l of o){const h=await e.getProperties(l);if(h)try{n.WriteLine(r,h)}catch{}else try{n.DeleteLine(r,l)}catch{}}const a=n.SaveModel(r);return i.webIfc.CloseModel(r),i.cleanUp(),a}async setAttributeListener(e,t,i){this.attributeListeners[e.uuid]||(this.attributeListeners[e.uuid]={});const n=this.attributeListeners[e.uuid][t]?this.attributeListeners[e.uuid][t][i]:null;if(n)return n;const r=await e.getProperties(t);if(!r)throw new Error(`Entity with expressID ${t} doesn't exists.`);const o=r[i];if(Array.isArray(o)||!o)throw new Error(`Attribute ${i} is array or null, and it can't have a listener.`);const a=o.value;if(a===void 0||a==null)throw new Error(`Attribute ${i} has a badly defined handle.`);const l=new ee;return Object.defineProperty(r[i],"value",{get(){return this._value},async set(h){this._value=h,l.trigger(h)}}),r[i].value=a,this.attributeListeners[e.uuid][t]||(this.attributeListeners[e.uuid][t]={}),this.attributeListeners[e.uuid][t][i]=l,l}};A(lE,"uuid","58c2d9f0-183c-48d6-a402-dfcf5b9a34df");const pm=class fm extends Re{constructor(e){super(e),A(this,"enabled",!0),A(this,"list",{}),A(this,"onDisposed",new ee),A(this,"onFragmentsDisposed",t=>{const{groupID:i,fragmentIDs:n}=t;for(const r in this.list){const o=this.list[r],a=Object.keys(o);if(a.includes(i))delete o[i],Object.values(o).length===0&&delete this.list[r];else for(const l of a){const h=o[l];for(const d of n)delete h[d];Object.values(h).length===0&&delete o[l]}}}),e.add(fm.uuid,this),e.get(rt).onFragmentsDisposed.add(this.onFragmentsDisposed)}dispose(){this.list={},this.components.get(rt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(),this.onDisposed.reset()}remove(e){for(const t in this.list){const i=this.list[t];for(const n in i){const r=i[n];delete r[e]}}}find(e){const t=this.components.get(rt);if(!e){const o={};for(const[a,l]of t.list)o[a]=new Set(l.ids);return o}const i=Object.keys(e).length,n={};for(const o in e){const a=e[o];if(!this.list[o]){console.warn(`Classification ${o} does not exist.`);continue}for(const l of a){const h=this.list[o][l];if(h)for(const d in h){n[d]||(n[d]=new Map);for(const p of h[d]){const f=n[d].get(p);f===void 0?n[d].set(p,1):n[d].set(p,f+1)}}}}const r={};for(const o in n){const a=n[o];for(const[l,h]of a){if(h===void 0)throw new Error("Malformed fragments map!");h===i&&(r[o]||(r[o]=new Set),r[o].add(l))}}return r}byModel(e,t){this.list.models||(this.list.models={});const i=this.list.models;i[e]||(i[e]={});const n=i[e];for(const[r,o]of t.data){const a=o[0];for(const l of a){const h=t.keyFragments.get(l);h&&(n[h]||(n[h]=new Set),n[h].add(r))}}}async byPredefinedType(e){var t;this.list.predefinedTypes||(this.list.predefinedTypes={});const i=this.list.predefinedTypes,n=e.getAllPropertiesIDs();for(const r of n){const o=await e.getProperties(r);if(!o)continue;const a=String((t=o.PredefinedType)==null?void 0:t.value).toUpperCase();i[a]||(i[a]={});const l=i[a];for(const[h,d]of e.data){const p=d[0];for(const f of p){const g=e.keyFragments.get(f);if(!g)throw new Error("Fragment ID not found!");l[g]||(l[g]=new Set),l[g].add(o.expressID)}}}}byEntity(e){this.list.entities||(this.list.entities={});for(const[t,i]of e.data){const n=i[1][1],r=om[n];this.saveItem(e,"entities",r,t)}}byStorey(e){for(const[t,i]of e.data){const n=i[1][0].toString();this.saveItem(e,"storeys",n,t)}}async byIfcRel(e,t,i){Dn.isRel(t)&&await Dn.getRelationMap(e,t,async(n,r)=>{const{name:o}=await Dn.getEntityName(e,n);for(const a of r)this.saveItem(e,i,o??"NO REL NAME",a)})}setColor(e,t,i=!1){const n=this.components.get(rt);for(const r in e){const o=n.list.get(r);if(!o)continue;const a=e[r];o.setColor(t,a,i)}}resetColor(e){const t=this.components.get(rt);for(const i in e){const n=t.list.get(i);if(!n)continue;const r=e[i];n.resetColor(r)}}saveItem(e,t,i,n){this.list[t]||(this.list[t]={});const r=e.data.get(n);if(r)for(const o of r[0]){const a=e.keyFragments.get(o);if(a){const l=this.list[t];l[i]||(l[i]={}),l[i][a]||(l[i][a]=new Set),l[i][a].add(n)}}}};A(pm,"uuid","e25a7f3c-46c4-4a14-9d3d-5115f24ebeb7");let cE=pm;const hE=class mm extends Re{constructor(e){super(e),A(this,"enabled",!0),A(this,"height",10),A(this,"groupName","storeys"),A(this,"onDisposed",new ee),A(this,"list",new Set),e.add(mm.uuid,this)}dispose(){this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}set(e){if(!this.enabled)return;const t=this.components.get(cE),i=this.components.get(rt),n=e?1:-1;let r=0;const o=t.list[this.groupName],a=new Ee;for(const l in o){a.elements[13]=r*n*this.height;for(const h in o[l]){const d=i.list.get(h),p=l+h,f=this.list.has(p);if(!d||e&&f||!e&&!f)continue;e?this.list.add(p):this.list.delete(p);const g=o[l][h];d.applyTransform(g,a)}r++}}};A(hE,"uuid","d260618b-ce88-4c7d-826c-6debb91de3e2");const uE=class gm extends Re{constructor(e){super(e),A(this,"enabled",!0),this.components.add(gm.uuid,this)}set(e,t){const i=this.components.get(rt);if(!t){for(const n in i.list){const r=i.list.get(n);r&&(r.setVisibility(e),this.updateCulledVisibility(r))}return}for(const n in t){const r=t[n],o=i.list.get(n);o&&(o.setVisibility(e,r),this.updateCulledVisibility(o))}}isolate(e){this.set(!1),this.set(!0,e)}updateCulledVisibility(e){const t=this.components.get(Z1);for(const[i,n]of t.list){const r=n.colorMeshes.get(e.id);r&&(r.count=e.mesh.count)}}};A(uE,"uuid","dd9ccf2d-8a21-4821-b7f6-2949add16a29");class dE extends ru{constructor(){super(...arguments),A(this,"minGeometrySize",10),A(this,"minAssetsSize",1e3)}}let vm=class extends ru{constructor(){super(...arguments),A(this,"propertiesSize",100)}};class pE extends Re{constructor(){super(...arguments),A(this,"onPropertiesStreamed",new $i),A(this,"onProgress",new $i),A(this,"onIndicesStreamed",new $i),A(this,"onDisposed",new ee),A(this,"enabled",!0),A(this,"settings",new vm),A(this,"webIfc",new tn)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(e){const t=performance.now();await this.readIfcFile(e),await this.streamAllProperties(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async streamFromCallBack(e){const t=performance.now();await this.streamIfcFile(e),await this.streamAllProperties(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async readIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModel(e,this.settings.webIfc)}async streamIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModelFromCallback(e,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:e}=this.settings,t=new Set(this.webIfc.GetIfcEntityList(0)),i=[cl,Kh,jh,hl,Wh,Xh],n=new Map,r=new Set([pl,Qh,Zh,dl,Wn]);for(const h of r)t.add(h);let o=.01,a=0;for(const h of t){if(a++,nu.has(h))continue;const d=r.has(h),p=this.webIfc.GetLineIDsWithType(0,h),f=p.size();let g=0;for(let b=0;b<f-e;b+=e){const w={};for(let T=0;T<e;T++){g++;const S=p.get(b+T);try{const _=this.webIfc.GetLine(0,S,d);i.includes(h)&&this.getIndices(_,S,n),w[_.expressID]=_}catch{console.log(`Could not get property: ${S}`)}}await this.onPropertiesStreamed.trigger({type:h,data:w})}if(g!==f){const b={};for(let w=g;w<f;w++){const T=p.get(w);try{const S=this.webIfc.GetLine(0,T,d);i.includes(h)&&this.getIndices(S,T,n),b[S.expressID]=S}catch{console.log(`Could not get property: ${T}`)}}await this.onPropertiesStreamed.trigger({type:h,data:b})}const v=a/t.size;v>o&&(o+=.01,o=Math.max(o,v),await this.onProgress.trigger(Math.round(o*100)/100))}const l=[];for(const[h,d]of n)l.push([h,...d]);await this.onIndicesStreamed.trigger(l)}getIndices(e,t,i){const n=e.RelatedObjects||e.RelatedElements;if(!n){console.log(`Related objects not found: ${t}`);return}const r=e.RelatingType||e.RelatingMaterial||e.RelatingStructure||e.RelatingPropertyDefinition||e.RelatingGroup||e.RelatingClassification;if(!r){console.log(`Relating object not found: ${t}`);return}if(!Array.isArray(n)||r.value===void 0)return;const o=r.value;for(const a of n){if(a.value===void 0||a.value===null)continue;const l=a.value;i.has(l)||i.set(l,new Set),i.get(l).add(o)}}cleanUp(){this.webIfc=null,this.webIfc=new tn}}A(pE,"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");const fE=class ym extends Re{constructor(e){super(e),A(this,"onGeometryStreamed",new ee),A(this,"onAssetStreamed",new ee),A(this,"onProgress",new ee),A(this,"onIfcLoaded",new ee),A(this,"onDisposed",new ee),A(this,"settings",new dE),A(this,"enabled",!0),A(this,"webIfc",new tn),A(this,"_spatialTree",new cm),A(this,"_metaData",new um),A(this,"_visitedGeometries",new Map),A(this,"_streamSerializer",new Cf),A(this,"_geometries",new Map),A(this,"_geometryCount",0),A(this,"_civil",new hm),A(this,"_groupSerializer",new Ef),A(this,"_assets",[]),A(this,"_meshesWithHoles",new Set),this.components.add(ym.uuid,this),this.settings.excludedCategories.add(wf)}dispose(){this.onIfcLoaded.reset(),this.onGeometryStreamed.reset(),this.onAssetStreamed.reset(),this.webIfc=null,this.onDisposed.trigger(),this.onDisposed.reset()}async streamFromBuffer(e){const t=performance.now();await this.readIfcFile(e),await this.streamAllGeometries(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async streamFromCallBack(e){const t=performance.now();await this.streamIfcFile(e),await this.streamAllGeometries(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async readIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModel(e,this.settings.webIfc)}async streamIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModelFromCallback(e,this.settings.webIfc)}async streamAllGeometries(){const{minGeometrySize:e,minAssetsSize:t}=this.settings;this._spatialTree.setUp(this.webIfc);const i=this.webIfc.GetIfcEntityList(0),n=[[]],r=new If,{FILE_NAME:o,FILE_DESCRIPTION:a}=ii;r.ifcMetadata={name:this._metaData.get(this.webIfc,o),description:this._metaData.get(this.webIfc,a),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};let l=0,h=0;for(const T of i){if(!this.webIfc.IsIfcElement(T)&&T!==Wn||this.settings.excludedCategories.has(T))continue;const S=this.webIfc.GetLineIDsWithType(0,T),_=S.size();console.log(_);for(let I=0;I<_;I++){l>e&&(l=0,h++,n.push([]));const P=S.get(I);n[h].push(P);const M=this._spatialTree.itemsByFloor[P]||0;r.data.set(P,[[],[M,T]]),l++}}this._spatialTree.cleanUp();let d=.01,p=0;for(const T of n){p++,this.webIfc.StreamMeshes(0,T,_=>{this.getMesh(this.webIfc,_,r)}),this._geometryCount>e&&await this.streamGeometries(),this._assets.length>t&&await this.streamAssets();const S=p/n.length;S>d&&(d+=.01,d=Math.max(d,S),this.onProgress.trigger(Math.round(d*100)/100))}this._geometryCount&&await this.streamGeometries(),this._assets.length&&await this.streamAssets();const{opaque:f,transparent:g}=r.geometryIDs;for(const[T,{index:S,uuid:_}]of this._visitedGeometries)r.keyFragments.set(S,_),(T>1?f:g).set(T,S);const v=r.data.keys();for(const T of v){const[S]=r.data.get(T);S.length||r.data.delete(T)}const b=this.webIfc.GetCoordinationMatrix(0);r.coordinationMatrix.fromArray(b),r.civilData=this._civil.read(this.webIfc);const w=this._groupSerializer.export(r);this.onIfcLoaded.trigger(w),r.dispose(!0)}cleanUp(){this.webIfc=null,this.webIfc=new tn,this._visitedGeometries.clear(),this._geometries.clear(),this._assets=[],this._meshesWithHoles.clear()}getMesh(e,t,i){const n=t.geometries.size(),r=t.expressID,o={id:r,geometries:[]};for(let a=0;a<n;a++){const l=t.geometries.get(a),h=l.geometryExpressID,d=l.color.w===1?1:-1,p=h*d;if(!this._visitedGeometries.has(p)){this._visitedGeometries.has(h)||this.getGeometry(e,h);const I=this._visitedGeometries.size,P=so.generateUUID();this._visitedGeometries.set(p,{uuid:P,index:I})}const f=this._visitedGeometries.get(p);if(f===void 0)throw new Error("Error getting geometry data for streaming!");const g=i.data.get(r);if(!g)throw new Error("Data not found!");g[0].push(f.index);const{x:v,y:b,z:w,w:T}=l.color,S=[v,b,w,T],_=l.flatTransformation;o.geometries.push({color:S,geometryID:h,transformation:_})}this._assets.push(o)}getGeometry(e,t){const i=e.GetGeometry(0,t),n=e.GetIndexArray(i.GetIndexData(),i.GetIndexDataSize()),r=e.GetVertexArray(i.GetVertexData(),i.GetVertexDataSize()),o=new Float32Array(r.length/2),a=new Float32Array(r.length/2);for(let f=0;f<r.length;f+=6)o[f/2]=r[f],o[f/2+1]=r[f+1],o[f/2+2]=r[f+2],a[f/2]=r[f+3],a[f/2+1]=r[f+4],a[f/2+2]=r[f+5];const l=C1(o),h=new Float32Array(l.transformation.elements),d=[l.center.x,l.center.y,l.center.z];let p=!1;for(let f=0;f<o.length-2;f+=3){const g=o[f],v=o[f+1],b=o[f+2],w=a[f],T=a[f+1],S=a[f+2];if(T1(d,[g,v,b],[w,T,S])){p=!0;break}}this._geometries.set(t,{position:o,normal:a,index:n,boundingBox:h,hasHoles:p}),i.delete(),this._geometryCount++}async streamAssets(){await this.onAssetStreamed.trigger(this._assets),this._assets=null,this._assets=[]}async streamGeometries(){let e=this._streamSerializer.export(this._geometries),t={};for(const[i,{boundingBox:n,hasHoles:r}]of this._geometries)t[i]={boundingBox:n,hasHoles:r};this.onGeometryStreamed.trigger({data:t,buffer:e}),t=null,e=null,this._geometries.clear(),this._geometryCount=0}};A(fE,"uuid","d9999a00-e1f5-4d3f-8cfe-c56e08609764");class mE extends Re{constructor(){super(...arguments),A(this,"onPropertiesStreamed",new $i),A(this,"onProgress",new $i),A(this,"onIndicesStreamed",new $i),A(this,"onDisposed",new ee),A(this,"enabled",!0),A(this,"settings",new vm),A(this,"webIfc",new tn)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(e){const t=performance.now();await this.readIfcFile(e),await this.streamAllProperties(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async streamFromCallBack(e){const t=performance.now();await this.streamIfcFile(e),await this.streamAllProperties(),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-t} ms!`)}async readIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModel(e,this.settings.webIfc)}async streamIfcFile(e){const{path:t,absolute:i,logLevel:n}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),n&&this.webIfc.SetLogLevel(n),this.webIfc.OpenModelFromCallback(e,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:e}=this.settings,t=new Set(this.webIfc.GetIfcEntityList(0)),i=new Set([pl,Qh,Zh,dl,Wn]);for(const a of i)t.add(a);let n=.01,r=0;for(const a of t){if(r++,nu.has(a))continue;const l=i.has(a),h=this.webIfc.GetLineIDsWithType(0,a),d=h.size();let p=0;for(let g=0;g<d-e;g+=e){const v={};for(let b=0;b<e;b++){p++;const w=h.get(g+b);try{const T=this.webIfc.GetLine(0,w,l);v[T.expressID]=T}catch{console.log(`Could not get property: ${w}`)}}await this.onPropertiesStreamed.trigger({type:a,data:v})}if(p!==d){const g={};for(let v=p;v<d;v++){const b=h.get(v);try{const w=this.webIfc.GetLine(0,b,l);g[w.expressID]=w}catch{console.log(`Could not get property: ${b}`)}}await this.onPropertiesStreamed.trigger({type:a,data:g})}const f=r/t.size;f>n&&(n+=.01,n=Math.max(n,f),await this.onProgress.trigger(Math.round(n*100)/100))}const o=await this.components.get(su).processFromWebIfc(this.webIfc,0);await this.onIndicesStreamed.trigger(o)}cleanUp(){this.webIfc=null,this.webIfc=new tn}}A(mE,"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");const Em=class bm extends Re{constructor(e){super(e),A(this,"enabled",!0),e.add(bm.uuid,this)}getFace(e,t,i){if(!e.geometry.index)throw new Error("Geometry must be indexed!");const n=new Map,r=e.geometry.index.array,{plane:o}=this.getFaceData(t,i,e),a=[];for(let p=0;p<r.length/3;p++){const{plane:f,edges:g}=this.getFaceData(p,i,e);if(f.equals(o)){a.push({index:p,edges:g});for(const{id:v,points:b,distance:w}of g)n.set(v,{points:b,distance:w})}}let l=0;const h=new Map,d=new Map;for(const{index:p,edges:f}of a){const g=new Map;for(const{id:I}of f)if(h.has(I)){const P=h.get(I);g.set(I,P)}const v=f.map(I=>I.id);if(!g.size){const I=l++;for(const{id:P}of f)h.set(P,I);d.set(I,{edges:new Set(v),indices:new Set([p])});continue}let b=null;const w=new Set,T=new Set(v);for(const[I,P]of g){b===null?b=P:P!==b&&w.add(P),h.delete(I);const{edges:M}=d.get(P);M.delete(I),T.delete(I)}if(b===null)throw new Error("Error computing face!");const S=d.get(b),{indices:_}=S;_.add(p);for(const I of T){h.set(I,b);const{edges:P}=S;P.add(I)}for(const I of w){const P=d.get(I),{edges:M,indices:k}=P,V=d.get(b),{edges:W,indices:j}=V;for(const Q of M)W.add(Q),h.set(Q,b);for(const Q of k)j.add(Q);d.delete(I)}}for(const[p,{indices:f,edges:g}]of d)if(f.has(t)){const v=[];for(const b of g){const w=n.get(b);v.push(w)}return{edges:v,indices:f}}return null}static distanceFromPointToLine(e,t,i,n=!1){const r=new Dt,o=new F;return r.set(t,i),r.closestPointToPoint(e,n,o),o.distanceTo(e)}getFaceData(e,t,i){const n=this.getVerticesAndNormal(i,e,t),{p1:r,p2:o,p3:a,faceNormal:l}=n;this.round(r),this.round(o),this.round(a),this.round(l);const h=[{id:`${r.x}|${r.y}|${r.z}`,value:r},{id:`${o.x}|${o.y}|${o.z}`,value:o},{id:`${a.x}|${a.y}|${a.z}`,value:a}];h.sort((S,_)=>S.id<_.id?-1:S.id>_.id?1:0);const[{id:d,value:p},{id:f,value:g},{id:v,value:b}]=h,w=[{id:`${d}|${f}`,distance:p.distanceTo(g),points:[p,g]},{id:`${f}|${v}`,distance:g.distanceTo(b),points:[g,b]},{id:`${d}|${v}`,distance:p.distanceTo(b),points:[p,b]}],T=new an;return T.setFromNormalAndCoplanarPoint(l,r),T.constant=Math.round(T.constant*10)/10,{plane:T,edges:w}}getVerticesAndNormal(e,t,i){if(!e.geometry.index)throw new Error("Geometry must be indexed!");const n=e.geometry.index.array,r=e.geometry.attributes.position.array,o=e.geometry.attributes.normal.array,a=n[t*3]*3,l=n[t*3+1]*3,h=n[t*3+2]*3,d=new F(r[a],r[a+1],r[a+2]),p=new F(r[l],r[l+1],r[l+2]),f=new F(r[h],r[h+1],r[h+2]),g=new F(o[a],o[a+1],o[a+2]),v=new F(o[l],o[l+1],o[l+2]),b=new F(o[h],o[h+1],o[h+2]),w=(g.x+v.x+b.x)/3,T=(g.y+v.y+b.y)/3,S=(g.z+v.z+b.z)/3,_=new F(w,T,S);if(i!==void 0&&e instanceof Kt){const I=new Ee;e.getMatrixAt(i,I);const P=new Ee;P.extractRotation(I),_.applyMatrix4(P),d.applyMatrix4(I),p.applyMatrix4(I),f.applyMatrix4(I)}return{p1:d,p2:p,p3:f,faceNormal:_}}round(e){e.x=Math.trunc(e.x*1e3)/1e3,e.y=Math.trunc(e.y*1e3)/1e3,e.z=Math.trunc(e.z*1e3)/1e3}};A(Em,"uuid","267ca032-672f-4cb0-afa9-d24e904f39d6");let ja=Em;const Kd=new Ke,ba=new F;class wm extends Nv{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new Ps(e,3)),this.setAttribute("uv",new Ps(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new Kc(t,6,1);return this.setAttribute("instanceStart",new xs(i,3,0)),this.setAttribute("instanceEnd",new xs(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new Kc(t,6,1);return this.setAttribute("instanceColorStart",new xs(i,3,0)),this.setAttribute("instanceColorEnd",new xs(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Uv(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ke);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),Kd.setFromBufferAttribute(t),this.boundingBox.union(Kd))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gn),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let n=0;for(let r=0,o=e.count;r<o;r++)ba.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(ba)),ba.fromBufferAttribute(t,r),n=Math.max(n,i.distanceToSquared(ba));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}Fa.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ve(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Oa.line={uniforms:Yh.merge([Fa.common,Fa.fog,Fa.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};let ro=class extends wt{constructor(e){super({type:"LineMaterial",uniforms:Yh.clone(Oa.line.uniforms),vertexShader:Oa.line.vertexShader,fragmentShader:Oa.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}};const Qd=new F,Zd=new F,pt=new Vs,ft=new Vs,fi=new Vs,Bc=new F,zc=new Ee,mt=new Dt,qd=new F,wa=new Ke,Ia=new Gn,mi=new Vs;let vi,Nn;function Jd(s,e,t){return mi.set(0,0,-e,1).applyMatrix4(s.projectionMatrix),mi.multiplyScalar(1/mi.w),mi.x=Nn/t.width,mi.y=Nn/t.height,mi.applyMatrix4(s.projectionMatrixInverse),mi.multiplyScalar(1/mi.w),Math.abs(Math.max(mi.x,mi.y))}function gE(s,e){const t=s.matrixWorld,i=s.geometry,n=i.attributes.instanceStart,r=i.attributes.instanceEnd,o=Math.min(i.instanceCount,n.count);for(let a=0,l=o;a<l;a++){mt.start.fromBufferAttribute(n,a),mt.end.fromBufferAttribute(r,a),mt.applyMatrix4(t);const h=new F,d=new F;vi.distanceSqToSegment(mt.start,mt.end,d,h),d.distanceTo(h)<Nn*.5&&e.push({point:d,pointOnLine:h,distance:vi.origin.distanceTo(d),object:s,face:null,faceIndex:a,uv:null,uv1:null})}}function vE(s,e,t){const i=e.projectionMatrix,n=s.material.resolution,r=s.matrixWorld,o=s.geometry,a=o.attributes.instanceStart,l=o.attributes.instanceEnd,h=Math.min(o.instanceCount,a.count),d=-e.near;vi.at(1,fi),fi.w=1,fi.applyMatrix4(e.matrixWorldInverse),fi.applyMatrix4(i),fi.multiplyScalar(1/fi.w),fi.x*=n.x/2,fi.y*=n.y/2,fi.z=0,Bc.copy(fi),zc.multiplyMatrices(e.matrixWorldInverse,r);for(let p=0,f=h;p<f;p++){if(pt.fromBufferAttribute(a,p),ft.fromBufferAttribute(l,p),pt.w=1,ft.w=1,pt.applyMatrix4(zc),ft.applyMatrix4(zc),pt.z>d&&ft.z>d)continue;if(pt.z>d){const T=pt.z-ft.z,S=(pt.z-d)/T;pt.lerp(ft,S)}else if(ft.z>d){const T=ft.z-pt.z,S=(ft.z-d)/T;ft.lerp(pt,S)}pt.applyMatrix4(i),ft.applyMatrix4(i),pt.multiplyScalar(1/pt.w),ft.multiplyScalar(1/ft.w),pt.x*=n.x/2,pt.y*=n.y/2,ft.x*=n.x/2,ft.y*=n.y/2,mt.start.copy(pt),mt.start.z=0,mt.end.copy(ft),mt.end.z=0;const g=mt.closestPointToPointParameter(Bc,!0);mt.at(g,qd);const v=so.lerp(pt.z,ft.z,g),b=v>=-1&&v<=1,w=Bc.distanceTo(qd)<Nn*.5;if(b&&w){mt.start.fromBufferAttribute(a,p),mt.end.fromBufferAttribute(l,p),mt.start.applyMatrix4(r),mt.end.applyMatrix4(r);const T=new F,S=new F;vi.distanceSqToSegment(mt.start,mt.end,S,T),t.push({point:S,pointOnLine:T,distance:vi.origin.distanceTo(S),object:s,face:null,faceIndex:p,uv:null,uv1:null})}}}class yE extends le{constructor(e=new wm,t=new ro({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,n=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)Qd.fromBufferAttribute(t,o),Zd.fromBufferAttribute(i,o),n[a]=a===0?0:n[a-1],n[a+1]=n[a]+Qd.distanceTo(Zd);const r=new Kc(n,2,1);return e.setAttribute("instanceDistanceStart",new xs(r,1,0)),e.setAttribute("instanceDistanceEnd",new xs(r,1,1)),this}raycast(e,t){const i=this.material.worldUnits,n=e.camera;n===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const r=e.params.Line2!==void 0&&e.params.Line2.threshold||0;vi=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Nn=l.linewidth+r,a.boundingSphere===null&&a.computeBoundingSphere(),Ia.copy(a.boundingSphere).applyMatrix4(o);let h;if(i)h=Nn*.5;else{const p=Math.max(n.near,Ia.distanceToPoint(vi.origin));h=Jd(n,p,l.resolution)}if(Ia.radius+=h,vi.intersectsSphere(Ia)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),wa.copy(a.boundingBox).applyMatrix4(o);let d;if(i)d=Nn*.5;else{const p=Math.max(n.near,wa.distanceToPoint(vi.origin));d=Jd(n,p,l.resolution)}wa.expandByScalar(d),vi.intersectsBox(wa)!==!1&&(i?gE(this,t):vE(this,n,t))}}let Wa=class extends wm{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let n=0;n<t;n+=3)i[2*n]=e[n],i[2*n+1]=e[n+1],i[2*n+2]=e[n+2],i[2*n+3]=e[n+3],i[2*n+4]=e[n+4],i[2*n+5]=e[n+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let n=0;n<t;n+=3)i[2*n]=e[n],i[2*n+1]=e[n+1],i[2*n+2]=e[n+2],i[2*n+3]=e[n+3],i[2*n+4]=e[n+4],i[2*n+5]=e[n+5];return super.setColors(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}},Im=class extends yE{constructor(e=new Wa,t=new ro({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}};const Cm=class Tm{constructor(e,t){x(this,"scene"),x(this,"onSelect",new ee),x(this,"type"),x(this,"selectCurve"),x(this,"selectPoints"),x(this,"hoverCurve"),x(this,"hoverPoints"),x(this,"caster",new io),this.scene=e,this.type=t,this.hoverCurve=this.newCurve(.003,4473924,!1),this.hoverPoints=this.newPoints(5,4473924),this.selectCurve=this.newCurve(.005,16777215,!0),this.selectPoints=this.newPoints(7,16777215)}dispose(){this.selectCurve&&this.scene.remove(this.selectCurve),this.selectCurve.material.dispose(),this.selectCurve.geometry.dispose(),this.selectCurve=null,this.hoverCurve.material.dispose(),this.hoverCurve.geometry.dispose(),this.hoverCurve=null,this.hoverPoints.material.dispose(),this.hoverPoints.geometry.dispose(),this.selectPoints.material.dispose(),this.selectPoints.geometry.dispose(),this.scene=null}castRay(e,t,i,n){const r=new Ve,o=i.getBoundingClientRect();r.x=(e.clientX-o.left)/o.width*2-1,r.y=-((e.clientY-o.top)/o.height)*2+1,this.caster.setFromCamera(r,t);const a=this.caster.intersectObjects(n);return a.length?a[0]:null}select(e){this.highlight(e,this.selectCurve,this.selectPoints,!0),this.onSelect.trigger(e)}unSelect(){this.selectCurve.removeFromParent(),this.selectPoints.removeFromParent()}hover(e){this.highlight(e,this.hoverCurve,this.hoverPoints,!1)}unHover(){this.hoverCurve.removeFromParent(),this.hoverPoints.removeFromParent()}setResolution({x:e,y:t}){this.selectCurve.material.resolution.set(e/t,1),this.hoverCurve.material.resolution.set(e/t,1)}highlight(e,t,i,n){const{alignment:r}=e.curve;this.scene.add(t),this.scene.add(i);const o=[],a=[],l=[];for(const f of r[this.type]){const g=f.mesh.geometry.attributes.position;for(const T of g.array)o.push(T);if(n){let T;if(this.type==="absolute"){const{horizontal:_}=f.alignment;T=_[f.index].data.TYPE}else T=f.data.TYPE;const S=Tm.settings.colors[T]||[1,1,1];for(let _=0;_<g.count;_++)a.push(...S)}const[v,b,w]=g.array;l.push(new F(v,b,w))}const h=o[o.length-3],d=o[o.length-2],p=o[o.length-1];l.push(new F(h,d,p)),o.length/3>t.geometry.attributes.position.count&&(t.geometry.dispose(),t.geometry=new Wa),t.geometry.setPositions(o),n&&t.geometry.setColors(a),i.geometry.setFromPoints(l)}newCurve(e,t,i){const n=new Wa,r=new ro({color:t,linewidth:e,vertexColors:i,worldUnits:!1,depthTest:!1}),o=new Im(n,r);return this.scene.add(o),o}newPoints(e,t){const i=new Ne,n=new gt(new Float32Array,3);i.setAttribute("position",n);const r=new ff({size:e,color:t,sizeAttenuation:!1,depthTest:!1}),o=new mf(i,r);return o.frustumCulled=!1,this.scene.add(o),o}};x(Cm,"settings",{colors:{LINE:[213/255,0/255,255/255],CIRCULARARC:[0/255,46,255/255],CLOTHOID:[0/255,255/255,0/255],PARABOLICARC:[0/255,255/255,72/255],CONSTANTGRADIENT:[213/255,0/255,255/255]}});let xm=Cm;class EE extends kn{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Ve(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const bs=new F,$d=new Ee,ep=new Ee,tp=new F,ip=new F;class bE{constructor(e={}){const t=this;let i,n,r,o;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:n}},this.render=function(g,v){g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),v.parent===null&&v.matrixWorldAutoUpdate===!0&&v.updateMatrixWorld(),$d.copy(v.matrixWorldInverse),ep.multiplyMatrices(v.projectionMatrix,$d),h(g,g,v),f(g)},this.setSize=function(g,v){i=g,n=v,r=i/2,o=n/2,l.style.width=g+"px",l.style.height=v+"px"};function h(g,v,b){if(g.isCSS2DObject){bs.setFromMatrixPosition(g.matrixWorld),bs.applyMatrix4(ep);const w=g.visible===!0&&bs.z>=-1&&bs.z<=1&&g.layers.test(b.layers)===!0;if(g.element.style.display=w===!0?"":"none",w===!0){g.onBeforeRender(t,v,b);const S=g.element;S.style.transform="translate("+-100*g.center.x+"%,"+-100*g.center.y+"%)translate("+(bs.x*r+r)+"px,"+(-bs.y*o+o)+"px)",S.parentNode!==l&&l.appendChild(S),g.onAfterRender(t,v,b)}const T={distanceToCameraSquared:d(b,g)};a.objects.set(g,T)}for(let w=0,T=g.children.length;w<T;w++)h(g.children[w],v,b)}function d(g,v){return tp.setFromMatrixPosition(g.matrixWorld),ip.setFromMatrixPosition(v.matrixWorld),tp.distanceToSquared(ip)}function p(g){const v=[];return g.traverse(function(b){b.isCSS2DObject&&v.push(b)}),v}function f(g){const v=p(g).sort(function(w,T){if(w.renderOrder!==T.renderOrder)return T.renderOrder-w.renderOrder;const S=a.objects.get(w).distanceToCameraSquared,_=a.objects.get(T).distanceToCameraSquared;return S-_}),b=v.length;for(let w=0,T=v.length;w<T;w++)v[w].element.style.zIndex=b-w}}}let _t=class{constructor(e,t,i){x(this,"three"),x(this,"world"),x(this,"onDisposed",new ee),this.world=e;let n;t?n=t:(n=document.createElement("div"),n.style.width="15px",n.style.height="15px",n.style.border="5px solid red"),this.three=new EE(n),(i||e.scene.three).add(this.three),this.visible=!0}set visible(e){this.three.visible=e}get visible(){return this.three.visible}toggleVisibility(){this.visible=!this.visible}dispose(){this.three.removeFromParent(),this.three.element.remove(),this.onDisposed.trigger(),this.onDisposed.reset()}};class Am extends P1{constructor(e,t,i){super(e,t,i),x(this,"three2D",new bE),this.onAfterUpdate.add(()=>{if(this.onBeforeUpdate.trigger(this),!this.enabled||!this.currentWorld)return;const n=this.currentWorld.scene.three,r=this.currentWorld.camera.three;n instanceof Xn&&this.three2D.render(n,r)}),this.onDisposed.add(()=>{this.three2D.domElement.remove()}),this.onResize.add(({x:n,y:r})=>{this.three2D.setSize(n,r)}),this.setupHtmlRenderer(),this.resize()}setupHtmlRenderer(){this.three2D.domElement.style.position="absolute",this.three2D.domElement.style.top="0px",this.three2D.domElement.style.pointerEvents="none",this.container&&this.container.appendChild(this.three2D.domElement)}}const Sm=class _m extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"enabled",!0),x(this,"threshold",50),x(this,"autoCluster",!0),x(this,"list",new Map),x(this,"_worldEvents",new Map),x(this,"clusterLabels",new Set),x(this,"currentKeys",new Set),x(this,"_color","white"),x(this,"_markerKey",0),x(this,"_clusterKey",0),x(this,"_setupWorlds",new Set),e.add(_m.uuid,this)}get color(){return this._color}set color(e){this._color=e;for(const[t,i]of this.list)for(const[n,r]of i)r.label.three.element.style.color=e}create(e,t,i,n=!1){this.setupEvents(e,!0);const r=this._markerKey.toString(),o=this.getWorldMarkerList(e);if(o.has(r))return;const a=document.createElement("span");a.innerHTML=t,a.style.color=this._color;const l=new _t(e,a);return l.three.position.copy(i),o.set(r,{key:r,label:l,merged:!1,static:n}),this._markerKey++,r}delete(e){for(const[t,i]of this.list){const n=i.get(e);n&&n.label.dispose(),i.delete(e)}}getWorldMarkerList(e){return this.list.has(e.uuid)||this.list.set(e.uuid,new Map),this.list.get(e.uuid)}dispose(e){for(const[t,i]of this.list){const n=[...i.keys()];for(const r of n){const o=i.get(r);e&&o.type!==e||(o.label.dispose(),i.delete(r))}}if(!e){this.list.clear(),this._markerKey=0;for(const t of this.clusterLabels)t.label.dispose();this.clusterLabels.clear(),this._clusterKey=0,this.currentKeys.clear()}this.onDisposed.trigger()}setupEvents(e,t){if(t&&this._setupWorlds.has(e.uuid)||!e.camera.hasCameraControls())return;const i=this.getWorldEvent(e);e.camera.controls.removeEventListener("sleep",i),e.camera.controls.removeEventListener("rest",i),t&&(e.camera.controls.addEventListener("sleep",i),e.camera.controls.addEventListener("rest",i))}getWorldEvent(e){if(!this._worldEvents.has(e.uuid)){const t=()=>{this.cluster(e)};this._worldEvents.set(e.uuid,t)}return this._worldEvents.get(e.uuid)}resetMarkers(){for(const[e,t]of this.list)for(const[i,n]of t)n.merged=!1;for(const e of this.clusterLabels)e.label.dispose();this.clusterLabels.clear(),this._clusterKey=0}removeMergeMarkers(e){const t=this.list.get(e.uuid);if(t){for(const[i,n]of t)n.merged?n.label.dispose():n.label.world.scene.three.add(n.label.three);for(const i of this.clusterLabels)if(i.markerKeys.length===1){for(const[n,r]of this.list){const o=r.get(i.markerKeys[0]);o&&(o.label.world.scene.three.add(o.label.three),o.merged=!1)}i.label.dispose(),this.clusterLabels.delete(i)}}}cluster(e){if(!this.autoCluster)return;this.resetMarkers();const t=this.list.get(e.uuid);if(t){for(const[i,n]of t)if(!n.merged&&!n.static){this.currentKeys.clear();for(const[r,o]of t)o.static||n.key!==o.key&&!o.merged&&this.distance(n.label,o.label)<this.threshold&&(this.currentKeys.add(o.key),o.merged=!0);if(this.currentKeys.size>0){this.currentKeys.add(n.key),n.merged=!0;const r=Array.from(this.currentKeys),o=this.getAveragePositionFromLabels(r),a=new _t(n.label.world,this.createClusterElement(this._clusterKey.toString())),{element:l}=a.three;l.textContent=r.length.toString(),a.three.position.copy(o),this.clusterLabels.add({key:this._clusterKey.toString(),markerKeys:r,label:a}),this._clusterKey++}}this.removeMergeMarkers(e)}}getAveragePositionFromLabels(e){const t=e.map(i=>{for(const[n,r]of this.list){const o=r.get(i);if(o)return o.label.three.position}return new F});return t.reduce((i,n)=>i.add(n),new F).divideScalar(t.length)}createClusterElement(e){const t=document.createElement("div");return t.textContent=e,t.style.color="#000000",t.style.background="#FFFFFF",t.style.fontSize="1.2rem",t.style.fontWeight="500",t.style.pointerEvents="auto",t.style.borderRadius="50%",t.style.padding="5px 11px",t.style.textAlign="center",t.style.cursor="pointer",t.addEventListener("pointerdown",()=>{this.navigateToCluster(e)}),t.addEventListener("pointerover",()=>{t.style.background="#BCF124"}),t.addEventListener("pointerout",()=>{t.style.background="#FFFFFF"}),t}getScreenPosition(e){const t=new F;if(!e.world.renderer)throw new Error("Renderer not found!");const i=e.three.position.clone();i.project(e.world.camera.three);const n=e.world.renderer.getSize();return t.x=i.x*n.x/2+n.x/2,t.y=-(i.y*n.y/2)+n.y/2,t}distance(e,t){const i=this.getScreenPosition(e),n=this.getScreenPosition(t),r=i.x-n.x,o=i.y-n.y,a=Math.sqrt(r*r+o*o)*.5;return a===0?this.threshold+1:a}navigateToCluster(e){const t=[],i=Array.from(this.clusterLabels).find(h=>h.key===e);if(!i)return;const n=i.label.world.camera;if(!n.hasCameraControls()){console.warn("Zoom to clusters only supported with Camera Controls!");return}for(const h of i.markerKeys)for(const[d,p]of this.list){const f=p.get(h);if(f){const{x:g,y:v,z:b}=f.label.three.position;t.push(g,v,b)}}i.label.dispose(),this.clusterLabels.delete(i);const r=new Ne,o=new Float32Array(t),a=new gt(o,3);r.setAttribute("position",a);const l=new le(r);l.geometry.computeBoundingSphere(),l.geometry.boundingSphere&&n.controls.fitToSphere(l,!0),r.dispose(),l.clear(),t.length=0}};x(Sm,"uuid","4079eb91-79b0-4ede-bcf2-15b837129236");let An=Sm;var np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rm(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ou={exports:{}};ou.exports=gl;ou.exports.default=gl;function gl(s,e,t){t=t||2;var i=e&&e.length,n=i?e[0]*t:s.length,r=Pm(s,0,n,t,!0),o=[];if(!r||r.next===r.prev)return o;var a,l,h,d,p,f,g;if(i&&(r=xE(s,e,r,t)),s.length>80*t){a=h=s[0],l=d=s[1];for(var v=t;v<n;v+=t)p=s[v],f=s[v+1],p<a&&(a=p),f<l&&(l=f),p>h&&(h=p),f>d&&(d=f);g=Math.max(h-a,d-l),g=g!==0?32767/g:0}return Vr(r,o,t,a,l,g,0),o}function Pm(s,e,t,i,n){var r,o;if(n===mh(s,e,t,i)>0)for(r=e;r<t;r+=i)o=sp(r,s[r],s[r+1],o);else for(r=t-i;r>=e;r-=i)o=sp(r,s[r],s[r+1],o);return o&&vl(o,o.next)&&(Yr(o),o=o.next),o}function Bn(s,e){if(!s)return s;e||(e=s);var t=s,i;do if(i=!1,!t.steiner&&(vl(t,t.next)||$e(t.prev,t,t.next)===0)){if(Yr(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Vr(s,e,t,i,n,r,o){if(s){!o&&r&&PE(s,i,n,r);for(var a=s,l,h;s.prev!==s.next;){if(l=s.prev,h=s.next,r?IE(s,i,n,r):wE(s)){e.push(l.i/t|0),e.push(s.i/t|0),e.push(h.i/t|0),Yr(s),s=h.next,a=h.next;continue}if(s=h,s===a){o?o===1?(s=CE(Bn(s),e,t),Vr(s,e,t,i,n,r,2)):o===2&&TE(s,e,t,i,n,r):Vr(Bn(s),e,t,i,n,r,1);break}}}}function wE(s){var e=s.prev,t=s,i=s.next;if($e(e,t,i)>=0)return!1;for(var n=e.x,r=t.x,o=i.x,a=e.y,l=t.y,h=i.y,d=n<r?n<o?n:o:r<o?r:o,p=a<l?a<h?a:h:l<h?l:h,f=n>r?n>o?n:o:r>o?r:o,g=a>l?a>h?a:h:l>h?l:h,v=i.next;v!==e;){if(v.x>=d&&v.x<=f&&v.y>=p&&v.y<=g&&Ss(n,a,r,l,o,h,v.x,v.y)&&$e(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function IE(s,e,t,i){var n=s.prev,r=s,o=s.next;if($e(n,r,o)>=0)return!1;for(var a=n.x,l=r.x,h=o.x,d=n.y,p=r.y,f=o.y,g=a<l?a<h?a:h:l<h?l:h,v=d<p?d<f?d:f:p<f?p:f,b=a>l?a>h?a:h:l>h?l:h,w=d>p?d>f?d:f:p>f?p:f,T=ph(g,v,e,t,i),S=ph(b,w,e,t,i),_=s.prevZ,I=s.nextZ;_&&_.z>=T&&I&&I.z<=S;){if(_.x>=g&&_.x<=b&&_.y>=v&&_.y<=w&&_!==n&&_!==o&&Ss(a,d,l,p,h,f,_.x,_.y)&&$e(_.prev,_,_.next)>=0||(_=_.prevZ,I.x>=g&&I.x<=b&&I.y>=v&&I.y<=w&&I!==n&&I!==o&&Ss(a,d,l,p,h,f,I.x,I.y)&&$e(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;_&&_.z>=T;){if(_.x>=g&&_.x<=b&&_.y>=v&&_.y<=w&&_!==n&&_!==o&&Ss(a,d,l,p,h,f,_.x,_.y)&&$e(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;I&&I.z<=S;){if(I.x>=g&&I.x<=b&&I.y>=v&&I.y<=w&&I!==n&&I!==o&&Ss(a,d,l,p,h,f,I.x,I.y)&&$e(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function CE(s,e,t){var i=s;do{var n=i.prev,r=i.next.next;!vl(n,r)&&Fm(n,i,i.next,r)&&Hr(n,r)&&Hr(r,n)&&(e.push(n.i/t|0),e.push(i.i/t|0),e.push(r.i/t|0),Yr(i),Yr(i.next),i=s=r),i=i.next}while(i!==s);return Bn(i)}function TE(s,e,t,i,n,r){var o=s;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ME(o,a)){var l=Om(o,a);o=Bn(o,o.next),l=Bn(l,l.next),Vr(o,e,t,i,n,r,0),Vr(l,e,t,i,n,r,0);return}a=a.next}o=o.next}while(o!==s)}function xE(s,e,t,i){var n=[],r,o,a,l,h;for(r=0,o=e.length;r<o;r++)a=e[r]*i,l=r<o-1?e[r+1]*i:s.length,h=Pm(s,a,l,i,!1),h===h.next&&(h.steiner=!0),n.push(OE(h));for(n.sort(AE),r=0;r<n.length;r++)t=SE(n[r],t);return t}function AE(s,e){return s.x-e.x}function SE(s,e){var t=_E(s,e);if(!t)return e;var i=Om(t,s);return Bn(i,i.next),Bn(t,t.next)}function _E(s,e){var t=e,i=s.x,n=s.y,r=-1/0,o;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){var a=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>r&&(r=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,h=o.x,d=o.y,p=1/0,f;t=o;do i>=t.x&&t.x>=h&&i!==t.x&&Ss(n<d?i:r,n,h,d,n<d?r:i,n,t.x,t.y)&&(f=Math.abs(n-t.y)/(i-t.x),Hr(t,s)&&(f<p||f===p&&(t.x>o.x||t.x===o.x&&RE(o,t)))&&(o=t,p=f)),t=t.next;while(t!==l);return o}function RE(s,e){return $e(s.prev,s,e.prev)<0&&$e(e.next,s,s.next)<0}function PE(s,e,t,i){var n=s;do n.z===0&&(n.z=ph(n.x,n.y,e,t,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,FE(n)}function FE(s){var e,t,i,n,r,o,a,l,h=1;do{for(t=s,s=null,r=null,o=0;t;){for(o++,i=t,a=0,e=0;e<h&&(a++,i=i.nextZ,!!i);e++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(n=t,t=t.nextZ,a--):(n=i,i=i.nextZ,l--),r?r.nextZ=n:s=n,n.prevZ=r,r=n;t=i}r.nextZ=null,h*=2}while(o>1);return s}function ph(s,e,t,i,n){return s=(s-t)*n|0,e=(e-i)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function OE(s){var e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function Ss(s,e,t,i,n,r,o,a){return(n-o)*(e-a)>=(s-o)*(r-a)&&(s-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(r-a)>=(n-o)*(i-a)}function ME(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!LE(s,e)&&(Hr(s,e)&&Hr(e,s)&&DE(s,e)&&($e(s.prev,s,e.prev)||$e(s,e.prev,e))||vl(s,e)&&$e(s.prev,s,s.next)>0&&$e(e.prev,e,e.next)>0)}function $e(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function vl(s,e){return s.x===e.x&&s.y===e.y}function Fm(s,e,t,i){var n=Ta($e(s,e,t)),r=Ta($e(s,e,i)),o=Ta($e(t,i,s)),a=Ta($e(t,i,e));return!!(n!==r&&o!==a||n===0&&Ca(s,t,e)||r===0&&Ca(s,i,e)||o===0&&Ca(t,s,i)||a===0&&Ca(t,e,i))}function Ca(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function Ta(s){return s>0?1:s<0?-1:0}function LE(s,e){var t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&Fm(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function Hr(s,e){return $e(s.prev,s,s.next)<0?$e(s,e,s.next)>=0&&$e(s,s.prev,e)>=0:$e(s,e,s.prev)<0||$e(s,s.next,e)<0}function DE(s,e){var t=s,i=!1,n=(s.x+e.x)/2,r=(s.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&n<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==s);return i}function Om(s,e){var t=new fh(s.i,s.x,s.y),i=new fh(e.i,e.x,e.y),n=s.next,r=e.prev;return s.next=e,e.prev=s,t.next=n,n.prev=t,i.next=t,t.prev=i,r.next=i,i.prev=r,i}function sp(s,e,t,i){var n=new fh(s,e,t);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Yr(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function fh(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}gl.deviation=function(s,e,t,i){var n=e&&e.length,r=n?e[0]*t:s.length,o=Math.abs(mh(s,0,r,t));if(n)for(var a=0,l=e.length;a<l;a++){var h=e[a]*t,d=a<l-1?e[a+1]*t:s.length;o-=Math.abs(mh(s,h,d,t))}var p=0;for(a=0;a<i.length;a+=3){var f=i[a]*t,g=i[a+1]*t,v=i[a+2]*t;p+=Math.abs((s[f]-s[v])*(s[g+1]-s[f+1])-(s[f]-s[g])*(s[v+1]-s[f+1]))}return o===0&&p===0?0:Math.abs((p-o)/o)};function mh(s,e,t,i){for(var n=0,r=e,o=t-i;r<t;r+=i)n+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return n}gl.flatten=function(s){for(var e=s[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,n=0;n<s.length;n++){for(var r=0;r<s[n].length;r++)for(var o=0;o<e;o++)t.vertices.push(s[n][r][o]);n>0&&(i+=s[n-1].length,t.holes.push(i))}return t};var NE=ou.exports;const UE=Rm(NE),kE={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};let Ys=class{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}};const BE=new jn(-1,1,1,-1,0,1);class zE extends Ne{constructor(){super(),this.setAttribute("position",new Ps([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Ps([0,2,0,0,2,0],2))}}const VE=new zE;class Mm{constructor(e){this._mesh=new le(VE,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,BE)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}let Lm=class extends Ys{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof wt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Yh.clone(e.uniforms),this.material=new wt({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Mm(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}},rp=class extends Ys{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const n=e.getContext(),r=e.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),r.buffers.stencil.setFunc(n.ALWAYS,o,4294967295),r.buffers.stencil.setClear(a),r.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.color.setMask(!0),r.buffers.depth.setMask(!0),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(n.EQUAL,1,4294967295),r.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP),r.buffers.stencil.setLocked(!0)}};class HE extends Ys{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class YE{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const i=e.getSize(new Ve);this._width=i.width,this._height=i.height,t=new Ri(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Jh}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Lm(kE),this.copyPass.material.blending=zv,this.clock=new vf}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let n=0,r=this.passes.length;n<r;n++){const o=this.passes[n];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}rp!==void 0&&(o instanceof rp?i=!0:o instanceof HE&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new Ve);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(i,n),this.renderTarget2.setSize(i,n);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(i,n)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class GE extends Ys{constructor(e,t,i=null,n=null,r=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=r,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Rt}render(e,t,i){const n=e.autoClear;e.autoClear=!1;let r,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),this.clearAlpha!==null&&(r=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(r),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=n}}const oo=new Ne;oo.setAttribute("position",new gt(new Float32Array([-1,-1,3,-1,-1,3]),2));oo.setAttribute("uv",new gt(new Float32Array([0,0,2,0,0,2]),2));oo.boundingSphere=new Gn;oo.computeBoundingSphere=function(){};const jE=new jn;let xa=class{constructor(e){this._mesh=new le(oo,e),this._mesh.frustumCulled=!1}render(e){e.render(this._mesh,jE)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}};const WE={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new Ee},viewMat:{value:new Ee},projViewMat:{value:new Ee},projectionMatrixInv:{value:new Ee},viewMatrixInv:{value:new Ee},cameraPos:{value:new F},resolution:{value:new Ve},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projViewMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},XE={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ee},viewMat:{value:new Ee},projectionMatrixInv:{value:new Ee},viewMatrixInv:{value:new Ee},cameraPos:{value:new F},resolution:{value:new Ve},color:{value:new F(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform sampler2D sceneDepth;
    uniform sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform float radius;
    uniform float distanceFalloff;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);

        #ifdef HALFRES 
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

     
        float finalAo = pow(texel.a, intensity);
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = LinearTosRGB(gl_FragColor);
        }
    }
    `},KE={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new Ee},viewMat:{value:new Ee},projectionMatrixInv:{value:new Ee},viewMatrixInv:{value:new Ee},cameraPos:{value:new F},resolution:{value:new Ve},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        occlusion /= count;
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},QE={uniforms:{sceneDepth:{value:null},resolution:{value:new Ve},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new Ee},projectionMatrixInv:{value:new Ee},logDepth:{value:!1}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`};var Dm="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";Uint8Array.from(atob(Dm),s=>s.charCodeAt(0));const ZE=Uint8Array.from(atob(Dm),s=>s.charCodeAt(0));function Nm(s,e,t){if(e.getQueryParameter(s,e.QUERY_RESULT_AVAILABLE)){const i=e.getQueryParameter(s,e.QUERY_RESULT)/1e6;t.lastTime=i}else setTimeout(()=>{Nm(s,e,t)},1)}class qE extends Ys{constructor(e,t,i=512,n=512){super(),this.width=i,this.height=n,this.clear=!0,this.camera=t,this.scene=e,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Rt(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0},{set:(r,o,a)=>{const l=r[o];return r[o]=a,o==="aoSamples"&&l!==a&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),o==="denoiseSamples"&&l!==a&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),o==="halfRes"&&l!==a&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),o==="depthAwareUpsampling"&&l!==a&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.beautyRenderTarget=new Ri(this.width,this.height,{minFilter:fr,magFilter:Ai}),this.beautyRenderTarget.depthTexture=new Vv(this.width,this.height,Hv),this.beautyRenderTarget.depthTexture.format=Yv,this.writeTargetInternal=new Ri(this.width,this.height,{minFilter:fr,magFilter:fr,depthBuffer:!1}),this.readTargetInternal=new Ri(this.width,this.height,{minFilter:fr,magFilter:fr,depthBuffer:!1}),this.bluenoise=new Gv(ZE,128,128),this.bluenoise.colorSpace=jv,this.bluenoise.wrapS=ld,this.bluenoise.wrapT=ld,this.bluenoise.minFilter=Ai,this.bluenoise.magFilter=Ai,this.bluenoise.needsUpdate=!0,this.lastTime=0,this._r=new Ve,this._c=new Rt}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new Wv(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=Xv,this.depthDownsampleTarget.texture[0].type=Kv,this.depthDownsampleTarget.texture[0].minFilter=Ai,this.depthDownsampleTarget.texture[0].magFilter=Ai,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=Af,this.depthDownsampleTarget.texture[1].type=Jh,this.depthDownsampleTarget.texture[1].minFilter=Ai,this.depthDownsampleTarget.texture[1].magFilter=Ai,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new xa(new wt(QE))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(e=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const t={...WE};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new wt(t)):this.effectShaderQuad=new xa(new wt(t))}configureDenoisePass(e=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const t={...KE};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new wt(t)):this.poissonBlurQuad=new xa(new wt(t))}configureEffectCompositer(e=!1){const t={...XE};e&&(t.fragmentShader=`#define LOGDEPTH
`+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader=`#define HALFRES
`+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new wt(t)):this.effectCompositerQuad=new xa(new wt(t))}generateHemisphereSamples(e){const t=[];for(let i=0;i<e;i++){const n=2.399963*i,r=Math.sqrt(i+.5)/Math.sqrt(e),o=r*Math.cos(n),a=r*Math.sin(n),l=Math.sqrt(1-(o*o+a*a));t.push(new F(o,a,l))}return t}generateHemisphereSamplesR(e){let t=[];for(let i=0;i<e;i++)t.push((i+1)/e);return t}generateDenoiseSamples(e,t){const i=2*Math.PI*t/e,n=1/e,r=n,o=[];let a=n,l=0;for(let h=0;h<e;h++)o.push(new Ve(Math.cos(l),Math.sin(l)).multiplyScalar(Math.pow(a,.75))),a+=r,l+=i;return o}setSize(e,t){this.width=e,this.height=t;const i=this.configuration.halfRes?.5:1;this.beautyRenderTarget.setSize(e,t),this.writeTargetInternal.setSize(e*i,t*i),this.readTargetInternal.setSize(e*i,t*i),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*i,t*i)}render(e,t,i,n,r){e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer));let o,a,l;this.debugMode&&(o=e.getContext(),a=o.getExtension("EXT_disjoint_timer_query_webgl2"),a===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),e.setRenderTarget(this.beautyRenderTarget),e.render(this.scene,this.camera),this.debugMode&&(l=o.createQuery(),o.beginQuery(a.TIME_ELAPSED_EXT,l));const h=e.xr.enabled;e.xr.enabled=!1,this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let d=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(d*=.5),this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.position,this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=d,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(let p=0;p<this.configuration.denoiseIterations;p++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.position,this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=d,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=p,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=d,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),e.setRenderTarget(this.renderToScreen?null:t),this.effectCompositerQuad.render(e),this.debugMode&&(o.endQuery(a.TIME_ELAPSED_EXT),Nm(l,o,this)),e.xr.enabled=h}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}setQualityMode(e){e==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):e==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):e==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):e==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}const JE={name:"GammaCorrectionShader",uniforms:{tDiffuse:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 tex = texture2D( tDiffuse, vUv );

			gl_FragColor = sRGBTransferOETF( tex );

		}`};function $E(){return new wt({side:2,clipping:!0,uniforms:{},vertexShader:`
    varying vec4 vColor;
    
    #include <clipping_planes_pars_vertex>
  
    void main() {
       #include <begin_vertex>
    
       vec4 absPosition = vec4(position, 1.0);
       vec3 trueNormal = normal;
       
       #ifdef USE_INSTANCING
          absPosition = instanceMatrix * absPosition;
          trueNormal = (instanceMatrix * vec4(normal, 0.)).xyz;
       #endif
       
       absPosition = modelMatrix * absPosition;
       trueNormal = (normalize(modelMatrix * vec4(trueNormal, 0.))).xyz;
       
       vec3 planePosition = absPosition.xyz / 40.;
       float d = abs(dot(trueNormal, planePosition));
       vColor = vec4(abs(trueNormal), d);
       gl_Position = projectionMatrix * viewMatrix * absPosition;
       
       #include <project_vertex>
       #include <clipping_planes_vertex>
    }
    `,fragmentShader:`
    varying vec4 vColor;
    
    #include <clipping_planes_pars_fragment>
  
    void main() {
      #include <clipping_planes_fragment>
      gl_FragColor = vColor;
    }
    `})}function eb(){return new wt({side:2,clipping:!0,uniforms:{},vertexShader:`
    varying vec3 vCameraPosition;
    varying vec3 vPosition;
    varying vec3 vNormal;
    
    #include <clipping_planes_pars_vertex>
  
    void main() {
       #include <begin_vertex>
       
       vec4 absPosition = vec4(position, 1.0);
       vNormal = normal;
       
       #ifdef USE_INSTANCING
          absPosition = instanceMatrix * absPosition;
          vNormal = (instanceMatrix * vec4(normal, 0.)).xyz;
       #endif
       
       absPosition = modelMatrix * absPosition;
       vNormal = (normalize(modelMatrix * vec4(vNormal, 0.))).xyz;
       
       gl_Position = projectionMatrix * viewMatrix * absPosition;
       
       vCameraPosition = cameraPosition;
       vPosition = absPosition.xyz;
       
       #include <project_vertex>
       #include <clipping_planes_vertex>
    }
    `,fragmentShader:`
    varying vec3 vCameraPosition;
    varying vec3 vPosition;
    varying vec3 vNormal;
    
    #include <clipping_planes_pars_fragment>
  
    void main() {
      #include <clipping_planes_fragment>
      vec3 cameraPixelVec = normalize(vCameraPosition - vPosition);
      float difference = abs(dot(vNormal, cameraPixelVec));
      
      // This achieves a double gloss effect: when the surface is perpendicular and when it's parallel
      difference = abs((difference * 2.) - 1.);
      
      gl_FragColor = vec4(difference, difference, difference, 1.);
    }
    `})}class tb extends Ys{constructor(e,t,i,n,r){if(super(),x(this,"components"),x(this,"resolution"),x(this,"renderScene"),x(this,"renderCamera"),x(this,"fsQuad"),x(this,"normalOverrideMaterial"),x(this,"glossOverrideMaterial"),x(this,"planeBuffer"),x(this,"glossBuffer"),x(this,"outlineBuffer"),x(this,"excludedMeshes",[]),x(this,"outlinedMeshes",{}),x(this,"_outlineScene",new Xn),x(this,"_outlineEnabled",!1),x(this,"_lineColor",10066329),x(this,"_opacity",.4),x(this,"_tolerance",3),x(this,"_glossEnabled",!0),x(this,"_glossExponent",1.9),x(this,"_minGloss",-.1),x(this,"_maxGloss",.1),x(this,"_outlinesNeedsUpdate",!1),!i.renderer)throw new Error("The given world must have a renderer!");this.components=t,this.renderScene=n,this.renderCamera=r,this.resolution=new Ve(e.x,e.y),this.fsQuad=new Mm,this.fsQuad.material=this.createOutlinePostProcessMaterial(),this.planeBuffer=this.newRenderTarget(),this.glossBuffer=this.newRenderTarget(),this.outlineBuffer=this.newRenderTarget();const o=$E();o.clippingPlanes=i.renderer.clippingPlanes,this.normalOverrideMaterial=o;const a=eb();a.clippingPlanes=i.renderer.clippingPlanes,this.glossOverrideMaterial=a}get lineColor(){return this._lineColor}set lineColor(e){this._lineColor=e,this.fsQuad.material.uniforms.lineColor.value.set(e)}get tolerance(){return this._tolerance}set tolerance(e){this._tolerance=e;const t=this.fsQuad.material;t.uniforms.tolerance.value=e}get opacity(){return this._opacity}set opacity(e){this._opacity=e;const t=this.fsQuad.material;t.uniforms.opacity.value=e}get glossEnabled(){return this._glossEnabled}set glossEnabled(e){if(e===this._glossEnabled)return;this._glossEnabled=e;const t=this.fsQuad.material;t.uniforms.glossEnabled.value=e?1:0}get glossExponent(){return this._glossExponent}set glossExponent(e){this._glossExponent=e;const t=this.fsQuad.material;t.uniforms.glossExponent.value=e}get minGloss(){return this._minGloss}set minGloss(e){this._minGloss=e;const t=this.fsQuad.material;t.uniforms.minGloss.value=e}get maxGloss(){return new Xt().color.convertLinearToSRGB(),this._maxGloss}set maxGloss(e){this._maxGloss=e;const t=this.fsQuad.material;t.uniforms.maxGloss.value=e}get outlineEnabled(){return this._outlineEnabled}set outlineEnabled(e){if(e===this._outlineEnabled)return;this._outlineEnabled=e;const t=this.fsQuad.material;t.uniforms.outlineEnabled.value=e?1:0}async dispose(){this.planeBuffer.dispose(),this.glossBuffer.dispose(),this.outlineBuffer.dispose(),this.normalOverrideMaterial.dispose(),this.glossOverrideMaterial.dispose(),this.fsQuad.dispose(),this.excludedMeshes=[],this._outlineScene.children=[];const e=this.components.get(Oi);for(const t in this.outlinedMeshes){const i=this.outlinedMeshes[t];for(const n of i.meshes)e.destroy(n,!0,!0);i.material.dispose()}}setSize(e,t){this.planeBuffer.setSize(e,t),this.glossBuffer.setSize(e,t),this.outlineBuffer.setSize(e,t),this.resolution.set(e,t),this.fsQuad.material.uniforms.screenSize.value.set(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y)}render(e,t,i){const n=t.depthBuffer;t.depthBuffer=!1;const r=this.renderScene.overrideMaterial,o=this.renderScene.background;this.renderScene.background=null;for(const l of this.excludedMeshes)l.visible=!1;if(e.setRenderTarget(this.planeBuffer),this.renderScene.overrideMaterial=this.normalOverrideMaterial,e.render(this.renderScene,this.renderCamera),this._glossEnabled&&(e.setRenderTarget(this.glossBuffer),this.renderScene.overrideMaterial=this.glossOverrideMaterial,e.render(this.renderScene,this.renderCamera)),this.renderScene.overrideMaterial=r,this._outlineEnabled){let l=!1;for(const h in this.outlinedMeshes){const d=this.outlinedMeshes[h];for(const p of d.meshes)l=!0,p.userData.materialPreOutline=p.material,p.material=d.material,p.userData.groupsPreOutline=p.geometry.groups,p.geometry.groups=[],p instanceof Kt&&(p.userData.colorPreOutline=p.instanceColor,p.instanceColor=null),p.userData.parentPreOutline=p.parent,this._outlineScene.add(p)}(l||this._outlinesNeedsUpdate)&&(e.setRenderTarget(this.outlineBuffer),e.render(this._outlineScene,this.renderCamera),this._outlinesNeedsUpdate=l);for(const h in this.outlinedMeshes){const d=this.outlinedMeshes[h];for(const p of d.meshes)p.material=p.userData.materialPreOutline,p.geometry.groups=p.userData.groupsPreOutline,p instanceof Kt&&(p.instanceColor=p.userData.colorPreOutline),p.userData.parentPreOutline&&p.userData.parentPreOutline.add(p),p.userData.materialPreOutline=void 0,p.userData.groupsPreOutline=void 0,p.userData.colorPreOutline=void 0,p.userData.parentPreOutline=void 0}}for(const l of this.excludedMeshes)l.visible=!0;this.renderScene.background=o;const a=this.fsQuad.material;a.uniforms.planeBuffer.value=this.planeBuffer.texture,a.uniforms.glossBuffer.value=this.glossBuffer.texture,a.uniforms.outlineBuffer.value=this.outlineBuffer.texture,a.uniforms.sceneColorBuffer.value=i.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.fsQuad.render(e)),t.depthBuffer=n}get vertexShader(){return`
	  varying vec2 vUv;
	  void main() {
	  	vUv = uv;
	  	gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
	  }
	`}get fragmentShader(){return`
	  uniform sampler2D sceneColorBuffer;
	  uniform sampler2D planeBuffer;
	  uniform sampler2D glossBuffer;
	  uniform sampler2D outlineBuffer;
	  uniform vec4 screenSize;
	  uniform vec3 lineColor;
	  
	  uniform float outlineEnabled;
	  
      uniform int width;
	  uniform float opacity;
      uniform float tolerance;
      uniform float glossExponent;
      uniform float minGloss;
      uniform float maxGloss;
      uniform float glossEnabled;

	  varying vec2 vUv;

	  vec4 getValue(sampler2D buffer, int x, int y) {
	  	return texture2D(buffer, vUv + screenSize.zw * vec2(x, y));
	  }

      float normalDiff(vec3 normal1, vec3 normal2) {
        return ((dot(normal1, normal2) - 1.) * -1.) / 2.;
      }

      // Returns 0 if it's background, 1 if it's not
      float getIsBackground(vec3 normal) {
        float background = 1.0;
        background *= step(normal.x, 0.);
        background *= step(normal.y, 0.);
        background *= step(normal.z, 0.);
        background = (background - 1.) * -1.;
        return background;
      }

	  void main() {
	  
	    vec4 sceneColor = getValue(sceneColorBuffer, 0, 0);
	    vec3 normSceneColor = normalize(sceneColor.rgb);
  
        vec4 plane = getValue(planeBuffer, 0, 0);
	    vec3 normal = plane.xyz;
        float distance = plane.w;
  
        vec3 normalTop = getValue(planeBuffer, 0, width).rgb;
        vec3 normalBottom = getValue(planeBuffer, 0, -width).rgb;
        vec3 normalRight = getValue(planeBuffer, width, 0).rgb;
        vec3 normalLeft = getValue(planeBuffer, -width, 0).rgb;
        vec3 normalTopRight = getValue(planeBuffer, width, width).rgb;
        vec3 normalTopLeft = getValue(planeBuffer, -width, width).rgb;
        vec3 normalBottomRight = getValue(planeBuffer, width, -width).rgb;
        vec3 normalBottomLeft = getValue(planeBuffer, -width, -width).rgb;
  
        float distanceTop = getValue(planeBuffer, 0, width).a;
        float distanceBottom = getValue(planeBuffer, 0, -width).a;
        float distanceRight = getValue(planeBuffer, width, 0).a;
        float distanceLeft = getValue(planeBuffer, -width, 0).a;
        float distanceTopRight = getValue(planeBuffer, width, width).a;
        float distanceTopLeft = getValue(planeBuffer, -width, width).a;
        float distanceBottomRight = getValue(planeBuffer, width, -width).a;
        float distanceBottomLeft = getValue(planeBuffer, -width, -width).a;
        
        vec3 sceneColorTop = normalize(getValue(sceneColorBuffer, 1, 0).rgb);
        vec3 sceneColorBottom = normalize(getValue(sceneColorBuffer, -1, 0).rgb);
        vec3 sceneColorLeft = normalize(getValue(sceneColorBuffer, 0, -1).rgb);
        vec3 sceneColorRight = normalize(getValue(sceneColorBuffer, 0, 1).rgb);
        vec3 sceneColorTopRight = normalize(getValue(sceneColorBuffer, 1, 1).rgb);
        vec3 sceneColorBottomRight = normalize(getValue(sceneColorBuffer, -1, 1).rgb);
        vec3 sceneColorTopLeft = normalize(getValue(sceneColorBuffer, 1, 1).rgb);
        vec3 sceneColorBottomLeft = normalize(getValue(sceneColorBuffer, -1, 1).rgb);

        // Checks if the planes of this texel and the neighbour texels are different

        float planeDiff = 0.0;

        planeDiff += step(0.001, normalDiff(normal, normalTop));
        planeDiff += step(0.001, normalDiff(normal, normalBottom));
        planeDiff += step(0.001, normalDiff(normal, normalLeft));
        planeDiff += step(0.001, normalDiff(normal, normalRight));
        planeDiff += step(0.001, normalDiff(normal, normalTopRight));
        planeDiff += step(0.001, normalDiff(normal, normalTopLeft));
        planeDiff += step(0.001, normalDiff(normal, normalBottomRight));
        planeDiff += step(0.001, normalDiff(normal, normalBottomLeft));
        
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTop));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottom));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorLeft));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorRight));
       	planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopRight));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopLeft));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomRight));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomLeft));

        planeDiff += step(0.001, abs(distance - distanceTop));
        planeDiff += step(0.001, abs(distance - distanceBottom));
        planeDiff += step(0.001, abs(distance - distanceLeft));
        planeDiff += step(0.001, abs(distance - distanceRight));
        planeDiff += step(0.001, abs(distance - distanceTopRight));
        planeDiff += step(0.001, abs(distance - distanceTopLeft));
        planeDiff += step(0.001, abs(distance - distanceBottomRight));
        planeDiff += step(0.001, abs(distance - distanceBottomLeft));

        // Add extra background outline

        int width2 = width + 1;
        vec3 normalTop2 = getValue(planeBuffer, 0, width2).rgb;
        vec3 normalBottom2 = getValue(planeBuffer, 0, -width2).rgb;
        vec3 normalRight2 = getValue(planeBuffer, width2, 0).rgb;
        vec3 normalLeft2 = getValue(planeBuffer, -width2, 0).rgb;
        vec3 normalTopRight2 = getValue(planeBuffer, width2, width2).rgb;
        vec3 normalTopLeft2 = getValue(planeBuffer, -width2, width2).rgb;
        vec3 normalBottomRight2 = getValue(planeBuffer, width2, -width2).rgb;
        vec3 normalBottomLeft2 = getValue(planeBuffer, -width2, -width2).rgb;

        planeDiff += -(getIsBackground(normalTop2) - 1.);
        planeDiff += -(getIsBackground(normalBottom2) - 1.);
        planeDiff += -(getIsBackground(normalRight2) - 1.);
        planeDiff += -(getIsBackground(normalLeft2) - 1.);
        planeDiff += -(getIsBackground(normalTopRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomLeft2) - 1.);

        // Tolerance sets the minimum amount of differences to consider
        // this texel an edge

        float line = step(tolerance, planeDiff);

        // Exclude background and apply opacity

        float background = getIsBackground(normal);
        line *= background;
        line *= opacity;
        
        // Add gloss
        
        vec3 gloss = getValue(glossBuffer, 0, 0).xyz;
        float diffGloss = abs(maxGloss - minGloss);
        vec3 glossExpVector = vec3(glossExponent,glossExponent,glossExponent);
        gloss = min(pow(gloss, glossExpVector), vec3(1.,1.,1.));
        gloss *= diffGloss;
        gloss += minGloss;
        vec4 glossedColor = sceneColor + vec4(gloss, 1.) * glossEnabled;
        
        vec4 corrected = mix(sceneColor, glossedColor, background);
        
        // Draw lines
        
        corrected = mix(corrected, vec4(lineColor, 1.), line);
        
        // Add outline
        
        vec4 outlinePreview =getValue(outlineBuffer, 0, 0);
        float outlineColorCorrection = 1. / max(0.2, outlinePreview.a);
        vec3 outlineColor = outlinePreview.rgb * outlineColorCorrection;
        
        // thickness between 10 and 2, opacity between 1 and 0.2
	    int outlineThickness = int(outlinePreview.a * 10.);
	    
	    float outlineDiff = 0.;
        
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 1, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -1, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -1).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 1).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, -outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, -outlineThickness).a);
        
        float outLine = step(4., outlineDiff) * step(outlineDiff, 12.) * outlineEnabled;
        corrected = mix(corrected, vec4(outlineColor, 1.), outLine);
        
        gl_FragColor = corrected;
	}
			`}createOutlinePostProcessMaterial(){return new wt({uniforms:{opacity:{value:this._opacity},debugVisualize:{value:0},sceneColorBuffer:{value:null},tolerance:{value:this._tolerance},planeBuffer:{value:null},glossBuffer:{value:null},outlineBuffer:{value:null},glossEnabled:{value:1},minGloss:{value:this._minGloss},maxGloss:{value:this._maxGloss},outlineEnabled:{value:0},glossExponent:{value:this._glossExponent},width:{value:1},lineColor:{value:new Rt(this._lineColor)},screenSize:{value:new Vs(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}newRenderTarget(){const e=new Ri(this.resolution.x,this.resolution.y);return e.texture.colorSpace="srgb-linear",e.texture.format=Af,e.texture.type=Jh,e.texture.minFilter=Ai,e.texture.magFilter=Ai,e.texture.generateMipmaps=!1,e.stencilBuffer=!1,e}}class ib{constructor(e,t,i){if(x(this,"overrideClippingPlanes",!1),x(this,"composer"),x(this,"_enabled",!1),x(this,"_initialized",!1),x(this,"_n8ao"),x(this,"_customEffects"),x(this,"_basePass"),x(this,"_gammaPass"),x(this,"_depthTexture"),x(this,"_settings",{gamma:!0,custom:!0,ao:!1}),x(this,"_renderer"),x(this,"_components"),x(this,"_world"),x(this,"_renderTarget"),!i.renderer)throw new Error("The given world must have a renderer!");this._components=e,this._renderer=t,this._world=i,this._renderTarget=new Ri(window.innerWidth,window.innerHeight),this._renderTarget.texture.colorSpace="srgb-linear",this.composer=new YE(t,this._renderTarget),this.composer.setSize(window.innerWidth,window.innerHeight)}get basePass(){if(!this._basePass)throw new Error("Custom effects not initialized!");return this._basePass}get gammaPass(){if(!this._gammaPass)throw new Error("Custom effects not initialized!");return this._gammaPass}get customEffects(){if(!this._customEffects)throw new Error("Custom effects not initialized!");return this._customEffects}get n8ao(){if(!this._n8ao)throw new Error("Custom effects not initialized!");return this._n8ao}get enabled(){return this._enabled}set enabled(e){this._initialized||this.initialize(),this._enabled=e}get settings(){return{...this._settings}}dispose(){var e,t,i,n;this._renderTarget.dispose(),(e=this._depthTexture)==null||e.dispose(),(t=this._customEffects)==null||t.dispose(),(i=this._gammaPass)==null||i.dispose(),(n=this._n8ao)==null||n.dispose()}setPasses(e){let t=!1;for(const i in e){const n=i;if(this.settings[n]!==e[n]){t=!0;break}}if(t){for(const i in e){const n=i;this._settings[n]!==void 0&&(this._settings[n]=e[n])}this.updatePasses()}}setSize(e,t){this._initialized&&(this.composer.setSize(e,t),this.basePass.setSize(e,t),this.n8ao.setSize(e,t),this.customEffects.setSize(e,t),this.gammaPass.setSize(e,t))}update(){this._enabled&&this.composer.render()}updateCamera(){const e=this._world.camera.three;this._n8ao&&(this._n8ao.camera=e),this._customEffects&&(this._customEffects.renderCamera=e),this._basePass&&(this._basePass.camera=e)}initialize(){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const e=this._world.scene.three,t=this._world.camera.three;if(!(e instanceof Xn))throw new Error("The given scene must have a THREE.Scene as core!");this._world.camera instanceof nE&&this._world.camera.projection.onChanged.add(()=>{this.updateCamera()});const i=this._world.renderer;this.overrideClippingPlanes||(this._renderer.clippingPlanes=i.clippingPlanes),this._renderer.outputColorSpace="srgb",this._renderer.toneMapping=Bv,this.newBasePass(e,t),this.newSaoPass(e,t),this.newGammaPass(),this.newCustomPass(e,t),this._initialized=!0,this.updatePasses()}updateProjection(e){this.composer.passes.forEach(t=>{t.camera=e}),this.update()}updatePasses(){for(const e of this.composer.passes)this.composer.removePass(e);this._basePass&&this.composer.addPass(this.basePass),this._settings.gamma&&this.composer.addPass(this.gammaPass),this._settings.ao&&this.composer.addPass(this.n8ao),this._settings.custom&&this.composer.addPass(this.customEffects)}newCustomPass(e,t){this._customEffects=new tb(new Ve(window.innerWidth,window.innerHeight),this._components,this._world,e,t)}newGammaPass(){this._gammaPass=new Lm(JE)}newSaoPass(e,t){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const{width:i,height:n}=this._world.renderer.getSize();this._n8ao=new qE(e,t,i,n);const{configuration:r}=this._n8ao;r.aoSamples=16,r.denoiseSamples=1,r.denoiseRadius=13,r.aoRadius=1,r.distanceFalloff=4,r.aoRadius=1,r.intensity=4,r.halfRes=!0,r.color=new Rt().setHex(13421772,"srgb-linear")}newBasePass(e,t){this._basePass=new GE(e,t)}}let gh=class extends Am{constructor(e,t,i){super(e,t,i),x(this,"_postproduction"),this.onResize.add(n=>this.resizePostproduction(n)),this.onWorldChanged.add(()=>{this.currentWorld&&(this._postproduction&&this._postproduction.dispose(),this._postproduction=new ib(e,this.three,this.currentWorld),this.setPostproductionSize())})}get postproduction(){if(!this._postproduction)throw new Error("Renderer not initialized yet with a world!");return this._postproduction}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger();const e=this.currentWorld.scene.three,t=this.currentWorld.camera.three;this.postproduction.enabled?this.postproduction.composer.render():this.three.render(e,t),e instanceof Xn&&this.three2D.render(e,t),this.onAfterUpdate.trigger()}dispose(){super.dispose(),this.postproduction.dispose()}resizePostproduction(e){this.postproduction&&this.setPostproductionSize(e)}setPostproductionSize(e){if(!this.container)return;const t=e?e.x:this.container.clientWidth,i=e?e.y:this.container.clientHeight;this.postproduction.setSize(t,i)}};class nb{constructor(e,t,i,n){x(this,"mesh",new le(new Ne)),x(this,"world"),x(this,"styleName"),x(this,"_precission",1e4),x(this,"_tempVector",new F),x(this,"_plane"),x(this,"_geometry"),x(this,"_plane2DCoordinateSystem",new Ee),x(this,"_planeAxis"),this.world=e,this.mesh.material=n,this.mesh.frustumCulled=!1,this._plane=t;const{x:r,y:o,z:a}=t.normal;Math.abs(r)===1?this._planeAxis="x":Math.abs(o)===1?this._planeAxis="y":Math.abs(a)===1&&(this._planeAxis="z"),this._geometry=i,this.mesh.geometry.attributes.position=i.attributes.position;const l=t.normal.clone().multiplyScalar(.01);this.mesh.position.copy(l),this.visible=!0}get visible(){return this.mesh.parent!==null}set visible(e){const t=this.getStyle();e?(this.world.scene.three.add(this.mesh),t&&t.meshes.add(this.mesh)):(this.mesh.removeFromParent(),t&&t.meshes.delete(this.mesh))}set geometry(e){this._geometry=e,this.mesh.geometry.attributes.position=e.attributes.position}dispose(){const e=this.getStyle();e&&e.meshes.delete(this.mesh),this.mesh.geometry.dispose(),this.mesh.removeFromParent(),this.mesh.geometry=null,this.mesh=null,this._plane=null,this._geometry=null}update(e){const t=this._geometry.attributes.position.array;if(!t)return;this.updatePlane2DCoordinateSystem();const i=[];let n=0;for(let r=0;r<e.length;r++){const o=e[r],a=[];for(let h=n;h<o;h+=2)a.push(h*3);const l=this.computeFill(a,t);for(const h of l)i.push(h);n=o}this.mesh.geometry.setIndex(i)}computeFill(e,t){const i=new Map,n={},r=new Map;let o=0;const a=new Map,l=new Map,h=new Set,d=this._precission;for(let f=0;f<e.length;f++){const g=e[f];let v=0,b=0,w=0,T=0;const S=t[g],_=t[g+1],I=t[g+2],P=t[g+3],M=t[g+4],k=t[g+5];if(this._tempVector.set(S,_,I),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),v=Math.trunc(this._tempVector.x*d)/d,b=Math.trunc(this._tempVector.y*d)/d,this._tempVector.set(P,M,k),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),w=Math.trunc(this._tempVector.x*d)/d,T=Math.trunc(this._tempVector.y*d)/d,v===w&&b===T)continue;const V=`${v}|${b}`,W=`${w}|${T}`;i.has(V)||i.set(V,g/3),i.has(W)||i.set(W,g/3+1);const j=i.get(V),Q=i.get(W);n[j]=[v,b],n[Q]=[w,T];const $=l.has(j),ne=a.has(j),oe=l.has(Q),ve=a.has(Q);if(!$&&!ne&&!oe&&!ve)l.set(j,o),a.set(Q,o),h.add(o),r.set(o,[j,Q]),o++;else if($&&ve){const re=l.get(j),ge=a.get(Q);if(re!==ge){const me=r.get(ge),we=r.get(re);if(!me||!we)continue;r.delete(re),h.delete(re),a.set(we[we.length-1],ge),a.delete(me[me.length-1]);for(const Ge of we)me.push(Ge)}else h.delete(ge);l.delete(j),a.delete(Q)}else if(ne&&oe){const re=l.get(Q),ge=a.get(j);if(re!==ge){const me=r.get(ge),we=r.get(re);if(!me||!we)continue;r.delete(re),h.delete(re),a.set(we[we.length-1],ge),a.delete(me[me.length-1]);for(const Ge of we)me.push(Ge)}else h.delete(ge);l.delete(Q),a.delete(j)}else if($&&oe){const re=l.get(Q),ge=l.get(j),me=r.get(ge),we=r.get(re);if(!me||!we)continue;r.delete(re),h.delete(re),l.delete(me[0]),l.delete(we[0]),a.delete(we[we.length-1]),l.set(we[we.length-1],ge),we.reverse(),me.splice(0,0,...we)}else if(ne&&ve){const re=a.get(Q),ge=a.get(j),me=r.get(ge),we=r.get(re);if(!me||!we)continue;r.delete(re),h.delete(re),a.delete(me[me.length-1]),a.delete(we[we.length-1]),l.delete(we[0]),a.set(we[0],ge),we.reverse(),me.push(...we)}else if($){const re=l.get(j),ge=r.get(re);if(!ge)continue;ge.unshift(Q),l.delete(j),l.set(Q,re)}else if(ne){const re=a.get(j),ge=r.get(re);if(!ge)continue;ge.push(Q),a.delete(j),a.set(Q,re)}else if(oe){const re=l.get(Q),ge=r.get(re);if(!ge)continue;ge.unshift(j),l.delete(Q),l.set(j,re)}else if(ve){const re=a.get(Q),ge=r.get(re);if(!ge)continue;ge.push(j),a.delete(Q),a.set(j,re)}}const p=[];for(const[f,g]of r){if(h.has(f))continue;const v=[],b=new Map;let w=0;for(const S of g){const _=n[S];v.push(_[0],_[1]),b.set(w++,S)}const T=UE(v);for(const S of T){const _=b.get(S);if(_===void 0)throw new Error("Map error!");p.push(_)}}return p}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new Ee;const e=new F(1,0,0),t=new F(0,1,0),i=this._plane.normal,n=new F;this._plane.coplanarPoint(n),this._planeAxis==="x"?e.crossVectors(t,i):this._planeAxis==="y"?t.crossVectors(i,e):this._planeAxis==="z"||(e.crossVectors(t,i).normalize(),t.crossVectors(i,e)),this._plane2DCoordinateSystem.fromArray([e.x,e.y,e.z,0,t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,1]),this._plane2DCoordinateSystem.invert()}getStyle(){if(!this.world.renderer)return null;const e=this.world.renderer instanceof gh;return this.styleName&&e?this.world.renderer.postproduction.customEffects.outlinedMeshes[this.styleName]:null}}class sb{constructor(e,t,i){x(this,"onDisposed",new ee),x(this,"onAfterUpdate",new ee),x(this,"onBeforeUpdate",new ee),x(this,"enabled",!0),x(this,"fillNeedsUpdate",!1),x(this,"components"),x(this,"world"),x(this,"_edges",{}),x(this,"_visible",!0),x(this,"_inverseMatrix",new Ee),x(this,"_localPlane",new an),x(this,"_tempLine",new Dt),x(this,"_tempVector",new F),x(this,"_plane"),this.components=e,this.world=t,this._plane=i}get visible(){return this._visible}set visible(e){for(const t in this._edges){const i=this._edges[t];e?this.world.scene.three.add(i.mesh):i.mesh.removeFromParent(),i.fill&&(i.fill.visible=e)}}update(){const e=this.components.get(Aa).styles.list;this.updateDeletedEdges(e);for(const t in e)this.drawEdges(t);this.fillNeedsUpdate=!1}get(){return this._edges}dispose(){const e=Object.keys(this._edges);for(const t of e)this.disposeEdge(t);this.onDisposed.trigger(),this.onDisposed.reset()}newEdgesMesh(e){const t=this.components.get(Aa).styles.list[e].lineMaterial,i=new Ne,n=new Float32Array(3e5),r=new gt(n,3,!1);r.setUsage(kv),i.setAttribute("position",r);const o=new xf(i,t);return o.frustumCulled=!1,o}newFillMesh(e,t){const i=this.components.get(Aa).styles.list[e],n=i.fillMaterial;if(n){const r=new nb(this.world,this._plane,t,n);return this.newFillOutline(e,r,i),r}}newFillOutline(e,t,i){if(!i.outlineMaterial||!this.world.renderer)return;const n=this.world.renderer;if(n instanceof gh){const r=n.postproduction.customEffects.outlinedMeshes;r[e]||(r[e]={meshes:new Set,material:i.outlineMaterial}),t.styleName=e}}drawEdges(e){const t=this.components.get(Aa).styles.list[e];this._edges[e]||this.initializeStyle(e);const i=this._edges[e];let n=0;const r=i.mesh.geometry.attributes.position;r.array.fill(0);const o=[];let a=0;for(const h of t.meshes)if(h.geometry){if(!h.geometry.boundsTree)throw new Error("Bounds tree not found for clipping edges subset.");if(h instanceof Kt){if(h.count===0)continue;const d=h;for(let p=0;p<d.count;p++){const f=d instanceof yf,g=d,v=t.fragments[g.fragment.id];if(f&&v){const T=g.fragment.getItemID(p);if(T===null||!v.has(T))continue}const b=new le(h.geometry);b.matrix.copy(h.matrix);const w=new Ee;d.getMatrixAt(p,w),b.applyMatrix4(w),b.applyMatrix4(h.matrix),b.updateMatrix(),b.updateMatrixWorld(),this._inverseMatrix.copy(b.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(b,r,n),n!==a&&(o.push(n),a=n)}}else this._inverseMatrix.copy(h.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(h,r,n),n!==a&&(o.push(n),a=n)}i.mesh.geometry.setDrawRange(0,n),i.mesh.position.copy(this._plane.normal).multiplyScalar(1e-4),r.needsUpdate=!0;const l=i.mesh.geometry.attributes.position;Number.isNaN(l.array[0])||(i.mesh.parent||this.world.scene.three.add(i.mesh),this.fillNeedsUpdate&&i.fill&&(i.fill.geometry=i.mesh.geometry,i.fill.update(o)))}initializeStyle(e){const t=this.newEdgesMesh(e),i=t.geometry,n=this.newFillMesh(e,i);this._edges[e]={mesh:t,name:e,fill:n}}shapecast(e,t,i){return e.geometry.boundsTree.shapecast({intersectsBounds:n=>this._localPlane.intersectsBox(n),intersectsTriangle:n=>{let r=0;if(this._tempLine.start.copy(n.a),this._tempLine.end.copy(n.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,o.x,o.y,o.z),r++,i++}if(this._tempLine.start.copy(n.b),this._tempLine.end.copy(n.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,o.x,o.y,o.z),r++,i++}if(this._tempLine.start.copy(n.c),this._tempLine.end.copy(n.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,o.x,o.y,o.z),r++,i++}r!==2&&(i-=r)}}),i}updateDeletedEdges(e){const t=Object.keys(this._edges);for(const i of t)e[i]===void 0&&(this.disposeEdge(i),this.disposeOutline(i))}disposeOutline(e){if(!this.world.renderer)return;const t=this.world.renderer;if(t instanceof gh){const i=t.postproduction.customEffects.outlinedMeshes;delete i[e]}}disposeEdge(e){const t=this.components.get(Oi),i=this._edges[e];i.fill&&i.fill.dispose(),t.destroy(i.mesh,!1),delete this._edges[e]}}let Gr=class extends Kf{constructor(e,t,i,n,r,o=5,a=!0){super(e,t,i,n,r,o,a),x(this,"edges"),x(this,"edgesMaxUpdateRate",50),x(this,"_visible",!0),x(this,"_edgesVisible",!0),x(this,"updateFill",()=>{this.edges.fillNeedsUpdate=!0,this.edges.update(),this.edges.visible=this._visible}),this.edges=new sb(e,t,this.three),this.toggleControls(!0),this.edges.visible=!0,this.onDraggingEnded.add(()=>{this.updateFill()}),this.onDraggingStarted.add(()=>this.edges.visible=!1)}get visible(){return this._visible}set visible(e){super.visible=e,this.toggleControls(e)}set enabled(e){this._enabled=e,this.world.renderer&&this.world.renderer.setPlane(e,this.three)}get enabled(){return super.enabled}dispose(){super.dispose(),this.edges.dispose()}};class rb{constructor(){x(this,"onDisposed",new ee),x(this,"enabled",!0),x(this,"list",{}),x(this,"_defaultLineMaterial",new Di({color:0,linewidth:.001})),x(this,"onAfterUpdate",new ee),x(this,"onBeforeUpdate",new ee)}update(e){this.onBeforeUpdate.trigger(this.list),this.onAfterUpdate.trigger(this.list)}create(e,t,i,n,r,o){if(!i.renderer)throw new Error("The given world doesn't have a renderer!");n||(n=this._defaultLineMaterial);for(const h of t)h.geometry.boundsTree||h.geometry.computeBoundsTree();const a=i.renderer;n.clippingPlanes=a.clippingPlanes;const l={name:e,lineMaterial:n,meshes:t,fillMaterial:r,outlineMaterial:o,fragments:{}};return this.list[e]=l,l}dispose(){const e=Object.keys(this.list);for(const t of e)this.deleteStyle(t);this.list={},this.onDisposed.trigger(),this.onDisposed.reset()}deleteStyle(e,t=!0){var i,n;const r=this.list[e];r&&(r.meshes.clear(),t&&(r.lineMaterial.dispose(),(i=r.fillMaterial)==null||i.dispose(),(n=r.outlineMaterial)==null||n.dispose())),delete this.list[e]}}const Um=class km extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"enabled",!0),x(this,"styles"),x(this,"fillsNeedUpdate",!1),x(this,"_visible",!0),this.components.list.set(km.uuid,this),this.styles=new rb}get visible(){return this._visible}set visible(e){this._visible=e;const t=this.components.get(Ga);for(const i of t.list)i instanceof Gr&&(i.edges.visible=e)}dispose(){this.styles.dispose(),this.onDisposed.trigger()}async update(e=!1){if(!this.enabled)return;const t=this.components.get(Ga);for(const i of t.list)i instanceof Gr&&(e||this.fillsNeedUpdate?i.updateFill():i.update());this.fillsNeedUpdate=!1}};x(Um,"uuid","24dfc306-a3c4-410f-8071-babc4afa5e4d");let Aa=Um;const ob={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`},ab={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`},lb=class Is extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"enabled",!0),x(this,"cameraHeight",10),x(this,"darkness",1.2),x(this,"opacity",1),x(this,"resolution",512),x(this,"amount",3.5),x(this,"planeColor",16777215),x(this,"shadowOffset",0),x(this,"shadowExtraScaleFactor",1.5),x(this,"list",{}),x(this,"tempMaterial",new Xt({visible:!1})),x(this,"depthMaterial",new Tf),this.components.add(Is.uuid,this),this.initializeDepthMaterial()}dispose(){for(const e in this.list)this.deleteShadow(e);this.tempMaterial.dispose(),this.depthMaterial.dispose(),this.components=null,this.onDisposed.trigger(Is.uuid),this.onDisposed.reset()}create(e,t,i){if(this.list[t])throw new Error(`There is already a shadow with ID ${t}`);const{size:n,center:r,min:o}=this.getSizeCenterMin(e),a=this.createShadow(t,n,i);return this.initializeShadow(a,r,o),this.createPlanes(a,n),this.bakeShadow(e,a),a.root}deleteShadow(e){const t=this.components.get(Oi),i=this.list[e];if(delete this.list[e],!i)throw new Error(`No shadow with ID ${e} was found.`);t.destroy(i.root),t.destroy(i.blurPlane),i.rt.dispose(),i.rtBlur.dispose()}createPlanes(e,t){const i=new ul(t.x,t.z).rotateX(Math.PI/2);this.createBasePlane(e,i),Is.createBlurPlane(e,i)}initializeShadow(e,t,i){this.initializeRoot(e,t,i),Is.initializeRenderTargets(e),Is.initializeCamera(e)}bakeShadow(e,t){const i=t.world.scene.three;if(!(i instanceof Xn))throw new Error("The core of the scene of the world must be a scene!");if(!t.world.renderer)throw new Error("The given world must have a renderer!");const n=t.world.renderer.three,r=e.map(h=>!!h.parent);for(let h=0;h<e.length;h++)r[h]||i.add(e[h]);const o=i.children.filter(h=>!e.includes(h)&&h!==t.root);for(let h=o.length-1;h>=0;h--)i.remove(o[h]);const a=i.background;i.background=null,i.overrideMaterial=this.depthMaterial;const l=[];for(const h of e)l.push(h.visible),h.visible=!0;n.setRenderTarget(t.rt),n.render(i,t.camera),i.overrideMaterial=null,this.blurShadow(t,this.amount),this.blurShadow(t,this.amount*.4),n.setRenderTarget(null),i.background=a;for(let h=0;h<e.length;h++)e[h].visible=l[h];for(let h=o.length-1;h>=0;h--)i.add(o[h]);for(let h=0;h<e.length;h++)r[h]||i.remove(e[h])}static initializeCamera(e){e.camera.rotation.x=Math.PI/2,e.root.add(e.camera)}static initializeRenderTargets(e){e.rt.texture.generateMipmaps=!1,e.rtBlur.texture.generateMipmaps=!1}initializeRoot(e,t,i){const n=e.world.scene.three;e.root.position.set(t.x,i.y-this.shadowOffset,t.z),n.add(e.root)}createBasePlane(e,t){const i=this.createPlaneMaterial(e),n=new le(t,i);n.renderOrder=2,e.root.add(n),n.scale.y=-1}static createBlurPlane(e,t){e.blurPlane.geometry=t,e.blurPlane.visible=!1,e.root.add(e.blurPlane)}createPlaneMaterial(e){if(!e.world.renderer)throw new Error("The given world must have a renderer!");const t=e.world.renderer.three;return new Xt({map:e.rt.texture,opacity:this.opacity,transparent:!0,depthWrite:!1,clippingPlanes:t.clippingPlanes})}initializeDepthMaterial(){this.depthMaterial.depthTest=!1,this.depthMaterial.depthWrite=!1;const e="gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );",t="gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );";this.depthMaterial.userData.darkness={value:this.darkness},this.depthMaterial.onBeforeCompile=i=>{i.uniforms.darkness=this.depthMaterial.userData.darkness,i.fragmentShader=`
						uniform float darkness;
						${i.fragmentShader.replace(e,t)}
					`}}createShadow(e,t,i){return this.list[e]={root:new Fs,world:i,rt:new Ri(this.resolution,this.resolution),rtBlur:new Ri(this.resolution,this.resolution),blurPlane:new le,camera:this.createCamera(t)},this.list[e]}createCamera(e){return new jn(-e.x/2,e.x/2,e.z/2,-e.z/2,0,this.cameraHeight)}getSizeCenterMin(e){const t=e[0].parent,i=new Fs;i.children=e;const n=new Ke().setFromObject(i);t==null||t.add(...e);const r=new F;n.getSize(r),r.x*=this.shadowExtraScaleFactor,r.z*=this.shadowExtraScaleFactor;const o=new F;n.getCenter(o);const a=n.min;return{size:r,center:o,min:a}}blurShadow(e,t){if(!e.world.renderer)throw new Error("The given world must have a renderer!");const i=new wt(ob);i.depthTest=!1;const n=new wt(ab);n.depthTest=!1,e.blurPlane.visible=!0,e.blurPlane.material=i,e.blurPlane.material.uniforms.tDiffuse.value=e.rt.texture,i.uniforms.h.value=t*1/256;const r=e.world.renderer.three;r.setRenderTarget(e.rtBlur),r.render(e.blurPlane,e.camera),e.blurPlane.material=n,e.blurPlane.material.uniforms.tDiffuse.value=e.rtBlur.texture,n.uniforms.v.value=t*1/256,r.setRenderTarget(e.rt),r.render(e.blurPlane,e.camera),e.blurPlane.visible=!1}};x(lb,"uuid","f833a09a-a3ab-4c58-b03e-da5298c7a1b6");const cb=["Station","Radius","Length","InitialKP","FinalKP","KP","Slope","Height","InitialKPV","FinalKPV"],Bm=class zm extends Re{constructor(e){super(e),x(this,"enabled",!0),x(this,"world",null),x(this,"_list",new Map),x(this,"_markerKey",0),x(this,"type","horizontal"),x(this,"divisionLength",100),e.add(zm.uuid,this)}addKPStation(e,t,i){const n=this.components.get(An),r=document.createElement("div"),o=document.createElement("div");r.appendChild(o),o.innerHTML=t,o.style.color=n.color,o.style.borderBottom="1px dotted white",o.style.width="160px",o.style.textAlign="left";const a=new _t(e,r),l=new F;l.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),l.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),l.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);const h=new F;h.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-2),h.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-2),h.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-2);const d=new F;d.x=(l.x+h.x)/2,d.y=(l.y+h.y)/2,d.z=(l.z+h.z)/2,a.three.position.copy(d);const p=new F;p.subVectors(l,h).normalize();const f=new Vt;f.setFromUnitVectors(new F(0,1,0),p);const g=new gf().setFromQuaternion(f).z,v=so.radToDeg(g);o.style.transform=`rotate(${-v-90}deg) translate(-35%, -50%)`;const b=this._markerKey.toString();n.setupEvents(e,!0),n.getWorldMarkerList(e).set(b,{label:a,key:b,merged:!1,static:!1}),this._markerKey++,this.save(b,"KP")}addVerticalMarker(e,t,i,n,r){const o=this.components.get(An),a=document.createElement("span");a.innerHTML=t,a.style.color=o.color;const l=new _t(e,a,r);if(n==="Height"){const d=document.createElement("span");d.innerHTML=t,d.style.color=o.color;const{position:p}=i.geometry.attributes,f=(p.array.length/3-1)*3,g=p.array.slice(f,f+3);l.three.position.set(g[0],g[1]+10,g[2])}else if(n==="InitialKPV"){const{position:d}=i.geometry.attributes,p=d.getX(0),f=d.getY(0),g=d.getZ(0);l.three.position.set(p-20,f,g)}else if(n==="FinalKPV"){const{position:d}=i.geometry.attributes,p=d.getX(i.geometry.attributes.position.count-1),f=d.getY(i.geometry.attributes.position.count-1),g=d.getZ(i.geometry.attributes.position.count-1);l.three.position.set(p+20,f,g)}else if(n==="Slope"){a.style.color="grey";const{position:d}=i.geometry.attributes,p=new F;p.x=d.getX(0),p.y=d.getY(0),p.z=d.getZ(0);const f=new F;f.x=d.getX(d.count-1),f.y=d.getY(d.count-1),f.z=d.getZ(d.count-1);const g=new F;g.addVectors(p,f).multiplyScalar(.5),l.three.position.set(g.x,g.y-10,g.z)}const h=this._markerKey.toString();return o.setupEvents(e,!0),o.getWorldMarkerList(e).set(h,{label:l,key:h,type:n,merged:!1,static:!1}),this._markerKey++,this.save(h,n),l}addCivilMarker(e,t,i,n){const r=this.components.get(An),o=document.createElement("span");o.innerHTML=t,o.style.color=r.color;const a=new _t(e,o);if(n==="InitialKP"){const h=i.geometry.attributes.position.getX(0),d=i.geometry.attributes.position.getY(0),p=i.geometry.attributes.position.getZ(0);a.three.position.set(h+2,d+2,p)}else if(n==="FinalKP"){const h=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),d=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),p=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);a.three.position.set(h+2,d-2,p)}else if(n==="Length"){const h=new F;h.x=i.geometry.attributes.position.getX(0),h.y=i.geometry.attributes.position.getY(0),h.z=i.geometry.attributes.position.getZ(0);const d=new F;d.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),d.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),d.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);const p=h.distanceTo(d);a.three.element.innerText=p.toFixed(2);const f=d.clone().add(h).divideScalar(2);a.three.position.copy(f)}const l=this._markerKey.toString();return r.setupEvents(e,!0),r.getWorldMarkerList(e).set(l,{label:a,key:l,type:n,merged:!1,static:!1}),this._markerKey++,this.save(l,n),a}showKPStations(e){if(!this.world)throw new Error("A world is needed for this component to work!");if(this.type==="horizontal"){const t=this.generateStartAndEndKP(e);for(const[,n]of t)this.addKPStation(this.world,n.value,n.normal);const i=this.generateConstantKP(e);for(const[,n]of i)this.addKPStation(this.world,n.value,n.normal)}}showCurveLength(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(An),n=e.length,r=`${t.toFixed(2)} m`,o=Math.round(n/2),a=e[o],l=i.create(this.world,r,a,!0);l!==void 0&&this.save(l,"Radius")}showLineLength(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(An),n=new F;n.x=e.geometry.getAttribute("position").getX(0),n.y=e.geometry.getAttribute("position").getY(0),n.z=e.geometry.getAttribute("position").getZ(0);const r=new F;r.x=e.geometry.getAttribute("position").getX(1),r.y=e.geometry.getAttribute("position").getY(1),r.z=e.geometry.getAttribute("position").getZ(1);const o=`${t.toFixed(2)} m`,a=new F;a.addVectors(n,r).multiplyScalar(.5);const l=i.create(this.world,o,a,!0);l!==void 0&&this.save(l,"Radius")}showCurveRadius(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(An),n=new F;n.x=e.geometry.getAttribute("position").getX(0),n.y=e.geometry.getAttribute("position").getY(0),n.z=e.geometry.getAttribute("position").getZ(0);const r=new F;r.x=e.geometry.getAttribute("position").getX(1),r.y=e.geometry.getAttribute("position").getY(1),r.z=e.geometry.getAttribute("position").getZ(1);const o=`R = ${t.toFixed(2)} m`,a=new F;a.addVectors(n,r).multiplyScalar(.5);const l=i.create(this.world,o,a,!0);l!==void 0&&this.save(l,"Radius")}deleteByType(e=cb){const t=this.components.get(An);for(const i of e){const n=this._list.get(i);if(n){for(const r of n)t.delete(r);this._list.delete(i)}}}generateStartAndEndKP(e){const{alignment:t}=e.curve,i=new Map;for(const n of t.horizontal){const r=n.getLength();if(i.size>0){const o=n.index-1,a=i.get(o).distance+r,l=n.mesh.geometry.getAttribute("position"),h=l.count-1,d=new F;d.x=l.getX(h),d.y=l.getY(h),d.z=l.getZ(h);const p=this.createNormalLine(n.mesh);i.set(n.index,{value:this.getShortendKPValue(a),distance:a,point:d,normal:p})}else{const o=n.mesh.geometry.getAttribute("position"),a=o.count-1,l=new F;l.x=o.getX(a),l.y=o.getY(a),l.z=o.getZ(a);const h=this.createNormalLine(n.mesh);i.set(n.index,{value:this.getShortendKPValue(r),distance:r,point:l,normal:h})}}return i}createNormalLine(e){const t=e.geometry.attributes.position.count-1,i=t-1,n=new F;n.x=e.geometry.attributes.position.getX(t),n.y=e.geometry.attributes.position.getY(t),n.z=e.geometry.attributes.position.getZ(t);const r=new F;r.x=e.geometry.attributes.position.getX(i),r.y=e.geometry.attributes.position.getY(i),r.z=e.geometry.attributes.position.getZ(i);const o=new F().subVectors(n,r).clone().applyAxisAngle(new F(0,0,1),Math.PI*.5).normalize(),a=new Ne().setFromPoints([o.clone().setLength(10).add(n),o.clone().setLength(-10).add(n)]);return new st(a)}generateConstantKP(e){const{alignment:t}=e.curve,i=new Map,n=t.getLength("horizontal"),r=Math.floor(n/this.divisionLength);for(let o=0;o<r;o++){const a=o/r,l=t.getPointAt(a,"horizontal"),h=n*a,d=this.getNormal(t,l);i.set(o,{value:this.getShortendKPValue(h),distance:h,point:l,normal:d})}return i}getNormal(e,t){const i=[],n={start:new F,end:new F};for(let a=0;a<e.horizontal.length;a++){const l=e.horizontal[a].mesh.geometry.attributes.position,h=l.count;for(let d=0;d<h;d++){const p=l.getX(d),f=l.getY(d),g=l.getZ(d);i.push(new F(p,f,g))}}for(let a=0;a<i.length-1;a++){const l=i[a],h=i[a+1],d=l.distanceTo(t),p=h.distanceTo(t),f=l.distanceTo(h);Math.abs(d+p-f)<1e-5&&(n.start=l,n.end=h)}const r=new F().subVectors(n.end,n.start).clone().applyAxisAngle(new F(0,0,1),Math.PI*.5).normalize(),o=new Ne().setFromPoints([r.clone().setLength(10).add(t),r.clone().setLength(-10).add(t)]);return new st(o,new Di({color:16711680}))}getShortendKPValue(e){const t=e.toFixed(2),[i,n]=t.toString().split("."),r=n||"00";if(parseInt(i,10)>1e3&&parseInt(i,10)<1e4){const[o,...a]=i;return`${o}+${a.join("")}.${r}`}if(parseInt(i,10)>1e4){const[o,a,...l]=i;return`${o}${a}+${l.join("")}.${r}`}return`0+${i.padStart(3,"0")}.${r}`}save(e,t){this._list.has(t)||this._list.set(t,new Set),this._list.get(t).add(e)}};x(Bm,"uuid","0af12c32-81ee-4100-a030-e9ae546f6170");let Lr=Bm;class Vm extends Re{constructor(e){super(e),x(this,"enabled",!0),x(this,"_highlighter"),x(this,"onHighlight",new ee),x(this,"onMarkerChange",new ee),x(this,"mouseMarkers"),x(this,"onMarkerHidden",new ee),x(this,"_curves",[]),x(this,"_previousAlignment",null),x(this,"_world",null),x(this,"updateLinesResolution",t=>{var i;(i=this._highlighter)==null||i.setResolution(t)}),x(this,"onMouseMove",t=>{var i,n,r;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const o=this._world.renderer.three.domElement.parentElement,a=this._world.camera.three,l=(i=this._highlighter)==null?void 0:i.castRay(t,a,o,this._curves);if(l){const{object:h}=l;(n=this._highlighter)==null||n.hover(h),this.updateMarker(l,"hover");return}this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),(r=this._highlighter)==null||r.unHover(),this.onMarkerHidden.trigger({type:"hover"})}),x(this,"onClick",t=>{var i,n;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const r=this._world.renderer.three.domElement.parentElement,o=this._world.camera.three,a=(i=this._highlighter)==null?void 0:i.castRay(t,o,r,this._curves);if(a){const l=a,h=l.object;if((n=this._highlighter)==null||n.select(h),this.updateMarker(l,"select"),this._world.camera.hasCameraControls()&&(h.geometry.boundingBox||h.geometry.computeBoundingBox(),h.geometry.boundingBox)){const d=this.getScaledBox(h.geometry.boundingBox,2);this._world.camera.controls.fitToBox(d,!0)}this.onHighlight.trigger({mesh:h,point:l.point}),this._previousAlignment!==h.curve.alignment&&(this.components.get(Lr).showKPStations(h),this._previousAlignment=h.curve.alignment)}}),x(this,"onControlsUpdated",()=>{if(!this._world)throw new Error("No world was given for this navigator!");if(!(this._world.camera.three instanceof jn)||!this._highlighter)return;const{zoom:t,left:i,right:n,top:r,bottom:o}=this._world.camera.three,a=i-n,l=r-o,h=Math.max(a,l)/t,d=40,{caster:p}=this._highlighter;p.params.Line.threshold=h/d})}get highlighter(){if(!this._highlighter)throw new Error("Highlighter not initialized. You must set a world first!");return this._highlighter}get world(){return this._world}set world(e){var t,i,n;if(e===this._world||(this._world&&this.setupEvents(!1),this._world=e,(t=this._highlighter)==null||t.dispose(),(i=this.mouseMarkers)==null||i.hover.dispose(),(n=this.mouseMarkers)==null||n.select.dispose(),!e))return;const r=e.scene.three;this._highlighter=new xm(r,this.view),this.mouseMarkers={select:this.newMouseMarker("#ffffff",e),hover:this.newMouseMarker("#575757",e)},this.setupEvents(!0)}async draw(e,t){if(!e.civilData)throw new Error("The provided model doesn't have civil data!");if(!this._world)throw new Error("No world was given for this navigator!");const{alignments:i}=e.civilData,n=t||i.values(),r=this._world.scene.three,o=new Ke;o.makeEmpty(),o.min.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),o.max.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(const l of n){if(!l)throw new Error("Alignment not found!");for(const h of l[this.view])if(r.add(h.mesh),this._curves.push(h.mesh),!o.isEmpty())o.expandByObject(h.mesh);else{h.mesh.geometry.computeBoundingBox();const d=h.mesh.geometry.boundingBox;d instanceof Ke&&o.copy(d).applyMatrix4(h.mesh.matrixWorld)}}const a=this.getScaledBox(o,1.2);this._world.camera.hasCameraControls()&&await this._world.camera.controls.fitToBox(a,!1)}async dispose(){var e;(e=this._highlighter)==null||e.dispose(),this.clear(),this.onHighlight.reset(),this._curves=[]}clear(){var e,t;(e=this._highlighter)==null||e.unSelect(),(t=this._highlighter)==null||t.unHover();for(const i of this._curves)i.removeFromParent();this._curves=[]}setMarker(e,t,i){if(!this._curves.length)return;const n=e.getCurveAt(t,this.view),r=e.getPointAt(t,this.view),{index:o}=n.curve.getSegmentAt(n.percentage);this.setMouseMarker(r,n.curve.mesh,o,i)}setDefSegments(e){const t=[],i=[],n=(r,o)=>{const a=o[1]-r[1],l=o[0]-r[0];return a/l};for(let r=0;r<e.length;r++){const o=e[r];let a,l,h,d;for(let f=0;f<Object.keys(o).length/3;f++)if(o[f*3]!==void 0&&o[f*3+1]!==void 0){a=o[f*3],l=o[f*3+1];break}for(let f=Object.keys(o).length/3-1;f>=0;f--)if(o[f*3]!==void 0&&o[f*3+1]!==void 0){h=o[f*3],d=o[f*3+1];break}const p=(n([a,l],[h,d])*100).toFixed(2);i.push({slope:p})}for(const r of e)for(let o=0;o<r.length-3;o+=3){const a=r[o],l=r[o+1],h=r[o+2],d=r[o+3],p=r[o+4],f=r[o+5];t.push({start:new F(a,l,h),end:new F(d,p,f)})}return{defSegments:t,slope:i}}hideMarker(e){this.mouseMarkers&&(this.mouseMarkers[e].visible=!1)}setupEvents(e){var t,i;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const n=this._world.renderer.three.domElement.parentElement;(t=this._world.renderer)==null||t.onResize.remove(this.updateLinesResolution),n.removeEventListener("mousemove",this.onMouseMove),n.removeEventListener("click",this.onClick),this._world.camera.hasCameraControls()&&this._world.camera.controls.removeEventListener("update",this.onControlsUpdated),e&&(n.addEventListener("mousemove",this.onMouseMove),n.addEventListener("click",this.onClick),(i=this._world.renderer)==null||i.onResize.add(this.updateLinesResolution),this._world.camera.hasCameraControls()&&this._world.camera.controls.addEventListener("update",this.onControlsUpdated))}newMouseMarker(e,t){if(!this._world)throw new Error("No world was given for this navigator!");const i=t.scene.three,n=document.createElement("div"),r=document.createElement("div");n.appendChild(r),r.style.backgroundColor=e,r.style.width="3rem",r.style.height="3px";const o=new _t(this._world,n,i);return o.visible=!1,o}setMouseMarker(e,t,i,n){if(i===void 0||!this.mouseMarkers)return;this.mouseMarkers[n].visible=!0;const r=this.mouseMarkers[n].three;r.position.copy(e);const o=t,{startPoint:a,endPoint:l}=o.curve.getSegment(i),h=Math.atan2(l.y-a.y,l.x-a.x),d=r.element.children[0],p=90-h/Math.PI*180;d.style.transform=`rotate(${p}deg)`}updateMarker(e,t){const{point:i,index:n,object:r}=e,o=r,a=o.curve,l=o.curve.alignment,h=l.getPercentageAt(i,this.view),d=i.clone();this.setMouseMarker(d,o,n,t),h!==null&&this.onMarkerChange.trigger({alignment:l,percentage:h,type:t,curve:a})}getScaledBox(e,t){const i=new Ke,n=new F,r=new F;return e.getCenter(r),e.getSize(n),n.multiplyScalar(t),i.setFromCenterAndSize(r,n),i}}class hb{constructor(e,t,i){x(this,"components"),x(this,"_scene"),x(this,"_world"),x(this,"offset",10),x(this,"markupLines",[]),x(this,"currentCurveMesh"),x(this,"markupMaterial",new Di({color:6842472})),this.components=e,this._scene=t,this._world=i}showCurveInfo(e){switch(this.disposeMarkups(),this.currentCurveMesh=e,e.curve.data.TYPE){case"LINE":this.showLineInfo(e,this.offset);break;case"CIRCULARARC":this.showCircularArcInfo(e,this.offset);break;case"CLOTHOID":this.showClothoidInfo(e,this.offset);break;default:console.log("Unknown curve type:",e.curve.data.TYPE);break}}updateOffset(e,t,i){const n=Math.max(e.height,e.width)/(t*150);n!==this.offset&&(this.offset=n,i&&this.currentCurveMesh&&this.showCurveInfo(this.currentCurveMesh))}dispose(){for(const e of this.markupLines)e.removeFromParent();this.disposeMarkups(),this.markupMaterial.dispose()}disposeMarkups(){for(const e of this.markupLines)e.geometry.dispose(),e.removeFromParent();this.markupLines=[]}unSelect(){this.disposeMarkups()}calculateTangent(e,t){const i=t*3,n=Math.max(0,i-3),r=Math.min(e.length-3,i+3),o=new F().fromArray(e,n);return new F().fromArray(e,r).clone().sub(o).normalize()}calculateParallelCurve(e,t,i){const n=[];for(let r=0;r<t;r++){const o=this.calculateTangent(e,r).clone().applyAxisAngle(new F(0,0,1),Math.PI/2);o.normalize();const a=o.clone().multiplyScalar(i),l=r*3,h=new F().fromArray(e,l).add(a);n.push(h)}return n}calculateDimensionLines(e,t){const i=[],n=e.geometry.attributes.position.array,r=t.geometry.attributes.position.array;if(n.length<6&&r.length<6)throw new Error("Line must have at least two vertices");const o=new F(n[0],n[1],n[2]),a=new F(r[0],r[1],r[2]),l=[],h=n.length-3,d=new F(n[h],n[h+1],n[h+2]),p=r.length-3,f=new F(r[p],r[p+1],r[p+2]);return i.push(o,a),l.push(d,f),{startDimensionPoints:i,endDimensionPoints:l}}offsetDimensionLine(e,t){const i=new F().copy(e[e.length-1]).sub(e[0]).normalize().clone().multiplyScalar(t);return e.map(n=>n.clone().add(i))}showLineInfo(e,t){const i=this.components.get(Lr);i.world=this._world,i.deleteByType(["Length","Radius"]);const n=e.geometry.attributes.position.array,r=this.calculateParallelCurve(n,n.length/3,t),o=new Ne().setFromPoints(r),a=new st(o,this.markupMaterial);i.showLineLength(a,e.curve.getLength()),this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:l,endDimensionPoints:h}=this.calculateDimensionLines(e,a),d=this.offsetDimensionLine(l,t*.1),p=this.offsetDimensionLine(h,t*.1),f=new Ne().setFromPoints(d),g=new Ne().setFromPoints(p),v=new st(f,this.markupMaterial);this._scene.add(v),this.markupLines.push(v);const b=new st(g,this.markupMaterial);this._scene.add(b),this.markupLines.push(b)}showClothoidInfo(e,t){const i=this.components.get(Lr);i.world=this._world,i.deleteByType(["Length","Radius"]);const n=e.geometry.attributes.position.array,r=this.calculateParallelCurve(n,n.length/3,t),o=new Ne().setFromPoints(r);i.showCurveLength(r,e.curve.getLength());const a=new st(o,this.markupMaterial);this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:l,endDimensionPoints:h}=this.calculateDimensionLines(e,a),d=this.offsetDimensionLine(l,t*.1),p=this.offsetDimensionLine(h,t*.1),f=new Ne().setFromPoints(d),g=new Ne().setFromPoints(p),v=new st(f,this.markupMaterial);this._scene.add(v),this.markupLines.push(v);const b=new st(g,this.markupMaterial);this._scene.add(b),this.markupLines.push(b)}showCircularArcInfo(e,t){const i=this.components.get(Lr);i.world=this._world,i.deleteByType(["Length","Radius"]);const n=e.curve.data.RADIUS,r=e.geometry.attributes.position.array,o=e.geometry.attributes.position.count,a=[],l=new F(r[0],r[1],r[2]),h=(o-1)*3,d=new F(r[h],r[h+1],r[h+2]),p=o/2*3,f=new F(r[p],r[p+1],r[p+2]),g=d.clone().sub(l).normalize(),v=new F(-g.y,g.x,0);v.multiplyScalar(n);const b=f.clone().add(v);a.push(f),a.push(b);const w=new Ne().setFromPoints(a),T=new st(w,this.markupMaterial);i.showCurveRadius(T,Math.abs(n)),this._scene.add(T),this.markupLines.push(T);const S=[];for(let ne=0;ne<o;ne++){const oe=this.calculateTangent(r,ne),ve=e.curve.data.RADIUS,re=new F(oe.y,-oe.x,0);re.normalize(),ve<0&&re.negate();const ge=re.clone().multiplyScalar(t),me=ne*3,we=new F(r[me]+ge.x,r[me+1]+ge.y,r[me+2]+ge.z);S.push(we)}const _=new Ne().setFromPoints(S);i.showCurveLength(S,e.curve.getLength());const I=new st(_,this.markupMaterial);this._scene.add(I),this.markupLines.push(I);const{startDimensionPoints:P,endDimensionPoints:M}=this.calculateDimensionLines(e,I),k=this.offsetDimensionLine(P,t*.1),V=this.offsetDimensionLine(M,t*.1),W=new Ne().setFromPoints(k),j=new Ne().setFromPoints(V),Q=new st(W,this.markupMaterial);this._scene.add(Q),this.markupLines.push(Q);const $=new st(j,this.markupMaterial);this._scene.add($),this.markupLines.push($)}}const ub=class Hm extends Vm{constructor(e){super(e),x(this,"view","horizontal"),x(this,"planHighlighter"),this.components.add(Hm.uuid,this),this.onHighlight.add(({mesh:t})=>{!this._highlighter||!this.planHighlighter||this.planHighlighter.showCurveInfo(t)})}get world(){return super.world}set world(e){var t;super.world=e,e&&((t=this.planHighlighter)==null||t.dispose(),this.planHighlighter=new hb(this.components,e.scene.three,e))}};x(ub,"uuid","3096dea0-5bc2-41c7-abce-9089b6c9431b");const db=class Ym extends Vm{constructor(e){super(e),x(this,"view","vertical"),x(this,"enabled",!0),this.components.add(Ym.uuid,this)}get world(){return super.world}set world(e){this.world!==e&&(super.world=e,this._highlighter&&this._highlighter.onSelect.add(t=>{if(!this.world)throw new Error("A world is needed to work with this component!");const i=this.components.get(Lr);i.deleteByType(["Slope","Height","InitialKPV","FinalKPV"]);const{alignment:n}=t.curve,r=[];for(const h of n.vertical){const d=h.mesh.geometry.attributes.position.array;r.push(d)}const{defSegments:o,slope:a}=this.setDefSegments(r),l=this.world.scene.three;for(let h=0;h<n.vertical.length;h++){const d=n.vertical[h];i.addVerticalMarker(this.world,`S: ${a[h].slope}%`,d.mesh,"Slope",l),i.addVerticalMarker(this.world,`H: ${o[h].end.y.toFixed(2)}`,d.mesh,"Height",l)}i.addVerticalMarker(this.world,"KP: 0",n.vertical[0].mesh,"InitialKPV",l),i.addVerticalMarker(this.world,`KP: ${n.vertical.length}`,n.vertical[n.vertical.length-1].mesh,"FinalKPV",l)}))}};x(db,"uuid","097eea29-2d5a-431a-a247-204d44670621");const pb=class Gm extends Re{constructor(e){super(e),x(this,"onHighlight",new ee),x(this,"enabled",!0),x(this,"_highlighter"),x(this,"mouseMarkers"),x(this,"onMarkerChange",new ee),x(this,"onMarkerHidden",new ee),x(this,"_curves",[]),x(this,"_world",null),x(this,"updateLinesResolution",t=>{var i;(i=this.highlighter)==null||i.setResolution(t)}),x(this,"onClick",t=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,n=this.world.camera.three,r=this._highlighter.castRay(t,n,i,this._curves);if(r){const o=r.object;this._highlighter.select(o),this.updateMarker(r,"select");const{point:a,index:l}=r;l!==void 0&&this.onHighlight.trigger({curve:o,point:a,index:l});return}this._highlighter.unSelect(),this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),this.onMarkerHidden.trigger({type:"hover"})}),x(this,"onMouseMove",async t=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,n=this.world.camera.three,r=this._highlighter.castRay(t,n,i,this._curves);if(r){this._highlighter.hover(r.object),this.updateMarker(r,"hover");return}this._highlighter.unHover()}),this.components.add(Gm.uuid,this)}get world(){return this._world}set world(e){var t,i,n;if(e===this._world||(this._world&&this.setupEvents(!1),this._world=e,(t=this._highlighter)==null||t.dispose(),(i=this.mouseMarkers)==null||i.hover.dispose(),(n=this.mouseMarkers)==null||n.select.dispose(),!e))return;const r=e.scene.three;this._highlighter=new xm(r,"absolute"),this.mouseMarkers={select:this.newMouseMarker("#ffffff",e),hover:this.newMouseMarker("#575757",e)},this.setupEvents(!0)}get highlighter(){if(!this._highlighter)throw new Error("Navigator not initialized!");return this._highlighter}draw(e){if(!e.civilData)throw new Error("Model must have civil data!");if(!this.world)throw new Error("A world must be given before drawing an alignment!");const t=this.world.scene.three;for(const[i,n]of e.civilData.alignments)for(const{mesh:r}of n.absolute)t.add(r),this._curves.push(r)}newMouseMarker(e,t){const i=t.scene.three,n=document.createElement("div");n.style.backgroundColor=e,n.style.width="1rem",n.style.height="1rem",n.style.borderRadius="1rem";const r=new _t(t,n,i);return r.visible=!1,r}setMarker(e,t,i){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const n=e.getPointAt(t,"absolute");this.mouseMarkers[i].visible=!0,this.mouseMarkers[i].three.position.copy(n)}hideMarker(e){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const t=this.mouseMarkers[e].three;t.visible=!1}setupEvents(e){var t,i;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const n=this.world.renderer.three.domElement;(t=this.world.renderer)==null||t.onResize.remove(this.updateLinesResolution),n.removeEventListener("click",this.onClick),n.removeEventListener("mousemove",this.onMouseMove),e&&(n.addEventListener("click",this.onClick),n.addEventListener("mousemove",this.onMouseMove),(i=this.world.renderer)==null||i.onResize.add(this.updateLinesResolution))}updateMarker(e,t){if(!this.mouseMarkers)return;const{point:i,object:n}=e,r=n,o=r.curve,a=r.curve.alignment,l=a.getPercentageAt(i,"absolute");this.mouseMarkers[t].visible=!0,this.mouseMarkers[t].three.position.copy(i),l!==null&&this.onMarkerChange.trigger({alignment:a,percentage:l,type:t,curve:o})}};x(pb,"uuid","0a59c09e-2b49-474a-9320-99f51f40f182");const fb=class jm extends Re{constructor(e){super(e),x(this,"world",null),x(this,"enabled",!0),x(this,"plane"),x(this,"_world3D",null),this.components.add(jm.uuid,this)}get world3D(){return this._world3D}set world3D(e){var t;if(this._world3D=e,(t=this.plane)==null||t.dispose(),!e)return;const i=this.components.get(Ga),n=i.Type;i.Type=Gr,this.plane=i.createFromNormalAndCoplanarPoint(e,new F(1,0,0),new F),i.Type=n,this.plane.visible=!1,this.plane.enabled=!1}async set(e,t){if(!this.world||!this.plane)throw new Error("You must set a world before using this component");this.plane.enabled=!0;const i=e.curve.getPercentageAt(t);if(i===null)return;const{startPoint:n,endPoint:r}=e.curve.getSegmentAt(i);if(e.geometry.index===null)throw new Error("Geometry must be indexed!");const o=new F;o.subVectors(r,n),o.normalize(),this.plane.setFromNormalAndCoplanarPoint(o,t),this.plane.edges.update();const a=this.plane.helper.matrix.clone();a.invert();const l=this.world.scene.three,h=this.plane.edges.get();for(const d in h){const{mesh:p}=h[d];p.position.set(0,0,0),p.rotation.set(0,0,0),p.updateMatrix(),p.applyMatrix4(a),p.parent!==l&&l.add(p)}this.plane.enabled=!1}};x(fb,"uuid","96b2c87e-d90b-4639-8257-8f01136fe324");function zn(){const s=document.createElement("div");return s.style.backgroundColor="black",s.style.color="white",s.style.padding="8px",s.style.borderRadius="8px",s.style.fontFamily="sans-serif",s}const vh=class yh{constructor(e,t,i){x(this,"label"),x(this,"boundingBox",new le),x(this,"world"),x(this,"components"),x(this,"_length"),x(this,"_visible",!0),x(this,"_start"),x(this,"_end"),x(this,"_root",new Fs),x(this,"_endpoints",[]),x(this,"_line"),this.components=e,this.world=t,this._start=i.start,this._end=i.end,this._length=this.getLength(),this._line=this.createLine(i),this.newEndpointElement(i.endpointElement),this.newEndpointElement(i.endpointElement.cloneNode(!0)),this.label=this.newText(),this._root.renderOrder=2,this.world.scene.three.add(this._root)}get visible(){return this._visible}set visible(e){this._visible=e,this.label.visible=e,this._endpoints[0].visible=e,this._endpoints[1].visible=e;const[t,i]=this._endpoints,n=t.three,r=i.three,o=this.label.three;e?(this.world.scene.three.add(this._root),this._root.add(o,n,r)):(o.removeFromParent(),n.removeFromParent(),r.removeFromParent(),this._root.removeFromParent())}get endPoint(){return this._end}set endPoint(e){this._end=e;const t=this._line.geometry.attributes.position;t.setXYZ(1,e.x,e.y,e.z),t.needsUpdate=!0,this._endpoints[1].three.position.copy(e),this.updateLabel()}get startPoint(){return this._start}set startPoint(e){this._start=e;const t=this._line.geometry.attributes.position;t.setXYZ(0,e.x,e.y,e.z),t.needsUpdate=!0,this._endpoints[0].three.position.copy(e),this.updateLabel()}get _center(){let e=this._end.clone().sub(this._start);const t=e.length()*.5;return e=e.normalize().multiplyScalar(t),this._start.clone().add(e)}dispose(){const e=this.components.get(Oi);this.visible=!1,e.destroy(this._root),e.destroy(this._line);for(const t of this._endpoints)t.dispose();this._endpoints.length=0,this.label.dispose(),this.boundingBox&&e.destroy(this.boundingBox),this.components=null}createBoundingBox(){this.boundingBox.geometry=new ut(1,1,this._length),this.boundingBox.position.copy(this._center),this.boundingBox.lookAt(this._end),this.boundingBox.visible=!1,this._root.add(this.boundingBox)}toggleLabel(){this.label.toggleVisibility()}newEndpointElement(e){const t=this._endpoints.length===0?this._start:this._end,i=new _t(this.world,e);i.three.position.copy(t),this._endpoints.push(i),this._root.add(i.three)}updateLabel(){this._length=this.getLength(),this.label.three.element.textContent=this.getTextContent(),this.label.three.position.copy(this._center),this._line.computeLineDistances()}createLine(e){const t=new Ne;t.setFromPoints([e.start,e.end]);const i=new st(t,e.lineMaterial);return this._root.add(i),i}newText(){const e=zn();e.textContent=this.getTextContent();const t=new _t(this.world,e);return t.three.position.copy(this._center),this._root.add(t.three),t}getTextContent(){return`${this._length/yh.scale} ${yh.units}`}getLength(){return parseFloat(this._start.distanceTo(this._end).toFixed(2))}};x(vh,"scale",1),x(vh,"units","m");let au=vh;class mb{constructor(e,t,i){x(this,"enabled",!0),x(this,"visible",!0),x(this,"points",[]),x(this,"workingPlane",null),x(this,"labelMarker"),x(this,"world"),x(this,"components"),x(this,"onDisposed",new ee),x(this,"_rotationMatrix",null),x(this,"_dimensionLines",[]),x(this,"_defaultLineMaterial",new Di({color:"red"})),x(this,"onAreaComputed",new ee),x(this,"onWorkingPlaneComputed",new ee),x(this,"onPointAdded",new ee),x(this,"onPointRemoved",new ee),this.world=t,this.components=e;const n=zn();this.labelMarker=new _t(t,n),this.labelMarker.visible=!1,this.onPointAdded.add(r=>{this.points.length===3&&!this._dimensionLines[2]&&(this.addDimensionLine(r,this.points[0]),this.labelMarker.visible=!0)}),i==null||i.forEach(r=>this.setPoint(r))}setPoint(e,t){let i;if(t?i=t:i=this.points.length===0?0:this.points.length,i===0){this.points[0]=e;return}if(i<0||i>this.points.length)return;const n=this.points.length>i;this.points[i]=e,this.onPointAdded.trigger(e),n||this.addDimensionLine(this.points[i-1],e);const{previousLine:r,nextLine:o}=this.getLinesBetweenIndex(i);r&&(r.endPoint=e),o&&(o.startPoint=e)}removePoint(e){if(this.points.length===3)return;this.points.splice(e,1);const{previousLine:t,nextLine:i}=this.getLinesBetweenIndex(e);i&&(t.endPoint=i.endPoint),i==null||i.dispose(),this._dimensionLines.splice(e,1),this.onPointRemoved.trigger()}toggleLabel(){this.labelMarker.toggleVisibility()}addDimensionLine(e,t){const i=document.createElement("div");i.className="w-2 h-2 bg-red-600 rounded-full";const n=new au(this.components,this.world,{start:e,end:t,lineMaterial:this._defaultLineMaterial,endpointElement:i});return n.toggleLabel(),this._dimensionLines.length>1?this._dimensionLines.splice(this._dimensionLines.length-1,0,n):this._dimensionLines.push(n),n}getLinesBetweenIndex(e){const t=e===0?this._dimensionLines.length-1:e-1,i=this._dimensionLines[t],n=this._dimensionLines[e];return{previousLine:i,nextLine:n}}computeWorkingPlane(){this.workingPlane=new an().setFromCoplanarPoints(this.points[0],this.points[1],this.points[2]);const e=new F(0,1,0),t=this.workingPlane.normal.angleTo(e),i=new F().crossVectors(this.workingPlane.normal,e).normalize();this._rotationMatrix=new Ee().makeRotationAxis(i,t),this.onWorkingPlaneComputed.trigger(this.workingPlane)}computeArea(){if(!(this._rotationMatrix&&this.workingPlane))return this.onAreaComputed.trigger(0),0;let e=0,t=0;const i=this._rotationMatrix,n=this.points.map(o=>{const a=o.clone().applyMatrix4(i),l=new Ve(a.x,a.z);return e+=l.x,t+=l.y,l}),r=Math.abs(Rv.area(n));return this.labelMarker.three.element.textContent=`${r.toFixed(2)} m²`,this.labelMarker.three.position.set(e/n.length,-this.workingPlane.constant,t/n.length).applyMatrix4(i.clone().invert()),this.onAreaComputed.trigger(r),r}dispose(){this.onAreaComputed.reset(),this.onWorkingPlaneComputed.reset(),this.onPointAdded.reset(),this.onPointRemoved.reset();for(const e of this._dimensionLines)e.dispose();this.labelMarker.dispose(),this._dimensionLines=[],this.points=[],this._rotationMatrix=null,this.workingPlane=null,this._defaultLineMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return{points:this.points,workingPlane:this.workingPlane,area:this.computeArea()}}}let lu=class extends x1{constructor(){super(...arguments),x(this,"onDisposed",new ee),x(this,"marker",null)}dispose(){this.marker&&this.marker.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(e){const t=super.get(e);return t?(this.marker||(this.marker=new _t(e)),this.marker.world!==e&&(this.marker.world=e,this.marker.three.removeFromParent(),e.scene.three.add(this.marker.three)),this.marker.visible=!0,this.marker.three.position.copy(t)):this.marker&&(this.marker.visible=!1),t}};const gb=class Eh extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"list",[]),x(this,"world"),x(this,"_enabled",!1),x(this,"_vertexPicker"),x(this,"_currentAreaElement",null),x(this,"_clickCount",0),x(this,"create",()=>{if(!this.enabled)return;if(!this.world)throw new Error("World not defined for the area measurement!");const t=this._vertexPicker.get(this.world);if(t){if(!this._currentAreaElement){const i=new mb(this.components,this.world);i.onPointAdded.add(()=>{this._clickCount===3&&!i.workingPlane&&(i.computeWorkingPlane(),this._vertexPicker.workingPlane=i.workingPlane)}),i.onPointRemoved.add(()=>this._clickCount--),this._currentAreaElement=i}this._currentAreaElement.setPoint(t,this._clickCount),this._currentAreaElement.computeArea(),this._clickCount++}}),x(this,"onMouseMove",()=>{if(!this.world){console.log("No world given for the area measurement!");return}const t=this._vertexPicker.get(this.world);t&&this._currentAreaElement&&(this._currentAreaElement.setPoint(t,this._clickCount),this._currentAreaElement.computeArea())}),x(this,"onKeydown",t=>{this.enabled&&(t.key==="z"&&t.ctrlKey&&this._currentAreaElement&&this._currentAreaElement.removePoint(this._clickCount-1),t.key==="Enter"&&this._currentAreaElement&&this.endCreation(),t.key==="Escape"&&(this._clickCount===0&&!this._currentAreaElement?this.enabled=!1:this.cancelCreation()))}),this.components.add(Eh.uuid,this),this._vertexPicker=new lu(e)}set enabled(e){this._enabled=e,this._vertexPicker.enabled=e,this.setupEvents(e),e||this.cancelCreation()}get enabled(){return this._enabled}set workingPlane(e){this._vertexPicker.workingPlane=e}get workingPlane(){return this._vertexPicker.workingPlane}dispose(){this.setupEvents(!1),this._vertexPicker.dispose(),this._currentAreaElement&&this._currentAreaElement.dispose();for(const e of this.list)e.dispose();this.components=null,this.onDisposed.trigger(Eh.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const e of this.list)e.dispose();this.list=[]}endCreation(){this._currentAreaElement&&(this.list.push(this._currentAreaElement),this._currentAreaElement.removePoint(this._clickCount),this._currentAreaElement.computeWorkingPlane(),this._currentAreaElement.computeArea(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0}cancelCreation(){this._currentAreaElement&&(this._currentAreaElement.dispose(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0}setupEvents(e){if(!this.world)throw new Error("The area measurement needs a world to work!");if(!this.world.renderer)throw new Error("The world of the area measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("click",this.create),t.addEventListener("mousemove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("click",this.create),t.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}};x(gb,"uuid","c453a99e-f054-4781-9060-33df617db4a5");class vb{constructor(e,t){x(this,"enabled",!0),x(this,"visible",!0),x(this,"points",[]),x(this,"world"),x(this,"onDisposed",new ee),x(this,"_lineMaterial",new ro({color:6629591,linewidth:2})),x(this,"_lineGeometry",new Wa),x(this,"_line",new Im(this._lineGeometry,this._lineMaterial)),x(this,"_labelMarker"),x(this,"onAngleComputed",new ee),x(this,"onPointAdded",new ee),this.world=e;const i=zn();this._labelMarker=new _t(e,i),this.labelMarker.visible=!0,this.onPointAdded.add(()=>{this.points.length===1&&e.scene.three.add(this._line),this.points.length===3&&(this.labelMarker.visible=!0)}),this.onAngleComputed.add(n=>{this.labelMarker.three.element.textContent=`${n.toFixed(2)}°`,this.labelMarker.three.position.copy(this.points[1]??new F)}),t==null||t.forEach(n=>this.setPoint(n))}set lineMaterial(e){this._lineMaterial.dispose(),this._lineMaterial=e,this._line.material=e,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get lineMaterial(){return this._lineMaterial}set labelMarker(e){this._labelMarker.dispose(),this._labelMarker=e}get labelMarker(){return this._labelMarker}get angle(){return{points:this.points,angle:this.computeAngle()}}setPoint(e,t){let i;if(t?i=t:i=this.points.length===0?0:this.points.length,![0,1,2].includes(i))return;this.points[i]=e,this.onPointAdded.trigger(e);const n=this.points.map(r=>[r.x,r.y,r.z]);this._lineGeometry.setPositions(n.flat())}toggleLabel(){this.labelMarker.toggleVisibility()}computeAngle(){const e=this.points[0],t=this.points[1],i=this.points[2];if(!(e&&t&&i))return 0;const n=new F().subVectors(t,e),r=new F().subVectors(t,i),o=so.radToDeg(n.angleTo(r));return this.onAngleComputed.trigger(o),o}dispose(){this.points=[],this.labelMarker.dispose(),this.onAngleComputed.reset(),this.onPointAdded.reset(),this.labelMarker.dispose(),this._line.removeFromParent(),this._lineMaterial.dispose(),this._lineGeometry.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}}const yb=class bh extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"world"),x(this,"list",[]),x(this,"_lineMaterial"),x(this,"_enabled",!1),x(this,"_vertexPicker"),x(this,"_currentAngleElement",null),x(this,"_clickCount",0),x(this,"create",()=>{if(!this.enabled)return;if(!this.world){console.log("No world selected for angle measurement!");return}const t=this._vertexPicker.get(this.world);if(t){if(!this._currentAngleElement){const i=new vb(this.world);i.lineMaterial=this.lineMaterial,this._currentAngleElement=i}this._currentAngleElement.setPoint(t,this._clickCount),this._currentAngleElement.setPoint(t,this._clickCount+1),this._currentAngleElement.setPoint(t,this._clickCount+2),this._currentAngleElement.computeAngle(),this._clickCount++,this._clickCount===3&&this.endCreation()}}),x(this,"onMouseMove",()=>{if(!this.world){console.log("No world selected for angle measurement!");return}const t=this._vertexPicker.get(this.world);t&&this._currentAngleElement&&(this._currentAngleElement.setPoint(t,this._clickCount),this._currentAngleElement.computeAngle())}),x(this,"onKeyDown",t=>{this.enabled&&(t.key==="z"&&t.ctrlKey&&this._currentAngleElement,t.key==="Escape"&&(this._clickCount===0&&!this._currentAngleElement?this.enabled=!1:this.cancelCreation()))}),this.components.add(bh.uuid,this),this._vertexPicker=new lu(e),this._lineMaterial=new ro({color:6629591,linewidth:2})}set lineMaterial(e){this._lineMaterial.dispose(),this._lineMaterial=e,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get lineMaterial(){return this._lineMaterial}set enabled(e){this._enabled=e,this.setupEvents(e),this._vertexPicker.enabled=e,e||this.cancelCreation()}get enabled(){return this._enabled}set workingPlane(e){this._vertexPicker.workingPlane=e}get workingPlane(){return this._vertexPicker.workingPlane}dispose(){this.setupEvents(!1),this._lineMaterial.dispose(),this._vertexPicker.dispose();for(const e of this.list)e.dispose();this._currentAngleElement&&this._currentAngleElement.dispose(),this.components=null,this.onDisposed.trigger(bh.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const e of this.list)e.dispose();this.list=[]}endCreation(){this._currentAngleElement&&(this.list.push(this._currentAngleElement),this._currentAngleElement.computeAngle(),this._currentAngleElement=null),this._clickCount=0}cancelCreation(){this._currentAngleElement&&(this._currentAngleElement.dispose(),this._currentAngleElement=null),this._clickCount=0}setupEvents(e){if(!this.world)throw new Error("No world selected for angle measurement!");if(!this.world.renderer)throw new Error("The given world doesn't have a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("click",this.create),t.addEventListener("mousemove",this.onMouseMove),window.addEventListener("keydown",this.onKeyDown)):(t.removeEventListener("click",this.create),t.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeyDown))}};x(yb,"uuid","622fb2c9-528c-4b0a-8a0e-6a1375f0a3aa");const Wm=class wh extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"onBeforeUpdate",new ee),x(this,"onAfterUpdate",new ee),x(this,"snapDistance",.25),x(this,"_vertexPicker"),x(this,"_lineMaterial",new Di({color:"#DC2626",linewidth:2,depthTest:!1})),x(this,"list",[]),x(this,"world"),x(this,"_visible",!0),x(this,"_enabled",!1),x(this,"_temp",{isDragging:!1,start:new F,end:new F,dimension:void 0}),x(this,"create",t=>{const i=t instanceof kn?t:void 0;if(this._enabled){if(!this._temp.isDragging){this.drawStart(i);return}this.endCreation()}}),x(this,"onMouseMove",()=>{this.world&&this._vertexPicker.get(this.world)}),this.components.add(wh.uuid,this),this._vertexPicker=new lu(e,{previewElement:zn(),snapDistance:this.snapDistance})}get enabled(){return this._enabled}set enabled(e){e||this.cancelCreation(),this._enabled=e,this._vertexPicker.enabled=e,this.setupEvents(e)}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this.list)t.visible=e}get color(){return this._lineMaterial.color}set color(e){this._lineMaterial.color=e}dispose(){this.setupEvents(!1),this.enabled=!1;for(const e of this.list)e.dispose();this._lineMaterial.dispose(),this.list=[],this._vertexPicker.dispose(),this.onDisposed.trigger(wh.uuid),this.onDisposed.reset()}async update(e){this._enabled&&this._temp.isDragging&&this.drawInProcess()}createOnPoints(e,t){const i=this.drawDimension();i.startPoint=e,i.endPoint=t,i.createBoundingBox(),this.list.push(i)}delete(){if(!this.world)throw new Error("World is needed for Length Measurement!");if(!this._enabled||this.list.length===0)return;const e=this.getBoundingBoxes(),t=this.components.get(ni).get(this.world).castRay(e);if(!t)return;const i=this.list.find(n=>n.boundingBox===t.object);if(i){const n=this.list.indexOf(i);this.list.splice(n,1),i.dispose()}}async deleteMeasurement(e){if(e){const t=this.list.indexOf(e);this.list.splice(t,1),e.dispose()}}deleteAll(){for(const e of this.list)e.dispose();this.list=[]}cancelCreation(){var e;this._temp.dimension&&(this._temp.isDragging=!1,(e=this._temp.dimension)==null||e.dispose(),this._temp.dimension=void 0)}drawStart(e){if(!this.world)throw new Error("The length measurement needs a world to work!");const t=e?[e]:void 0,i=this.components.get(ni).get(this.world).castRay(t),n=this._vertexPicker.get(this.world);i&&n&&(this._temp.isDragging=!0,this._temp.start=e?i.point:n)}drawInProcess(){if(!this.world)throw new Error("The length measurement needs a world to work!");if(!this.components.get(ni).get(this.world).castRay())return;const e=this._vertexPicker.get(this.world);e&&(this._temp.end=e,this._temp.dimension||(this._temp.dimension=this.drawDimension()),this._temp.dimension.endPoint=this._temp.end)}endCreation(){this._temp.dimension&&(this._temp.dimension.createBoundingBox(),this.list.push(this._temp.dimension),this._temp.dimension=void 0,this._temp.isDragging=!1)}drawDimension(){if(!this.world)throw new Error("The length measurement needs a world to work!");return new au(this.components,this.world,{start:this._temp.start,end:this._temp.end,lineMaterial:this._lineMaterial,endpointElement:zn()})}getBoundingBoxes(){return this.list.map(e=>e.boundingBox).filter(e=>e!==void 0)}setupEvents(e){if(!this.world)throw new Error("The length measurement needs a world to work!");if(!this.world.renderer)throw new Error("The world of the length measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;t&&(t.removeEventListener("click",this.create),e&&t.addEventListener("mousemove",this.onMouseMove))}};x(Wm,"uuid","2f9bcacf-18a9-4be6-a293-e898eae64ea1");let _r=Wm;const Eb=class Xm extends Re{constructor(e){super(e),x(this,"label",null),x(this,"world"),x(this,"onVolumeFound",new ee),x(this,"_enabled",!1),x(this,"onDisposed",new ee),x(this,"create",()=>{if(!this.enabled)return;if(!this.world)throw new Error("World is needed for Volume Measurement!");const t=this.components.get(ni).get(this.world).castRay();if(!t||!t.object)return;const{object:i}=t;if(i instanceof le){const n=this.getVolumeOfMesh(i);this.onVolumeFound.trigger(n)}}),x(this,"onMouseMove",()=>{}),x(this,"onKeydown",t=>{}),this.components.add(Xm.uuid,this)}set enabled(e){this._enabled=e,this.setupEvents(e),e||this.cancelCreation()}get enabled(){return this._enabled}async dispose(){var e;this.setupEvents(!1),(e=this.label)==null||e.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){}async deleteAll(){}endCreation(){}cancelCreation(){}get(){}getVolumeFromFragments(e){const t=this.components.get(rt),i=new Ee,n=[];for(const r in e){const o=t.list.get(r);if(!o)continue;const a=e[r];let l=0;for(const p of a){const f=o.getInstancesIDs(p);f&&(l+=f.size)}const h=new Kt(o.mesh.geometry,void 0,l);let d=0;for(const p of a){const f=o.getInstancesIDs(p);if(f)for(const g of f)o.mesh.getMatrixAt(g,i),h.setMatrixAt(d++,i)}n.push(h)}return this.getVolumeFromMeshes(n)}getVolumeFromMeshes(e){if(!this.world)throw new Error("World is needed for Volume Measurement!");this.label||(this.label=this.newLabel(),this.label.three.removeFromParent());let t=0;for(const l of e)t+=this.getVolumeOfMesh(l);const i=this.world.scene.three,n=this.label.three;i.add(n);const r=this.components.get(tm);for(const l of e)l.geometry.computeBoundingSphere(),r.addMesh(l);const o=r.getSphere();r.reset(),n.position.copy(o.center);const a=Math.trunc(t*100)/100;return n.element.textContent=a.toString(),t}newLabel(){if(!this.world)throw new Error("World is needed for Volume Measurement!");const e=zn();return new _t(this.world,e)}setupEvents(e){if(!this.world)throw new Error("The volume measurement needs a world to work!");if(!this.world.renderer)throw new Error("The world of the volume measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("click",this.create),t.addEventListener("mousemove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("click",this.create),t.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}getVolumeOfMesh(e){let t=0;const i=new F,n=new F,r=new F,{index:o}=e.geometry,a=e.geometry.attributes.position.array;if(!o)return console.warn("Geometry must be indexed to compute its volume!"),0;const l=[];if(e instanceof Kt)for(let d=0;d<e.count;d++){const p=new Ee;e.getMatrixAt(d,p),l.push(p)}else l.push(new Ee().identity());const{matrixWorld:h}=e;for(let d=0;d<o.array.length-2;d+=3)for(const p of l){const f=p.multiply(h),g=o.array[d]*3,v=o.array[d+1]*3,b=o.array[d+2]*3;i.set(a[g],a[g+1],a[g+2]).applyMatrix4(f),n.set(a[v],a[v+1],a[v+2]).applyMatrix4(f),r.set(a[b],a[b+1],a[b+2]).applyMatrix4(f),t+=this.getSignedVolumeOfTriangle(i,n,r)}return Math.abs(t)}getSignedVolumeOfTriangle(e,t,i){const n=i.x*t.y*e.z,r=t.x*i.y*e.z,o=i.x*e.y*t.z,a=e.x*i.y*t.z,l=t.x*e.y*i.z,h=e.x*t.y*i.z;return 1/6*(-n+r+o-a-l+h)}};x(Eb,"uuid","811da532-7af3-4635-b592-1c06ae494af5");const bb=class Km extends Re{constructor(e){super(e),x(this,"selection",[]),x(this,"preview",new le(new Ne,new Xt({side:2,depthTest:!1,transparent:!0,opacity:.25,color:"#BCF124"}))),x(this,"selectionMaterial",new Xt({side:2,depthTest:!1,transparent:!0,color:"#BCF124",opacity:.75})),x(this,"world"),x(this,"onDisposed",new ee),x(this,"_enabled",!1),x(this,"_currentSelelection",null),x(this,"create",()=>{if(!this.world)throw new Error("No world given to the face measurement!");if(!this.enabled||!this._currentSelelection)return;const t=this.world.scene.three,i=new Ne,n=new le(i,this.selectionMaterial);i.setAttribute("position",this.preview.geometry.attributes.position),t.add(n),i.computeBoundingSphere();const{area:r,perimeter:o}=this._currentSelelection,a=this.newLabel(i,r);n.add(a.three),this.selection.push({area:r,perimeter:o,mesh:n,label:a})}),x(this,"onMouseMove",()=>{if(!this.world)throw new Error("The face measurement needs a world to work!");if(!this.enabled){this.unselect();return}const t=this.components.get(ni).get(this.world).castRay();if(!t||!t.object||t.faceIndex===void 0){this.unselect();return}const{object:i,faceIndex:n}=t;i instanceof le||i instanceof Kt?this.updateSelection(i,n,t.instanceId):this.unselect()}),x(this,"onKeydown",t=>{}),this.components.add(Km.uuid,this),this.preview.frustumCulled=!1}set enabled(e){if(!this.world)throw new Error("No world given for the Face measurement!");this._enabled=e,this.setupEvents(e),e?this.world.scene.three.add(this.preview):(this.preview.removeFromParent(),this.cancelCreation()),this.setVisibility(e)}get enabled(){return this._enabled}dispose(){this.setupEvents(!1),this.deleteAll(),this.preview.removeFromParent(),this.preview.material.dispose(),this.preview.geometry.dispose(),this.selectionMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.world)throw new Error("No world given to the face measurement!");const e=this.selection.map(r=>r.mesh),t=this.components.get(ni).get(this.world).castRay(e);if(!t||!t.object)return;const i=this.selection.find(r=>r.mesh===t.object);if(!i)return;i.mesh.removeFromParent(),i.mesh.geometry.dispose(),i.label.dispose();const n=this.selection.indexOf(i);this.selection.splice(n,1)}deleteAll(){for(const e of this.selection)e.mesh.removeFromParent(),e.mesh.geometry.dispose(),e.label.dispose();this.selection=[]}endCreation(){}cancelCreation(){}get(){const e=[];for(const t of this.selection){const i=t.mesh.geometry,{area:n,perimeter:r}=t,o=i.attributes.position.array;e.push({position:o,area:n,perimeter:r})}return e}set(e){if(!this.world)throw new Error("No world given to the face measurement!");const t=this.world.scene.three;for(const i of e){const n=new Ne,r=new le(n,this.selectionMaterial);t.add(r);const o=new gt(i.position,3);n.setAttribute("position",o),n.computeBoundingSphere();const{area:a,perimeter:l}=i,h=this.newLabel(n,a);r.add(h.three),this.selection.push({area:a,perimeter:l,mesh:r,label:h})}}setupEvents(e){if(!this.world)throw new Error("The face measurement needs a world to work!");if(!this.world.renderer)throw new Error("The world of the face measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;t.removeEventListener("click",this.create),t.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown),e&&(t.addEventListener("click",this.create),t.addEventListener("mousemove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown))}setVisibility(e){if(!this.world)throw new Error("The face measurement needs a world to work!");const t=this.world.scene.three;for(const i of this.selection){const n=i.label.three;e?(t.add(i.mesh),i.mesh.add(n)):(i.mesh.removeFromParent(),n.removeFromParent())}}unselect(){this.preview.removeFromParent(),this._currentSelelection=null}updateSelection(e,t,i){if(!this.world)throw new Error("The face measurement needs a world to work!");this.world.scene.three.add(this.preview);const n=this.components.get(ja).getFace(e,t,i);if(n===null)return;const r=this.regenerateHighlight(e,n.indices,i);let o=0;for(const{distance:a}of n.edges)o+=a;this._currentSelelection={perimeter:o,area:r}}newLabel(e,t){if(!e.boundingSphere)throw new Error("Error computing area geometry");if(!this.world)throw new Error("The face measurement needs a world to work!");const{center:i}=e.boundingSphere,n=zn(),r=Math.trunc(t*100)/100;n.textContent=r.toString();const o=new _t(this.world,n);return o.three.position.copy(i),o}regenerateHighlight(e,t,i){const n=[],r=[];let o=0,a=0;const l=new Fn,h=this.components.get(ja);for(const f of t){const{p1:g,p2:v,p3:b}=h.getVerticesAndNormal(e,f,i);n.push(g.x,g.y,g.z),n.push(v.x,v.y,v.z),n.push(b.x,b.y,b.z),l.set(g,v,b),a+=l.getArea(),r.push(o,o+1,o+2),o+=3}const d=new Float32Array(n),p=new gt(d,3);return this.preview.geometry.setAttribute("position",p),this.preview.geometry.setIndex(r),a}};x(bb,"uuid","30279548-1309-44f6-aa97-ce26eed73522");const wb=class Qm extends Re{constructor(e){super(e),x(this,"preview"),x(this,"tolerance",.3),x(this,"world"),x(this,"onDisposed",new ee),x(this,"_enabled",!1),x(this,"_lineMaterial",new Di({color:"#DC2626",linewidth:2,depthTest:!1,transparent:!0})),x(this,"create",async()=>{if(!this.preview||!this.enabled||!this.preview.visible)return;const t=this.components.get(_r);t.world=this.world;const i=this.preview.startPoint.clone(),n=this.preview.endPoint.clone();t.createOnPoints(i,n)}),x(this,"onMouseMove",()=>{if(!this.preview)return;if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.enabled){this.preview.visible=!1;return}const t=this.components.get(ni).get(this.world).castRay();if(!t||!t.object){this.preview.visible=!1;return}const{object:i,faceIndex:n,point:r}=t;if(n===void 0){this.preview.visible=!1;return}i instanceof le||i instanceof Kt?this.updateSelection(i,r,n,t.instanceId):this.preview.visible=!1}),x(this,"onKeydown",t=>{}),this.components.add(Qm.uuid,this)}set enabled(e){if(this._enabled=e,this.setupEvents(e),e){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.preview){const t=document.createElement("div");t.className="w-2 h-2 bg-red-600 rounded-full",this.preview=new au(this.components,this.world,{start:new F,end:new F,lineMaterial:this._lineMaterial,endpointElement:t}),this.preview.visible=!1}}else this.cancelCreation()}get enabled(){return this._enabled}dispose(){this.preview&&this.preview.dispose(),this._lineMaterial.dispose(),this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.enabled)return;const e=this.components.get(_r),t=e.enabled;e.enabled=!0,e.delete(),e.enabled=t}deleteAll(){this.components.get(_r).deleteAll()}endCreation(){}cancelCreation(){}get(){const e=this.components.get(_r).list,t=[];for(const i of e){const n=i.startPoint,r=i.endPoint,o=[n.x,n.y,n.z,r.x,r.y,r.z];t.push(o)}return t}set(e){const t=this.components.get(_r);t.world=this.world;for(const i of e){const[n,r,o,a,l,h]=i,d=new F(n,r,o),p=new F(a,l,h);t.createOnPoints(d,p)}}setupEvents(e){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.world.renderer)throw new Error("The world of the edge measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("click",this.create),t.addEventListener("mousemove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("click",this.create),t.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}updateSelection(e,t,i,n){if(!this.preview||!e.geometry.index)return;const r=this.components.get(ja).getFace(e,i,n);if(!r)return;const{edges:o}=r;let a=Number.MAX_VALUE,l=[];for(const p of o){const[f,g]=p.points,v=ja.distanceFromPointToLine(t,f,g,!0);v<this.tolerance&&v<a&&(a=v,l=p.points)}if(!l.length){this.preview.visible=!1;return}const[h,d]=l;this.preview.startPoint=h,this.preview.endPoint=d,this.preview.visible=!0}};x(wb,"uuid","e7be5749-89df-4514-8d25-83aa38ce12d8");class Ib extends qf{constructor(e,t,i){super(e,t,i),x(this,"threshold",50),x(this,"bboxThreshold",200),x(this,"maxLostTime",3e4),x(this,"maxHiddenTime",5e3),x(this,"boxes",new Map),x(this,"_geometry"),x(this,"_material",new Xt({transparent:!0,side:2,opacity:1})),x(this,"onViewUpdated",new $i),x(this,"_modelIDIndex",new Map),x(this,"_indexModelID",new Map),x(this,"_nextModelID",0),x(this,"_geometries",new Map),x(this,"_geometriesGroups",new Map),x(this,"_foundGeometries",new Set),x(this,"_intervalID",null),x(this,"codes",new Map),x(this,"handleWorkerMessage",async r=>{const o=r.data.colors,a={},l={},h={},d={},p=performance.now();let f=!1;const g=new Set(this._foundGeometries);for(const[v,b]of o){const w=this._geometries.get(v);if(!w)continue;const T=b>this.threshold,{exists:S}=w;if(!T&&!S)continue;const _=this._indexModelID.get(w.modelIndex);g.delete(v),T&&S?(w.time=p,d[_]||(d[_]=new Set),d[_].add(w.geometryID),this._foundGeometries.add(v),f=!0):T&&!S?(a[_]||(a[_]=new Map),w.time=p,w.exists=!0,a[_].has(b)||a[_].set(b,new Set),a[_].get(b).add(w.geometryID),this._foundGeometries.add(v),f=!0):!T&&S&&(this.handleLostGeometries(p,v,w,l,h),f=!0)}f&&await this.onViewUpdated.trigger({toLoad:a,toRemove:l,toHide:h,toShow:d}),this._isWorkerBusy=!1}),this.updateInterval=500,this._geometry=new ut(1,1,1),this._geometry.groups=[],this._geometry.deleteAttribute("uv");const n=this._geometry.attributes.position.array;for(let r=0;r<n.length;r++)n[r]+=.5;this._geometry.attributes.position.needsUpdate=!0,this.worker.addEventListener("message",this.handleWorkerMessage),this.autoUpdate&&(this._intervalID=window.setInterval(this.updateVisibility,this.updateInterval))}dispose(){super.dispose(),this.onViewUpdated.reset(),this._intervalID!==null&&(window.clearInterval(this._intervalID),this._intervalID=null);for(const[e,t]of this._geometriesGroups){t.removeFromParent();const i=[...t.children];for(const n of i)n.removeFromParent()}this._geometriesGroups.clear();for(const[e,t]of this.boxes)t.dispose(!0);this.boxes.clear();for(const[e,t]of this._geometries)t.fragment&&(t.fragment.dispose(!0),t.fragment=void 0);this._geometries.clear(),this._geometry.dispose(),this._material.dispose(),this._modelIDIndex.clear(),this._indexModelID.clear(),this.codes.clear()}add(e,t,i){const n=this.createModelIndex(e),r=Si.enabled;Si.enabled=!1;const o=new Map,a=new Ee,l=new Va(this._geometry,this._material,10);this.boxes.set(n,l),this.scene.add(l.mesh);const h=new Fs;this.scene.add(h),this._geometriesGroups.set(n,h);const d=new Map;for(const f of t)for(const g of f.geometries){const{geometryID:v,transformation:b,color:w}=g,T=new Rt;T.setRGB(w[0],w[1],w[2],"srgb");const S=this.getInstanceID(f.id,v),_=i[v];if(!_){console.log(`Geometry not found: ${v}`);continue}const{boundingBox:I}=_;let P;o.has(v)?P=o.get(v):(P=this.getAvailableColor(),this.increaseColor(),o.set(v,P));const{r:M,g:k,b:V,code:W}=P,j=new Rt;j.setRGB(M/255,k/255,V/255,"srgb"),this.codes.has(n)||this.codes.set(n,new Map),this.codes.get(n).set(v,W);const Q=new Ee,$=Object.values(I);if(Q.fromArray(b),a.fromArray($),Q.multiply(a),d.has(S)){const ne=d.get(S);if(ne===void 0||!ne.colors)throw new Error("Malformed item!");ne.colors.push(j),ne.geometryColors.push(T),ne.transforms.push(Q)}else d.set(S,{id:S,colors:[j],geometryColors:[T],transforms:[Q]});if(this._geometries.has(W))this._geometries.get(W).assetIDs.add(f.id);else{const ne=new Set([f.id]);this._geometries.set(W,{modelIndex:n,geometryID:v,assetIDs:ne,exists:!1,hidden:!1,time:0})}}const p=Array.from(d.values());l.add(p),Si.enabled=r}remove(e){const t=this._modelIDIndex.get(e);if(t===void 0)throw new Error("Model doesn't exist!");const i=this._geometriesGroups.get(t);i.removeFromParent();const n=[...i.children];for(const o of n)o.removeFromParent();this._geometriesGroups.delete(t),this.boxes.get(t).dispose(!1),this.boxes.delete(t);const r=this.codes.get(t);this.codes.delete(t);for(const[o,a]of r){const l=this._geometries.get(a);l&&l.fragment&&(l.fragment.dispose(!1),l.fragment=void 0),this._geometries.delete(a)}this._modelIDIndex.delete(e),this._indexModelID.delete(t),this._foundGeometries.clear()}addFragment(e,t,i){const n=Si.enabled;Si.enabled=!1;const r=this._modelIDIndex.get(e),o=this.codes.get(r).get(t),a=this._geometries.get(o);if(this.setGeometryVisibility(a,!1,!1),!a.fragment){a.fragment=new Va(i.mesh.geometry,this._material,i.capacity);const f=this._geometriesGroups.get(r);if(!f)throw new Error("Group not found!");f.add(a.fragment.mesh)}const[l,h,d]=o.split("-").map(f=>parseInt(f,10)),p=[];for(const f of i.ids){const g=i.get(f);if(!g.colors)throw new Error("Malformed fragments!");for(const v of g.colors)v.setRGB(l/255,h/255,d/255,"srgb");p.push(g)}a.fragment.add(p),Si.enabled=n,this.needsUpdate=!0}removeFragment(e,t){const i=this._modelIDIndex.get(e),n=this.codes.get(i).get(t),r=this._geometries.get(n);if(r.hidden||this.setGeometryVisibility(r,!0,!1),r.fragment){const{fragment:o}=r;o.dispose(!1),r.fragment=void 0}}setModelTransformation(e,t){const i=this._modelIDIndex.get(e);if(i===void 0)throw new Error("Model not found!");const n=this.boxes.get(i);n&&(n.mesh.position.set(0,0,0),n.mesh.rotation.set(0,0,0),n.mesh.scale.set(1,1,1),n.mesh.applyMatrix4(t));const r=this._geometriesGroups.get(i);r&&(r.position.set(0,0,0),r.rotation.set(0,0,0),r.scale.set(1,1,1),r.applyMatrix4(t))}setVisibility(e,t,i){const n=this._modelIDIndex.get(t);if(n!==void 0)for(const[r,o]of i){const a=this.codes.get(n);if(a===void 0)throw new Error("Map not found!");const l=a.get(r),h=this._geometries.get(l);if(h===void 0)throw new Error("Geometry not found!");h.hidden=!e,this.setGeometryVisibility(h,e,!0,o)}}setGeometryVisibility(e,t,i,n){const{modelIndex:r,geometryID:o,assetIDs:a}=e,l=this.boxes.get(r);if(l===void 0)throw new Error("Model not found!");const h=n||a;if(i&&e.fragment)e.fragment.setVisibility(t,h);else{const d=new Set;for(const p of h){const f=this.getInstanceID(p,o);d.add(f)}l.setVisibility(t,d)}}handleLostGeometries(e,t,i,n,r){const o=this._indexModelID.get(i.modelIndex),a=e-i.time;a>this.maxLostTime?(n[o]||(n[o]=new Set),i.exists=!1,n[o].add(i.geometryID),this._foundGeometries.delete(t)):a>this.maxHiddenTime&&(r[o]||(r[o]=new Set),r[o].add(i.geometryID))}createModelIndex(e){if(this._modelIDIndex.has(e))throw new Error("Can't load the same model twice!");const t=this._nextModelID;return this._nextModelID++,this._modelIDIndex.set(e,t),this._indexModelID.set(t,e),t}getInstanceID(e,t){const i=10**(Math.log(t)*Math.LOG10E+1|0);return e+t/i}}var Zm={exports:{}};(function(s,e){(function(t,i){s.exports=i()})(np,function(){var t=function(c,u){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(m[E]=y[E])})(c,u)},i=function(){return(i=Object.assign||function(c){for(var u,m=1,y=arguments.length;m<y;m++)for(var E in u=arguments[m])Object.prototype.hasOwnProperty.call(u,E)&&(c[E]=u[E]);return c}).apply(this,arguments)};function n(c,u,m){for(var y,E=0,C=u.length;E<C;E++)!y&&E in u||((y=y||Array.prototype.slice.call(u,0,E))[E]=u[E]);return c.concat(y||Array.prototype.slice.call(u))}var r=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:np,o=Object.keys,a=Array.isArray;function l(c,u){return typeof u!="object"||o(u).forEach(function(m){c[m]=u[m]}),c}typeof Promise>"u"||r.Promise||(r.Promise=Promise);var h=Object.getPrototypeOf,d={}.hasOwnProperty;function p(c,u){return d.call(c,u)}function f(c,u){typeof u=="function"&&(u=u(h(c))),(typeof Reflect>"u"?o:Reflect.ownKeys)(u).forEach(function(m){v(c,m,u[m])})}var g=Object.defineProperty;function v(c,u,m,y){g(c,u,l(m&&p(m,"get")&&typeof m.get=="function"?{get:m.get,set:m.set,configurable:!0}:{value:m,configurable:!0,writable:!0},y))}function b(c){return{from:function(u){return c.prototype=Object.create(u.prototype),v(c.prototype,"constructor",c),{extend:f.bind(null,c.prototype)}}}}var w=Object.getOwnPropertyDescriptor,T=[].slice;function S(c,u,m){return T.call(c,u,m)}function _(c,u){return u(c)}function I(c){if(!c)throw new Error("Assertion Failed")}function P(c){r.setImmediate?setImmediate(c):setTimeout(c,0)}function M(c,u){if(typeof u=="string"&&p(c,u))return c[u];if(!u)return c;if(typeof u!="string"){for(var m=[],y=0,E=u.length;y<E;++y){var C=M(c,u[y]);m.push(C)}return m}var R=u.indexOf(".");if(R!==-1){var O=c[u.substr(0,R)];return O==null?void 0:M(O,u.substr(R+1))}}function k(c,u,m){if(c&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(c)))if(typeof u!="string"&&"length"in u){I(typeof m!="string"&&"length"in m);for(var y=0,E=u.length;y<E;++y)k(c,u[y],m[y])}else{var C,R,O=u.indexOf(".");O!==-1?(C=u.substr(0,O),(R=u.substr(O+1))===""?m===void 0?a(c)&&!isNaN(parseInt(C))?c.splice(C,1):delete c[C]:c[C]=m:k(O=!(O=c[C])||!p(c,C)?c[C]={}:O,R,m)):m===void 0?a(c)&&!isNaN(parseInt(u))?c.splice(u,1):delete c[u]:c[u]=m}}function V(c){var u,m={};for(u in c)p(c,u)&&(m[u]=c[u]);return m}var W=[].concat;function j(c){return W.apply([],c)}var wi="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(j([8,16,32,64].map(function(c){return["Int","Uint","Float"].map(function(u){return u+c+"Array"})}))).filter(function(c){return r[c]}),Q=new Set(wi.map(function(c){return r[c]})),$=null;function ne(c){return $=new WeakMap,c=function u(m){if(!m||typeof m!="object")return m;var y=$.get(m);if(y)return y;if(a(m)){y=[],$.set(m,y);for(var E=0,C=m.length;E<C;++E)y.push(u(m[E]))}else if(Q.has(m.constructor))y=m;else{var R,O=h(m);for(R in y=O===Object.prototype?{}:Object.create(O),$.set(m,y),m)p(m,R)&&(y[R]=u(m[R]))}return y}(c),$=null,c}var oe={}.toString;function ve(c){return oe.call(c).slice(8,-1)}var re=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ge=typeof re=="symbol"?function(c){var u;return c!=null&&(u=c[re])&&u.apply(c)}:function(){return null};function me(c,u){return u=c.indexOf(u),0<=u&&c.splice(u,1),0<=u}var we={};function Ge(c){var u,m,y,E;if(arguments.length===1){if(a(c))return c.slice();if(this===we&&typeof c=="string")return[c];if(E=ge(c)){for(m=[];!(y=E.next()).done;)m.push(y.value);return m}if(c==null)return[c];if(typeof(u=c.length)!="number")return[c];for(m=new Array(u);u--;)m[u]=c[u];return m}for(u=arguments.length,m=new Array(u);u--;)m[u]=arguments[u];return m}var Pt=typeof Symbol<"u"?function(c){return c[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},tr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Bt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(tr),Bi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function At(c,u){this.name=c,this.message=u}function fn(c,u){return c+". Errors: "+Object.keys(u).map(function(m){return u[m].toString()}).filter(function(m,y,E){return E.indexOf(m)===y}).join(`
`)}function je(c,u,m,y){this.failures=u,this.failedKeys=y,this.successCount=m,this.message=fn(c,u)}function ke(c,u){this.name="BulkError",this.failures=Object.keys(u).map(function(m){return u[m]}),this.failuresByPos=u,this.message=fn(c,this.failures)}b(At).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(je).from(At),b(ke).from(At);var It=Bt.reduce(function(c,u){return c[u]=u+"Error",c},{}),He=At,fe=Bt.reduce(function(c,u){var m=u+"Error";function y(E,C){this.name=m,E?typeof E=="string"?(this.message="".concat(E).concat(C?`
 `+C:""),this.inner=C||null):typeof E=="object"&&(this.message="".concat(E.name," ").concat(E.message),this.inner=E):(this.message=Bi[u]||m,this.inner=null)}return b(y).from(He),c[u]=y,c},{});fe.Syntax=SyntaxError,fe.Type=TypeError,fe.Range=RangeError;var We=tr.reduce(function(c,u){return c[u+"Error"]=fe[u],c},{}),qt=Bt.reduce(function(c,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(c[u+"Error"]=fe[u]),c},{});function Le(){}function ai(c){return c}function Ml(c,u){return c==null||c===ai?u:function(m){return u(c(m))}}function Jt(c,u){return function(){c.apply(this,arguments),u.apply(this,arguments)}}function Js(c,u){return c===Le?u:function(){var m=c.apply(this,arguments);m!==void 0&&(arguments[0]=m);var y=this.onsuccess,E=this.onerror;this.onsuccess=null,this.onerror=null;var C=u.apply(this,arguments);return y&&(this.onsuccess=this.onsuccess?Jt(y,this.onsuccess):y),E&&(this.onerror=this.onerror?Jt(E,this.onerror):E),C!==void 0?C:m}}function $s(c,u){return c===Le?u:function(){c.apply(this,arguments);var m=this.onsuccess,y=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),m&&(this.onsuccess=this.onsuccess?Jt(m,this.onsuccess):m),y&&(this.onerror=this.onerror?Jt(y,this.onerror):y)}}function Y0(c,u){return c===Le?u:function(m){var y=c.apply(this,arguments);l(m,y);var E=this.onsuccess,C=this.onerror;return this.onsuccess=null,this.onerror=null,m=u.apply(this,arguments),E&&(this.onsuccess=this.onsuccess?Jt(E,this.onsuccess):E),C&&(this.onerror=this.onerror?Jt(C,this.onerror):C),y===void 0?m===void 0?void 0:m:l(y,m)}}function G0(c,u){return c===Le?u:function(){return u.apply(this,arguments)!==!1&&c.apply(this,arguments)}}function Ll(c,u){return c===Le?u:function(){var m=c.apply(this,arguments);if(m&&typeof m.then=="function"){for(var y=this,E=arguments.length,C=new Array(E);E--;)C[E]=arguments[E];return m.then(function(){return u.apply(y,C)})}return u.apply(this,arguments)}}qt.ModifyError=je,qt.DexieError=At,qt.BulkError=ke;var li=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ru(c){li=c}var er={},Pu=100,wi=typeof Promise>"u"?[]:function(){var c=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[c,h(c),c];var u=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[u,h(u),c]}(),tr=wi[0],Bt=wi[1],wi=wi[2],Bt=Bt&&Bt.then,ir=tr&&tr.constructor,Dl=!!wi,nr=function(c,u){sr.push([c,u]),Co&&(queueMicrotask(W0),Co=!1)},Nl=!0,Co=!0,mn=[],To=[],Ul=ai,zi={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Le,pgp:!1,env:{},finalize:Le},ye=zi,sr=[],gn=0,xo=[];function de(c){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=ye;if(typeof c!="function"){if(c!==er)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Bl(this,this._value))}this._state=null,this._value=null,++u.ref,function m(y,E){try{E(function(C){if(y._state===null){if(C===y)throw new TypeError("A promise cannot be resolved with itself.");var R=y._lib&&$n();C&&typeof C.then=="function"?m(y,function(O,U){C instanceof de?C._then(O,U):C.then(O,U)}):(y._state=!0,y._value=C,Ou(y)),R&&es()}},Bl.bind(null,y))}catch(C){Bl(y,C)}}(this,c)}var kl={get:function(){var c=ye,u=Ro;function m(y,E){var C=this,R=!c.global&&(c!==ye||u!==Ro),O=R&&!Hi(),U=new de(function(D,H){zl(C,new Fu(Lu(y,c,R,O),Lu(E,c,R,O),D,H,c))});return this._consoleTask&&(U._consoleTask=this._consoleTask),U}return m.prototype=er,m},set:function(c){v(this,"then",c&&c.prototype===er?kl:{get:function(){return c},set:kl.set})}};function Fu(c,u,m,y,E){this.onFulfilled=typeof c=="function"?c:null,this.onRejected=typeof u=="function"?u:null,this.resolve=m,this.reject=y,this.psd=E}function Bl(c,u){var m,y;To.push(u),c._state===null&&(m=c._lib&&$n(),u=Ul(u),c._state=!1,c._value=u,y=c,mn.some(function(E){return E._value===y._value})||mn.push(y),Ou(c),m&&es())}function Ou(c){var u=c._listeners;c._listeners=[];for(var m=0,y=u.length;m<y;++m)zl(c,u[m]);var E=c._PSD;--E.ref||E.finalize(),gn===0&&(++gn,nr(function(){--gn==0&&Vl()},[]))}function zl(c,u){if(c._state!==null){var m=c._state?u.onFulfilled:u.onRejected;if(m===null)return(c._state?u.resolve:u.reject)(c._value);++u.psd.ref,++gn,nr(j0,[m,c,u])}else c._listeners.push(u)}function j0(c,u,m){try{var y,E=u._value;!u._state&&To.length&&(To=[]),y=li&&u._consoleTask?u._consoleTask.run(function(){return c(E)}):c(E),u._state||To.indexOf(E)!==-1||function(C){for(var R=mn.length;R;)if(mn[--R]._value===C._value)return mn.splice(R,1)}(u),m.resolve(y)}catch(C){m.reject(C)}finally{--gn==0&&Vl(),--m.psd.ref||m.psd.finalize()}}function W0(){vn(zi,function(){$n()&&es()})}function $n(){var c=Nl;return Co=Nl=!1,c}function es(){var c,u,m;do for(;0<sr.length;)for(c=sr,sr=[],m=c.length,u=0;u<m;++u){var y=c[u];y[0].apply(null,y[1])}while(0<sr.length);Co=Nl=!0}function Vl(){var c=mn;mn=[],c.forEach(function(y){y._PSD.onunhandled.call(null,y._value,y)});for(var u=xo.slice(0),m=u.length;m;)u[--m]()}function Ao(c){return new de(er,!1,c)}function Ze(c,u){var m=ye;return function(){var y=$n(),E=ye;try{return Yi(m,!0),c.apply(this,arguments)}catch(C){u&&u(C)}finally{Yi(E,!1),y&&es()}}}f(de.prototype,{then:kl,_then:function(c,u){zl(this,new Fu(null,null,c,u,ye))},catch:function(c){if(arguments.length===1)return this.then(null,c);var u=c,m=arguments[1];return typeof u=="function"?this.then(null,function(y){return(y instanceof u?m:Ao)(y)}):this.then(null,function(y){return(y&&y.name===u?m:Ao)(y)})},finally:function(c){return this.then(function(u){return de.resolve(c()).then(function(){return u})},function(u){return de.resolve(c()).then(function(){return Ao(u)})})},timeout:function(c,u){var m=this;return c<1/0?new de(function(y,E){var C=setTimeout(function(){return E(new fe.Timeout(u))},c);m.then(y,E).finally(clearTimeout.bind(null,C))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&v(de.prototype,Symbol.toStringTag,"Dexie.Promise"),zi.env=Mu(),f(de,{all:function(){var c=Ge.apply(null,arguments).map(Po);return new de(function(u,m){c.length===0&&u([]);var y=c.length;c.forEach(function(E,C){return de.resolve(E).then(function(R){c[C]=R,--y||u(c)},m)})})},resolve:function(c){return c instanceof de?c:c&&typeof c.then=="function"?new de(function(u,m){c.then(u,m)}):new de(er,!0,c)},reject:Ao,race:function(){var c=Ge.apply(null,arguments).map(Po);return new de(function(u,m){c.map(function(y){return de.resolve(y).then(u,m)})})},PSD:{get:function(){return ye},set:function(c){return ye=c}},totalEchoes:{get:function(){return Ro}},newPSD:Vi,usePSD:vn,scheduler:{get:function(){return nr},set:function(c){nr=c}},rejectionMapper:{get:function(){return Ul},set:function(c){Ul=c}},follow:function(c,u){return new de(function(m,y){return Vi(function(E,C){var R=ye;R.unhandleds=[],R.onunhandled=C,R.finalize=Jt(function(){var O,U=this;O=function(){U.unhandleds.length===0?E():C(U.unhandleds[0])},xo.push(function D(){O(),xo.splice(xo.indexOf(D),1)}),++gn,nr(function(){--gn==0&&Vl()},[])},R.finalize),c()},u,m,y)})}}),ir&&(ir.allSettled&&v(de,"allSettled",function(){var c=Ge.apply(null,arguments).map(Po);return new de(function(u){c.length===0&&u([]);var m=c.length,y=new Array(m);c.forEach(function(E,C){return de.resolve(E).then(function(R){return y[C]={status:"fulfilled",value:R}},function(R){return y[C]={status:"rejected",reason:R}}).then(function(){return--m||u(y)})})})}),ir.any&&typeof AggregateError<"u"&&v(de,"any",function(){var c=Ge.apply(null,arguments).map(Po);return new de(function(u,m){c.length===0&&m(new AggregateError([]));var y=c.length,E=new Array(y);c.forEach(function(C,R){return de.resolve(C).then(function(O){return u(O)},function(O){E[R]=O,--y||m(new AggregateError(E))})})})}));var lt={awaits:0,echoes:0,id:0},X0=0,So=[],_o=0,Ro=0,K0=0;function Vi(c,u,m,y){var E=ye,C=Object.create(E);return C.parent=E,C.ref=0,C.global=!1,C.id=++K0,zi.env,C.env=Dl?{Promise:de,PromiseProp:{value:de,configurable:!0,writable:!0},all:de.all,race:de.race,allSettled:de.allSettled,any:de.any,resolve:de.resolve,reject:de.reject}:{},u&&l(C,u),++E.ref,C.finalize=function(){--this.parent.ref||this.parent.finalize()},y=vn(C,c,m,y),C.ref===0&&C.finalize(),y}function ts(){return lt.id||(lt.id=++X0),++lt.awaits,lt.echoes+=Pu,lt.id}function Hi(){return!!lt.awaits&&(--lt.awaits==0&&(lt.id=0),lt.echoes=lt.awaits*Pu,!0)}function Po(c){return lt.echoes&&c&&c.constructor===ir?(ts(),c.then(function(u){return Hi(),u},function(u){return Hi(),it(u)})):c}function Q0(){var c=So[So.length-1];So.pop(),Yi(c,!1)}function Yi(c,u){var m,y=ye;(u?!lt.echoes||_o++&&c===ye:!_o||--_o&&c===ye)||queueMicrotask(u?(function(E){++Ro,lt.echoes&&--lt.echoes!=0||(lt.echoes=lt.awaits=lt.id=0),So.push(ye),Yi(E,!0)}).bind(null,c):Q0),c!==ye&&(ye=c,y===zi&&(zi.env=Mu()),Dl&&(m=zi.env.Promise,u=c.env,(y.global||c.global)&&(Object.defineProperty(r,"Promise",u.PromiseProp),m.all=u.all,m.race=u.race,m.resolve=u.resolve,m.reject=u.reject,u.allSettled&&(m.allSettled=u.allSettled),u.any&&(m.any=u.any))))}function Mu(){var c=r.Promise;return Dl?{Promise:c,PromiseProp:Object.getOwnPropertyDescriptor(r,"Promise"),all:c.all,race:c.race,allSettled:c.allSettled,any:c.any,resolve:c.resolve,reject:c.reject}:{}}function vn(c,u,m,y,E){var C=ye;try{return Yi(c,!0),u(m,y,E)}finally{Yi(C,!1)}}function Lu(c,u,m,y){return typeof c!="function"?c:function(){var E=ye;m&&ts(),Yi(u,!0);try{return c.apply(this,arguments)}finally{Yi(E,!1),y&&queueMicrotask(Hi)}}}function Hl(c){Promise===ir&&lt.echoes===0?_o===0?c():enqueueNativeMicroTask(c):setTimeout(c,0)}(""+Bt).indexOf("[native code]")===-1&&(ts=Hi=Le);var it=de.reject,yn="￿",bi="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Du="String expected.",is=[],Fo="__dbnames",Yl="readonly",Gl="readwrite";function En(c,u){return c?u?function(){return c.apply(this,arguments)&&u.apply(this,arguments)}:c:u}var Nu={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Oo(c){return typeof c!="string"||/\./.test(c)?function(u){return u}:function(u){return u[c]===void 0&&c in u&&delete(u=ne(u))[c],u}}function Uu(){throw fe.Type()}function Oe(c,u){try{var m=ku(c),y=ku(u);if(m!==y)return m==="Array"?1:y==="Array"?-1:m==="binary"?1:y==="binary"?-1:m==="string"?1:y==="string"?-1:m==="Date"?1:y!=="Date"?NaN:-1;switch(m){case"number":case"Date":case"string":return u<c?1:c<u?-1:0;case"binary":return function(E,C){for(var R=E.length,O=C.length,U=R<O?R:O,D=0;D<U;++D)if(E[D]!==C[D])return E[D]<C[D]?-1:1;return R===O?0:R<O?-1:1}(Bu(c),Bu(u));case"Array":return function(E,C){for(var R=E.length,O=C.length,U=R<O?R:O,D=0;D<U;++D){var H=Oe(E[D],C[D]);if(H!==0)return H}return R===O?0:R<O?-1:1}(c,u)}}catch{}return NaN}function ku(c){var u=typeof c;return u!="object"?u:ArrayBuffer.isView(c)?"binary":(c=ve(c),c==="ArrayBuffer"?"binary":c)}function Bu(c){return c instanceof Uint8Array?c:ArrayBuffer.isView(c)?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c)}var zu=(Xe.prototype._trans=function(c,u,m){var y=this._tx||ye.trans,E=this.name,C=li&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(c==="readonly"?"read":"write"," ").concat(this.name));function R(D,H,L){if(!L.schema[E])throw new fe.NotFound("Table "+E+" not part of transaction");return u(L.idbtrans,L)}var O=$n();try{var U=y&&y.db._novip===this.db._novip?y===ye.trans?y._promise(c,R,m):Vi(function(){return y._promise(c,R,m)},{trans:y,transless:ye.transless||ye}):function D(H,L,Y,N){if(H.idbdb&&(H._state.openComplete||ye.letThrough||H._vip)){var B=H._createTransaction(L,Y,H._dbSchema);try{B.create(),H._state.PR1398_maxLoop=3}catch(G){return G.name===It.InvalidState&&H.isOpen()&&0<--H._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),H.close({disableAutoOpen:!1}),H.open().then(function(){return D(H,L,Y,N)})):it(G)}return B._promise(L,function(G,z){return Vi(function(){return ye.trans=B,N(G,z,B)})}).then(function(G){if(L==="readwrite")try{B.idbtrans.commit()}catch{}return L==="readonly"?G:B._completion.then(function(){return G})})}if(H._state.openComplete)return it(new fe.DatabaseClosed(H._state.dbOpenError));if(!H._state.isBeingOpened){if(!H._state.autoOpen)return it(new fe.DatabaseClosed);H.open().catch(Le)}return H._state.dbReadyPromise.then(function(){return D(H,L,Y,N)})}(this.db,c,[this.name],R);return C&&(U._consoleTask=C,U=U.catch(function(D){return console.trace(D),it(D)})),U}finally{O&&es()}},Xe.prototype.get=function(c,u){var m=this;return c&&c.constructor===Object?this.where(c).first(u):c==null?it(new fe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(y){return m.core.get({trans:y,key:c}).then(function(E){return m.hook.reading.fire(E)})}).then(u)},Xe.prototype.where=function(c){if(typeof c=="string")return new this.db.WhereClause(this,c);if(a(c))return new this.db.WhereClause(this,"[".concat(c.join("+"),"]"));var u=o(c);if(u.length===1)return this.where(u[0]).equals(c[u[0]]);var m=this.schema.indexes.concat(this.schema.primKey).filter(function(U){if(U.compound&&u.every(function(H){return 0<=U.keyPath.indexOf(H)})){for(var D=0;D<u.length;++D)if(u.indexOf(U.keyPath[D])===-1)return!1;return!0}return!1}).sort(function(U,D){return U.keyPath.length-D.keyPath.length})[0];if(m&&this.db._maxKey!==yn){var R=m.keyPath.slice(0,u.length);return this.where(R).equals(R.map(function(D){return c[D]}))}!m&&li&&console.warn("The query ".concat(JSON.stringify(c)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var y=this.schema.idxByName,E=this.db._deps.indexedDB;function C(U,D){return E.cmp(U,D)===0}var O=u.reduce(function(Y,D){var H=Y[0],L=Y[1],Y=y[D],N=c[D];return[H||Y,H||!Y?En(L,Y&&Y.multi?function(B){return B=M(B,D),a(B)&&B.some(function(G){return C(N,G)})}:function(B){return C(N,M(B,D))}):L]},[null,null]),R=O[0],O=O[1];return R?this.where(R.name).equals(c[R.keyPath]).filter(O):m?this.filter(O):this.where(u).equals("")},Xe.prototype.filter=function(c){return this.toCollection().and(c)},Xe.prototype.count=function(c){return this.toCollection().count(c)},Xe.prototype.offset=function(c){return this.toCollection().offset(c)},Xe.prototype.limit=function(c){return this.toCollection().limit(c)},Xe.prototype.each=function(c){return this.toCollection().each(c)},Xe.prototype.toArray=function(c){return this.toCollection().toArray(c)},Xe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Xe.prototype.orderBy=function(c){return new this.db.Collection(new this.db.WhereClause(this,a(c)?"[".concat(c.join("+"),"]"):c))},Xe.prototype.reverse=function(){return this.toCollection().reverse()},Xe.prototype.mapToClass=function(c){var u,m=this.db,y=this.name;function E(){return u!==null&&u.apply(this,arguments)||this}(this.schema.mappedClass=c).prototype instanceof Uu&&(function(U,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function H(){this.constructor=U}t(U,D),U.prototype=D===null?Object.create(D):(H.prototype=D.prototype,new H)}(E,u=c),Object.defineProperty(E.prototype,"db",{get:function(){return m},enumerable:!1,configurable:!0}),E.prototype.table=function(){return y},c=E);for(var C=new Set,R=c.prototype;R;R=h(R))Object.getOwnPropertyNames(R).forEach(function(U){return C.add(U)});function O(U){if(!U)return U;var D,H=Object.create(c.prototype);for(D in U)if(!C.has(D))try{H[D]=U[D]}catch{}return H}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=O,this.hook("reading",O),c},Xe.prototype.defineClass=function(){return this.mapToClass(function(c){l(this,c)})},Xe.prototype.add=function(c,u){var m=this,y=this.schema.primKey,E=y.auto,C=y.keyPath,R=c;return C&&E&&(R=Oo(C)(c)),this._trans("readwrite",function(O){return m.core.mutate({trans:O,type:"add",keys:u!=null?[u]:null,values:[R]})}).then(function(O){return O.numFailures?de.reject(O.failures[0]):O.lastResult}).then(function(O){if(C)try{k(c,C,O)}catch{}return O})},Xe.prototype.update=function(c,u){return typeof c!="object"||a(c)?this.where(":id").equals(c).modify(u):(c=M(c,this.schema.primKey.keyPath),c===void 0?it(new fe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(u))},Xe.prototype.put=function(c,u){var m=this,y=this.schema.primKey,E=y.auto,C=y.keyPath,R=c;return C&&E&&(R=Oo(C)(c)),this._trans("readwrite",function(O){return m.core.mutate({trans:O,type:"put",values:[R],keys:u!=null?[u]:null})}).then(function(O){return O.numFailures?de.reject(O.failures[0]):O.lastResult}).then(function(O){if(C)try{k(c,C,O)}catch{}return O})},Xe.prototype.delete=function(c){var u=this;return this._trans("readwrite",function(m){return u.core.mutate({trans:m,type:"delete",keys:[c]})}).then(function(m){return m.numFailures?de.reject(m.failures[0]):void 0})},Xe.prototype.clear=function(){var c=this;return this._trans("readwrite",function(u){return c.core.mutate({trans:u,type:"deleteRange",range:Nu})}).then(function(u){return u.numFailures?de.reject(u.failures[0]):void 0})},Xe.prototype.bulkGet=function(c){var u=this;return this._trans("readonly",function(m){return u.core.getMany({keys:c,trans:m}).then(function(y){return y.map(function(E){return u.hook.reading.fire(E)})})})},Xe.prototype.bulkAdd=function(c,u,m){var y=this,E=Array.isArray(u)?u:void 0,C=(m=m||(E?void 0:u))?m.allKeys:void 0;return this._trans("readwrite",function(R){var D=y.schema.primKey,O=D.auto,D=D.keyPath;if(D&&E)throw new fe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(E&&E.length!==c.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var U=c.length,D=D&&O?c.map(Oo(D)):c;return y.core.mutate({trans:R,type:"add",keys:E,values:D,wantResults:C}).then(function(B){var L=B.numFailures,Y=B.results,N=B.lastResult,B=B.failures;if(L===0)return C?Y:N;throw new ke("".concat(y.name,".bulkAdd(): ").concat(L," of ").concat(U," operations failed"),B)})})},Xe.prototype.bulkPut=function(c,u,m){var y=this,E=Array.isArray(u)?u:void 0,C=(m=m||(E?void 0:u))?m.allKeys:void 0;return this._trans("readwrite",function(R){var D=y.schema.primKey,O=D.auto,D=D.keyPath;if(D&&E)throw new fe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(E&&E.length!==c.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var U=c.length,D=D&&O?c.map(Oo(D)):c;return y.core.mutate({trans:R,type:"put",keys:E,values:D,wantResults:C}).then(function(B){var L=B.numFailures,Y=B.results,N=B.lastResult,B=B.failures;if(L===0)return C?Y:N;throw new ke("".concat(y.name,".bulkPut(): ").concat(L," of ").concat(U," operations failed"),B)})})},Xe.prototype.bulkUpdate=function(c){var u=this,m=this.core,y=c.map(function(R){return R.key}),E=c.map(function(R){return R.changes}),C=[];return this._trans("readwrite",function(R){return m.getMany({trans:R,keys:y,cache:"clone"}).then(function(O){var U=[],D=[];c.forEach(function(L,Y){var N=L.key,B=L.changes,G=O[Y];if(G){for(var z=0,X=Object.keys(B);z<X.length;z++){var K=X[z],Z=B[K];if(K===u.schema.primKey.keyPath){if(Oe(Z,N)!==0)throw new fe.Constraint("Cannot update primary key in bulkUpdate()")}else k(G,K,Z)}C.push(Y),U.push(N),D.push(G)}});var H=U.length;return m.mutate({trans:R,type:"put",keys:U,values:D,updates:{keys:y,changeSpecs:E}}).then(function(L){var Y=L.numFailures,N=L.failures;if(Y===0)return H;for(var B=0,G=Object.keys(N);B<G.length;B++){var z,X=G[B],K=C[Number(X)];K!=null&&(z=N[X],delete N[X],N[K]=z)}throw new ke("".concat(u.name,".bulkUpdate(): ").concat(Y," of ").concat(H," operations failed"),N)})})})},Xe.prototype.bulkDelete=function(c){var u=this,m=c.length;return this._trans("readwrite",function(y){return u.core.mutate({trans:y,type:"delete",keys:c})}).then(function(R){var E=R.numFailures,C=R.lastResult,R=R.failures;if(E===0)return C;throw new ke("".concat(u.name,".bulkDelete(): ").concat(E," of ").concat(m," operations failed"),R)})},Xe);function Xe(){}function rr(c){function u(R,O){if(O){for(var U=arguments.length,D=new Array(U-1);--U;)D[U-1]=arguments[U];return m[R].subscribe.apply(null,D),c}if(typeof R=="string")return m[R]}var m={};u.addEventType=C;for(var y=1,E=arguments.length;y<E;++y)C(arguments[y]);return u;function C(R,O,U){if(typeof R!="object"){var D;O=O||G0;var H={subscribers:[],fire:U=U||Le,subscribe:function(L){H.subscribers.indexOf(L)===-1&&(H.subscribers.push(L),H.fire=O(H.fire,L))},unsubscribe:function(L){H.subscribers=H.subscribers.filter(function(Y){return Y!==L}),H.fire=H.subscribers.reduce(O,U)}};return m[R]=u[R]=H}o(D=R).forEach(function(L){var Y=D[L];if(a(Y))C(L,D[L][0],D[L][1]);else{if(Y!=="asap")throw new fe.InvalidArgument("Invalid event config");var N=C(L,ai,function(){for(var B=arguments.length,G=new Array(B);B--;)G[B]=arguments[B];N.subscribers.forEach(function(z){P(function(){z.apply(null,G)})})})}})}}function or(c,u){return b(u).from({prototype:c}),u}function ns(c,u){return!(c.filter||c.algorithm||c.or)&&(u?c.justLimit:!c.replayFilter)}function jl(c,u){c.filter=En(c.filter,u)}function Wl(c,u,m){var y=c.replayFilter;c.replayFilter=y?function(){return En(y(),u())}:u,c.justLimit=m&&!y}function Mo(c,u){if(c.isPrimKey)return u.primaryKey;var m=u.getIndexByKeyPath(c.index);if(!m)throw new fe.Schema("KeyPath "+c.index+" on object store "+u.name+" is not indexed");return m}function Vu(c,u,m){var y=Mo(c,u.schema);return u.openCursor({trans:m,values:!c.keysOnly,reverse:c.dir==="prev",unique:!!c.unique,query:{index:y,range:c.range}})}function Lo(c,u,m,y){var E=c.replayFilter?En(c.filter,c.replayFilter()):c.filter;if(c.or){var C={},R=function(O,U,D){var H,L;E&&!E(U,D,function(Y){return U.stop(Y)},function(Y){return U.fail(Y)})||((L=""+(H=U.primaryKey))=="[object ArrayBuffer]"&&(L=""+new Uint8Array(H)),p(C,L)||(C[L]=!0,u(O,U,D)))};return Promise.all([c.or._iterate(R,m),Hu(Vu(c,y,m),c.algorithm,R,!c.keysOnly&&c.valueMapper)])}return Hu(Vu(c,y,m),En(c.algorithm,E),u,!c.keysOnly&&c.valueMapper)}function Hu(c,u,m,y){var E=Ze(y?function(C,R,O){return m(y(C),R,O)}:m);return c.then(function(C){if(C)return C.start(function(){var R=function(){return C.continue()};u&&!u(C,function(O){return R=O},function(O){C.stop(O),R=Le},function(O){C.fail(O),R=Le})||E(C.value,C,function(O){return R=O}),R()})})}var wi=Symbol(),Xl=(Yu.prototype.execute=function(c){var u=(u=this.replacePrefix)===null||u===void 0?void 0:u[0];return u&&typeof c=="string"&&c.startsWith(u)?this.replacePrefix[1]+c.substring(u.length):c},Yu);function Yu(c){Object.assign(this,c)}var Z0=(Pe.prototype._read=function(c,u){var m=this._ctx;return m.error?m.table._trans(null,it.bind(null,m.error)):m.table._trans("readonly",c).then(u)},Pe.prototype._write=function(c){var u=this._ctx;return u.error?u.table._trans(null,it.bind(null,u.error)):u.table._trans("readwrite",c,"locked")},Pe.prototype._addAlgorithm=function(c){var u=this._ctx;u.algorithm=En(u.algorithm,c)},Pe.prototype._iterate=function(c,u){return Lo(this._ctx,c,u,this._ctx.table.core)},Pe.prototype.clone=function(c){var u=Object.create(this.constructor.prototype),m=Object.create(this._ctx);return c&&l(m,c),u._ctx=m,u},Pe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Pe.prototype.each=function(c){var u=this._ctx;return this._read(function(m){return Lo(u,c,m,u.table.core)})},Pe.prototype.count=function(c){var u=this;return this._read(function(m){var y=u._ctx,E=y.table.core;if(ns(y,!0))return E.count({trans:m,query:{index:Mo(y,E.schema),range:y.range}}).then(function(R){return Math.min(R,y.limit)});var C=0;return Lo(y,function(){return++C,!1},m,E).then(function(){return C})}).then(c)},Pe.prototype.sortBy=function(c,u){var m=c.split(".").reverse(),y=m[0],E=m.length-1;function C(U,D){return D?C(U[m[D]],D-1):U[y]}var R=this._ctx.dir==="next"?1:-1;function O(U,D){return U=C(U,E),D=C(D,E),U<D?-R:D<U?R:0}return this.toArray(function(U){return U.sort(O)}).then(u)},Pe.prototype.toArray=function(c){var u=this;return this._read(function(m){var y=u._ctx;if(y.dir==="next"&&ns(y,!0)&&0<y.limit){var E=y.valueMapper,C=Mo(y,y.table.core.schema);return y.table.core.query({trans:m,limit:y.limit,values:!0,query:{index:C,range:y.range}}).then(function(O){return O=O.result,E?O.map(E):O})}var R=[];return Lo(y,function(O){return R.push(O)},m,y.table.core).then(function(){return R})},c)},Pe.prototype.offset=function(c){var u=this._ctx;return c<=0||(u.offset+=c,ns(u)?Wl(u,function(){var m=c;return function(y,E){return m===0||(m===1?--m:E(function(){y.advance(m),m=0}),!1)}}):Wl(u,function(){var m=c;return function(){return--m<0}})),this},Pe.prototype.limit=function(c){return this._ctx.limit=Math.min(this._ctx.limit,c),Wl(this._ctx,function(){var u=c;return function(m,y,E){return--u<=0&&y(E),0<=u}},!0),this},Pe.prototype.until=function(c,u){return jl(this._ctx,function(m,y,E){return!c(m.value)||(y(E),u)}),this},Pe.prototype.first=function(c){return this.limit(1).toArray(function(u){return u[0]}).then(c)},Pe.prototype.last=function(c){return this.reverse().first(c)},Pe.prototype.filter=function(c){var u;return jl(this._ctx,function(m){return c(m.value)}),(u=this._ctx).isMatch=En(u.isMatch,c),this},Pe.prototype.and=function(c){return this.filter(c)},Pe.prototype.or=function(c){return new this.db.WhereClause(this._ctx.table,c,this)},Pe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Pe.prototype.desc=function(){return this.reverse()},Pe.prototype.eachKey=function(c){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(m,y){c(y.key,y)})},Pe.prototype.eachUniqueKey=function(c){return this._ctx.unique="unique",this.eachKey(c)},Pe.prototype.eachPrimaryKey=function(c){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(m,y){c(y.primaryKey,y)})},Pe.prototype.keys=function(c){var u=this._ctx;u.keysOnly=!u.isMatch;var m=[];return this.each(function(y,E){m.push(E.key)}).then(function(){return m}).then(c)},Pe.prototype.primaryKeys=function(c){var u=this._ctx;if(u.dir==="next"&&ns(u,!0)&&0<u.limit)return this._read(function(y){var E=Mo(u,u.table.core.schema);return u.table.core.query({trans:y,values:!1,limit:u.limit,query:{index:E,range:u.range}})}).then(function(y){return y.result}).then(c);u.keysOnly=!u.isMatch;var m=[];return this.each(function(y,E){m.push(E.primaryKey)}).then(function(){return m}).then(c)},Pe.prototype.uniqueKeys=function(c){return this._ctx.unique="unique",this.keys(c)},Pe.prototype.firstKey=function(c){return this.limit(1).keys(function(u){return u[0]}).then(c)},Pe.prototype.lastKey=function(c){return this.reverse().firstKey(c)},Pe.prototype.distinct=function(){var c=this._ctx,c=c.index&&c.table.schema.idxByName[c.index];if(!c||!c.multi)return this;var u={};return jl(this._ctx,function(E){var y=E.primaryKey.toString(),E=p(u,y);return u[y]=!0,!E}),this},Pe.prototype.modify=function(c){var u=this,m=this._ctx;return this._write(function(y){var E,C,R;R=typeof c=="function"?c:(E=o(c),C=E.length,function(z){for(var X=!1,K=0;K<C;++K){var Z=E[K],q=c[Z],ie=M(z,Z);q instanceof Xl?(k(z,Z,q.execute(ie)),X=!0):ie!==q&&(k(z,Z,q),X=!0)}return X});function O(z,Z){var K=Z.failures,Z=Z.numFailures;B+=z-Z;for(var q=0,ie=o(K);q<ie.length;q++){var ce=ie[q];N.push(K[ce])}}var U=m.table.core,D=U.schema.primaryKey,H=D.outbound,L=D.extractKey,Y=u.db._options.modifyChunkSize||200,N=[],B=0,G=[];return u.clone().primaryKeys().then(function(z){function X(K){var Z=Math.min(Y,z.length-K);return U.getMany({trans:y,keys:z.slice(K,K+Z),cache:"immutable"}).then(function(q){for(var ie=[],ce=[],se=H?[]:null,ae=[],he=0;he<Z;++he){var ue=q[he],Ie={value:ne(ue),primKey:z[K+he]};R.call(Ie,Ie.value,Ie)!==!1&&(Ie.value==null?ae.push(z[K+he]):H||Oe(L(ue),L(Ie.value))===0?(ce.push(Ie.value),H&&se.push(z[K+he])):(ae.push(z[K+he]),ie.push(Ie.value)))}var xe=ns(m)&&m.limit===1/0&&(typeof c!="function"||c===Kl)&&{index:m.index,range:m.range};return Promise.resolve(0<ie.length&&U.mutate({trans:y,type:"add",values:ie}).then(function(_e){for(var Ae in _e.failures)ae.splice(parseInt(Ae),1);O(ie.length,_e)})).then(function(){return(0<ce.length||xe&&typeof c=="object")&&U.mutate({trans:y,type:"put",keys:se,values:ce,criteria:xe,changeSpec:typeof c!="function"&&c}).then(function(_e){return O(ce.length,_e)})}).then(function(){return(0<ae.length||xe&&c===Kl)&&U.mutate({trans:y,type:"delete",keys:ae,criteria:xe}).then(function(_e){return O(ae.length,_e)})}).then(function(){return z.length>K+Z&&X(K+Y)})})}return X(0).then(function(){if(0<N.length)throw new je("Error modifying one or more objects",N,B,G);return z.length})})})},Pe.prototype.delete=function(){var c=this._ctx,u=c.range;return ns(c)&&(c.isPrimKey||u.type===3)?this._write(function(m){var y=c.table.core.schema.primaryKey,E=u;return c.table.core.count({trans:m,query:{index:y,range:E}}).then(function(C){return c.table.core.mutate({trans:m,type:"deleteRange",range:E}).then(function(R){var O=R.failures;if(R.lastResult,R.results,R=R.numFailures,R)throw new je("Could not delete some values",Object.keys(O).map(function(U){return O[U]}),C-R);return C-R})})}):this.modify(Kl)},Pe);function Pe(){}var Kl=function(c,u){return u.value=null};function q0(c,u){return c<u?-1:c===u?0:1}function J0(c,u){return u<c?-1:c===u?0:1}function Ft(c,u,m){return c=c instanceof ju?new c.Collection(c):c,c._ctx.error=new(m||TypeError)(u),c}function ss(c){return new c.Collection(c,function(){return Gu("")}).limit(0)}function Do(c,u,m,y){var E,C,R,O,U,D,H,L=m.length;if(!m.every(function(B){return typeof B=="string"}))return Ft(c,Du);function Y(B){E=B==="next"?function(z){return z.toUpperCase()}:function(z){return z.toLowerCase()},C=B==="next"?function(z){return z.toLowerCase()}:function(z){return z.toUpperCase()},R=B==="next"?q0:J0;var G=m.map(function(z){return{lower:C(z),upper:E(z)}}).sort(function(z,X){return R(z.lower,X.lower)});O=G.map(function(z){return z.upper}),U=G.map(function(z){return z.lower}),H=(D=B)==="next"?"":y}Y("next"),c=new c.Collection(c,function(){return Gi(O[0],U[L-1]+y)}),c._ondirectionchange=function(B){Y(B)};var N=0;return c._addAlgorithm(function(B,G,z){var X=B.key;if(typeof X!="string")return!1;var K=C(X);if(u(K,U,N))return!0;for(var Z=null,q=N;q<L;++q){var ie=function(ce,se,ae,he,ue,Ie){for(var xe=Math.min(ce.length,he.length),_e=-1,Ae=0;Ae<xe;++Ae){var $t=se[Ae];if($t!==he[Ae])return ue(ce[Ae],ae[Ae])<0?ce.substr(0,Ae)+ae[Ae]+ae.substr(Ae+1):ue(ce[Ae],he[Ae])<0?ce.substr(0,Ae)+he[Ae]+ae.substr(Ae+1):0<=_e?ce.substr(0,_e)+se[_e]+ae.substr(_e+1):null;ue(ce[Ae],$t)<0&&(_e=Ae)}return xe<he.length&&Ie==="next"?ce+ae.substr(ce.length):xe<ce.length&&Ie==="prev"?ce.substr(0,ae.length):_e<0?null:ce.substr(0,_e)+he[_e]+ae.substr(_e+1)}(X,K,O[q],U[q],R,D);ie===null&&Z===null?N=q+1:(Z===null||0<R(Z,ie))&&(Z=ie)}return G(Z!==null?function(){B.continue(Z+H)}:z),!1}),c}function Gi(c,u,m,y){return{type:2,lower:c,upper:u,lowerOpen:m,upperOpen:y}}function Gu(c){return{type:1,lower:c,upper:c}}var ju=(Object.defineProperty(ct.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ct.prototype.between=function(c,u,m,y){m=m!==!1,y=y===!0;try{return 0<this._cmp(c,u)||this._cmp(c,u)===0&&(m||y)&&(!m||!y)?ss(this):new this.Collection(this,function(){return Gi(c,u,!m,!y)})}catch{return Ft(this,bi)}},ct.prototype.equals=function(c){return c==null?Ft(this,bi):new this.Collection(this,function(){return Gu(c)})},ct.prototype.above=function(c){return c==null?Ft(this,bi):new this.Collection(this,function(){return Gi(c,void 0,!0)})},ct.prototype.aboveOrEqual=function(c){return c==null?Ft(this,bi):new this.Collection(this,function(){return Gi(c,void 0,!1)})},ct.prototype.below=function(c){return c==null?Ft(this,bi):new this.Collection(this,function(){return Gi(void 0,c,!1,!0)})},ct.prototype.belowOrEqual=function(c){return c==null?Ft(this,bi):new this.Collection(this,function(){return Gi(void 0,c)})},ct.prototype.startsWith=function(c){return typeof c!="string"?Ft(this,Du):this.between(c,c+yn,!0,!0)},ct.prototype.startsWithIgnoreCase=function(c){return c===""?this.startsWith(c):Do(this,function(u,m){return u.indexOf(m[0])===0},[c],yn)},ct.prototype.equalsIgnoreCase=function(c){return Do(this,function(u,m){return u===m[0]},[c],"")},ct.prototype.anyOfIgnoreCase=function(){var c=Ge.apply(we,arguments);return c.length===0?ss(this):Do(this,function(u,m){return m.indexOf(u)!==-1},c,"")},ct.prototype.startsWithAnyOfIgnoreCase=function(){var c=Ge.apply(we,arguments);return c.length===0?ss(this):Do(this,function(u,m){return m.some(function(y){return u.indexOf(y)===0})},c,yn)},ct.prototype.anyOf=function(){var c=this,u=Ge.apply(we,arguments),m=this._cmp;try{u.sort(m)}catch{return Ft(this,bi)}if(u.length===0)return ss(this);var y=new this.Collection(this,function(){return Gi(u[0],u[u.length-1])});y._ondirectionchange=function(C){m=C==="next"?c._ascending:c._descending,u.sort(m)};var E=0;return y._addAlgorithm(function(C,R,O){for(var U=C.key;0<m(U,u[E]);)if(++E===u.length)return R(O),!1;return m(U,u[E])===0||(R(function(){C.continue(u[E])}),!1)}),y},ct.prototype.notEqual=function(c){return this.inAnyRange([[-1/0,c],[c,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ct.prototype.noneOf=function(){var c=Ge.apply(we,arguments);if(c.length===0)return new this.Collection(this);try{c.sort(this._ascending)}catch{return Ft(this,bi)}var u=c.reduce(function(m,y){return m?m.concat([[m[m.length-1][1],y]]):[[-1/0,y]]},null);return u.push([c[c.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},ct.prototype.inAnyRange=function(X,u){var m=this,y=this._cmp,E=this._ascending,C=this._descending,R=this._min,O=this._max;if(X.length===0)return ss(this);if(!X.every(function(K){return K[0]!==void 0&&K[1]!==void 0&&E(K[0],K[1])<=0}))return Ft(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",fe.InvalidArgument);var U=!u||u.includeLowers!==!1,D=u&&u.includeUppers===!0,H,L=E;function Y(K,Z){return L(K[0],Z[0])}try{(H=X.reduce(function(K,Z){for(var q=0,ie=K.length;q<ie;++q){var ce=K[q];if(y(Z[0],ce[1])<0&&0<y(Z[1],ce[0])){ce[0]=R(ce[0],Z[0]),ce[1]=O(ce[1],Z[1]);break}}return q===ie&&K.push(Z),K},[])).sort(Y)}catch{return Ft(this,bi)}var N=0,B=D?function(K){return 0<E(K,H[N][1])}:function(K){return 0<=E(K,H[N][1])},G=U?function(K){return 0<C(K,H[N][0])}:function(K){return 0<=C(K,H[N][0])},z=B,X=new this.Collection(this,function(){return Gi(H[0][0],H[H.length-1][1],!U,!D)});return X._ondirectionchange=function(K){L=K==="next"?(z=B,E):(z=G,C),H.sort(Y)},X._addAlgorithm(function(K,Z,q){for(var ie,ce=K.key;z(ce);)if(++N===H.length)return Z(q),!1;return!B(ie=ce)&&!G(ie)||(m._cmp(ce,H[N][1])===0||m._cmp(ce,H[N][0])===0||Z(function(){L===E?K.continue(H[N][0]):K.continue(H[N][1])}),!1)}),X},ct.prototype.startsWithAnyOf=function(){var c=Ge.apply(we,arguments);return c.every(function(u){return typeof u=="string"})?c.length===0?ss(this):this.inAnyRange(c.map(function(u){return[u,u+yn]})):Ft(this,"startsWithAnyOf() only works with strings")},ct);function ct(){}function ci(c){return Ze(function(u){return ar(u),c(u.target.error),!1})}function ar(c){c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault()}var lr="storagemutated",Ql="x-storagemutated-1",ji=rr(null,lr),$0=(hi.prototype._lock=function(){return I(!ye.global),++this._reculock,this._reculock!==1||ye.global||(ye.lockOwnerFor=this),this},hi.prototype._unlock=function(){if(I(!ye.global),--this._reculock==0)for(ye.global||(ye.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var c=this._blockedFuncs.shift();try{vn(c[1],c[0])}catch{}}return this},hi.prototype._locked=function(){return this._reculock&&ye.lockOwnerFor!==this},hi.prototype.create=function(c){var u=this;if(!this.mode)return this;var m=this.db.idbdb,y=this.db._state.dbOpenError;if(I(!this.idbtrans),!c&&!m)switch(y&&y.name){case"DatabaseClosedError":throw new fe.DatabaseClosed(y);case"MissingAPIError":throw new fe.MissingAPI(y.message,y);default:throw new fe.OpenFailed(y)}if(!this.active)throw new fe.TransactionInactive;return I(this._completion._state===null),(c=this.idbtrans=c||(this.db.core||m).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ze(function(E){ar(E),u._reject(c.error)}),c.onabort=Ze(function(E){ar(E),u.active&&u._reject(new fe.Abort(c.error)),u.active=!1,u.on("abort").fire(E)}),c.oncomplete=Ze(function(){u.active=!1,u._resolve(),"mutatedParts"in c&&ji.storagemutated.fire(c.mutatedParts)}),this},hi.prototype._promise=function(c,u,m){var y=this;if(c==="readwrite"&&this.mode!=="readwrite")return it(new fe.ReadOnly("Transaction is readonly"));if(!this.active)return it(new fe.TransactionInactive);if(this._locked())return new de(function(C,R){y._blockedFuncs.push([function(){y._promise(c,u,m).then(C,R)},ye])});if(m)return Vi(function(){var C=new de(function(R,O){y._lock();var U=u(R,O,y);U&&U.then&&U.then(R,O)});return C.finally(function(){return y._unlock()}),C._lib=!0,C});var E=new de(function(C,R){var O=u(C,R,y);O&&O.then&&O.then(C,R)});return E._lib=!0,E},hi.prototype._root=function(){return this.parent?this.parent._root():this},hi.prototype.waitFor=function(c){var u,m=this._root(),y=de.resolve(c);m._waitingFor?m._waitingFor=m._waitingFor.then(function(){return y}):(m._waitingFor=y,m._waitingQueue=[],u=m.idbtrans.objectStore(m.storeNames[0]),function C(){for(++m._spinCount;m._waitingQueue.length;)m._waitingQueue.shift()();m._waitingFor&&(u.get(-1/0).onsuccess=C)}());var E=m._waitingFor;return new de(function(C,R){y.then(function(O){return m._waitingQueue.push(Ze(C.bind(null,O)))},function(O){return m._waitingQueue.push(Ze(R.bind(null,O)))}).finally(function(){m._waitingFor===E&&(m._waitingFor=null)})})},hi.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new fe.Abort))},hi.prototype.table=function(c){var u=this._memoizedTables||(this._memoizedTables={});if(p(u,c))return u[c];var m=this.schema[c];if(!m)throw new fe.NotFound("Table "+c+" not part of transaction");return m=new this.db.Table(c,m,this),m.core=this.db.core.table(c),u[c]=m},hi);function hi(){}function Zl(c,u,m,y,E,C,R){return{name:c,keyPath:u,unique:m,multi:y,auto:E,compound:C,src:(m&&!R?"&":"")+(y?"*":"")+(E?"++":"")+Wu(u)}}function Wu(c){return typeof c=="string"?c:c?"["+[].join.call(c,"+")+"]":""}function ql(c,u,m){return{name:c,primKey:u,indexes:m,mappedClass:null,idxByName:(y=function(E){return[E.name,E]},m.reduce(function(E,C,R){return R=y(C,R),R&&(E[R[0]]=R[1]),E},{}))};var y}var cr=function(c){try{return c.only([[]]),cr=function(){return[[]]},[[]]}catch{return cr=function(){return yn},yn}};function Jl(c){return c==null?function(){}:typeof c=="string"?(u=c).split(".").length===1?function(m){return m[u]}:function(m){return M(m,u)}:function(m){return M(m,c)};var u}function Xu(c){return[].slice.call(c)}var ev=0;function hr(c){return c==null?":id":typeof c=="string"?c:"[".concat(c.join("+"),"]")}function tv(c,u,U){function y(z){if(z.type===3)return null;if(z.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var N=z.lower,B=z.upper,G=z.lowerOpen,z=z.upperOpen;return N===void 0?B===void 0?null:u.upperBound(B,!!z):B===void 0?u.lowerBound(N,!!G):u.bound(N,B,!!G,!!z)}function E(Y){var N,B=Y.name;return{name:B,schema:Y,mutate:function(G){var z=G.trans,X=G.type,K=G.keys,Z=G.values,q=G.range;return new Promise(function(ie,ce){ie=Ze(ie);var se=z.objectStore(B),ae=se.keyPath==null,he=X==="put"||X==="add";if(!he&&X!=="delete"&&X!=="deleteRange")throw new Error("Invalid operation type: "+X);var ue,Ie=(K||Z||{length:1}).length;if(K&&Z&&K.length!==Z.length)throw new Error("Given keys array must have same length as given values array.");if(Ie===0)return ie({numFailures:0,failures:{},results:[],lastResult:void 0});function xe(Ct){++$t,ar(Ct)}var _e=[],Ae=[],$t=0;if(X==="deleteRange"){if(q.type===4)return ie({numFailures:$t,failures:Ae,results:[],lastResult:void 0});q.type===3?_e.push(ue=se.clear()):_e.push(ue=se.delete(y(q)))}else{var ae=he?ae?[Z,K]:[Z,null]:[K,null],Se=ae[0],yt=ae[1];if(he)for(var Et=0;Et<Ie;++Et)_e.push(ue=yt&&yt[Et]!==void 0?se[X](Se[Et],yt[Et]):se[X](Se[Et])),ue.onerror=xe;else for(Et=0;Et<Ie;++Et)_e.push(ue=se[X](Se[Et])),ue.onerror=xe}function Ko(Ct){Ct=Ct.target.result,_e.forEach(function(In,vc){return In.error!=null&&(Ae[vc]=In.error)}),ie({numFailures:$t,failures:Ae,results:X==="delete"?K:_e.map(function(In){return In.result}),lastResult:Ct})}ue.onerror=function(Ct){xe(Ct),Ko(Ct)},ue.onsuccess=Ko})},getMany:function(G){var z=G.trans,X=G.keys;return new Promise(function(K,Z){K=Ze(K);for(var q,ie=z.objectStore(B),ce=X.length,se=new Array(ce),ae=0,he=0,ue=function(_e){_e=_e.target,se[_e._pos]=_e.result,++he===ae&&K(se)},Ie=ci(Z),xe=0;xe<ce;++xe)X[xe]!=null&&((q=ie.get(X[xe]))._pos=xe,q.onsuccess=ue,q.onerror=Ie,++ae);ae===0&&K(se)})},get:function(G){var z=G.trans,X=G.key;return new Promise(function(K,Z){K=Ze(K);var q=z.objectStore(B).get(X);q.onsuccess=function(ie){return K(ie.target.result)},q.onerror=ci(Z)})},query:(N=D,function(G){return new Promise(function(z,X){z=Ze(z);var K,Z,q,ae=G.trans,ie=G.values,ce=G.limit,ue=G.query,se=ce===1/0?void 0:ce,he=ue.index,ue=ue.range,ae=ae.objectStore(B),he=he.isPrimaryKey?ae:ae.index(he.name),ue=y(ue);if(ce===0)return z({result:[]});N?((se=ie?he.getAll(ue,se):he.getAllKeys(ue,se)).onsuccess=function(Ie){return z({result:Ie.target.result})},se.onerror=ci(X)):(K=0,Z=!ie&&"openKeyCursor"in he?he.openKeyCursor(ue):he.openCursor(ue),q=[],Z.onsuccess=function(Ie){var xe=Z.result;return xe?(q.push(ie?xe.value:xe.primaryKey),++K===ce?z({result:q}):void xe.continue()):z({result:q})},Z.onerror=ci(X))})}),openCursor:function(G){var z=G.trans,X=G.values,K=G.query,Z=G.reverse,q=G.unique;return new Promise(function(ie,ce){ie=Ze(ie);var he=K.index,se=K.range,ae=z.objectStore(B),ae=he.isPrimaryKey?ae:ae.index(he.name),he=Z?q?"prevunique":"prev":q?"nextunique":"next",ue=!X&&"openKeyCursor"in ae?ae.openKeyCursor(y(se),he):ae.openCursor(y(se),he);ue.onerror=ci(ce),ue.onsuccess=Ze(function(Ie){var xe,_e,Ae,$t,Se=ue.result;Se?(Se.___id=++ev,Se.done=!1,xe=Se.continue.bind(Se),_e=(_e=Se.continuePrimaryKey)&&_e.bind(Se),Ae=Se.advance.bind(Se),$t=function(){throw new Error("Cursor not stopped")},Se.trans=z,Se.stop=Se.continue=Se.continuePrimaryKey=Se.advance=function(){throw new Error("Cursor not started")},Se.fail=Ze(ce),Se.next=function(){var yt=this,Et=1;return this.start(function(){return Et--?yt.continue():yt.stop()}).then(function(){return yt})},Se.start=function(yt){function Et(){if(ue.result)try{yt()}catch(Ct){Se.fail(Ct)}else Se.done=!0,Se.start=function(){throw new Error("Cursor behind last entry")},Se.stop()}var Ko=new Promise(function(Ct,In){Ct=Ze(Ct),ue.onerror=ci(In),Se.fail=In,Se.stop=function(vc){Se.stop=Se.continue=Se.continuePrimaryKey=Se.advance=$t,Ct(vc)}});return ue.onsuccess=Ze(function(Ct){ue.onsuccess=Et,Et()}),Se.continue=xe,Se.continuePrimaryKey=_e,Se.advance=Ae,Et(),Ko},ie(Se)):ie(null)},ce)})},count:function(G){var z=G.query,X=G.trans,K=z.index,Z=z.range;return new Promise(function(q,ie){var ce=X.objectStore(B),se=K.isPrimaryKey?ce:ce.index(K.name),ce=y(Z),se=ce?se.count(ce):se.count();se.onsuccess=Ze(function(ae){return q(ae.target.result)}),se.onerror=ci(ie)})}}}var C,R,O,H=(R=U,O=Xu((C=c).objectStoreNames),{schema:{name:C.name,tables:O.map(function(Y){return R.objectStore(Y)}).map(function(Y){var N=Y.keyPath,z=Y.autoIncrement,B=a(N),G={},z={name:Y.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:N==null,compound:B,keyPath:N,autoIncrement:z,unique:!0,extractKey:Jl(N)},indexes:Xu(Y.indexNames).map(function(X){return Y.index(X)}).map(function(q){var K=q.name,Z=q.unique,ie=q.multiEntry,q=q.keyPath,ie={name:K,compound:a(q),keyPath:q,unique:Z,multiEntry:ie,extractKey:Jl(q)};return G[hr(q)]=ie}),getIndexByKeyPath:function(X){return G[hr(X)]}};return G[":id"]=z.primaryKey,N!=null&&(G[hr(N)]=z.primaryKey),z})},hasGetAll:0<O.length&&"getAll"in R.objectStore(O[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),U=H.schema,D=H.hasGetAll,H=U.tables.map(E),L={};return H.forEach(function(Y){return L[Y.name]=Y}),{stack:"dbcore",transaction:c.transaction.bind(c),table:function(Y){if(!L[Y])throw new Error("Table '".concat(Y,"' not found"));return L[Y]},MIN_KEY:-1/0,MAX_KEY:cr(u),schema:U}}function iv(c,u,m,y){var E=m.IDBKeyRange;return m.indexedDB,{dbcore:(y=tv(u,E,y),c.dbcore.reduce(function(C,R){return R=R.create,i(i({},C),R(C))},y))}}function No(c,y){var m=y.db,y=iv(c._middlewares,m,c._deps,y);c.core=y.dbcore,c.tables.forEach(function(E){var C=E.name;c.core.schema.tables.some(function(R){return R.name===C})&&(E.core=c.core.table(C),c[C]instanceof c.Table&&(c[C].core=E.core))})}function Uo(c,u,m,y){m.forEach(function(E){var C=y[E];u.forEach(function(R){var O=function U(D,H){return w(D,H)||(D=h(D))&&U(D,H)}(R,E);(!O||"value"in O&&O.value===void 0)&&(R===c.Transaction.prototype||R instanceof c.Transaction?v(R,E,{get:function(){return this.table(E)},set:function(U){g(this,E,{value:U,writable:!0,configurable:!0,enumerable:!0})}}):R[E]=new c.Table(E,C))})})}function $l(c,u){u.forEach(function(m){for(var y in m)m[y]instanceof c.Table&&delete m[y]})}function nv(c,u){return c._cfg.version-u._cfg.version}function sv(c,u,m,y){var E=c._dbSchema;m.objectStoreNames.contains("$meta")&&!E.$meta&&(E.$meta=ql("$meta",Qu("")[0],[]),c._storeNames.push("$meta"));var C=c._createTransaction("readwrite",c._storeNames,E);C.create(m),C._completion.catch(y);var R=C._reject.bind(C),O=ye.transless||ye;Vi(function(){return ye.trans=C,ye.transless=O,u!==0?(No(c,m),D=u,((U=C).storeNames.includes("$meta")?U.table("$meta").get("version").then(function(H){return H??D}):de.resolve(D)).then(function(H){return Y=H,N=C,B=m,G=[],H=(L=c)._versions,z=L._dbSchema=Bo(0,L.idbdb,B),(H=H.filter(function(X){return X._cfg.version>=Y})).length!==0?(H.forEach(function(X){G.push(function(){var K=z,Z=X._cfg.dbschema;zo(L,K,B),zo(L,Z,B),z=L._dbSchema=Z;var q=ec(K,Z);q.add.forEach(function(he){tc(B,he[0],he[1].primKey,he[1].indexes)}),q.change.forEach(function(he){if(he.recreate)throw new fe.Upgrade("Not yet support for changing primary key");var ue=B.objectStore(he.name);he.add.forEach(function(Ie){return ko(ue,Ie)}),he.change.forEach(function(Ie){ue.deleteIndex(Ie.name),ko(ue,Ie)}),he.del.forEach(function(Ie){return ue.deleteIndex(Ie)})});var ie=X._cfg.contentUpgrade;if(ie&&X._cfg.version>Y){No(L,B),N._memoizedTables={};var ce=V(Z);q.del.forEach(function(he){ce[he]=K[he]}),$l(L,[L.Transaction.prototype]),Uo(L,[L.Transaction.prototype],o(ce),ce),N.schema=ce;var se,ae=Pt(ie);return ae&&ts(),q=de.follow(function(){var he;(se=ie(N))&&ae&&(he=Hi.bind(null,null),se.then(he,he))}),se&&typeof se.then=="function"?de.resolve(se):q.then(function(){return se})}}),G.push(function(K){var Z,q,ie=X._cfg.dbschema;Z=ie,q=K,[].slice.call(q.db.objectStoreNames).forEach(function(ce){return Z[ce]==null&&q.db.deleteObjectStore(ce)}),$l(L,[L.Transaction.prototype]),Uo(L,[L.Transaction.prototype],L._storeNames,L._dbSchema),N.schema=L._dbSchema}),G.push(function(K){L.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(L.idbdb.version/10)===X._cfg.version?(L.idbdb.deleteObjectStore("$meta"),delete L._dbSchema.$meta,L._storeNames=L._storeNames.filter(function(Z){return Z!=="$meta"})):K.objectStore("$meta").put(X._cfg.version,"version"))})}),function X(){return G.length?de.resolve(G.shift()(N.idbtrans)).then(X):de.resolve()}().then(function(){Ku(z,B)})):de.resolve();var L,Y,N,B,G,z}).catch(R)):(o(E).forEach(function(H){tc(m,H,E[H].primKey,E[H].indexes)}),No(c,m),void de.follow(function(){return c.on.populate.fire(C)}).catch(R));var U,D})}function rv(c,u){Ku(c._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var m=Bo(0,c.idbdb,u);zo(c,c._dbSchema,u);for(var y=0,E=ec(m,c._dbSchema).change;y<E.length;y++){var C=function(R){if(R.change.length||R.recreate)return console.warn("Unable to patch indexes of table ".concat(R.name," because it has changes on the type of index or primary key.")),{value:void 0};var O=u.objectStore(R.name);R.add.forEach(function(U){li&&console.debug("Dexie upgrade patch: Creating missing index ".concat(R.name,".").concat(U.src)),ko(O,U)})}(E[y]);if(typeof C=="object")return C.value}}function ec(c,u){var m,y={del:[],add:[],change:[]};for(m in c)u[m]||y.del.push(m);for(m in u){var E=c[m],C=u[m];if(E){var R={name:m,def:C,recreate:!1,del:[],add:[],change:[]};if(""+(E.primKey.keyPath||"")!=""+(C.primKey.keyPath||"")||E.primKey.auto!==C.primKey.auto)R.recreate=!0,y.change.push(R);else{var O=E.idxByName,U=C.idxByName,D=void 0;for(D in O)U[D]||R.del.push(D);for(D in U){var H=O[D],L=U[D];H?H.src!==L.src&&R.change.push(L):R.add.push(L)}(0<R.del.length||0<R.add.length||0<R.change.length)&&y.change.push(R)}}else y.add.push([m,C])}return y}function tc(c,u,m,y){var E=c.db.createObjectStore(u,m.keyPath?{keyPath:m.keyPath,autoIncrement:m.auto}:{autoIncrement:m.auto});return y.forEach(function(C){return ko(E,C)}),E}function Ku(c,u){o(c).forEach(function(m){u.db.objectStoreNames.contains(m)||(li&&console.debug("Dexie: Creating missing table",m),tc(u,m,c[m].primKey,c[m].indexes))})}function ko(c,u){c.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function Bo(c,u,m){var y={};return S(u.objectStoreNames,0).forEach(function(E){for(var C=m.objectStore(E),R=Zl(Wu(D=C.keyPath),D||"",!0,!1,!!C.autoIncrement,D&&typeof D!="string",!0),O=[],U=0;U<C.indexNames.length;++U){var H=C.index(C.indexNames[U]),D=H.keyPath,H=Zl(H.name,D,!!H.unique,!!H.multiEntry,!1,D&&typeof D!="string",!1);O.push(H)}y[E]=ql(E,R,O)}),y}function zo(c,u,m){for(var y=m.db.objectStoreNames,E=0;E<y.length;++E){var C=y[E],R=m.objectStore(C);c._hasGetAll="getAll"in R;for(var O=0;O<R.indexNames.length;++O){var U=R.indexNames[O],D=R.index(U).keyPath,H=typeof D=="string"?D:"["+S(D).join("+")+"]";!u[C]||(D=u[C].idxByName[H])&&(D.name=U,delete u[C].idxByName[H],u[C].idxByName[U]=D)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&r.WorkerGlobalScope&&r instanceof r.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(c._hasGetAll=!1)}function Qu(c){return c.split(",").map(function(u,m){var y=(u=u.trim()).replace(/([&*]|\+\+)/g,""),E=/^\[/.test(y)?y.match(/^\[(.*)\]$/)[1].split("+"):y;return Zl(y,E||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),a(E),m===0)})}var ov=(Vo.prototype._parseStoresSpec=function(c,u){o(c).forEach(function(m){if(c[m]!==null){var y=Qu(c[m]),E=y.shift();if(E.unique=!0,E.multi)throw new fe.Schema("Primary key cannot be multi-valued");y.forEach(function(C){if(C.auto)throw new fe.Schema("Only primary key can be marked as autoIncrement (++)");if(!C.keyPath)throw new fe.Schema("Index must have a name and cannot be an empty string")}),u[m]=ql(m,E,y)}})},Vo.prototype.stores=function(m){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,m):m;var m=u._versions,y={},E={};return m.forEach(function(C){l(y,C._cfg.storesSource),E=C._cfg.dbschema={},C._parseStoresSpec(y,E)}),u._dbSchema=E,$l(u,[u._allTables,u,u.Transaction.prototype]),Uo(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],o(E),E),u._storeNames=o(E),this},Vo.prototype.upgrade=function(c){return this._cfg.contentUpgrade=Ll(this._cfg.contentUpgrade||Le,c),this},Vo);function Vo(){}function ic(c,u){var m=c._dbNamesDB;return m||(m=c._dbNamesDB=new Ii(Fo,{addons:[],indexedDB:c,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),m.table("dbnames")}function nc(c){return c&&typeof c.databases=="function"}function sc(c){return Vi(function(){return ye.letThrough=!0,c()})}function rc(c){return!("from"in c)}var vt=function(c,u){if(!this){var m=new vt;return c&&"d"in c&&l(m,c),m}l(this,arguments.length?{d:1,from:c,to:1<arguments.length?u:c}:{d:0})};function ur(c,u,m){var y=Oe(u,m);if(!isNaN(y)){if(0<y)throw RangeError();if(rc(c))return l(c,{from:u,to:m,d:1});var E=c.l,y=c.r;if(Oe(m,c.from)<0)return E?ur(E,u,m):c.l={from:u,to:m,d:1,l:null,r:null},Zu(c);if(0<Oe(u,c.to))return y?ur(y,u,m):c.r={from:u,to:m,d:1,l:null,r:null},Zu(c);Oe(u,c.from)<0&&(c.from=u,c.l=null,c.d=y?y.d+1:1),0<Oe(m,c.to)&&(c.to=m,c.r=null,c.d=c.l?c.l.d+1:1),m=!c.r,E&&!c.l&&dr(c,E),y&&m&&dr(c,y)}}function dr(c,u){rc(u)||function m(y,U){var C=U.from,R=U.to,O=U.l,U=U.r;ur(y,C,R),O&&m(y,O),U&&m(y,U)}(c,u)}function Ho(c,u){var m=oc(u),y=m.next();if(y.done)return!1;for(var E=y.value,C=oc(c),R=C.next(E.from),O=R.value;!y.done&&!R.done;){if(Oe(O.from,E.to)<=0&&0<=Oe(O.to,E.from))return!0;Oe(E.from,O.from)<0?E=(y=m.next(O.from)).value:O=(R=C.next(E.from)).value}return!1}function oc(c){var u=rc(c)?null:{s:0,n:c};return{next:function(m){for(var y=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,y)for(;u.n.l&&Oe(m,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!y||Oe(m,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function Zu(c){var u,m,y=(((u=c.r)===null||u===void 0?void 0:u.d)||0)-(((m=c.l)===null||m===void 0?void 0:m.d)||0),E=1<y?"r":y<-1?"l":"";E&&(u=E=="r"?"l":"r",m=i({},c),y=c[E],c.from=y.from,c.to=y.to,c[E]=y[E],m[E]=y[u],(c[u]=m).d=qu(m)),c.d=qu(c)}function qu(m){var u=m.r,m=m.l;return(u?m?Math.max(u.d,m.d):u.d:m?m.d:0)+1}function Yo(c,u){return o(u).forEach(function(m){c[m]?dr(c[m],u[m]):c[m]=function y(E){var C,R,O={};for(C in E)p(E,C)&&(R=E[C],O[C]=!R||typeof R!="object"||Q.has(R.constructor)?R:y(R));return O}(u[m])}),c}function ac(c,u){return c.all||u.all||Object.keys(c).some(function(m){return u[m]&&Ho(u[m],c[m])})}f(vt.prototype,((Bt={add:function(c){return dr(this,c),this},addKey:function(c){return ur(this,c,c),this},addKeys:function(c){var u=this;return c.forEach(function(m){return ur(u,m,m)}),this}})[re]=function(){return oc(this)},Bt));var bn={},lc={},cc=!1;function Go(c){Yo(lc,c),cc||(cc=!0,setTimeout(function(){cc=!1,hc(lc,!(lc={}))},0))}function hc(c,u){u===void 0&&(u=!1);var m=new Set;if(c.all)for(var y=0,E=Object.values(bn);y<E.length;y++)Ju(R=E[y],c,m,u);else for(var C in c){var R,O=/^idb\:\/\/(.*)\/(.*)\//.exec(C);O&&(C=O[1],O=O[2],(R=bn["idb://".concat(C,"/").concat(O)])&&Ju(R,c,m,u))}m.forEach(function(U){return U()})}function Ju(c,u,m,y){for(var E=[],C=0,R=Object.entries(c.queries.query);C<R.length;C++){for(var O=R[C],U=O[0],D=[],H=0,L=O[1];H<L.length;H++){var Y=L[H];ac(u,Y.obsSet)?Y.subscribers.forEach(function(z){return m.add(z)}):y&&D.push(Y)}y&&E.push([U,D])}if(y)for(var N=0,B=E;N<B.length;N++){var G=B[N],U=G[0],D=G[1];c.queries.query[U]=D}}function av(c){var u=c._state,m=c._deps.indexedDB;if(u.isBeingOpened||c.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?it(u.dbOpenError):c});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var y=u.openCanceller,E=Math.round(10*c.verno),C=!1;function R(){if(u.openCanceller!==y)throw new fe.DatabaseClosed("db.open() was cancelled")}function O(){return new de(function(Y,N){if(R(),!m)throw new fe.MissingAPI;var B=c.name,G=u.autoSchema||!E?m.open(B):m.open(B,E);if(!G)throw new fe.MissingAPI;G.onerror=ci(N),G.onblocked=Ze(c._fireOnBlocked),G.onupgradeneeded=Ze(function(z){var X;H=G.transaction,u.autoSchema&&!c._options.allowEmptyDB?(G.onerror=ar,H.abort(),G.result.close(),(X=m.deleteDatabase(B)).onsuccess=X.onerror=Ze(function(){N(new fe.NoSuchDatabase("Database ".concat(B," doesnt exist")))})):(H.onerror=ci(N),z=z.oldVersion>Math.pow(2,62)?0:z.oldVersion,L=z<1,c.idbdb=G.result,C&&rv(c,H),sv(c,z/10,H,N))},N),G.onsuccess=Ze(function(){H=null;var z,X,K,Z,q,ie=c.idbdb=G.result,ce=S(ie.objectStoreNames);if(0<ce.length)try{var se=ie.transaction((Z=ce).length===1?Z[0]:Z,"readonly");if(u.autoSchema)X=ie,K=se,(z=c).verno=X.version/10,K=z._dbSchema=Bo(0,X,K),z._storeNames=S(X.objectStoreNames,0),Uo(z,[z._allTables],o(K),K);else if(zo(c,c._dbSchema,se),((q=ec(Bo(0,(q=c).idbdb,se),q._dbSchema)).add.length||q.change.some(function(ae){return ae.add.length||ae.change.length}))&&!C)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ie.close(),E=ie.version+1,C=!0,Y(O());No(c,se)}catch{}is.push(c),ie.onversionchange=Ze(function(ae){u.vcFired=!0,c.on("versionchange").fire(ae)}),ie.onclose=Ze(function(ae){c.on("close").fire(ae)}),L&&(q=c._deps,se=B,ie=q.indexedDB,q=q.IDBKeyRange,nc(ie)||se===Fo||ic(ie,q).put({name:se}).catch(Le)),Y()},N)}).catch(function(Y){switch(Y==null?void 0:Y.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),O();break;case"VersionError":if(0<E)return E=0,O()}return de.reject(Y)})}var U,D=u.dbReadyResolve,H=null,L=!1;return de.race([y,(typeof navigator>"u"?de.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Y){function N(){return indexedDB.databases().finally(Y)}U=setInterval(N,100),N()}).finally(function(){return clearInterval(U)}):Promise.resolve()).then(O)]).then(function(){return R(),u.onReadyBeingFired=[],de.resolve(sc(function(){return c.on.ready.fire(c.vip)})).then(function Y(){if(0<u.onReadyBeingFired.length){var N=u.onReadyBeingFired.reduce(Ll,Le);return u.onReadyBeingFired=[],de.resolve(sc(function(){return N(c.vip)})).then(Y)}})}).finally(function(){u.openCanceller===y&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(Y){u.dbOpenError=Y;try{H&&H.abort()}catch{}return y===u.openCanceller&&c._close(),it(Y)}).finally(function(){u.openComplete=!0,D()}).then(function(){var Y;return L&&(Y={},c.tables.forEach(function(N){N.schema.indexes.forEach(function(B){B.name&&(Y["idb://".concat(c.name,"/").concat(N.name,"/").concat(B.name)]=new vt(-1/0,[[[]]]))}),Y["idb://".concat(c.name,"/").concat(N.name,"/")]=Y["idb://".concat(c.name,"/").concat(N.name,"/:dels")]=new vt(-1/0,[[[]]])}),ji(lr).fire(Y),hc(Y,!0)),c})}function uc(c){function u(C){return c.next(C)}var m=E(u),y=E(function(C){return c.throw(C)});function E(C){return function(U){var O=C(U),U=O.value;return O.done?U:U&&typeof U.then=="function"?U.then(m,y):a(U)?Promise.all(U).then(m,y):m(U)}}return E(u)()}function jo(c,u,m){for(var y=a(c)?c.slice():[c],E=0;E<m;++E)y.push(u);return y}var lv={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(c){return i(i({},c),{table:function(u){var m=c.table(u),y=m.schema,E={},C=[];function R(L,Y,N){var B=hr(L),G=E[B]=E[B]||[],z=L==null?0:typeof L=="string"?1:L.length,X=0<Y,X=i(i({},N),{name:X?"".concat(B,"(virtual-from:").concat(N.name,")"):N.name,lowLevelIndex:N,isVirtual:X,keyTail:Y,keyLength:z,extractKey:Jl(L),unique:!X&&N.unique});return G.push(X),X.isPrimaryKey||C.push(X),1<z&&R(z===2?L[0]:L.slice(0,z-1),Y+1,N),G.sort(function(K,Z){return K.keyTail-Z.keyTail}),X}u=R(y.primaryKey.keyPath,0,y.primaryKey),E[":id"]=[u];for(var O=0,U=y.indexes;O<U.length;O++){var D=U[O];R(D.keyPath,0,D)}function H(L){var Y,N=L.query.index;return N.isVirtual?i(i({},L),{query:{index:N.lowLevelIndex,range:(Y=L.query.range,N=N.keyTail,{type:Y.type===1?2:Y.type,lower:jo(Y.lower,Y.lowerOpen?c.MAX_KEY:c.MIN_KEY,N),lowerOpen:!0,upper:jo(Y.upper,Y.upperOpen?c.MIN_KEY:c.MAX_KEY,N),upperOpen:!0})}}):L}return i(i({},m),{schema:i(i({},y),{primaryKey:u,indexes:C,getIndexByKeyPath:function(L){return(L=E[hr(L)])&&L[0]}}),count:function(L){return m.count(H(L))},query:function(L){return m.query(H(L))},openCursor:function(L){var Y=L.query.index,N=Y.keyTail,B=Y.isVirtual,G=Y.keyLength;return B?m.openCursor(H(L)).then(function(X){return X&&z(X)}):m.openCursor(L);function z(X){return Object.create(X,{continue:{value:function(K){K!=null?X.continue(jo(K,L.reverse?c.MAX_KEY:c.MIN_KEY,N)):L.unique?X.continue(X.key.slice(0,G).concat(L.reverse?c.MIN_KEY:c.MAX_KEY,N)):X.continue()}},continuePrimaryKey:{value:function(K,Z){X.continuePrimaryKey(jo(K,c.MAX_KEY,N),Z)}},primaryKey:{get:function(){return X.primaryKey}},key:{get:function(){var K=X.key;return G===1?K[0]:K.slice(0,G)}},value:{get:function(){return X.value}}})}}})}})}};function dc(c,u,m,y){return m=m||{},y=y||"",o(c).forEach(function(E){var C,R,O;p(u,E)?(C=c[E],R=u[E],typeof C=="object"&&typeof R=="object"&&C&&R?(O=ve(C))!==ve(R)?m[y+E]=u[E]:O==="Object"?dc(C,R,m,y+E+"."):C!==R&&(m[y+E]=u[E]):C!==R&&(m[y+E]=u[E])):m[y+E]=void 0}),o(u).forEach(function(E){p(c,E)||(m[y+E]=u[E])}),m}function pc(c,u){return u.type==="delete"?u.keys:u.keys||u.values.map(c.extractKey)}var cv={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(c){return i(i({},c),{table:function(u){var m=c.table(u),y=m.schema.primaryKey;return i(i({},m),{mutate:function(E){var C=ye.trans,R=C.table(u).hook,O=R.deleting,U=R.creating,D=R.updating;switch(E.type){case"add":if(U.fire===Le)break;return C._promise("readwrite",function(){return H(E)},!0);case"put":if(U.fire===Le&&D.fire===Le)break;return C._promise("readwrite",function(){return H(E)},!0);case"delete":if(O.fire===Le)break;return C._promise("readwrite",function(){return H(E)},!0);case"deleteRange":if(O.fire===Le)break;return C._promise("readwrite",function(){return function L(Y,N,B){return m.query({trans:Y,values:!1,query:{index:y,range:N},limit:B}).then(function(G){var z=G.result;return H({type:"delete",keys:z,trans:Y}).then(function(X){return 0<X.numFailures?Promise.reject(X.failures[0]):z.length<B?{failures:[],numFailures:0,lastResult:void 0}:L(Y,i(i({},N),{lower:z[z.length-1],lowerOpen:!0}),B)})})}(E.trans,E.range,1e4)},!0)}return m.mutate(E);function H(L){var Y,N,B,G=ye.trans,z=L.keys||pc(y,L);if(!z)throw new Error("Keys missing");return(L=L.type==="add"||L.type==="put"?i(i({},L),{keys:z}):i({},L)).type!=="delete"&&(L.values=n([],L.values)),L.keys&&(L.keys=n([],L.keys)),Y=m,B=z,((N=L).type==="add"?Promise.resolve([]):Y.getMany({trans:N.trans,keys:B,cache:"immutable"})).then(function(X){var K=z.map(function(Z,q){var ie,ce,se,ae=X[q],he={onerror:null,onsuccess:null};return L.type==="delete"?O.fire.call(he,Z,ae,G):L.type==="add"||ae===void 0?(ie=U.fire.call(he,Z,L.values[q],G),Z==null&&ie!=null&&(L.keys[q]=Z=ie,y.outbound||k(L.values[q],y.keyPath,Z))):(ie=dc(ae,L.values[q]),(ce=D.fire.call(he,ie,Z,ae,G))&&(se=L.values[q],Object.keys(ce).forEach(function(ue){p(se,ue)?se[ue]=ce[ue]:k(se,ue,ce[ue])}))),he});return m.mutate(L).then(function(Z){for(var q=Z.failures,ie=Z.results,ce=Z.numFailures,Z=Z.lastResult,se=0;se<z.length;++se){var ae=(ie||z)[se],he=K[se];ae==null?he.onerror&&he.onerror(q[se]):he.onsuccess&&he.onsuccess(L.type==="put"&&X[se]?L.values[se]:ae)}return{failures:q,results:ie,numFailures:ce,lastResult:Z}}).catch(function(Z){return K.forEach(function(q){return q.onerror&&q.onerror(Z)}),Promise.reject(Z)})})}}})}})}};function $u(c,u,m){try{if(!u||u.keys.length<c.length)return null;for(var y=[],E=0,C=0;E<u.keys.length&&C<c.length;++E)Oe(u.keys[E],c[C])===0&&(y.push(m?ne(u.values[E]):u.values[E]),++C);return y.length===c.length?y:null}catch{return null}}var hv={stack:"dbcore",level:-1,create:function(c){return{table:function(u){var m=c.table(u);return i(i({},m),{getMany:function(y){if(!y.cache)return m.getMany(y);var E=$u(y.keys,y.trans._cache,y.cache==="clone");return E?de.resolve(E):m.getMany(y).then(function(C){return y.trans._cache={keys:y.keys,values:y.cache==="clone"?ne(C):C},C})},mutate:function(y){return y.type!=="add"&&(y.trans._cache=null),m.mutate(y)}})}}}};function ed(c,u){return c.trans.mode==="readonly"&&!!c.subscr&&!c.trans.explicit&&c.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function td(c,u){switch(c){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var uv={stack:"dbcore",level:0,name:"Observability",create:function(c){var u=c.schema.name,m=new vt(c.MIN_KEY,c.MAX_KEY);return i(i({},c),{transaction:function(y,E,C){if(ye.subscr&&E!=="readonly")throw new fe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ye.querier));return c.transaction(y,E,C)},table:function(y){var E=c.table(y),C=E.schema,R=C.primaryKey,L=C.indexes,O=R.extractKey,U=R.outbound,D=R.autoIncrement&&L.filter(function(N){return N.compound&&N.keyPath.includes(R.keyPath)}),H=i(i({},E),{mutate:function(N){function B(ue){return ue="idb://".concat(u,"/").concat(y,"/").concat(ue),Z[ue]||(Z[ue]=new vt)}var G,z,X,K=N.trans,Z=N.mutatedParts||(N.mutatedParts={}),q=B(""),ie=B(":dels"),ce=N.type,he=N.type==="deleteRange"?[N.range]:N.type==="delete"?[N.keys]:N.values.length<50?[pc(R,N).filter(function(ue){return ue}),N.values]:[],se=he[0],ae=he[1],he=N.trans._cache;return a(se)?(q.addKeys(se),(he=ce==="delete"||se.length===ae.length?$u(se,he):null)||ie.addKeys(se),(he||ae)&&(G=B,z=he,X=ae,C.indexes.forEach(function(ue){var Ie=G(ue.name||"");function xe(Ae){return Ae!=null?ue.extractKey(Ae):null}function _e(Ae){return ue.multiEntry&&a(Ae)?Ae.forEach(function($t){return Ie.addKey($t)}):Ie.addKey(Ae)}(z||X).forEach(function(Ae,yt){var Se=z&&xe(z[yt]),yt=X&&xe(X[yt]);Oe(Se,yt)!==0&&(Se!=null&&_e(Se),yt!=null&&_e(yt))})}))):se?(ae={from:se.lower,to:se.upper},ie.add(ae),q.add(ae)):(q.add(m),ie.add(m),C.indexes.forEach(function(ue){return B(ue.name).add(m)})),E.mutate(N).then(function(ue){return!se||N.type!=="add"&&N.type!=="put"||(q.addKeys(ue.results),D&&D.forEach(function(Ie){var xe=N.values.map(function(Ae){return Ie.extractKey(Ae)}),_e=Ie.keyPath.findIndex(function(Ae){return Ae===R.keyPath});ue.results.forEach(function(Ae){return xe[_e]=Ae}),B(Ie.name).addKeys(xe)})),K.mutatedParts=Yo(K.mutatedParts||{},Z),ue})}}),L=function(B){var G=B.query,B=G.index,G=G.range;return[B,new vt((B=G.lower)!==null&&B!==void 0?B:c.MIN_KEY,(G=G.upper)!==null&&G!==void 0?G:c.MAX_KEY)]},Y={get:function(N){return[R,new vt(N.key)]},getMany:function(N){return[R,new vt().addKeys(N.keys)]},count:L,query:L,openCursor:L};return o(Y).forEach(function(N){H[N]=function(B){var G=ye.subscr,z=!!G,X=ed(ye,E)&&td(N,B)?B.obsSet={}:G;if(z){var K=function(ae){return ae="idb://".concat(u,"/").concat(y,"/").concat(ae),X[ae]||(X[ae]=new vt)},Z=K(""),q=K(":dels"),G=Y[N](B),z=G[0],G=G[1];if((N==="query"&&z.isPrimaryKey&&!B.values?q:K(z.name||"")).add(G),!z.isPrimaryKey){if(N!=="count"){var ie=N==="query"&&U&&B.values&&E.query(i(i({},B),{values:!1}));return E[N].apply(this,arguments).then(function(ae){if(N==="query"){if(U&&B.values)return ie.then(function(xe){return xe=xe.result,Z.addKeys(xe),ae});var he=B.values?ae.result.map(O):ae.result;(B.values?Z:q).addKeys(he)}else if(N==="openCursor"){var ue=ae,Ie=B.values;return ue&&Object.create(ue,{key:{get:function(){return q.addKey(ue.primaryKey),ue.key}},primaryKey:{get:function(){var xe=ue.primaryKey;return q.addKey(xe),xe}},value:{get:function(){return Ie&&Z.addKey(ue.primaryKey),ue.value}}})}return ae})}q.add(m)}}return E[N].apply(this,arguments)}}),H}})}};function id(c,u,m){if(m.numFailures===0)return u;if(u.type==="deleteRange")return null;var y=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1;return m.numFailures===y?null:(u=i({},u),a(u.keys)&&(u.keys=u.keys.filter(function(E,C){return!(C in m.failures)})),"values"in u&&a(u.values)&&(u.values=u.values.filter(function(E,C){return!(C in m.failures)})),u)}function fc(c,u){return m=c,((y=u).lower===void 0||(y.lowerOpen?0<Oe(m,y.lower):0<=Oe(m,y.lower)))&&(c=c,(u=u).upper===void 0||(u.upperOpen?Oe(c,u.upper)<0:Oe(c,u.upper)<=0));var m,y}function nd(c,u,Y,y,E,C){if(!Y||Y.length===0)return c;var R=u.query.index,O=R.multiEntry,U=u.query.range,D=y.schema.primaryKey.extractKey,H=R.extractKey,L=(R.lowLevelIndex||R).extractKey,Y=Y.reduce(function(N,B){var G=N,z=B.type==="add"||B.type==="put"?B.values.filter(function(q){return q=H(q),O&&a(q)?q.some(function(ie){return fc(ie,U)}):fc(q,U)}).map(function(q){return q=ne(q),C&&Object.freeze(q),q}):[];switch(B.type){case"add":G=N.concat(u.values?z:z.map(function(ie){return D(ie)}));break;case"put":var X=new vt().addKeys(B.values.map(function(ie){return D(ie)})),G=N.filter(function(ie){return ie=u.values?D(ie):ie,!Ho(new vt(ie),X)}).concat(u.values?z:z.map(function(ie){return D(ie)}));break;case"delete":var K=new vt().addKeys(B.keys);G=N.filter(function(ie){return ie=u.values?D(ie):ie,!Ho(new vt(ie),K)});break;case"deleteRange":var Z=B.range;G=N.filter(function(ie){return!fc(D(ie),Z)})}return G},c);return Y===c?c:(Y.sort(function(N,B){return Oe(L(N),L(B))||Oe(D(N),D(B))}),u.limit&&u.limit<1/0&&(Y.length>u.limit?Y.length=u.limit:c.length===u.limit&&Y.length<u.limit&&(E.dirty=!0)),C?Object.freeze(Y):Y)}function sd(c,u){return Oe(c.lower,u.lower)===0&&Oe(c.upper,u.upper)===0&&!!c.lowerOpen==!!u.lowerOpen&&!!c.upperOpen==!!u.upperOpen}function dv(c,u){return function(m,y,E,C){if(m===void 0)return y!==void 0?-1:0;if(y===void 0)return 1;if((y=Oe(m,y))===0){if(E&&C)return 0;if(E)return 1;if(C)return-1}return y}(c.lower,u.lower,c.lowerOpen,u.lowerOpen)<=0&&0<=function(m,y,E,C){if(m===void 0)return y!==void 0?1:0;if(y===void 0)return-1;if((y=Oe(m,y))===0){if(E&&C)return 0;if(E)return-1;if(C)return 1}return y}(c.upper,u.upper,c.upperOpen,u.upperOpen)}function pv(c,u,m,y){c.subscribers.add(m),y.addEventListener("abort",function(){var E,C;c.subscribers.delete(m),c.subscribers.size===0&&(E=c,C=u,setTimeout(function(){E.subscribers.size===0&&me(C,E)},3e3))})}var fv={stack:"dbcore",level:0,name:"Cache",create:function(c){var u=c.schema.name;return i(i({},c),{transaction:function(m,y,E){var C,R,O=c.transaction(m,y,E);return y==="readwrite"&&(R=(C=new AbortController).signal,E=function(U){return function(){if(C.abort(),y==="readwrite"){for(var D=new Set,H=0,L=m;H<L.length;H++){var Y=L[H],N=bn["idb://".concat(u,"/").concat(Y)];if(N){var B=c.table(Y),G=N.optimisticOps.filter(function(Ie){return Ie.trans===O});if(O._explicit&&U&&O.mutatedParts)for(var z=0,X=Object.values(N.queries.query);z<X.length;z++)for(var K=0,Z=(ce=X[z]).slice();K<Z.length;K++)ac((se=Z[K]).obsSet,O.mutatedParts)&&(me(ce,se),se.subscribers.forEach(function(Ie){return D.add(Ie)}));else if(0<G.length){N.optimisticOps=N.optimisticOps.filter(function(Ie){return Ie.trans!==O});for(var q=0,ie=Object.values(N.queries.query);q<ie.length;q++)for(var ce,se,ae,he=0,ue=(ce=ie[q]).slice();he<ue.length;he++)(se=ue[he]).res!=null&&O.mutatedParts&&(U&&!se.dirty?(ae=Object.isFrozen(se.res),ae=nd(se.res,se.req,G,B,se,ae),se.dirty?(me(ce,se),se.subscribers.forEach(function(Ie){return D.add(Ie)})):ae!==se.res&&(se.res=ae,se.promise=de.resolve({result:ae}))):(se.dirty&&me(ce,se),se.subscribers.forEach(function(Ie){return D.add(Ie)})))}}}D.forEach(function(Ie){return Ie()})}}},O.addEventListener("abort",E(!1),{signal:R}),O.addEventListener("error",E(!1),{signal:R}),O.addEventListener("complete",E(!0),{signal:R})),O},table:function(m){var y=c.table(m),E=y.schema.primaryKey;return i(i({},y),{mutate:function(C){var R=ye.trans;if(E.outbound||R.db._options.cache==="disabled"||R.explicit)return y.mutate(C);var O=bn["idb://".concat(u,"/").concat(m)];return O?(R=y.mutate(C),C.type!=="add"&&C.type!=="put"||!(50<=C.values.length||pc(E,C).some(function(U){return U==null}))?(O.optimisticOps.push(C),C.mutatedParts&&Go(C.mutatedParts),R.then(function(U){0<U.numFailures&&(me(O.optimisticOps,C),(U=id(0,C,U))&&O.optimisticOps.push(U),C.mutatedParts&&Go(C.mutatedParts))}),R.catch(function(){me(O.optimisticOps,C),C.mutatedParts&&Go(C.mutatedParts)})):R.then(function(U){var D=id(0,i(i({},C),{values:C.values.map(function(N,L){var Y,N=(Y=E.keyPath)!==null&&Y!==void 0&&Y.includes(".")?ne(N):i({},N);return k(N,E.keyPath,U.results[L]),N})}),U);O.optimisticOps.push(D),queueMicrotask(function(){return C.mutatedParts&&Go(C.mutatedParts)})}),R):y.mutate(C)},query:function(C){if(!ed(ye,y)||!td("query",C))return y.query(C);var R=((D=ye.trans)===null||D===void 0?void 0:D.db._options.cache)==="immutable",L=ye,O=L.requery,U=L.signal,D=function(B,G,z,X){var K=bn["idb://".concat(B,"/").concat(G)];if(!K)return[];if(!(G=K.queries[z]))return[null,!1,K,null];var Z=G[(X.query?X.query.index.name:null)||""];if(!Z)return[null,!1,K,null];switch(z){case"query":var q=Z.find(function(ie){return ie.req.limit===X.limit&&ie.req.values===X.values&&sd(ie.req.query.range,X.query.range)});return q?[q,!0,K,Z]:[Z.find(function(ie){return("limit"in ie.req?ie.req.limit:1/0)>=X.limit&&(!X.values||ie.req.values)&&dv(ie.req.query.range,X.query.range)}),!1,K,Z];case"count":return q=Z.find(function(ie){return sd(ie.req.query.range,X.query.range)}),[q,!!q,K,Z]}}(u,m,"query",C),H=D[0],L=D[1],Y=D[2],N=D[3];return H&&L?H.obsSet=C.obsSet:(L=y.query(C).then(function(B){var G=B.result;if(H&&(H.res=G),R){for(var z=0,X=G.length;z<X;++z)Object.freeze(G[z]);Object.freeze(G)}else B.result=ne(G);return B}).catch(function(B){return N&&H&&me(N,H),Promise.reject(B)}),H={obsSet:C.obsSet,promise:L,subscribers:new Set,type:"query",req:C,dirty:!1},N?N.push(H):(N=[H],(Y=Y||(bn["idb://".concat(u,"/").concat(m)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[C.query.index.name||""]=N)),pv(H,N,O,U),H.promise.then(function(B){return{result:nd(B.result,C,Y==null?void 0:Y.optimisticOps,y,H,R)}})}})}})}};function Wo(c,u){return new Proxy(c,{get:function(m,y,E){return y==="db"?u:Reflect.get(m,y,E)}})}var Ii=(nt.prototype.version=function(c){if(isNaN(c)||c<.1)throw new fe.Type("Given version is not a positive number");if(c=Math.round(10*c)/10,this.idbdb||this._state.isBeingOpened)throw new fe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,c);var u=this._versions,m=u.filter(function(y){return y._cfg.version===c})[0];return m||(m=new this.Version(c),u.push(m),u.sort(nv),m.stores({}),this._state.autoSchema=!1,m)},nt.prototype._whenReady=function(c){var u=this;return this.idbdb&&(this._state.openComplete||ye.letThrough||this._vip)?c():new de(function(m,y){if(u._state.openComplete)return y(new fe.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void y(new fe.DatabaseClosed);u.open().catch(Le)}u._state.dbReadyPromise.then(m,y)}).then(c)},nt.prototype.use=function(c){var u=c.stack,m=c.create,y=c.level,E=c.name;return E&&this.unuse({stack:u,name:E}),c=this._middlewares[u]||(this._middlewares[u]=[]),c.push({stack:u,create:m,level:y??10,name:E}),c.sort(function(C,R){return C.level-R.level}),this},nt.prototype.unuse=function(c){var u=c.stack,m=c.name,y=c.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(E){return y?E.create!==y:!!m&&E.name!==m})),this},nt.prototype.open=function(){var c=this;return vn(zi,function(){return av(c)})},nt.prototype._close=function(){var c=this._state,u=is.indexOf(this);if(0<=u&&is.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}c.isBeingOpened||(c.dbReadyPromise=new de(function(m){c.dbReadyResolve=m}),c.openCanceller=new de(function(m,y){c.cancelOpen=y}))},nt.prototype.close=function(m){var u=(m===void 0?{disableAutoOpen:!0}:m).disableAutoOpen,m=this._state;u?(m.isBeingOpened&&m.cancelOpen(new fe.DatabaseClosed),this._close(),m.autoOpen=!1,m.dbOpenError=new fe.DatabaseClosed):(this._close(),m.autoOpen=this._options.autoOpen||m.isBeingOpened,m.openComplete=!1,m.dbOpenError=null)},nt.prototype.delete=function(c){var u=this;c===void 0&&(c={disableAutoOpen:!0});var m=0<arguments.length&&typeof arguments[0]!="object",y=this._state;return new de(function(E,C){function R(){u.close(c);var O=u._deps.indexedDB.deleteDatabase(u.name);O.onsuccess=Ze(function(){var U,D,H;U=u._deps,D=u.name,H=U.indexedDB,U=U.IDBKeyRange,nc(H)||D===Fo||ic(H,U).delete(D).catch(Le),E()}),O.onerror=ci(C),O.onblocked=u._fireOnBlocked}if(m)throw new fe.InvalidArgument("Invalid closeOptions argument to db.delete()");y.isBeingOpened?y.dbReadyPromise.then(R):R()})},nt.prototype.backendDB=function(){return this.idbdb},nt.prototype.isOpen=function(){return this.idbdb!==null},nt.prototype.hasBeenClosed=function(){var c=this._state.dbOpenError;return c&&c.name==="DatabaseClosed"},nt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},nt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(nt.prototype,"tables",{get:function(){var c=this;return o(this._allTables).map(function(u){return c._allTables[u]})},enumerable:!1,configurable:!0}),nt.prototype.transaction=function(){var c=(function(u,m,y){var E=arguments.length;if(E<2)throw new fe.InvalidArgument("Too few arguments");for(var C=new Array(E-1);--E;)C[E-1]=arguments[E];return y=C.pop(),[u,j(C),y]}).apply(this,arguments);return this._transaction.apply(this,c)},nt.prototype._transaction=function(c,u,m){var y=this,E=ye.trans;E&&E.db===this&&c.indexOf("!")===-1||(E=null);var C,R,O=c.indexOf("?")!==-1;c=c.replace("!","").replace("?","");try{if(R=u.map(function(D){if(D=D instanceof y.Table?D.name:D,typeof D!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return D}),c=="r"||c===Yl)C=Yl;else{if(c!="rw"&&c!=Gl)throw new fe.InvalidArgument("Invalid transaction mode: "+c);C=Gl}if(E){if(E.mode===Yl&&C===Gl){if(!O)throw new fe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");E=null}E&&R.forEach(function(D){if(E&&E.storeNames.indexOf(D)===-1){if(!O)throw new fe.SubTransaction("Table "+D+" not included in parent transaction.");E=null}}),O&&E&&!E.active&&(E=null)}}catch(D){return E?E._promise(null,function(H,L){L(D)}):it(D)}var U=(function D(H,L,Y,N,B){return de.resolve().then(function(){var G=ye.transless||ye,z=H._createTransaction(L,Y,H._dbSchema,N);if(z.explicit=!0,G={trans:z,transless:G},N)z.idbtrans=N.idbtrans;else try{z.create(),z.idbtrans._explicit=!0,H._state.PR1398_maxLoop=3}catch(Z){return Z.name===It.InvalidState&&H.isOpen()&&0<--H._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),H.close({disableAutoOpen:!1}),H.open().then(function(){return D(H,L,Y,null,B)})):it(Z)}var X,K=Pt(B);return K&&ts(),G=de.follow(function(){var Z;(X=B.call(z,z))&&(K?(Z=Hi.bind(null,null),X.then(Z,Z)):typeof X.next=="function"&&typeof X.throw=="function"&&(X=uc(X)))},G),(X&&typeof X.then=="function"?de.resolve(X).then(function(Z){return z.active?Z:it(new fe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):G.then(function(){return X})).then(function(Z){return N&&z._resolve(),z._completion.then(function(){return Z})}).catch(function(Z){return z._reject(Z),it(Z)})})}).bind(null,this,C,R,E,m);return E?E._promise(C,U,"lock"):ye.trans?vn(ye.transless,function(){return y._whenReady(U)}):this._whenReady(U)},nt.prototype.table=function(c){if(!p(this._allTables,c))throw new fe.InvalidTable("Table ".concat(c," does not exist"));return this._allTables[c]},nt);function nt(c,u){var m=this;this._middlewares={},this.verno=0;var y=nt.dependencies;this._options=u=i({addons:nt.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},y=u.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var E,C,R,O,U,D={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Le,dbReadyPromise:null,cancelOpen:Le,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};D.dbReadyPromise=new de(function(L){D.dbReadyResolve=L}),D.openCanceller=new de(function(L,Y){D.cancelOpen=Y}),this._state=D,this.name=c,this.on=rr(this,"populate","blocked","versionchange","close",{ready:[Ll,Le]}),this.on.ready.subscribe=_(this.on.ready.subscribe,function(L){return function(Y,N){nt.vip(function(){var B,G=m._state;G.openComplete?(G.dbOpenError||de.resolve().then(Y),N&&L(Y)):G.onReadyBeingFired?(G.onReadyBeingFired.push(Y),N&&L(Y)):(L(Y),B=m,N||L(function z(){B.on.ready.unsubscribe(Y),B.on.ready.unsubscribe(z)}))})}}),this.Collection=(E=this,or(Z0.prototype,function(X,z){this.db=E;var N=Nu,B=null;if(z)try{N=z()}catch(K){B=K}var G=X._ctx,z=G.table,X=z.hook.reading.fire;this._ctx={table:z,index:G.index,isPrimKey:!G.index||z.schema.primKey.keyPath&&G.index===z.schema.primKey.name,range:N,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:B,or:G.or,valueMapper:X!==ai?X:null}})),this.Table=(C=this,or(zu.prototype,function(L,Y,N){this.db=C,this._tx=N,this.name=L,this.schema=Y,this.hook=C._allTables[L]?C._allTables[L].hook:rr(null,{creating:[Js,Le],reading:[Ml,ai],updating:[Y0,Le],deleting:[$s,Le]})})),this.Transaction=(R=this,or($0.prototype,function(L,Y,N,B,G){var z=this;this.db=R,this.mode=L,this.storeNames=Y,this.schema=N,this.chromeTransactionDurability=B,this.idbtrans=null,this.on=rr(this,"complete","error","abort"),this.parent=G||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new de(function(X,K){z._resolve=X,z._reject=K}),this._completion.then(function(){z.active=!1,z.on.complete.fire()},function(X){var K=z.active;return z.active=!1,z.on.error.fire(X),z.parent?z.parent._reject(X):K&&z.idbtrans&&z.idbtrans.abort(),it(X)})})),this.Version=(O=this,or(ov.prototype,function(L){this.db=O,this._cfg={version:L,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(U=this,or(ju.prototype,function(L,Y,N){if(this.db=U,this._ctx={table:L,index:Y===":id"?null:Y,or:N},this._cmp=this._ascending=Oe,this._descending=function(B,G){return Oe(G,B)},this._max=function(B,G){return 0<Oe(B,G)?B:G},this._min=function(B,G){return Oe(B,G)<0?B:G},this._IDBKeyRange=U._deps.IDBKeyRange,!this._IDBKeyRange)throw new fe.MissingAPI})),this.on("versionchange",function(L){0<L.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(L){!L.newVersion||L.newVersion<L.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(L.oldVersion/10))}),this._maxKey=cr(u.IDBKeyRange),this._createTransaction=function(L,Y,N,B){return new m.Transaction(L,Y,N,m._options.chromeTransactionDurability,B)},this._fireOnBlocked=function(L){m.on("blocked").fire(L),is.filter(function(Y){return Y.name===m.name&&Y!==m&&!Y._state.vcFired}).map(function(Y){return Y.on("versionchange").fire(L)})},this.use(hv),this.use(fv),this.use(uv),this.use(lv),this.use(cv);var H=new Proxy(this,{get:function(L,Y,N){if(Y==="_vip")return!0;if(Y==="table")return function(G){return Wo(m.table(G),H)};var B=Reflect.get(L,Y,N);return B instanceof zu?Wo(B,H):Y==="tables"?B.map(function(G){return Wo(G,H)}):Y==="_createTransaction"?function(){return Wo(B.apply(this,arguments),H)}:B}});this.vip=H,y.forEach(function(L){return L(m)})}var Xo,Bt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",mv=(mc.prototype.subscribe=function(c,u,m){return this._subscribe(c&&typeof c!="function"?c:{next:c,error:u,complete:m})},mc.prototype[Bt]=function(){return this},mc);function mc(c){this._subscribe=c}try{Xo={indexedDB:r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,IDBKeyRange:r.IDBKeyRange||r.webkitIDBKeyRange}}catch{Xo={indexedDB:null,IDBKeyRange:null}}function rd(c){var u,m=!1,y=new mv(function(E){var C=Pt(c),R,O=!1,U={},D={},H={get closed(){return O},unsubscribe:function(){O||(O=!0,R&&R.abort(),L&&ji.storagemutated.unsubscribe(N))}};E.start&&E.start(H);var L=!1,Y=function(){return Hl(B)},N=function(G){Yo(U,G),ac(D,U)&&Y()},B=function(){var G,z,X;!O&&Xo.indexedDB&&(U={},G={},R&&R.abort(),R=new AbortController,X=function(K){var Z=$n();try{C&&ts();var q=Vi(c,K);return q=C?q.finally(Hi):q}finally{Z&&es()}}(z={subscr:G,signal:R.signal,requery:Y,querier:c,trans:null}),Promise.resolve(X).then(function(K){m=!0,u=K,O||z.signal.aborted||(U={},function(Z){for(var q in Z)if(p(Z,q))return;return 1}(D=G)||L||(ji(lr,N),L=!0),Hl(function(){return!O&&E.next&&E.next(K)}))},function(K){m=!1,["DatabaseClosedError","AbortError"].includes(K==null?void 0:K.name)||O||Hl(function(){O||E.error&&E.error(K)})}))};return setTimeout(Y,0),H});return y.hasValue=function(){return m},y.getValue=function(){return u},y}var wn=Ii;function gc(c){var u=Wi;try{Wi=!0,ji.storagemutated.fire(c),hc(c,!0)}finally{Wi=u}}f(wn,i(i({},qt),{delete:function(c){return new wn(c,{addons:[]}).delete()},exists:function(c){return new wn(c,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(c){try{return u=wn.dependencies,m=u.indexedDB,u=u.IDBKeyRange,(nc(m)?Promise.resolve(m.databases()).then(function(y){return y.map(function(E){return E.name}).filter(function(E){return E!==Fo})}):ic(m,u).toCollection().primaryKeys()).then(c)}catch{return it(new fe.MissingAPI)}var u,m},defineClass:function(){return function(c){l(this,c)}},ignoreTransaction:function(c){return ye.trans?vn(ye.transless,c):c()},vip:sc,async:function(c){return function(){try{var u=uc(c.apply(this,arguments));return u&&typeof u.then=="function"?u:de.resolve(u)}catch(m){return it(m)}}},spawn:function(c,u,m){try{var y=uc(c.apply(m,u||[]));return y&&typeof y.then=="function"?y:de.resolve(y)}catch(E){return it(E)}},currentTransaction:{get:function(){return ye.trans||null}},waitFor:function(c,u){return u=de.resolve(typeof c=="function"?wn.ignoreTransaction(c):c).timeout(u||6e4),ye.trans?ye.trans.waitFor(u):u},Promise:de,debug:{get:function(){return li},set:function(c){Ru(c)}},derive:b,extend:l,props:f,override:_,Events:rr,on:ji,liveQuery:rd,extendObservabilitySet:Yo,getByKeyPath:M,setByKeyPath:k,delByKeyPath:function(c,u){typeof u=="string"?k(c,u,void 0):"length"in u&&[].map.call(u,function(m){k(c,m,void 0)})},shallowClone:V,deepClone:ne,getObjectDiff:dc,cmp:Oe,asap:P,minKey:-1/0,addons:[],connections:is,errnames:It,dependencies:Xo,cache:bn,semVer:"4.0.4",version:"4.0.4".split(".").map(function(c){return parseInt(c)}).reduce(function(c,u,m){return c+u/Math.pow(10,2*m)})})),wn.maxKey=cr(wn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ji(lr,function(c){Wi||(c=new CustomEvent(Ql,{detail:c}),Wi=!0,dispatchEvent(c),Wi=!1)}),addEventListener(Ql,function(c){c=c.detail,Wi||gc(c)}));var rs,Wi=!1,od=function(){};return typeof BroadcastChannel<"u"&&((od=function(){(rs=new BroadcastChannel(Ql)).onmessage=function(c){return c.data&&gc(c.data)}})(),typeof rs.unref=="function"&&rs.unref(),ji(lr,function(c){Wi||rs.postMessage(c)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(c){if(!Ii.disableBfCache&&c.persisted){li&&console.debug("Dexie: handling persisted pagehide"),rs!=null&&rs.close();for(var u=0,m=is;u<m.length;u++)m[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(c){!Ii.disableBfCache&&c.persisted&&(li&&console.debug("Dexie: handling persisted pageshow"),od(),gc({all:new vt(-1/0,[[]])}))})),de.rejectionMapper=function(c,u){return!c||c instanceof At||c instanceof TypeError||c instanceof SyntaxError||!c.name||!We[c.name]?c:(u=new We[c.name](u||c.message,c),"stack"in c&&v(u,"stack",{get:function(){return this.inner.stack}}),u)},Ru(li),i(Ii,Object.freeze({__proto__:null,Dexie:Ii,liveQuery:rd,Entity:Uu,cmp:Oe,PropModSymbol:wi,PropModification:Xl,replacePrefix:function(c,u){return new Xl({replacePrefix:[c,u]})},default:Ii,RangeSet:vt,mergeRanges:dr,rangesOverlap:Ho}),{default:Ii}),Ii})})(Zm);var Cb=Zm.exports;const Ih=Rm(Cb),op=Symbol.for("Dexie"),Ch=globalThis[op]||(globalThis[op]=Ih);if(Ih.semVer!==Ch.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ih.semVer} and ${Ch.semVer}`);class Tb extends Ch{constructor(){super("MyAppDatabase"),x(this,"files"),this.version(1).stores({files:"id, file"})}}const xb=class Th extends Re{constructor(e){super(e),x(this,"enabled",!0),x(this,"onFragmentsDeleted",new ee),x(this,"onFragmentsLoaded",new ee),x(this,"onDisposed",new ee),x(this,"models",{}),x(this,"serializer",new Cf),x(this,"maxRamTime",5e3),x(this,"useCache",!0),x(this,"_culler",null),x(this,"_world",null),x(this,"_ramCache",new Map),x(this,"_fileCache",new Tb),x(this,"_url",null),x(this,"_isDisposing",!1),x(this,"_geometryInstances",{}),x(this,"_loadedFragments",{}),x(this,"fragIDData",new Map),x(this,"_baseMaterial",new za),x(this,"_baseMaterialT",new za({transparent:!0,opacity:.5})),this.components.add(Th.uuid,this)}get url(){if(!this._url)throw new Error("url must be set before using the streaming service!");return this._url}set url(e){this._url=e}get world(){if(!this._world)throw new Error("You must set a world before using the streamer!");return this._world}set world(e){var t;this._world=e,(t=this._culler)==null||t.dispose(),this._culler=new Ib(this.components,e),this._culler.onViewUpdated.add(async({toLoad:i,toRemove:n,toShow:r,toHide:o})=>{await this.loadFoundGeometries(i),await this.unloadLostGeometries(n),this.setMeshVisibility(r,!0),this.setMeshVisibility(o,!1)})}get culler(){if(!this._culler)throw new Error("You must set a world before using the streamer!");return this._culler}dispose(){var e;this._isDisposing=!0,this.onFragmentsLoaded.reset(),this.onFragmentsDeleted.reset(),this._ramCache.clear(),this.models={},this._geometryInstances={},this._loadedFragments={},this.fragIDData.clear(),this._baseMaterial.dispose(),this._baseMaterialT.dispose(),(e=this._culler)==null||e.dispose(),this.onDisposed.trigger(Th.uuid),this.onDisposed.reset(),this._isDisposing=!1}async load(e,t,i){const{assets:n,geometries:r,globalDataFileId:o}=e,a=this.url+o,l=await(await fetch(a)).arrayBuffer(),h=new Uint8Array(l),d=this.components.get(rt).load(h,{coordinate:t});this.world.scene.three.add(d);const{opaque:p,transparent:f}=d.geometryIDs;for(const[v,b]of p){const w=d.keyFragments.get(b);if(w===void 0)throw new Error("Malformed fragments group!");this.fragIDData.set(w,[d,v,new Set])}for(const[v,b]of f){const w=d.keyFragments.get(b);if(w===void 0)throw new Error("Malformed fragments group!");this.fragIDData.set(w,[d,Math.abs(v),new Set])}this.culler.add(d.uuid,n,r),this.models[d.uuid]={assets:n,geometries:r};const g=new Map;for(const v of n){const b=v.id;for(const{transformation:w,geometryID:T,color:S}of v.geometries){g.has(T)||g.set(T,[]);const _=g.get(T);if(!_)throw new Error("Malformed instances");_.push({id:b,transformation:w,color:S})}}if(this._geometryInstances[d.uuid]=g,i){const v=new Map,b=new Map;for(const I in i.ids){const P=i.ids[I],M=parseInt(I,10);v.set(M,P)}for(const I in i.types){const P=i.types[I],M=parseInt(I,10);b.set(M,P)}const w=o.replace("-global","-properties");d.streamSettings={baseUrl:this.url,baseFileName:w,ids:v,types:b};const{indexesFile:T}=i,S=await(await fetch(this.url+T)).text(),_=this.components.get(su);_.setRelationMap(d,_.getRelationsMapFromJSON(S))}return this.culler.needsUpdate=!0,d}remove(e){this._isDisposing=!0;const t=this.components.get(rt).groups.get(e);if(t===void 0){console.log("Group to delete not found.");return}delete this.models[e],delete this._geometryInstances[e],delete this._loadedFragments[e];const i=t.keyFragments.values();for(const n of i)this.fragIDData.delete(n);this.culler.remove(e),this._isDisposing=!1}setVisibility(e,t){const i=new Map;for(const n in t){const r=this.fragIDData.get(n);if(r===void 0)throw new Error("Geometry not found!");const[o,a,l]=r,h=o.uuid;i.has(h)||i.set(h,new Map);const d=i.get(h),p=t[n];for(const g of p)e?l.delete(g):l.add(g);d.get(a)||d.set(a,new Set);const f=d.get(a);for(const g of p)f.add(g)}for(const[n,r]of i){this.culler.setVisibility(e,n,r);for(const[o]of r){const a=this._loadedFragments[n];if(!a)continue;const l=a[o];if(l)for(const h of l){const d=t[h.id];d&&h.setVisibility(e,d)}}}this.culler.needsUpdate=!0}async clearCache(){await this._fileCache.delete()}get(){}update(){}async loadFoundGeometries(e){for(const t in e){if(this._isDisposing)return;const i=this.components.get(rt).groups.get(t);if(!i)return;const{geometries:n}=this.models[t],r=new Map,o=new Set;for(const[d,p]of e[t])for(const f of p){o.add(f);const g=n[f];if(!g)throw new Error("Geometry not found");if(g.geometryFile){const v=g.geometryFile,b=r.get(v)||0;r.set(v,b+d)}}const a=Array.from(r).sort((d,p)=>p[1]-d[1]);for(const[d]of a){const p=this.url+d;if(!this._ramCache.has(p)){let v=new Uint8Array;if(this.useCache){const w=await this._fileCache.files.get(p);if(w)v=w.file;else{const T=await(await fetch(p)).arrayBuffer();v=new Uint8Array(T),this._fileCache.files.add({file:v,id:p})}}else{const w=await(await fetch(p)).arrayBuffer();v=new Uint8Array(w)}const b=this.serializer.import(v);this._ramCache.set(p,{data:b,time:performance.now()})}const f=this._ramCache.get(p);if(!f)continue;f.time=performance.now();const g=[];if(f)for(const[v,{position:b,index:w,normal:T}]of f.data){if(this._isDisposing)return;if(!o.has(v)||!this._geometryInstances[t]||!this._geometryInstances[t].has(v))continue;const S=this._geometryInstances[t].get(v);if(!S)throw new Error("Instances not found!");const _=new Ne,I=new gt(b,3),P=new gt(T,3);_.setAttribute("position",I),_.setAttribute("normal",P),_.setIndex(Array.from(w));const M=[],k=[];for(const V of S)V.color[3]===1?k.push(V):M.push(V);this.newFragment(i,v,_,M,!0,g),this.newFragment(i,v,_,k,!1,g)}g.length&&!this._isDisposing&&this.onFragmentsLoaded.trigger(g)}const l=new Set,h=performance.now();for(const[d,{time:p}]of this._ramCache)h-p>this.maxRamTime&&l.add(d);for(const d of l)this._ramCache.delete(d)}}async unloadLostGeometries(e){if(this._isDisposing)return;const t=[],i=this.components.get(rt);for(const n in e){const r=i.groups.get(n);if(!r)throw new Error("Fragment group not found!");if(!this._loadedFragments[n])continue;const o=this._loadedFragments[n],a=e[n];for(const l of a){if(this.culler.removeFragment(r.uuid,l),!o[l])continue;const h=o[l];for(const d of h)r.items.splice(r.items.indexOf(d),1),t.push(d);delete o[l]}}t.length&&this.onFragmentsDeleted.trigger(t);for(const n of t)i.list.delete(n.id),this.world.meshes.delete(n.mesh),n.mesh.material=[],n.dispose(!0)}setMeshVisibility(e,t){for(const i in e)for(const n of e[i]){const r=this._loadedFragments[i];if(!r)continue;const o=r[n];if(o)for(const a of o)a.mesh.visible=t}}newFragment(e,t,i,n,r,o){if(n.length===0||this._isDisposing)return;const a=e.geometryIDs,l=r?a.transparent:a.opaque,h=t*(r?-1:1),d=l.get(h);if(d===void 0)return;const p=e.keyFragments.get(d);if(p===void 0)return;const f=this.components.get(rt);if(f.list.has(p))return;const g=r?this._baseMaterialT:this._baseMaterial,v=new Va(i,g,n.length);v.id=p,v.mesh.uuid=p,v.group=e,e.add(v.mesh),e.items.push(v),f.list.set(v.id,v),this.world.meshes.add(v.mesh),this._loadedFragments[e.uuid]||(this._loadedFragments[e.uuid]={});const b=this._loadedFragments[e.uuid];b[t]||(b[t]=[]),b[t].push(v);const w=new Map;for(let I=0;I<n.length;I++){const P=new Ee,M=new Rt,{id:k,transformation:V,color:W}=n[I];P.fromArray(V);const[j,Q,$]=W;if(M.setRGB(j,Q,$,"srgb"),w.has(k)){const ne=w.get(k);if(!ne)continue;ne.transforms.push(P),ne.colors&&ne.colors.push(M)}else w.set(k,{id:k,colors:[M],transforms:[P]})}const T=Array.from(w.values());v.add(T);const S=this.fragIDData.get(v.id);if(!S)throw new Error("Fragment data not found!");const _=S[2];_.size&&v.setVisibility(!1,_),this.culler.addFragment(e.uuid,t,v),o.push(v)}};x(xb,"uuid","22437e8d-9dbc-4b99-a04f-d2da280d50c8");const Ab=class xh extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"onBeforeUpdate",new ee),x(this,"onAfterUpdate",new ee),x(this,"onSetup",new ee),x(this,"isSetup",!1),x(this,"enabled",!0),x(this,"events",{}),x(this,"multiple","ctrlKey"),x(this,"zoomFactor",1.5),x(this,"zoomToSelection",!1),x(this,"backupColor",null),x(this,"selection",{}),x(this,"config",{selectName:"select",hoverName:"hover",selectionColor:new Rt("#BCF124"),hoverColor:new Rt("#6528D7"),autoHighlightOnClick:!0,world:null}),x(this,"colors",new Map),x(this,"_mouseState",{down:!1,moved:!1}),x(this,"clearHover",()=>{this.selection[this.config.hoverName]={}}),x(this,"onMouseDown",()=>{this.enabled&&(this._mouseState.down=!0)}),x(this,"onMouseUp",async t=>{const i=this.config.world;if(!i)throw new Error("No world found!");if(!i.renderer)throw new Error("This world doesn't have a renderer!");if(this.enabled&&t.target===i.renderer.three.domElement){if(this._mouseState.down=!1,this._mouseState.moved||t.button!==0){this._mouseState.moved=!1;return}if(this._mouseState.moved=!1,this.config.autoHighlightOnClick){const n=this.multiple==="none"?!0:!t[this.multiple];await this.highlight(this.config.selectName,n,this.zoomToSelection)}}}),x(this,"onMouseMove",async()=>{if(!this.enabled)return;if(this._mouseState.moved){this.clear(this.config.hoverName);return}this._mouseState.moved=this._mouseState.down;const t=this.selection[this.config.selectName];await this.highlight(this.config.hoverName,!0,!1,t)}),this.components.add(xh.uuid,this)}async dispose(){this.setupEvents(!1),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.selection={};for(const e in this.events)this.events[e].onClear.reset(),this.events[e].onHighlight.reset();this.onSetup.reset(),this.events={},this.onDisposed.trigger(xh.uuid),this.onDisposed.reset()}add(e,t){if(this.selection[e]||this.colors.has(e))throw new Error("A selection with that name already exists!");this.colors.set(e,t),this.selection[e]={},this.events[e]={onHighlight:new ee,onClear:new ee}}async highlight(e,t=!0,i=this.zoomToSelection,n={}){if(!this.enabled)return null;if(!this.config.world)throw new Error("No world found in config!");const r=this.config.world;if(!this.selection[e])throw new Error(`Selection ${e} does not exist.`);const o=this.components.get(rt).meshes,a=this.components.get(ni).get(r).castRay(o);if(!a||!a.face)return this.clear(e),null;const l=a.object,h=l.geometry,d=a.instanceId;if(!h||d===void 0)return null;const p=l.fragment.getItemID(d);if(p===null)throw new Error("Item ID not found!");const f=l.fragment.group;if(!f)throw new Error("Fragment must belong to a FragmentsGroup!");const g=f.getFragmentMap([p]),v={};for(const b in g){const w=g[b],T=n[b];for(const S of w)(!T||!T.has(S))&&(v[b]||(v[b]=new Set),v[b].add(S))}return await this.highlightByID(e,v,t,i),{id:p,fragments:g}}async highlightByID(e,t,i=!0,n=this.zoomToSelection){if(!this.enabled)return;i&&this.clear(e);const r=this.components.get(rt),o=this.colors.get(e);if(!o)throw new Error("Color for selection not found!");for(const a in t){const l=r.list.get(a);if(!l)continue;this.selection[e][a]||(this.selection[e][a]=new Set);const h=t[a];for(const d of h)this.selection[e][a].add(d),l.setColor(o,[d])}this.events[e].onHighlight.trigger(this.selection[e]),n&&await this.zoomSelection(e)}clear(e){const t=e?[e]:Object.keys(this.selection);for(const i of t){const n=this.components.get(rt),r=this.selection[i];for(const o in this.selection[i]){const a=n.list.get(o);if(!a)continue;const l=r[o];l&&(this.backupColor?a.setColor(this.backupColor):a.resetColor(l))}this.events[i].onClear.trigger(null),this.selection[i]={}}}setup(e){this.config={...this.config,...e},this.add(this.config.selectName,this.config.selectionColor),this.add(this.config.hoverName,this.config.hoverColor),this.setupEvents(!0),this.enabled=!0,this.isSetup=!0,this.onSetup.trigger(this)}async zoomSelection(e){if(!this.config.world)throw new Error("No world found in config!");const t=this.config.world;if(!t.camera.hasCameraControls())return;const i=this.components.get(tm),n=this.components.get(rt);i.reset();const r=this.selection[e];if(!Object.keys(r).length)return;for(const b in r){const w=n.list.get(b);if(!w)continue;const T=r[b];i.addMesh(w.mesh,T)}const o=i.getSphere(),a=1/0,l=-1/0,{x:h,y:d,z:p}=o.center,f=o.radius===a||h===a||d===a||p===a,g=o.radius===l||h===l||d===l||p===l,v=o.radius===0;f||g||v||(o.radius*=this.zoomFactor,await t.camera.controls.fitToSphere(o,!0))}setupEvents(e){if(!this.config.world)throw new Error("No world found while setting up events!");if(!this.config.world.renderer)throw new Error("The given world doesn't have a renderer!");const t=this.config.world.renderer.three.domElement,i=this.events[this.config.selectName].onHighlight;i.remove(this.clearHover),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mousemove",this.onMouseMove),e&&(i.add(this.clearHover),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mousemove",this.onMouseMove))}};x(Ab,"uuid","cb8a76f2-654a-4b50-80c6-66fd83cafd77");const Sb=class qm extends Re{constructor(e){super(e),x(this,"onDisposed",new ee),x(this,"onNavigated",new ee),x(this,"onExited",new ee),x(this,"enabled",!1),x(this,"currentPlan",null),x(this,"defaultSectionOffset",1.5),x(this,"defaultCameraOffset",30),x(this,"list",[]),x(this,"world"),x(this,"_floorPlanViewCached",!1),x(this,"_previousCamera",new F),x(this,"_previousTarget",new F),x(this,"_previousProjection","Perspective"),this.components.add(qm.uuid,this)}dispose(){this.onExited.reset(),this.onNavigated.reset(),this.list=[],this.onDisposed.trigger(),this.onDisposed.reset()}async generate(e){if(!e.hasProperties)throw new Error("Properties are needed to compute plan views!");const t=await e.getAllPropertiesOfType(dl);if(!t)throw new Error("Floorplans not found!");const i=e.coordinationMatrix.elements[13],n=await Dn.getUnits(e);for(const r of Object.values(t)){const o={value:0};this.getAbsoluteFloorHeight(r.ObjectPlacement,o);const a=o.value*n+i;this.create({name:r.Name.value,id:r.GlobalId.value,normal:new F(0,-1,0),point:new F(0,a,0),ortho:!0,offset:this.defaultSectionOffset})}}create(e){if(!this.world)throw new Error("You must set a world before creating the clipping planes!");if(this.list.find(n=>n.id===e.id)){console.warn(`There's already a plan with the id: ${e.id}`);return}const t=this.createClippingPlane(e),i={...e,plane:t};this.list.push(i)}async goTo(e,t=!1){var i;((i=this.currentPlan)==null?void 0:i.id)!==e&&(this.onNavigated.trigger({id:e}),this.storeCameraPosition(),await this.hidePreviousClippingPlane(),this.updateCurrentPlan(e),await this.activateCurrentPlan(),this.enabled||(await this.moveCameraTo2DPlanPosition(t),this.enabled=!0))}async exitPlanView(e=!1){if(!this.enabled||!this.world)return;this.enabled=!1,this.onExited.trigger(),this.cacheFloorplanView();const t=this.world.camera;t.set("Orbit"),await t.projection.set(this._previousProjection),this.currentPlan&&this.currentPlan.plane&&(this.currentPlan.plane.enabled=!1,this.currentPlan.plane.edges.enabled=!1,this.currentPlan.plane.edges.visible=!1),this.currentPlan=null,await t.controls.setLookAt(this._previousCamera.x,this._previousCamera.y,this._previousCamera.z,this._previousTarget.x,this._previousTarget.y,this._previousTarget.z,e)}storeCameraPosition(){this.enabled?this.cacheFloorplanView():this.store3dCameraPosition()}createClippingPlane(e){if(!this.world)throw new Error("World is needed to create clipping planes!");const{normal:t,point:i}=e,n=i.clone();e.offset&&(n.y+=e.offset);const r=this.components.get(Ga),o=r.Type;r.Type=Gr;const a=r.createFromNormalAndCoplanarPoint(this.world,t,n);return a.edges.update(),a.visible=!1,a.enabled=!1,a.edges.enabled=!1,a.edges.visible=!1,r.Type=o,a}cacheFloorplanView(){if(!this.world)throw new Error("World is needed to create clipping planes!");this._floorPlanViewCached=!0,this.world.camera.controls.saveState()}async moveCameraTo2DPlanPosition(e){if(!this.world)throw new Error("World is needed to create clipping planes!");const t=this.world.camera;this._floorPlanViewCached?await t.controls.reset(e):await t.controls.setLookAt(0,100,0,0,0,0,e)}async activateCurrentPlan(){if(!this.world)throw new Error("World is needed to create clipping planes!");if(!this.currentPlan)throw new Error("Current plan is not defined.");const e=this.world.camera;this.currentPlan.plane&&(this.currentPlan.plane.enabled=!0,this.currentPlan.plane.edges.fillNeedsUpdate=!0,this.currentPlan.plane.edges.visible=!0),e.set("Plan");const t=this.currentPlan.ortho?"Orthographic":"Perspective";await e.projection.set(t)}store3dCameraPosition(){if(!this.world)throw new Error("World is needed to create clipping planes!");const e=this.world.camera;e.three.getWorldPosition(this._previousCamera),e.controls.getTarget(this._previousTarget),this._previousProjection=e.projection.current}updateCurrentPlan(e){const t=this.list.find(i=>i.id===e);if(!t)throw new Error("The specified plan is undefined!");this.currentPlan=t}async hidePreviousClippingPlane(){if(this.currentPlan){const e=this.currentPlan.plane;e&&(e.enabled=!1),this.currentPlan.plane instanceof Gr&&(this.currentPlan.plane.edges.visible=!1)}}getAbsoluteFloorHeight(e,t){const i=e.RelativePlacement.Location.Coordinates;t.value+=i[2].value,e.PlacementRelTo&&this.getAbsoluteFloorHeight(e.PlacementRelTo,t)}};x(Sb,"uuid","a80874aa-1c93-43a4-80f2-df346da086b1");var _b=Object.defineProperty,Rb=(s,e,t)=>e in s?_b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Sn=(s,e,t)=>(Rb(s,typeof e!="symbol"?e+"":e,t),t);const Os=Math.min,Pi=Math.max,Xa=Math.round,sn=s=>({x:s,y:s}),Pb={left:"right",right:"left",bottom:"top",top:"bottom"},Fb={start:"end",end:"start"};function ap(s,e,t){return Pi(s,Os(e,t))}function ao(s,e){return typeof s=="function"?s(e):s}function Mi(s){return s.split("-")[0]}function yl(s){return s.split("-")[1]}function Jm(s){return s==="x"?"y":"x"}function $m(s){return s==="y"?"height":"width"}function lo(s){return["top","bottom"].includes(Mi(s))?"y":"x"}function eg(s){return Jm(lo(s))}function Ob(s,e,t){t===void 0&&(t=!1);const i=yl(s),n=eg(s),r=$m(n);let o=n==="x"?i===(t?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[r]>e.floating[r]&&(o=Ka(o)),[o,Ka(o)]}function Mb(s){const e=Ka(s);return[Ah(s),e,Ah(e)]}function Ah(s){return s.replace(/start|end/g,e=>Fb[e])}function Lb(s,e,t){const i=["left","right"],n=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(s){case"top":case"bottom":return t?e?n:i:e?i:n;case"left":case"right":return e?r:o;default:return[]}}function Db(s,e,t,i){const n=yl(s);let r=Lb(Mi(s),t==="start",i);return n&&(r=r.map(o=>o+"-"+n),e&&(r=r.concat(r.map(Ah)))),r}function Ka(s){return s.replace(/left|right|bottom|top/g,e=>Pb[e])}function Nb(s){return{top:0,right:0,bottom:0,left:0,...s}}function tg(s){return typeof s!="number"?Nb(s):{top:s,right:s,bottom:s,left:s}}function Ms(s){const{x:e,y:t,width:i,height:n}=s;return{width:i,height:n,top:t,left:e,right:e+i,bottom:t+n,x:e,y:t}}function lp(s,e,t){let{reference:i,floating:n}=s;const r=lo(e),o=eg(e),a=$m(o),l=Mi(e),h=r==="y",d=i.x+i.width/2-n.width/2,p=i.y+i.height/2-n.height/2,f=i[a]/2-n[a]/2;let g;switch(l){case"top":g={x:d,y:i.y-n.height};break;case"bottom":g={x:d,y:i.y+i.height};break;case"right":g={x:i.x+i.width,y:p};break;case"left":g={x:i.x-n.width,y:p};break;default:g={x:i.x,y:i.y}}switch(yl(e)){case"start":g[o]-=f*(t&&h?-1:1);break;case"end":g[o]+=f*(t&&h?-1:1);break}return g}const Ub=async(s,e,t)=>{const{placement:i="bottom",strategy:n="absolute",middleware:r=[],platform:o}=t,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let h=await o.getElementRects({reference:s,floating:e,strategy:n}),{x:d,y:p}=lp(h,i,l),f=i,g={},v=0;for(let b=0;b<a.length;b++){const{name:w,fn:T}=a[b],{x:S,y:_,data:I,reset:P}=await T({x:d,y:p,initialPlacement:i,placement:f,strategy:n,middlewareData:g,rects:h,platform:o,elements:{reference:s,floating:e}});d=S??d,p=_??p,g={...g,[w]:{...g[w],...I}},P&&v<=50&&(v++,typeof P=="object"&&(P.placement&&(f=P.placement),P.rects&&(h=P.rects===!0?await o.getElementRects({reference:s,floating:e,strategy:n}):P.rects),{x:d,y:p}=lp(h,f,l)),b=-1)}return{x:d,y:p,placement:f,strategy:n,middlewareData:g}};async function cu(s,e){var t;e===void 0&&(e={});const{x:i,y:n,platform:r,rects:o,elements:a,strategy:l}=s,{boundary:h="clippingAncestors",rootBoundary:d="viewport",elementContext:p="floating",altBoundary:f=!1,padding:g=0}=ao(e,s),v=tg(g),b=a[f?p==="floating"?"reference":"floating":p],w=Ms(await r.getClippingRect({element:(t=await(r.isElement==null?void 0:r.isElement(b)))==null||t?b:b.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:h,rootBoundary:d,strategy:l})),T=p==="floating"?{x:i,y:n,width:o.floating.width,height:o.floating.height}:o.reference,S=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),_=await(r.isElement==null?void 0:r.isElement(S))?await(r.getScale==null?void 0:r.getScale(S))||{x:1,y:1}:{x:1,y:1},I=Ms(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:T,offsetParent:S,strategy:l}):T);return{top:(w.top-I.top+v.top)/_.y,bottom:(I.bottom-w.bottom+v.bottom)/_.y,left:(w.left-I.left+v.left)/_.x,right:(I.right-w.right+v.right)/_.x}}const kb=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(e){var t,i;const{placement:n,middlewareData:r,rects:o,initialPlacement:a,platform:l,elements:h}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:b=!0,...w}=ao(s,e);if((t=r.arrow)!=null&&t.alignmentOffset)return{};const T=Mi(n),S=Mi(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(h.floating)),I=f||(S||!b?[Ka(a)]:Mb(a));!f&&v!=="none"&&I.push(...Db(a,b,v,_));const P=[a,...I],M=await cu(e,w),k=[];let V=((i=r.flip)==null?void 0:i.overflows)||[];if(d&&k.push(M[T]),p){const $=Ob(n,o,_);k.push(M[$[0]],M[$[1]])}if(V=[...V,{placement:n,overflows:k}],!k.every($=>$<=0)){var W,j;const $=(((W=r.flip)==null?void 0:W.index)||0)+1,ne=P[$];if(ne)return{data:{index:$,overflows:V},reset:{placement:ne}};let oe=(j=V.filter(ve=>ve.overflows[0]<=0).sort((ve,re)=>ve.overflows[1]-re.overflows[1])[0])==null?void 0:j.placement;if(!oe)switch(g){case"bestFit":{var Q;const ve=(Q=V.map(re=>[re.placement,re.overflows.filter(ge=>ge>0).reduce((ge,me)=>ge+me,0)]).sort((re,ge)=>re[1]-ge[1])[0])==null?void 0:Q[0];ve&&(oe=ve);break}case"initialPlacement":oe=a;break}if(n!==oe)return{reset:{placement:oe}}}return{}}}};function ig(s){const e=Os(...s.map(r=>r.left)),t=Os(...s.map(r=>r.top)),i=Pi(...s.map(r=>r.right)),n=Pi(...s.map(r=>r.bottom));return{x:e,y:t,width:i-e,height:n-t}}function Bb(s){const e=s.slice().sort((n,r)=>n.y-r.y),t=[];let i=null;for(let n=0;n<e.length;n++){const r=e[n];!i||r.y-i.y>i.height/2?t.push([r]):t[t.length-1].push(r),i=r}return t.map(n=>Ms(ig(n)))}const zb=function(s){return s===void 0&&(s={}),{name:"inline",options:s,async fn(e){const{placement:t,elements:i,rects:n,platform:r,strategy:o}=e,{padding:a=2,x:l,y:h}=ao(s,e),d=Array.from(await(r.getClientRects==null?void 0:r.getClientRects(i.reference))||[]),p=Bb(d),f=Ms(ig(d)),g=tg(a);function v(){if(p.length===2&&p[0].left>p[1].right&&l!=null&&h!=null)return p.find(w=>l>w.left-g.left&&l<w.right+g.right&&h>w.top-g.top&&h<w.bottom+g.bottom)||f;if(p.length>=2){if(lo(t)==="y"){const j=p[0],Q=p[p.length-1],$=Mi(t)==="top",ne=j.top,oe=Q.bottom,ve=$?j.left:Q.left,re=$?j.right:Q.right,ge=re-ve,me=oe-ne;return{top:ne,bottom:oe,left:ve,right:re,width:ge,height:me,x:ve,y:ne}}const w=Mi(t)==="left",T=Pi(...p.map(j=>j.right)),S=Os(...p.map(j=>j.left)),_=p.filter(j=>w?j.left===S:j.right===T),I=_[0].top,P=_[_.length-1].bottom,M=S,k=T,V=k-M,W=P-I;return{top:I,bottom:P,left:M,right:k,width:V,height:W,x:M,y:I}}return f}const b=await r.getElementRects({reference:{getBoundingClientRect:v},floating:i.floating,strategy:o});return n.reference.x!==b.reference.x||n.reference.y!==b.reference.y||n.reference.width!==b.reference.width||n.reference.height!==b.reference.height?{reset:{rects:b}}:{}}}};async function Vb(s,e){const{placement:t,platform:i,elements:n}=s,r=await(i.isRTL==null?void 0:i.isRTL(n.floating)),o=Mi(t),a=yl(t),l=lo(t)==="y",h=["left","top"].includes(o)?-1:1,d=r&&l?-1:1,p=ao(e,s);let{mainAxis:f,crossAxis:g,alignmentAxis:v}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return a&&typeof v=="number"&&(g=a==="end"?v*-1:v),l?{x:g*d,y:f*h}:{x:f*h,y:g*d}}const ng=function(s){return{name:"offset",options:s,async fn(e){var t,i;const{x:n,y:r,placement:o,middlewareData:a}=e,l=await Vb(e,s);return o===((t=a.offset)==null?void 0:t.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:n+l.x,y:r+l.y,data:{...l,placement:o}}}}},Hb=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(e){const{x:t,y:i,placement:n}=e,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:T,y:S}=w;return{x:T,y:S}}},...l}=ao(s,e),h={x:t,y:i},d=await cu(e,l),p=lo(Mi(n)),f=Jm(p);let g=h[f],v=h[p];if(r){const w=f==="y"?"top":"left",T=f==="y"?"bottom":"right",S=g+d[w],_=g-d[T];g=ap(S,g,_)}if(o){const w=p==="y"?"top":"left",T=p==="y"?"bottom":"right",S=v+d[w],_=v-d[T];v=ap(S,v,_)}const b=a.fn({...e,[f]:g,[p]:v});return{...b,data:{x:b.x-t,y:b.y-i}}}}};function rn(s){return sg(s)?(s.nodeName||"").toLowerCase():"#document"}function Nt(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function ln(s){var e;return(e=(sg(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function sg(s){return s instanceof Node||s instanceof Nt(s).Node}function Li(s){return s instanceof Element||s instanceof Nt(s).Element}function yi(s){return s instanceof HTMLElement||s instanceof Nt(s).HTMLElement}function cp(s){return typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof Nt(s).ShadowRoot}function co(s){const{overflow:e,overflowX:t,overflowY:i,display:n}=Qt(s);return/auto|scroll|overlay|hidden|clip/.test(e+i+t)&&!["inline","contents"].includes(n)}function Yb(s){return["table","td","th"].includes(rn(s))}function hu(s){const e=uu(),t=Qt(s);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(t.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(t.contain||"").includes(i))}function Gb(s){let e=Ls(s);for(;yi(e)&&!El(e);){if(hu(e))return e;e=Ls(e)}return null}function uu(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function El(s){return["html","body","#document"].includes(rn(s))}function Qt(s){return Nt(s).getComputedStyle(s)}function bl(s){return Li(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.pageXOffset,scrollTop:s.pageYOffset}}function Ls(s){if(rn(s)==="html")return s;const e=s.assignedSlot||s.parentNode||cp(s)&&s.host||ln(s);return cp(e)?e.host:e}function rg(s){const e=Ls(s);return El(e)?s.ownerDocument?s.ownerDocument.body:s.body:yi(e)&&co(e)?e:rg(e)}function Sh(s,e,t){var i;e===void 0&&(e=[]),t===void 0&&(t=!0);const n=rg(s),r=n===((i=s.ownerDocument)==null?void 0:i.body),o=Nt(n);return r?e.concat(o,o.visualViewport||[],co(n)?n:[],o.frameElement&&t?Sh(o.frameElement):[]):e.concat(n,Sh(n,[],t))}function og(s){const e=Qt(s);let t=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const n=yi(s),r=n?s.offsetWidth:t,o=n?s.offsetHeight:i,a=Xa(t)!==r||Xa(i)!==o;return a&&(t=r,i=o),{width:t,height:i,$:a}}function ag(s){return Li(s)?s:s.contextElement}function _s(s){const e=ag(s);if(!yi(e))return sn(1);const t=e.getBoundingClientRect(),{width:i,height:n,$:r}=og(e);let o=(r?Xa(t.width):t.width)/i,a=(r?Xa(t.height):t.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const jb=sn(0);function lg(s){const e=Nt(s);return!uu()||!e.visualViewport?jb:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Wb(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==Nt(s)?!1:e}function jr(s,e,t,i){e===void 0&&(e=!1),t===void 0&&(t=!1);const n=s.getBoundingClientRect(),r=ag(s);let o=sn(1);e&&(i?Li(i)&&(o=_s(i)):o=_s(s));const a=Wb(r,t,i)?lg(r):sn(0);let l=(n.left+a.x)/o.x,h=(n.top+a.y)/o.y,d=n.width/o.x,p=n.height/o.y;if(r){const f=Nt(r),g=i&&Li(i)?Nt(i):i;let v=f,b=v.frameElement;for(;b&&i&&g!==v;){const w=_s(b),T=b.getBoundingClientRect(),S=Qt(b),_=T.left+(b.clientLeft+parseFloat(S.paddingLeft))*w.x,I=T.top+(b.clientTop+parseFloat(S.paddingTop))*w.y;l*=w.x,h*=w.y,d*=w.x,p*=w.y,l+=_,h+=I,v=Nt(b),b=v.frameElement}}return Ms({width:d,height:p,x:l,y:h})}const Xb=[":popover-open",":modal"];function cg(s){return Xb.some(e=>{try{return s.matches(e)}catch{return!1}})}function Kb(s){let{elements:e,rect:t,offsetParent:i,strategy:n}=s;const r=n==="fixed",o=ln(i),a=e?cg(e.floating):!1;if(i===o||a&&r)return t;let l={scrollLeft:0,scrollTop:0},h=sn(1);const d=sn(0),p=yi(i);if((p||!p&&!r)&&((rn(i)!=="body"||co(o))&&(l=bl(i)),yi(i))){const f=jr(i);h=_s(i),d.x=f.x+i.clientLeft,d.y=f.y+i.clientTop}return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-l.scrollLeft*h.x+d.x,y:t.y*h.y-l.scrollTop*h.y+d.y}}function Qb(s){return Array.from(s.getClientRects())}function hg(s){return jr(ln(s)).left+bl(s).scrollLeft}function Zb(s){const e=ln(s),t=bl(s),i=s.ownerDocument.body,n=Pi(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),r=Pi(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-t.scrollLeft+hg(s);const a=-t.scrollTop;return Qt(i).direction==="rtl"&&(o+=Pi(e.clientWidth,i.clientWidth)-n),{width:n,height:r,x:o,y:a}}function qb(s,e){const t=Nt(s),i=ln(s),n=t.visualViewport;let r=i.clientWidth,o=i.clientHeight,a=0,l=0;if(n){r=n.width,o=n.height;const h=uu();(!h||h&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:r,height:o,x:a,y:l}}function Jb(s,e){const t=jr(s,!0,e==="fixed"),i=t.top+s.clientTop,n=t.left+s.clientLeft,r=yi(s)?_s(s):sn(1),o=s.clientWidth*r.x,a=s.clientHeight*r.y,l=n*r.x,h=i*r.y;return{width:o,height:a,x:l,y:h}}function hp(s,e,t){let i;if(e==="viewport")i=qb(s,t);else if(e==="document")i=Zb(ln(s));else if(Li(e))i=Jb(e,t);else{const n=lg(s);i={...e,x:e.x-n.x,y:e.y-n.y}}return Ms(i)}function ug(s,e){const t=Ls(s);return t===e||!Li(t)||El(t)?!1:Qt(t).position==="fixed"||ug(t,e)}function $b(s,e){const t=e.get(s);if(t)return t;let i=Sh(s,[],!1).filter(a=>Li(a)&&rn(a)!=="body"),n=null;const r=Qt(s).position==="fixed";let o=r?Ls(s):s;for(;Li(o)&&!El(o);){const a=Qt(o),l=hu(o);!l&&a.position==="fixed"&&(n=null),(r?!l&&!n:!l&&a.position==="static"&&n&&["absolute","fixed"].includes(n.position)||co(o)&&!l&&ug(s,o))?i=i.filter(h=>h!==o):n=a,o=Ls(o)}return e.set(s,i),i}function ew(s){let{element:e,boundary:t,rootBoundary:i,strategy:n}=s;const r=[...t==="clippingAncestors"?$b(e,this._c):[].concat(t),i],o=r[0],a=r.reduce((l,h)=>{const d=hp(e,h,n);return l.top=Pi(d.top,l.top),l.right=Os(d.right,l.right),l.bottom=Os(d.bottom,l.bottom),l.left=Pi(d.left,l.left),l},hp(e,o,n));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function tw(s){const{width:e,height:t}=og(s);return{width:e,height:t}}function iw(s,e,t){const i=yi(e),n=ln(e),r=t==="fixed",o=jr(s,!0,r,e);let a={scrollLeft:0,scrollTop:0};const l=sn(0);if(i||!i&&!r)if((rn(e)!=="body"||co(n))&&(a=bl(e)),i){const p=jr(e,!0,r,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else n&&(l.x=hg(n));const h=o.left+a.scrollLeft-l.x,d=o.top+a.scrollTop-l.y;return{x:h,y:d,width:o.width,height:o.height}}function up(s,e){return!yi(s)||Qt(s).position==="fixed"?null:e?e(s):s.offsetParent}function dg(s,e){const t=Nt(s);if(!yi(s)||cg(s))return t;let i=up(s,e);for(;i&&Yb(i)&&Qt(i).position==="static";)i=up(i,e);return i&&(rn(i)==="html"||rn(i)==="body"&&Qt(i).position==="static"&&!hu(i))?t:i||Gb(s)||t}const nw=async function(s){const e=this.getOffsetParent||dg,t=this.getDimensions;return{reference:iw(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,...await t(s.floating)}}};function sw(s){return Qt(s).direction==="rtl"}const rw={convertOffsetParentRelativeRectToViewportRelativeRect:Kb,getDocumentElement:ln,getClippingRect:ew,getOffsetParent:dg,getElementRects:nw,getClientRects:Qb,getDimensions:tw,getScale:_s,isElement:Li,isRTL:sw},pg=Hb,fg=kb,mg=zb,gg=(s,e,t)=>{const i=new Map,n={platform:rw,...t},r={...n.platform,_c:i};return Ub(s,e,{...n,platform:r})};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Na=globalThis,du=Na.ShadowRoot&&(Na.ShadyCSS===void 0||Na.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,pu=Symbol(),dp=new WeakMap;let vg=class{constructor(s,e,t){if(this._$cssResult$=!0,t!==pu)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=s,this.t=e}get styleSheet(){let s=this.o;const e=this.t;if(du&&s===void 0){const t=e!==void 0&&e.length===1;t&&(s=dp.get(e)),s===void 0&&((this.o=s=new CSSStyleSheet).replaceSync(this.cssText),t&&dp.set(e,s))}return s}toString(){return this.cssText}};const ow=s=>new vg(typeof s=="string"?s:s+"",void 0,pu),Be=(s,...e)=>{const t=s.length===1?s[0]:e.reduce((i,n,r)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+s[r+1],s[0]);return new vg(t,s,pu)},aw=(s,e)=>{if(du)s.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),n=Na.litNonce;n!==void 0&&i.setAttribute("nonce",n),i.textContent=t.cssText,s.appendChild(i)}},pp=du?s=>s:s=>s instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return ow(t)})(s):s;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:lw,defineProperty:cw,getOwnPropertyDescriptor:hw,getOwnPropertyNames:uw,getOwnPropertySymbols:dw,getPrototypeOf:pw}=Object,Ds=globalThis,fp=Ds.trustedTypes,fw=fp?fp.emptyScript:"",mp=Ds.reactiveElementPolyfillSupport,Dr=(s,e)=>s,Qa={toAttribute(s,e){switch(e){case Boolean:s=s?fw:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,e){let t=s;switch(e){case Boolean:t=s!==null;break;case Number:t=s===null?null:Number(s);break;case Object:case Array:try{t=JSON.parse(s)}catch{t=null}}return t}},fu=(s,e)=>!lw(s,e),gp={attribute:!0,type:String,converter:Qa,reflect:!1,hasChanged:fu};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Ds.litPropertyMetadata??(Ds.litPropertyMetadata=new WeakMap);class Cs extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=gp){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(e,i,t);n!==void 0&&cw(this.prototype,e,n)}}static getPropertyDescriptor(e,t,i){const{get:n,set:r}=hw(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get(){return n==null?void 0:n.call(this)},set(o){const a=n==null?void 0:n.call(this);r.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??gp}static _$Ei(){if(this.hasOwnProperty(Dr("elementProperties")))return;const e=pw(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Dr("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Dr("properties"))){const t=this.properties,i=[...uw(t),...dw(t)];for(const n of i)this.createProperty(n,t[n])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,n]of t)this.elementProperties.set(i,n)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const n=this._$Eu(t,i);n!==void 0&&this._$Eh.set(n,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const n of i)t.unshift(pp(n))}else e!==void 0&&t.push(pp(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return aw(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostConnected)==null?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostDisconnected)==null?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EC(e,t){var i;const n=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,n);if(r!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:Qa).toAttribute(t,n.type);this._$Em=e,o==null?this.removeAttribute(r):this.setAttribute(r,o),this._$Em=null}}_$AK(e,t){var i;const n=this.constructor,r=n._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const o=n.getPropertyOptions(r),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)==null?void 0:i.fromAttribute)!==void 0?o.converter:Qa;this._$Em=r,this[r]=a.fromAttribute(t,o.type),this._$Em=null}}requestUpdate(e,t,i){if(e!==void 0){if(i??(i=this.constructor.getPropertyOptions(e)),!(i.hasChanged??fu)(this[e],t))return;this.P(e,t,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,i){this._$AL.has(e)||this._$AL.set(e,t),i.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[r,o]of this._$Ep)this[r]=o;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[r,o]of n)o.wrapped!==!0||this._$AL.has(r)||this[r]===void 0||this.P(r,this[r],o)}let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostUpdate)==null?void 0:r.call(n)}),this.update(i)):this._$EU()}catch(n){throw t=!1,this._$EU(),n}t&&this._$AE(i)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(i=>{var n;return(n=i.hostUpdated)==null?void 0:n.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}}Cs.elementStyles=[],Cs.shadowRootOptions={mode:"open"},Cs[Dr("elementProperties")]=new Map,Cs[Dr("finalized")]=new Map,mp==null||mp({ReactiveElement:Cs}),(Ds.reactiveElementVersions??(Ds.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Za=globalThis,qa=Za.trustedTypes,vp=qa?qa.createPolicy("lit-html",{createHTML:s=>s}):void 0,mu="$lit$",_i=`lit$${Math.random().toFixed(9).slice(2)}$`,gu="?"+_i,mw=`<${gu}>`,Vn=document,Wr=()=>Vn.createComment(""),Xr=s=>s===null||typeof s!="object"&&typeof s!="function",yg=Array.isArray,Eg=s=>yg(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",Vc=`[ 	
\f\r]`,Rr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,yp=/-->/g,Ep=/>/g,_n=RegExp(`>|${Vc}(?:([^\\s"'>=/]+)(${Vc}*=${Vc}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),bp=/'/g,wp=/"/g,bg=/^(?:script|style|textarea|title)$/i,gw=s=>(e,...t)=>({_$litType$:s,strings:e,values:t}),pe=gw(1),Ns=Symbol.for("lit-noChange"),tt=Symbol.for("lit-nothing"),Ip=new WeakMap,Mn=Vn.createTreeWalker(Vn,129);function wg(s,e){if(!Array.isArray(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return vp!==void 0?vp.createHTML(e):e}const Ig=(s,e)=>{const t=s.length-1,i=[];let n,r=e===2?"<svg>":"",o=Rr;for(let a=0;a<t;a++){const l=s[a];let h,d,p=-1,f=0;for(;f<l.length&&(o.lastIndex=f,d=o.exec(l),d!==null);)f=o.lastIndex,o===Rr?d[1]==="!--"?o=yp:d[1]!==void 0?o=Ep:d[2]!==void 0?(bg.test(d[2])&&(n=RegExp("</"+d[2],"g")),o=_n):d[3]!==void 0&&(o=_n):o===_n?d[0]===">"?(o=n??Rr,p=-1):d[1]===void 0?p=-2:(p=o.lastIndex-d[2].length,h=d[1],o=d[3]===void 0?_n:d[3]==='"'?wp:bp):o===wp||o===bp?o=_n:o===yp||o===Ep?o=Rr:(o=_n,n=void 0);const g=o===_n&&s[a+1].startsWith("/>")?" ":"";r+=o===Rr?l+mw:p>=0?(i.push(h),l.slice(0,p)+mu+l.slice(p)+_i+g):l+_i+(p===-2?a:g)}return[wg(s,r+(s[t]||"<?>")+(e===2?"</svg>":"")),i]};class Kr{constructor({strings:e,_$litType$:t},i){let n;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[h,d]=Ig(e,t);if(this.el=Kr.createElement(h,i),Mn.currentNode=this.el.content,t===2){const p=this.el.content.firstChild;p.replaceWith(...p.childNodes)}for(;(n=Mn.nextNode())!==null&&l.length<a;){if(n.nodeType===1){if(n.hasAttributes())for(const p of n.getAttributeNames())if(p.endsWith(mu)){const f=d[o++],g=n.getAttribute(p).split(_i),v=/([.?@])?(.*)/.exec(f);l.push({type:1,index:r,name:v[2],strings:g,ctor:v[1]==="."?Tg:v[1]==="?"?xg:v[1]==="@"?Ag:ho}),n.removeAttribute(p)}else p.startsWith(_i)&&(l.push({type:6,index:r}),n.removeAttribute(p));if(bg.test(n.tagName)){const p=n.textContent.split(_i),f=p.length-1;if(f>0){n.textContent=qa?qa.emptyScript:"";for(let g=0;g<f;g++)n.append(p[g],Wr()),Mn.nextNode(),l.push({type:2,index:++r});n.append(p[f],Wr())}}}else if(n.nodeType===8)if(n.data===gu)l.push({type:2,index:r});else{let p=-1;for(;(p=n.data.indexOf(_i,p+1))!==-1;)l.push({type:7,index:r}),p+=_i.length-1}r++}}static createElement(e,t){const i=Vn.createElement("template");return i.innerHTML=e,i}}function Hn(s,e,t=s,i){var n,r;if(e===Ns)return e;let o=i!==void 0?(n=t._$Co)==null?void 0:n[i]:t._$Cl;const a=Xr(e)?void 0:e._$litDirective$;return(o==null?void 0:o.constructor)!==a&&((r=o==null?void 0:o._$AO)==null||r.call(o,!1),a===void 0?o=void 0:(o=new a(s),o._$AT(s,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=o:t._$Cl=o),o!==void 0&&(e=Hn(s,o._$AS(s,e.values),o,i)),e}class Cg{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,n=((e==null?void 0:e.creationScope)??Vn).importNode(t,!0);Mn.currentNode=n;let r=Mn.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let h;l.type===2?h=new Gs(r,r.nextSibling,this,e):l.type===1?h=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(h=new Sg(r,this,e)),this._$AV.push(h),l=i[++a]}o!==(l==null?void 0:l.index)&&(r=Mn.nextNode(),o++)}return Mn.currentNode=Vn,n}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class Gs{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,n){this.type=2,this._$AH=tt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=n,this._$Cv=(n==null?void 0:n.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Hn(this,e,t),Xr(e)?e===tt||e==null||e===""?(this._$AH!==tt&&this._$AR(),this._$AH=tt):e!==this._$AH&&e!==Ns&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Eg(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==tt&&Xr(this._$AH)?this._$AA.nextSibling.data=e:this.T(Vn.createTextNode(e)),this._$AH=e}$(e){var t;const{values:i,_$litType$:n}=e,r=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Kr.createElement(wg(n.h,n.h[0]),this.options)),n);if(((t=this._$AH)==null?void 0:t._$AD)===r)this._$AH.p(i);else{const o=new Cg(r,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(e){let t=Ip.get(e.strings);return t===void 0&&Ip.set(e.strings,t=new Kr(e)),t}k(e){yg(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,n=0;for(const r of e)n===t.length?t.push(i=new Gs(this.S(Wr()),this.S(Wr()),this,this.options)):i=t[n],i._$AI(r),n++;n<t.length&&(this._$AR(i&&i._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class ho{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,n,r){this.type=1,this._$AH=tt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=r,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=tt}_$AI(e,t=this,i,n){const r=this.strings;let o=!1;if(r===void 0)e=Hn(this,e,t,0),o=!Xr(e)||e!==this._$AH&&e!==Ns,o&&(this._$AH=e);else{const a=e;let l,h;for(e=r[0],l=0;l<r.length-1;l++)h=Hn(this,a[i+l],t,l),h===Ns&&(h=this._$AH[l]),o||(o=!Xr(h)||h!==this._$AH[l]),h===tt?e=tt:e!==tt&&(e+=(h??"")+r[l+1]),this._$AH[l]=h}o&&!n&&this.j(e)}j(e){e===tt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Tg extends ho{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===tt?void 0:e}}class xg extends ho{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==tt)}}class Ag extends ho{constructor(e,t,i,n,r){super(e,t,i,n,r),this.type=5}_$AI(e,t=this){if((e=Hn(this,e,t,0)??tt)===Ns)return;const i=this._$AH,n=e===tt&&i!==tt||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==tt&&(i===tt||n);n&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class Sg{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Hn(this,e)}}const vw={P:mu,A:_i,C:gu,M:1,L:Ig,R:Cg,D:Eg,V:Hn,I:Gs,H:ho,N:xg,U:Ag,B:Tg,F:Sg},Cp=Za.litHtmlPolyfillSupport;Cp==null||Cp(Kr,Gs),(Za.litHtmlVersions??(Za.litHtmlVersions=[])).push("3.1.3");const Ja=(s,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let n=i._$litPart$;if(n===void 0){const r=(t==null?void 0:t.renderBefore)??null;i._$litPart$=n=new Gs(e.insertBefore(Wr(),r),r,void 0,t??{})}return n._$AI(s),n};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Ue=class extends Cs{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var s;const e=super.createRenderRoot();return(s=this.renderOptions).renderBefore??(s.renderBefore=e.firstChild),e}update(s){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(s),this._$Do=Ja(e,this.renderRoot,this.renderOptions)}connectedCallback(){var s;super.connectedCallback(),(s=this._$Do)==null||s.setConnected(!0)}disconnectedCallback(){var s;super.disconnectedCallback(),(s=this._$Do)==null||s.setConnected(!1)}render(){return Ns}};var Tp;Ue._$litElement$=!0,Ue.finalized=!0,(Tp=globalThis.litElementHydrateSupport)==null||Tp.call(globalThis,{LitElement:Ue});const xp=globalThis.litElementPolyfillSupport;xp==null||xp({LitElement:Ue});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.5");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yw={attribute:!0,type:String,converter:Qa,reflect:!1,hasChanged:fu},Ew=(s=yw,e,t)=>{const{kind:i,metadata:n}=t;let r=globalThis.litPropertyMetadata.get(n);if(r===void 0&&globalThis.litPropertyMetadata.set(n,r=new Map),r.set(t.name,s),i==="accessor"){const{name:o}=t;return{set(a){const l=e.get.call(this);e.set.call(this,a),this.requestUpdate(o,l,s)},init(a){return a!==void 0&&this.P(o,void 0,s),a}}}if(i==="setter"){const{name:o}=t;return function(a){const l=this[o];e.call(this,a),this.requestUpdate(o,l,s)}}throw Error("Unsupported decorator location: "+i)};function te(s){return(e,t)=>typeof t=="object"?Ew(s,e,t):((i,n,r)=>{const o=n.hasOwnProperty(r);return n.constructor.createProperty(r,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(n,r):void 0})(s,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function uo(s){return te({...s,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:bw}=vw,Ap=(s,e)=>(s==null?void 0:s._$litType$)!==void 0,ww=s=>{var e;return((e=s==null?void 0:s._$litType$)==null?void 0:e.h)!=null},Iw=s=>s.strings===void 0,Sp=()=>document.createComment(""),_p=(s,e,t)=>{var i;const n=s._$AA.parentNode,r=s._$AB;if(t===void 0){const o=n.insertBefore(Sp(),r),a=n.insertBefore(Sp(),r);t=new bw(o,a,s,s.options)}else{const o=t._$AB.nextSibling,a=t._$AM,l=a!==s;if(l){let h;(i=t._$AQ)==null||i.call(t,s),t._$AM=s,t._$AP!==void 0&&(h=s._$AU)!==a._$AU&&t._$AP(h)}if(o!==r||l){let h=t._$AA;for(;h!==o;){const d=h.nextSibling;n.insertBefore(h,r),h=d}}}return t},Cw={},Rp=(s,e=Cw)=>s._$AH=e,Pp=s=>s._$AH,Tw=s=>{s._$AR()};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const xw={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},_g=s=>(...e)=>({_$litDirective$:s,values:e});let Rg=class{constructor(s){}get _$AU(){return this._$AM._$AU}_$AT(s,e,t){this._$Ct=s,this._$AM=e,this._$Ci=t}_$AS(s,e){return this.update(s,e)}update(s,e){return this.render(...e)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Nr=(s,e)=>{var t;const i=s._$AN;if(i===void 0)return!1;for(const n of i)(t=n._$AO)==null||t.call(n,e,!1),Nr(n,e);return!0},$a=s=>{let e,t;do{if((e=s._$AM)===void 0)break;t=e._$AN,t.delete(s),s=e}while((t==null?void 0:t.size)===0)},Pg=s=>{for(let e;e=s._$AM;s=e){let t=e._$AN;if(t===void 0)e._$AN=t=new Set;else if(t.has(s))break;t.add(s),_w(e)}};function Aw(s){this._$AN!==void 0?($a(this),this._$AM=s,Pg(this)):this._$AM=s}function Sw(s,e=!1,t=0){const i=this._$AH,n=this._$AN;if(n!==void 0&&n.size!==0)if(e)if(Array.isArray(i))for(let r=t;r<i.length;r++)Nr(i[r],!1),$a(i[r]);else i!=null&&(Nr(i,!1),$a(i));else Nr(this,s)}const _w=s=>{s.type==xw.CHILD&&(s._$AP??(s._$AP=Sw),s._$AQ??(s._$AQ=Aw))};class Rw extends Rg{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),Pg(this),this.isConnected=e._$AU}_$AO(e,t=!0){var i,n;e!==this.isConnected&&(this.isConnected=e,e?(i=this.reconnected)==null||i.call(this):(n=this.disconnected)==null||n.call(this)),t&&(Nr(this,e),$a(this))}setValue(e){if(Iw(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const en=()=>new Pw;let Pw=class{};const Hc=new WeakMap,Ut=_g(class extends Rw{render(s){return tt}update(s,[e]){var t;const i=e!==this.Y;return i&&this.Y!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.Y=e,this.ht=(t=s.options)==null?void 0:t.host,this.rt(this.ct=s.element)),tt}rt(s){if(typeof this.Y=="function"){const e=this.ht??globalThis;let t=Hc.get(e);t===void 0&&(t=new WeakMap,Hc.set(e,t)),t.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),t.set(this.Y,s),s!==void 0&&this.Y.call(this.ht,s)}else this.Y.value=s}get lt(){var s,e;return typeof this.Y=="function"?(s=Hc.get(this.ht??globalThis))==null?void 0:s.get(this.Y):(e=this.Y)==null?void 0:e.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});/**
* (c) Iconify
*
* For the full copyright and license information, please view the license.txt
* files at https://github.com/iconify/iconify
*
* Licensed under MIT.
*
* @license MIT
* @version 2.0.0
*/const Fg=Object.freeze({left:0,top:0,width:16,height:16}),el=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),po=Object.freeze({...Fg,...el}),_h=Object.freeze({...po,body:"",hidden:!1}),Fw=Object.freeze({width:null,height:null}),Og=Object.freeze({...Fw,...el});function Ow(s,e=0){const t=s.replace(/^-?[0-9.]*/,"");function i(n){for(;n<0;)n+=4;return n%4}if(t===""){const n=parseInt(s);return isNaN(n)?0:i(n)}else if(t!==s){let n=0;switch(t){case"%":n=25;break;case"deg":n=90}if(n){let r=parseFloat(s.slice(0,s.length-t.length));return isNaN(r)?0:(r=r/n,r%1===0?i(r):0)}}return e}const Mw=/[\s,]+/;function Lw(s,e){e.split(Mw).forEach(t=>{switch(t.trim()){case"horizontal":s.hFlip=!0;break;case"vertical":s.vFlip=!0;break}})}const Mg={...Og,preserveAspectRatio:""};function Fp(s){const e={...Mg},t=(i,n)=>s.getAttribute(i)||n;return e.width=t("width",null),e.height=t("height",null),e.rotate=Ow(t("rotate","")),Lw(e,t("flip","")),e.preserveAspectRatio=t("preserveAspectRatio",t("preserveaspectratio","")),e}function Dw(s,e){for(const t in Mg)if(s[t]!==e[t])return!0;return!1}const Ur=/^[a-z0-9]+(-[a-z0-9]+)*$/,fo=(s,e,t,i="")=>{const n=s.split(":");if(s.slice(0,1)==="@"){if(n.length<2||n.length>3)return null;i=n.shift().slice(1)}if(n.length>3||!n.length)return null;if(n.length>1){const a=n.pop(),l=n.pop(),h={provider:n.length>0?n[0]:i,prefix:l,name:a};return e&&!Ua(h)?null:h}const r=n[0],o=r.split("-");if(o.length>1){const a={provider:i,prefix:o.shift(),name:o.join("-")};return e&&!Ua(a)?null:a}if(t&&i===""){const a={provider:i,prefix:"",name:r};return e&&!Ua(a,t)?null:a}return null},Ua=(s,e)=>s?!!((s.provider===""||s.provider.match(Ur))&&(e&&s.prefix===""||s.prefix.match(Ur))&&s.name.match(Ur)):!1;function Nw(s,e){const t={};!s.hFlip!=!e.hFlip&&(t.hFlip=!0),!s.vFlip!=!e.vFlip&&(t.vFlip=!0);const i=((s.rotate||0)+(e.rotate||0))%4;return i&&(t.rotate=i),t}function Op(s,e){const t=Nw(s,e);for(const i in _h)i in el?i in s&&!(i in t)&&(t[i]=el[i]):i in e?t[i]=e[i]:i in s&&(t[i]=s[i]);return t}function Uw(s,e){const t=s.icons,i=s.aliases||Object.create(null),n=Object.create(null);function r(o){if(t[o])return n[o]=[];if(!(o in n)){n[o]=null;const a=i[o]&&i[o].parent,l=a&&r(a);l&&(n[o]=[a].concat(l))}return n[o]}return Object.keys(t).concat(Object.keys(i)).forEach(r),n}function kw(s,e,t){const i=s.icons,n=s.aliases||Object.create(null);let r={};function o(a){r=Op(i[a]||n[a],r)}return o(e),t.forEach(o),Op(s,r)}function Lg(s,e){const t=[];if(typeof s!="object"||typeof s.icons!="object")return t;s.not_found instanceof Array&&s.not_found.forEach(n=>{e(n,null),t.push(n)});const i=Uw(s);for(const n in i){const r=i[n];r&&(e(n,kw(s,n,r)),t.push(n))}return t}const Bw={provider:"",aliases:{},not_found:{},...Fg};function Yc(s,e){for(const t in e)if(t in s&&typeof s[t]!=typeof e[t])return!1;return!0}function Dg(s){if(typeof s!="object"||s===null)return null;const e=s;if(typeof e.prefix!="string"||!s.icons||typeof s.icons!="object"||!Yc(s,Bw))return null;const t=e.icons;for(const n in t){const r=t[n];if(!n.match(Ur)||typeof r.body!="string"||!Yc(r,_h))return null}const i=e.aliases||Object.create(null);for(const n in i){const r=i[n],o=r.parent;if(!n.match(Ur)||typeof o!="string"||!t[o]&&!i[o]||!Yc(r,_h))return null}return e}const tl=Object.create(null);function zw(s,e){return{provider:s,prefix:e,icons:Object.create(null),missing:new Set}}function on(s,e){const t=tl[s]||(tl[s]=Object.create(null));return t[e]||(t[e]=zw(s,e))}function vu(s,e){return Dg(e)?Lg(e,(t,i)=>{i?s.icons[t]=i:s.missing.add(t)}):[]}function Vw(s,e,t){try{if(typeof t.body=="string")return s.icons[e]={...t},!0}catch{}return!1}function Hw(s,e){let t=[];return(typeof s=="string"?[s]:Object.keys(tl)).forEach(i=>{(typeof i=="string"&&typeof e=="string"?[e]:Object.keys(tl[i]||{})).forEach(n=>{const r=on(i,n);t=t.concat(Object.keys(r.icons).map(o=>(i!==""?"@"+i+":":"")+n+":"+o))})}),t}let Qr=!1;function Ng(s){return typeof s=="boolean"&&(Qr=s),Qr}function Zr(s){const e=typeof s=="string"?fo(s,!0,Qr):s;if(e){const t=on(e.provider,e.prefix),i=e.name;return t.icons[i]||(t.missing.has(i)?null:void 0)}}function Ug(s,e){const t=fo(s,!0,Qr);if(!t)return!1;const i=on(t.provider,t.prefix);return Vw(i,t.name,e)}function Mp(s,e){if(typeof s!="object")return!1;if(typeof e!="string"&&(e=s.provider||""),Qr&&!e&&!s.prefix){let n=!1;return Dg(s)&&(s.prefix="",Lg(s,(r,o)=>{o&&Ug(r,o)&&(n=!0)})),n}const t=s.prefix;if(!Ua({provider:e,prefix:t,name:"a"}))return!1;const i=on(e,t);return!!vu(i,s)}function Lp(s){return!!Zr(s)}function Yw(s){const e=Zr(s);return e?{...po,...e}:null}function Gw(s){const e={loaded:[],missing:[],pending:[]},t=Object.create(null);s.sort((n,r)=>n.provider!==r.provider?n.provider.localeCompare(r.provider):n.prefix!==r.prefix?n.prefix.localeCompare(r.prefix):n.name.localeCompare(r.name));let i={provider:"",prefix:"",name:""};return s.forEach(n=>{if(i.name===n.name&&i.prefix===n.prefix&&i.provider===n.provider)return;i=n;const r=n.provider,o=n.prefix,a=n.name,l=t[r]||(t[r]=Object.create(null)),h=l[o]||(l[o]=on(r,o));let d;a in h.icons?d=e.loaded:o===""||h.missing.has(a)?d=e.missing:d=e.pending;const p={provider:r,prefix:o,name:a};d.push(p)}),e}function kg(s,e){s.forEach(t=>{const i=t.loaderCallbacks;i&&(t.loaderCallbacks=i.filter(n=>n.id!==e))})}function jw(s){s.pendingCallbacksFlag||(s.pendingCallbacksFlag=!0,setTimeout(()=>{s.pendingCallbacksFlag=!1;const e=s.loaderCallbacks?s.loaderCallbacks.slice(0):[];if(!e.length)return;let t=!1;const i=s.provider,n=s.prefix;e.forEach(r=>{const o=r.icons,a=o.pending.length;o.pending=o.pending.filter(l=>{if(l.prefix!==n)return!0;const h=l.name;if(s.icons[h])o.loaded.push({provider:i,prefix:n,name:h});else if(s.missing.has(h))o.missing.push({provider:i,prefix:n,name:h});else return t=!0,!0;return!1}),o.pending.length!==a&&(t||kg([s],r.id),r.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),r.abort))})}))}let Ww=0;function Xw(s,e,t){const i=Ww++,n=kg.bind(null,t,i);if(!e.pending.length)return n;const r={id:i,icons:e,callback:s,abort:n};return t.forEach(o=>{(o.loaderCallbacks||(o.loaderCallbacks=[])).push(r)}),n}const Rh=Object.create(null);function Dp(s,e){Rh[s]=e}function Ph(s){return Rh[s]||Rh[""]}function Kw(s,e=!0,t=!1){const i=[];return s.forEach(n=>{const r=typeof n=="string"?fo(n,e,t):n;r&&i.push(r)}),i}var Qw={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function Zw(s,e,t,i){const n=s.resources.length,r=s.random?Math.floor(Math.random()*n):s.index;let o;if(s.random){let M=s.resources.slice(0);for(o=[];M.length>1;){const k=Math.floor(Math.random()*M.length);o.push(M[k]),M=M.slice(0,k).concat(M.slice(k+1))}o=o.concat(M)}else o=s.resources.slice(r).concat(s.resources.slice(0,r));const a=Date.now();let l="pending",h=0,d,p=null,f=[],g=[];typeof i=="function"&&g.push(i);function v(){p&&(clearTimeout(p),p=null)}function b(){l==="pending"&&(l="aborted"),v(),f.forEach(M=>{M.status==="pending"&&(M.status="aborted")}),f=[]}function w(M,k){k&&(g=[]),typeof M=="function"&&g.push(M)}function T(){return{startTime:a,payload:e,status:l,queriesSent:h,queriesPending:f.length,subscribe:w,abort:b}}function S(){l="failed",g.forEach(M=>{M(void 0,d)})}function _(){f.forEach(M=>{M.status==="pending"&&(M.status="aborted")}),f=[]}function I(M,k,V){const W=k!=="success";switch(f=f.filter(j=>j!==M),l){case"pending":break;case"failed":if(W||!s.dataAfterTimeout)return;break;default:return}if(k==="abort"){d=V,S();return}if(W){d=V,f.length||(o.length?P():S());return}if(v(),_(),!s.random){const j=s.resources.indexOf(M.resource);j!==-1&&j!==s.index&&(s.index=j)}l="completed",g.forEach(j=>{j(V)})}function P(){if(l!=="pending")return;v();const M=o.shift();if(M===void 0){if(f.length){p=setTimeout(()=>{v(),l==="pending"&&(_(),S())},s.timeout);return}S();return}const k={status:"pending",resource:M,callback:(V,W)=>{I(k,V,W)}};f.push(k),h++,p=setTimeout(P,s.rotate),t(M,e,k.callback)}return setTimeout(P),T}function Bg(s){const e={...Qw,...s};let t=[];function i(){t=t.filter(o=>o().status==="pending")}function n(o,a,l){const h=Zw(e,o,a,(d,p)=>{i(),l&&l(d,p)});return t.push(h),h}function r(o){return t.find(a=>o(a))||null}return{query:n,find:r,setIndex:o=>{e.index=o},getIndex:()=>e.index,cleanup:i}}function yu(s){let e;if(typeof s.resources=="string")e=[s.resources];else if(e=s.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:s.path||"/",maxURL:s.maxURL||500,rotate:s.rotate||750,timeout:s.timeout||5e3,random:s.random===!0,index:s.index||0,dataAfterTimeout:s.dataAfterTimeout!==!1}}const wl=Object.create(null),Sa=["https://api.simplesvg.com","https://api.unisvg.com"],Fh=[];for(;Sa.length>0;)Sa.length===1||Math.random()>.5?Fh.push(Sa.shift()):Fh.push(Sa.pop());wl[""]=yu({resources:["https://api.iconify.design"].concat(Fh)});function Np(s,e){const t=yu(e);return t===null?!1:(wl[s]=t,!0)}function Il(s){return wl[s]}function qw(){return Object.keys(wl)}function Up(){}const Gc=Object.create(null);function Jw(s){if(!Gc[s]){const e=Il(s);if(!e)return;const t=Bg(e),i={config:e,redundancy:t};Gc[s]=i}return Gc[s]}function zg(s,e,t){let i,n;if(typeof s=="string"){const r=Ph(s);if(!r)return t(void 0,424),Up;n=r.send;const o=Jw(s);o&&(i=o.redundancy)}else{const r=yu(s);if(r){i=Bg(r);const o=s.resources?s.resources[0]:"",a=Ph(o);a&&(n=a.send)}}return!i||!n?(t(void 0,424),Up):i.query(e,n,t)().abort}const kp="iconify2",qr="iconify",Vg=qr+"-count",Bp=qr+"-version",Hg=36e5,$w=168,eI=50;function Oh(s,e){try{return s.getItem(e)}catch{}}function Eu(s,e,t){try{return s.setItem(e,t),!0}catch{}}function zp(s,e){try{s.removeItem(e)}catch{}}function Mh(s,e){return Eu(s,Vg,e.toString())}function Lh(s){return parseInt(Oh(s,Vg))||0}const Un={local:!0,session:!0},Yg={local:new Set,session:new Set};let bu=!1;function tI(s){bu=s}let _a=typeof window>"u"?{}:window;function Gg(s){const e=s+"Storage";try{if(_a&&_a[e]&&typeof _a[e].length=="number")return _a[e]}catch{}Un[s]=!1}function jg(s,e){const t=Gg(s);if(!t)return;const i=Oh(t,Bp);if(i!==kp){if(i){const a=Lh(t);for(let l=0;l<a;l++)zp(t,qr+l.toString())}Eu(t,Bp,kp),Mh(t,0);return}const n=Math.floor(Date.now()/Hg)-$w,r=a=>{const l=qr+a.toString(),h=Oh(t,l);if(typeof h=="string"){try{const d=JSON.parse(h);if(typeof d=="object"&&typeof d.cached=="number"&&d.cached>n&&typeof d.provider=="string"&&typeof d.data=="object"&&typeof d.data.prefix=="string"&&e(d,a))return!0}catch{}zp(t,l)}};let o=Lh(t);for(let a=o-1;a>=0;a--)r(a)||(a===o-1?(o--,Mh(t,o)):Yg[s].add(a))}function Wg(){if(!bu){tI(!0);for(const s in Un)jg(s,e=>{const t=e.data,i=e.provider,n=t.prefix,r=on(i,n);if(!vu(r,t).length)return!1;const o=t.lastModified||-1;return r.lastModifiedCached=r.lastModifiedCached?Math.min(r.lastModifiedCached,o):o,!0})}}function iI(s,e){const t=s.lastModifiedCached;if(t&&t>=e)return t===e;if(s.lastModifiedCached=e,t)for(const i in Un)jg(i,n=>{const r=n.data;return n.provider!==s.provider||r.prefix!==s.prefix||r.lastModified===e});return!0}function nI(s,e){bu||Wg();function t(i){let n;if(!Un[i]||!(n=Gg(i)))return;const r=Yg[i];let o;if(r.size)r.delete(o=Array.from(r).shift());else if(o=Lh(n),o>=eI||!Mh(n,o+1))return;const a={cached:Math.floor(Date.now()/Hg),provider:s.provider,data:e};return Eu(n,qr+o.toString(),JSON.stringify(a))}e.lastModified&&!iI(s,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&(e=Object.assign({},e),delete e.not_found),t("local")||t("session"))}function Vp(){}function sI(s){s.iconsLoaderFlag||(s.iconsLoaderFlag=!0,setTimeout(()=>{s.iconsLoaderFlag=!1,jw(s)}))}function rI(s,e){s.iconsToLoad?s.iconsToLoad=s.iconsToLoad.concat(e).sort():s.iconsToLoad=e,s.iconsQueueFlag||(s.iconsQueueFlag=!0,setTimeout(()=>{s.iconsQueueFlag=!1;const{provider:t,prefix:i}=s,n=s.iconsToLoad;delete s.iconsToLoad;let r;!n||!(r=Ph(t))||r.prepare(t,i,n).forEach(o=>{zg(t,o,a=>{if(typeof a!="object")o.icons.forEach(l=>{s.missing.add(l)});else try{const l=vu(s,a);if(!l.length)return;const h=s.pendingIcons;h&&l.forEach(d=>{h.delete(d)}),nI(s,a)}catch(l){console.error(l)}sI(s)})})}))}const wu=(s,e)=>{const t=Kw(s,!0,Ng()),i=Gw(t);if(!i.pending.length){let l=!0;return e&&setTimeout(()=>{l&&e(i.loaded,i.missing,i.pending,Vp)}),()=>{l=!1}}const n=Object.create(null),r=[];let o,a;return i.pending.forEach(l=>{const{provider:h,prefix:d}=l;if(d===a&&h===o)return;o=h,a=d,r.push(on(h,d));const p=n[h]||(n[h]=Object.create(null));p[d]||(p[d]=[])}),i.pending.forEach(l=>{const{provider:h,prefix:d,name:p}=l,f=on(h,d),g=f.pendingIcons||(f.pendingIcons=new Set);g.has(p)||(g.add(p),n[h][d].push(p))}),r.forEach(l=>{const{provider:h,prefix:d}=l;n[h][d].length&&rI(l,n[h][d])}),e?Xw(e,i,r):Vp},oI=s=>new Promise((e,t)=>{const i=typeof s=="string"?fo(s,!0):s;if(!i){t(s);return}wu([i||s],n=>{if(n.length&&i){const r=Zr(i);if(r){e({...po,...r});return}}t(s)})});function aI(s){try{const e=typeof s=="string"?JSON.parse(s):s;if(typeof e.body=="string")return{...e}}catch{}}function lI(s,e){const t=typeof s=="string"?fo(s,!0,!0):null;if(!t){const r=aI(s);return{value:s,data:r}}const i=Zr(t);if(i!==void 0||!t.prefix)return{value:s,name:t,data:i};const n=wu([t],()=>e(s,t,Zr(t)));return{value:s,name:t,loading:n}}function jc(s){return s.hasAttribute("inline")}let Xg=!1;try{Xg=navigator.vendor.indexOf("Apple")===0}catch{}function cI(s,e){switch(e){case"svg":case"bg":case"mask":return e}return e!=="style"&&(Xg||s.indexOf("<a")===-1)?"svg":s.indexOf("currentColor")===-1?"bg":"mask"}const hI=/(-?[0-9.]*[0-9]+[0-9.]*)/g,uI=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Dh(s,e,t){if(e===1)return s;if(t=t||100,typeof s=="number")return Math.ceil(s*e*t)/t;if(typeof s!="string")return s;const i=s.split(hI);if(i===null||!i.length)return s;const n=[];let r=i.shift(),o=uI.test(r);for(;;){if(o){const a=parseFloat(r);isNaN(a)?n.push(r):n.push(Math.ceil(a*e*t)/t)}else n.push(r);if(r=i.shift(),r===void 0)return n.join("");o=!o}}function dI(s,e="defs"){let t="";const i=s.indexOf("<"+e);for(;i>=0;){const n=s.indexOf(">",i),r=s.indexOf("</"+e);if(n===-1||r===-1)break;const o=s.indexOf(">",r);if(o===-1)break;t+=s.slice(n+1,r).trim(),s=s.slice(0,i).trim()+s.slice(o+1)}return{defs:t,content:s}}function pI(s,e){return s?"<defs>"+s+"</defs>"+e:e}function fI(s,e,t){const i=dI(s);return pI(i.defs,e+i.content+t)}const mI=s=>s==="unset"||s==="undefined"||s==="none";function Kg(s,e){const t={...po,...s},i={...Og,...e},n={left:t.left,top:t.top,width:t.width,height:t.height};let r=t.body;[t,i].forEach(b=>{const w=[],T=b.hFlip,S=b.vFlip;let _=b.rotate;T?S?_+=2:(w.push("translate("+(n.width+n.left).toString()+" "+(0-n.top).toString()+")"),w.push("scale(-1 1)"),n.top=n.left=0):S&&(w.push("translate("+(0-n.left).toString()+" "+(n.height+n.top).toString()+")"),w.push("scale(1 -1)"),n.top=n.left=0);let I;switch(_<0&&(_-=Math.floor(_/4)*4),_=_%4,_){case 1:I=n.height/2+n.top,w.unshift("rotate(90 "+I.toString()+" "+I.toString()+")");break;case 2:w.unshift("rotate(180 "+(n.width/2+n.left).toString()+" "+(n.height/2+n.top).toString()+")");break;case 3:I=n.width/2+n.left,w.unshift("rotate(-90 "+I.toString()+" "+I.toString()+")");break}_%2===1&&(n.left!==n.top&&(I=n.left,n.left=n.top,n.top=I),n.width!==n.height&&(I=n.width,n.width=n.height,n.height=I)),w.length&&(r=fI(r,'<g transform="'+w.join(" ")+'">',"</g>"))});const o=i.width,a=i.height,l=n.width,h=n.height;let d,p;o===null?(p=a===null?"1em":a==="auto"?h:a,d=Dh(p,l/h)):(d=o==="auto"?l:o,p=a===null?Dh(d,h/l):a==="auto"?h:a);const f={},g=(b,w)=>{mI(w)||(f[b]=w.toString())};g("width",d),g("height",p);const v=[n.left,n.top,l,h];return f.viewBox=v.join(" "),{attributes:f,viewBox:v,body:r}}function Iu(s,e){let t=s.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const i in e)t+=" "+i+'="'+e[i]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+t+">"+s+"</svg>"}function gI(s){return s.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function vI(s){return"data:image/svg+xml,"+gI(s)}function Qg(s){return'url("'+vI(s)+'")'}const yI=()=>{let s;try{if(s=fetch,typeof s=="function")return s}catch{}};let il=yI();function EI(s){il=s}function bI(){return il}function wI(s,e){const t=Il(s);if(!t)return 0;let i;if(!t.maxURL)i=0;else{let n=0;t.resources.forEach(o=>{n=Math.max(n,o.length)});const r=e+".json?icons=";i=t.maxURL-n-t.path.length-r.length}return i}function II(s){return s===404}const CI=(s,e,t)=>{const i=[],n=wI(s,e),r="icons";let o={type:r,provider:s,prefix:e,icons:[]},a=0;return t.forEach((l,h)=>{a+=l.length+1,a>=n&&h>0&&(i.push(o),o={type:r,provider:s,prefix:e,icons:[]},a=l.length),o.icons.push(l)}),i.push(o),i};function TI(s){if(typeof s=="string"){const e=Il(s);if(e)return e.path}return"/"}const xI=(s,e,t)=>{if(!il){t("abort",424);return}let i=TI(e.provider);switch(e.type){case"icons":{const r=e.prefix,o=e.icons.join(","),a=new URLSearchParams({icons:o});i+=r+".json?"+a.toString();break}case"custom":{const r=e.uri;i+=r.slice(0,1)==="/"?r.slice(1):r;break}default:t("abort",400);return}let n=503;il(s+i).then(r=>{const o=r.status;if(o!==200){setTimeout(()=>{t(II(o)?"abort":"next",o)});return}return n=501,r.json()}).then(r=>{if(typeof r!="object"||r===null){setTimeout(()=>{r===404?t("abort",r):t("next",n)});return}setTimeout(()=>{t("success",r)})}).catch(()=>{t("next",n)})},AI={prepare:CI,send:xI};function Hp(s,e){switch(s){case"local":case"session":Un[s]=e;break;case"all":for(const t in Un)Un[t]=e;break}}const Wc="data-style";let Zg="";function SI(s){Zg=s}function Yp(s,e){let t=Array.from(s.childNodes).find(i=>i.hasAttribute&&i.hasAttribute(Wc));t||(t=document.createElement("style"),t.setAttribute(Wc,Wc),s.appendChild(t)),t.textContent=":host{display:inline-block;vertical-align:"+(e?"-0.125em":"0")+"}span,svg{display:block}"+Zg}function qg(){Dp("",AI),Ng(!0);let s;try{s=window}catch{}if(s){if(Wg(),s.IconifyPreload!==void 0){const e=s.IconifyPreload,t="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(i=>{try{(typeof i!="object"||i===null||i instanceof Array||typeof i.icons!="object"||typeof i.prefix!="string"||!Mp(i))&&console.error(t)}catch{console.error(t)}})}if(s.IconifyProviders!==void 0){const e=s.IconifyProviders;if(typeof e=="object"&&e!==null)for(const t in e){const i="IconifyProviders["+t+"] is invalid.";try{const n=e[t];if(typeof n!="object"||!n||n.resources===void 0)continue;Np(t,n)||console.error(i)}catch{console.error(i)}}}}return{enableCache:e=>Hp(e,!0),disableCache:e=>Hp(e,!1),iconLoaded:Lp,iconExists:Lp,getIcon:Yw,listIcons:Hw,addIcon:Ug,addCollection:Mp,calculateSize:Dh,buildIcon:Kg,iconToHTML:Iu,svgToURL:Qg,loadIcons:wu,loadIcon:oI,addAPIProvider:Np,appendCustomStyle:SI,_api:{getAPIConfig:Il,setAPIModule:Dp,sendAPIQuery:zg,setFetch:EI,getFetch:bI,listAPIProviders:qw}}}const Nh={"background-color":"currentColor"},Jg={"background-color":"transparent"},Gp={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},jp={"-webkit-mask":Nh,mask:Nh,background:Jg};for(const s in jp){const e=jp[s];for(const t in Gp)e[s+"-"+t]=Gp[t]}function Wp(s){return s?s+(s.match(/^[-0-9.]+$/)?"px":""):"inherit"}function _I(s,e,t){const i=document.createElement("span");let n=s.body;n.indexOf("<a")!==-1&&(n+="<!-- "+Date.now()+" -->");const r=s.attributes,o=Iu(n,{...r,width:e.width+"",height:e.height+""}),a=Qg(o),l=i.style,h={"--svg":a,width:Wp(r.width),height:Wp(r.height),...t?Nh:Jg};for(const d in h)l.setProperty(d,h[d]);return i}let kr;function RI(){try{kr=window.trustedTypes.createPolicy("iconify",{createHTML:s=>s})}catch{kr=null}}function PI(s){return kr===void 0&&RI(),kr?kr.createHTML(s):s}function FI(s){const e=document.createElement("span"),t=s.attributes;let i="";t.width||(i="width: inherit;"),t.height||(i+="height: inherit;"),i&&(t.style=i);const n=Iu(s.body,t);return e.innerHTML=PI(n),e.firstChild}function Uh(s){return Array.from(s.childNodes).find(e=>{const t=e.tagName&&e.tagName.toUpperCase();return t==="SPAN"||t==="SVG"})}function Xp(s,e){const t=e.icon.data,i=e.customisations,n=Kg(t,i);i.preserveAspectRatio&&(n.attributes.preserveAspectRatio=i.preserveAspectRatio);const r=e.renderedMode;let o;switch(r){case"svg":o=FI(n);break;default:o=_I(n,{...po,...t},r==="mask")}const a=Uh(s);a?o.tagName==="SPAN"&&a.tagName===o.tagName?a.setAttribute("style",o.getAttribute("style")):s.replaceChild(o,a):s.appendChild(o)}function Kp(s,e,t){const i=t&&(t.rendered?t:t.lastRender);return{rendered:!1,inline:e,icon:s,lastRender:i}}function OI(s="iconify-icon"){let e,t;try{e=window.customElements,t=window.HTMLElement}catch{return}if(!e||!t)return;const i=e.get(s);if(i)return i;const n=["icon","mode","inline","observe","width","height","rotate","flip"],r=class extends t{constructor(){super(),Sn(this,"_shadowRoot"),Sn(this,"_initialised",!1),Sn(this,"_state"),Sn(this,"_checkQueued",!1),Sn(this,"_connected",!1),Sn(this,"_observer",null),Sn(this,"_visible",!0);const a=this._shadowRoot=this.attachShadow({mode:"open"}),l=jc(this);Yp(a,l),this._state=Kp({value:""},l),this._queueCheck()}connectedCallback(){this._connected=!0,this.startObserver()}disconnectedCallback(){this._connected=!1,this.stopObserver()}static get observedAttributes(){return n.slice(0)}attributeChangedCallback(a){switch(a){case"inline":{const l=jc(this),h=this._state;l!==h.inline&&(h.inline=l,Yp(this._shadowRoot,l));break}case"observer":{this.observer?this.startObserver():this.stopObserver();break}default:this._queueCheck()}}get icon(){const a=this.getAttribute("icon");if(a&&a.slice(0,1)==="{")try{return JSON.parse(a)}catch{}return a}set icon(a){typeof a=="object"&&(a=JSON.stringify(a)),this.setAttribute("icon",a)}get inline(){return jc(this)}set inline(a){a?this.setAttribute("inline","true"):this.removeAttribute("inline")}get observer(){return this.hasAttribute("observer")}set observer(a){a?this.setAttribute("observer","true"):this.removeAttribute("observer")}restartAnimation(){const a=this._state;if(a.rendered){const l=this._shadowRoot;if(a.renderedMode==="svg")try{l.lastChild.setCurrentTime(0);return}catch{}Xp(l,a)}}get status(){const a=this._state;return a.rendered?"rendered":a.icon.data===null?"failed":"loading"}_queueCheck(){this._checkQueued||(this._checkQueued=!0,setTimeout(()=>{this._check()}))}_check(){if(!this._checkQueued)return;this._checkQueued=!1;const a=this._state,l=this.getAttribute("icon");if(l!==a.icon.value){this._iconChanged(l);return}if(!a.rendered||!this._visible)return;const h=this.getAttribute("mode"),d=Fp(this);(a.attrMode!==h||Dw(a.customisations,d)||!Uh(this._shadowRoot))&&this._renderIcon(a.icon,d,h)}_iconChanged(a){const l=lI(a,(h,d,p)=>{const f=this._state;if(f.rendered||this.getAttribute("icon")!==h)return;const g={value:h,name:d,data:p};g.data?this._gotIconData(g):f.icon=g});l.data?this._gotIconData(l):this._state=Kp(l,this._state.inline,this._state)}_forceRender(){if(!this._visible){const a=Uh(this._shadowRoot);a&&this._shadowRoot.removeChild(a);return}this._queueCheck()}_gotIconData(a){this._checkQueued=!1,this._renderIcon(a,Fp(this),this.getAttribute("mode"))}_renderIcon(a,l,h){const d=cI(a.data.body,h),p=this._state.inline;Xp(this._shadowRoot,this._state={rendered:!0,icon:a,inline:p,customisations:l,attrMode:h,renderedMode:d})}startObserver(){if(!this._observer)try{this._observer=new IntersectionObserver(a=>{const l=a.some(h=>h.isIntersecting);l!==this._visible&&(this._visible=l,this._forceRender())}),this._observer.observe(this)}catch{if(this._observer){try{this._observer.disconnect()}catch{}this._observer=null}}}stopObserver(){this._observer&&(this._observer.disconnect(),this._observer=null,this._visible=!0,this._connected&&this._forceRender())}};n.forEach(a=>{a in r.prototype||Object.defineProperty(r.prototype,a,{get:function(){return this.getAttribute(a)},set:function(l){l!==null?this.setAttribute(a,l):this.removeAttribute(a)}})});const o=qg();for(const a in o)r[a]=r.prototype[a]=o[a];return e.define(s,r),r}OI()||qg();var MI=Object.defineProperty,Ei=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&MI(e,t,n),n},Ra;const ri=(Ra=class extends Ue{constructor(){super(),this.labelHidden=!1,this.active=!1,this.disabled=!1,this.vertical=!1,this.tooltipVisible=!1,this._parent=en(),this._tooltip=en(),this._contextMenu=en(),this._mouseLeave=!1,this.onWindowMouseUp=s=>{const{value:e}=this._contextMenu;!this.contains(s.target)&&e&&(e.visible=!1)},this.mouseLeave=!0,this.addEventListener("click",s=>s.stopPropagation())}set mouseLeave(s){this._mouseLeave=s,s&&(this.tooltipVisible=!1,clearTimeout(this.timeoutID))}get mouseLeave(){return this._mouseLeave}computeTooltipPosition(){const{value:s}=this._parent,{value:e}=this._tooltip;s&&e&&gg(s,e,{placement:"bottom",middleware:[ng(10),mg(),fg(),pg({padding:5})]}).then(t=>{const{x:i,y:n}=t;Object.assign(e.style,{left:`${i}px`,top:`${n}px`})})}onMouseEnter(){if(!(this.tooltipTitle||this.tooltipText))return;this.mouseLeave=!1;const s=this.tooltipTime??700;this.timeoutID=setTimeout(()=>{this.mouseLeave||(this.computeTooltipPosition(),this.tooltipVisible=!0)},s)}onChildrenClick(s){s.stopPropagation();const{value:e}=this._contextMenu;e&&(e.visible=!e.visible)}onSlotChange(s){const{value:e}=this._contextMenu,t=s.target.assignedElements();for(const i of t){if(!(i instanceof Ra)){i.remove(),console.warn("Only bim-button is allowed inside bim-button. Child has been removed.");continue}i.addEventListener("click",()=>e==null?void 0:e.updatePosition())}this.requestUpdate()}connectedCallback(){super.connectedCallback(),window.addEventListener("mouseup",this.onWindowMouseUp)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("mouseup",this.onWindowMouseUp)}render(){const s=pe`
      <div ${Ut(this._tooltip)} class="tooltip">
        ${this.tooltipTitle?pe`<p style="text-wrap: nowrap;">
              <strong>${this.tooltipTitle}</strong>
            </p>`:null}
        ${this.tooltipText?pe`<p style="width: 9rem;">${this.tooltipText}</p>`:null}
      </div>
    `,e=this.children.length>0;return pe`
      <style>
        .button {
          border-radius: var(
            --bim-button--bdrs,
            ${e?"var(--bim-ui_size-4xs) 0 0 var(--bim-ui_size-4xs)":"var(--bim-ui_size-4xs)"}
          );
        }
        .children {
          border-radius: var(
            --bim-button--bdrs,
            ${e?"0 var(--bim-ui_size-4xs) var(--bim-ui_size-4xs) 0":"var(--bim-ui_size-4xs)"}
          );
        }
      </style>
      <div ${Ut(this._parent)} class="parent">
        ${this.label||this.icon?pe`
              <div
                class="button"
                @mouseenter=${this.onMouseEnter}
                @mouseleave=${()=>this.mouseLeave=!0}
              >
                <bim-label
                  .label=${this.label}
                  .icon=${this.icon}
                  .vertical=${this.vertical}
                  .labelHidden=${this.labelHidden}
                ></bim-label>
              </div>
            `:null}
        ${this.tooltipTitle||this.tooltipText?s:null}
        ${e?pe`
              <div class="children" @click=${this.onChildrenClick}>
                <bim-icon .icon=${"ic:round-plus"}></bim-icon>
              </div>
            `:null}
        <bim-context-menu
          ${Ut(this._contextMenu)}
          style="row-gap: var(--bim-ui_size-4xs)"
        >
          <slot @slotchange=${this.onSlotChange}></slot>
        </bim-context-menu>
      </div>
    `}},Ra.styles=Be`
    :host {
      display: block;
      flex: 1;
      pointer-events: none;
    }

    :host(:not([disabled]):hover) {
      cursor: pointer;
    }

    bim-label {
      pointer-events: none;
    }

    .parent {
      --bim-label--c: var(--bim-ui_bg-contrast-80);
      --bim-label--fz: var(--bim-ui_size-xs);
      --bim-icon--c: var(--bim-label--c);
      display: flex;
      height: 100%;
      user-select: none;
      row-gap: 0.125rem;
      column-gap: 0.125rem;
    }

    .button,
    .children {
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
      min-height: var(--bim-ui_size-5xl);
      min-width: var(--bim-ui_size-5xl);
      background-color: var(--bim-button--bgc, var(--bim-ui_bg-contrast-20));
      outline: var(--bim-button--olw) solid var(--bim-button--olc);
    }

    .button {
      flex-grow: 1;
    }

    :host(:not([label-hidden])[label]) .button {
      justify-content: var(--bim-button--jc, center);
    }

    :host(:hover) .button,
    :host(:hover) .children {
      --bim-label--c: var(--bim-ui_main-contrast);
      --bim-icon--c: var(--bim-ui_main-contrast);
      fill: white;
      background-color: var(--bim-ui_color-main);
    }

    :host(:not([label]):not([icon])) .children {
      flex: 1;
    }

    :host([active]) .button {
      --bim-label--c: var(--bim-ui_main-contrast);
      --bim-icon--c: var(--bim-ui_main-contrast);
      background-color: var(--bim-ui_color-main);
    }

    :host([vertical]) .parent {
      justify-content: center;
    }

    :host(:not([label-hidden])[label]) .button {
      padding: 0 0.75rem;
    }

    :host([disabled]) .parent {
      background-color: gray;
    }

    .children {
      --bim-icon--fz: var(--bim-ui_size-base);
      padding: 0 0.125rem;
    }

    ::slotted(bim-button) {
      --bim-icon--fz: var(--bim-ui_size-base);
      --bim-button--bgc: var(
        --bim-context-menu--bgc,
        var(--bim-ui_bg-contrast-20)
      );
      --bim-button--bdrs: var(--bim-ui_size-4xs);
      --bim-button--olw: 0;
      --bim-button--olc: transparent;
    }

    .tooltip {
      position: absolute;
      padding: 0.75rem;
      z-index: 99;
      display: flex;
      flex-flow: column;
      row-gap: 0.375rem;
      box-shadow: 0 0 10px 3px rgba(0 0 0 / 20%);
      outline: 1px solid var(--bim-ui_bg-contrast-40);
      font-size: var(--bim-ui_size-xs);
      border-radius: var(--bim-ui_size-4xs);
      background-color: var(--bim-ui_bg-contrast-20);
      color: var(--bim-ui_bg-contrast-100);
    }

    .tooltip p {
      margin: 0;
      padding: 0;
    }

    :host(:not([tooltip-visible])) .tooltip {
      display: none;
    }
  `,Ra);Ei([te({type:String,reflect:!0})],ri.prototype,"label");Ei([te({type:Boolean,attribute:"label-hidden",reflect:!0})],ri.prototype,"labelHidden");Ei([te({type:Boolean,reflect:!0})],ri.prototype,"active");Ei([te({type:Boolean,reflect:!0,attribute:"disabled"})],ri.prototype,"disabled");Ei([te({type:String,reflect:!0})],ri.prototype,"icon");Ei([te({type:Boolean,reflect:!0})],ri.prototype,"vertical");Ei([te({type:Number,attribute:"tooltip-time",reflect:!0})],ri.prototype,"tooltipTime");Ei([te({type:Boolean,attribute:"tooltip-visible",reflect:!0})],ri.prototype,"tooltipVisible");Ei([te({type:String,attribute:"tooltip-title",reflect:!0})],ri.prototype,"tooltipTitle");Ei([te({type:String,attribute:"tooltip-text",reflect:!0})],ri.prototype,"tooltipText");let LI=ri;var DI=Object.defineProperty,mo=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&DI(e,t,n),n};const $g=class extends Ue{constructor(){super(...arguments),this.checked=!1,this.inverted=!1,this.onValueChange=new Event("change")}get value(){return this.checked}onChange(s){s.stopPropagation(),this.checked=s.target.checked,this.dispatchEvent(this.onValueChange)}render(){return pe`
      <div class="parent">
        ${this.label?pe`<bim-label
              label="${this.label}"
              .icon="${this.icon}"
            ></bim-label> `:null}
        <input
          type="checkbox"
          aria-label=${this.label||this.name||"Checkbox Input"}
          @change="${this.onChange}"
          .checked="${this.checked}"
        />
      </div>
    `}};$g.styles=Be`
    :host {
      display: block;
    }

    .parent {
      display: flex;
      justify-content: space-between;
      height: 1.75rem;
      column-gap: 0.5rem;
      width: 100%;
      align-items: center;
    }

    :host([inverted]) .parent {
      flex-direction: row-reverse;
      justify-content: start;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_color-main));
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_color-accent));
    }
  `;let js=$g;mo([te({type:String,reflect:!0})],js.prototype,"icon");mo([te({type:String,reflect:!0})],js.prototype,"name");mo([te({type:String,reflect:!0})],js.prototype,"label");mo([te({type:Boolean,reflect:!0})],js.prototype,"checked");mo([te({type:Boolean,reflect:!0})],js.prototype,"inverted");var NI=Object.defineProperty,Ws=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&NI(e,t,n),n};const e0=class extends Ue{constructor(){super(...arguments),this.vertical=!1,this.color="#bcf124",this._colorInput=en(),this._textInput=en(),this.onValueChange=new Event("input"),this.onOpacityInput=s=>{const e=s.target;this.opacity=e.value,this.dispatchEvent(this.onValueChange)}}set value(s){const{color:e,opacity:t}=s;this.color=e,t&&(this.opacity=t)}get value(){const s={color:this.color};return this.opacity&&(s.opacity=this.opacity),s}onColorInput(s){s.stopPropagation();const{value:e}=this._colorInput;e&&(this.color=e.value,this.dispatchEvent(this.onValueChange))}onTextInput(s){s.stopPropagation();const{value:e}=this._textInput;if(!e)return;const{value:t}=e;let i=t.replace(/[^a-fA-F0-9]/g,"");i.startsWith("#")||(i=`#${i}`),e.value=i.slice(0,7),e.value.length===7&&(this.color=e.value,this.dispatchEvent(this.onValueChange))}focus(){const{value:s}=this._colorInput;s&&s.click()}render(){return pe`
      <div class="parent">
        <bim-input
          .label=${this.label}
          .icon=${this.icon}
          .vertical="${this.vertical}"
        >
          <div class="color-container">
            <div
              style="display: flex; align-items: center; gap: .375rem; height: 100%; flex: 1; padding: 0 0.5rem;"
            >
              <input
                ${Ut(this._colorInput)}
                @input="${this.onColorInput}"
                type="color"
                aria-label=${this.label||this.name||"Color Input"}
                value="${this.color}"
              />
              <div
                @click=${this.focus}
                class="sample"
                style="background-color: ${this.color}"
              ></div>
              <input
                ${Ut(this._textInput)}
                @input="${this.onTextInput}"
                value="${this.color}"
                type="text"
                aria-label=${this.label||this.name||"Text Color Input"}
              />
            </div>
            ${this.opacity!==void 0?pe`<bim-number-input
                  @input=${this.onOpacityInput}
                  slider
                  suffix="%"
                  min="0"
                  value=${this.opacity}
                  max="100"
                ></bim-number-input>`:null}
          </div>
        </bim-input>
      </div>
    `}};e0.styles=Be`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-ui_color-accent);
    }

    .parent {
      display: flex;
      gap: 0.375rem;
    }

    .color-container {
      position: relative;
      outline: none;
      display: flex;
      height: 100%;
      gap: 0.5rem;
      justify-content: flex-start;
      align-items: center;
      flex: 1;
      border-radius: var(--bim-color-input--bdrs, var(--bim-ui_size-4xs));
    }

    .color-container input[type="color"] {
      position: absolute;
      bottom: -0.25rem;
      visibility: hidden;
      width: 0;
      height: 0;
    }

    .color-container .sample {
      width: 1rem;
      height: 1rem;
      border-radius: 0.125rem;
      background-color: #fff;
    }

    .color-container input[type="text"] {
      height: 100%;
      flex: 1;
      width: 3.25rem;
      text-transform: uppercase;
      font-size: 0.75rem;
      background-color: transparent;
      padding: 0%;
      outline: none;
      border: none;
      color: var(--bim-color-input--c, var(--bim-ui_bg-contrast-100));
    }

    bim-number-input {
      flex-grow: 0;
    }
  `;let Kn=e0;Ws([te({type:String,reflect:!0})],Kn.prototype,"name");Ws([te({type:String,reflect:!0})],Kn.prototype,"label");Ws([te({type:String,reflect:!0})],Kn.prototype,"icon");Ws([te({type:Boolean,reflect:!0})],Kn.prototype,"vertical");Ws([te({type:Number,reflect:!0})],Kn.prototype,"opacity");Ws([te({type:String,reflect:!0})],Kn.prototype,"color");const UI=Be`
  ::-webkit-scrollbar {
    width: 0.4rem;
    height: 0.4rem;
    overflow: hidden;
  }

  ::-webkit-scrollbar-thumb {
    border-radius: 0.25rem;
    background-color: var(
      --bim-scrollbar--c,
      color-mix(in lab, var(--bim-ui_color-main), white 15%)
    );
  }

  ::-webkit-scrollbar-track {
    background-color: var(--bim-scrollbar--bgc, var(--bim-ui_bg-base));
  }
`,kI=Be`
  :root {
    /* Backgrounds */
    --bim-ui_bg-base: hsl(210 10% 5%);
    --bim-ui_bg-contrast-10: hsl(210 10% 10%);
    --bim-ui_bg-contrast-20: hsl(210 10% 20%);
    --bim-ui_bg-contrast-40: hsl(210 10% 40%);
    --bim-ui_bg-contrast-60: hsl(210 10% 60%);
    --bim-ui_bg-contrast-80: hsl(210 10% 80%);
    --bim-ui_bg-contrast-100: hsl(210 10% 95%);

    /* Main/accent app color that contrasts with bg-base */
    --bim-ui_bg-main-contrast: #6528d7;
    --bim-ui_bg-accent-contrast: #6528d7;

    /* Colors */
    --bim-ui_color-main: #6528d7;
    --bim-ui_color-accent: #bcf124;

    --bim-ui_main-base: #6528d7;
    --bim-ui_main-contrast: hsl(210 10% 95%);
    --bim-ui_accent-base: #bcf124;
    --bim-ui_accent-contrast: hsl(210 10% 5%);

    /* Sizes */
    --bim-ui_size-4xs: 0.375rem;
    --bim-ui_size-3xs: 0.5rem;
    --bim-ui_size-2xs: 0.625rem;
    --bim-ui_size-xs: 0.75rem;
    --bim-ui_size-sm: 0.875rem;
    --bim-ui_size-base: 1rem;
    --bim-ui_size-lg: 1.125rem;
    --bim-ui_size-xl: 1.25rem;
    --bim-ui_size-2xl: 1.375rem;
    --bim-ui_size-3xl: 1.5rem;
    --bim-ui_size-4xl: 1.625rem;
    --bim-ui_size-5xl: 1.75rem;
    --bim-ui_size-6xl: 1.875rem;
    --bim-ui_size-7xl: 2rem;
    --bim-ui_size-8xl: 2.125rem;
    --bim-ui_size-9xl: 2.25rem;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --bim-ui_bg-base: hsl(210 10% 5%);
      --bim-ui_bg-contrast-10: hsl(210 10% 10%);
      --bim-ui_bg-contrast-20: hsl(210 10% 20%);
      --bim-ui_bg-contrast-40: hsl(210 10% 40%);
      --bim-ui_bg-contrast-60: hsl(210 10% 60%);
      --bim-ui_bg-contrast-80: hsl(210 10% 80%);
      --bim-ui_bg-contrast-100: hsl(210 10% 95%);
    }
  }

  @media (prefers-color-scheme: light) {
    :root {
      --bim-ui_bg-base: hsl(210 10% 95%);
      --bim-ui_bg-contrast-10: hsl(210 10% 90%);
      --bim-ui_bg-contrast-20: hsl(210 10% 85%);
      --bim-ui_bg-contrast-40: hsl(210 10% 60%);
      --bim-ui_bg-contrast-60: hsl(210 10% 40%);
      --bim-ui_bg-contrast-80: hsl(210 10% 20%);
      --bim-ui_bg-contrast-100: hsl(210 10% 5%);

      --bim-ui_color-main: #6528d7;
      --bim-ui_color-accent: #6528d7;
    }
  }

  html.bim-ui-dark {
    --bim-ui_bg-base: hsl(210 10% 5%);
    --bim-ui_bg-contrast-10: hsl(210 10% 10%);
    --bim-ui_bg-contrast-20: hsl(210 10% 20%);
    --bim-ui_bg-contrast-40: hsl(210 10% 40%);
    --bim-ui_bg-contrast-60: hsl(210 10% 60%);
    --bim-ui_bg-contrast-80: hsl(210 10% 80%);
    --bim-ui_bg-contrast-100: hsl(210 10% 95%);
  }

  html.bim-ui-light {
    --bim-ui_bg-base: hsl(210 10% 95%);
    --bim-ui_bg-contrast-10: hsl(210 10% 90%);
    --bim-ui_bg-contrast-20: hsl(210 10% 85%);
    --bim-ui_bg-contrast-40: hsl(210 10% 60%);
    --bim-ui_bg-contrast-60: hsl(210 10% 40%);
    --bim-ui_bg-contrast-80: hsl(210 10% 20%);
    --bim-ui_bg-contrast-100: hsl(210 10% 5%);

    --bim-ui_color-main: #6528d7;
    --bim-ui_color-accent: #6528d7;
  }

  bim-grid:not([floating]) bim-toolbars-container {
    background-color: var(--bim-ui_bg-base);
  }

  bim-grid[floating] bim-toolbars-container {
    background-color: transparent;
  }
`,Qn={scrollbar:UI,globalStyles:kI};var BI=Object.defineProperty,zI=Object.getOwnPropertyDescriptor,VI=(s,e,t,i)=>{for(var n=zI(e,t),r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&BI(e,t,n),n};const t0=class extends Ue{constructor(){super(...arguments),this._visible=!1,this._middleware={name:"middleware",async fn(s){const{right:e,top:t}=await cu(s);return s.x-=Math.sign(e)===1?e+5:0,s.y-=Math.sign(t)===1?t+5:0,s}}}get visible(){return this._visible}set visible(s){this._visible=s,s&&this.updatePosition()}async updatePosition(s){const e=s||this.parentNode;if(!e){this.visible=!1,console.warn("No target element found for context-menu.");return}const t=await gg(e,this,{placement:"right",middleware:[ng(10),mg(),fg(),pg({padding:5}),this._middleware]}),{x:i,y:n}=t;this.style.left=`${i}px`,this.style.top=`${n}px`}render(){return pe` <slot></slot> `}};t0.styles=[Qn.scrollbar,Be`
      :host {
        --bim-label--fz: var(--bim-ui_size-xs);
        position: absolute;
        top: 0;
        left: 0;
        z-index: 999;
        overflow: auto;
        max-height: 20rem;
        min-width: 3rem;
        flex-direction: column;
        box-shadow: 1px 2px 8px 2px rgba(0, 0, 0, 0.15);
        padding: 0.5rem;
        border-radius: var(--bim-ui_size-4xs);
        background-color: var(
          --bim-context-menu--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      :host([visible]) {
        display: flex;
      }

      :host(:not([visible])) {
        display: none;
      }
    `];let i0=t0;VI([te({type:Boolean,reflect:!0})],i0.prototype,"visible");class Zn extends Ue{constructor(){super(...arguments),this._lazyLoadObserver=null,this._visibleElements=[],this.ELEMENTS_BEFORE_OBSERVER=20,this.useObserver=!1,this.elements=new Set,this.observe=e=>{if(!this.useObserver)return;for(const i of e)this.elements.add(i);const t=e.slice(this.ELEMENTS_BEFORE_OBSERVER);for(const i of t)i.remove();this.observeLastElement()}}set visibleElements(e){this._visibleElements=this.useObserver?e:[],this.requestUpdate()}get visibleElements(){return this._visibleElements}getLazyObserver(){if(!this.useObserver)return null;if(this._lazyLoadObserver)return this._lazyLoadObserver;const e=new IntersectionObserver(t=>{const i=t[0];if(!i.isIntersecting)return;const n=i.target;e.unobserve(n);const r=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length,o=[...this.elements][r];o&&(this.visibleElements=[...this.visibleElements,o],e.observe(o))},{threshold:.5});return e}observeLastElement(){const e=this.getLazyObserver();if(!e)return;const t=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length-1,i=[...this.elements][t];i&&e.observe(i)}resetVisibleElements(){const e=this.getLazyObserver();if(e){for(const t of this.elements)e.unobserve(t);this.visibleElements=[],this.observeLastElement()}}static create(e,t){const i=document.createDocumentFragment();if(e.length===0)return Ja(e(),i),i.firstElementChild;if(!t)throw new Error("UIComponent: Initial state is required for statefull components.");let n=t;const r=e,o=a=>(n={...n,...a},Ja(r(n),i),n);return o(t),[i.firstElementChild,o]}}const nl=(s,e=!0)=>{let t={};for(const i of s.children){const n=i,r=n.getAttribute("name")||n.getAttribute("label");if(r){if("value"in n){const o=n.value;if(typeof o=="object"&&!Array.isArray(o)&&Object.keys(o).length===0)continue;t[r]=n.value}else if(e){const o=nl(n);if(Object.keys(o).length===0)continue;t[r]=o}}else e&&(t={...t,...nl(n)})}return t},Cl=s=>s==="true"||s==="false"?s==="true":s&&!isNaN(Number(s))&&s.trim()!==""?Number(s):s,HI=["=",">",">=","<","<=","?","/","#"];function Qp(s){const e=HI.filter(o=>s.split(o).length===2)[0],t=s.split(e).map(o=>o.trim()),[i,n]=t,r=n.startsWith("'")&&n.endsWith("'")?n.replace(/'/g,""):Cl(n);return{key:i,condition:e,value:r}}const kh=s=>{try{const e=[],t=s.split(/&(?![^()]*\))/).map(i=>i.trim());for(const i of t){const n=!i.startsWith("(")&&!i.endsWith(")"),r=i.startsWith("(")&&i.endsWith(")");if(n){const o=Qp(i);e.push(o)}if(r){const o={operator:"&",queries:i.replace(/^(\()|(\))$/g,"").split("&").map(a=>a.trim()).map((a,l)=>{const h=Qp(a);return l>0&&(h.operator="&"),h})};e.push(o)}}return e}catch{return null}},Zp=(s,e,t)=>{let i=!1;switch(e){case"=":i=s===t;break;case"?":i=String(s).includes(String(t));break;case"<":(typeof s=="number"||typeof t=="number")&&(i=s<t);break;case"<=":(typeof s=="number"||typeof t=="number")&&(i=s<=t);break;case">":(typeof s=="number"||typeof t=="number")&&(i=s>t);break;case">=":(typeof s=="number"||typeof t=="number")&&(i=s>=t);break;case"/":i=String(s).startsWith(String(t));break}return i};var YI=Object.defineProperty,GI=Object.getOwnPropertyDescriptor,cn=(s,e,t,i)=>{for(var n=i>1?void 0:i?GI(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&YI(e,t,n),n};const n0=class extends Ue{constructor(){super(...arguments),this.checked=!1,this.checkbox=!1,this.noMark=!1,this.vertical=!1}get value(){return this._value!==void 0?this._value:this.label?Cl(this.label):this.label}set value(s){this._value=s}render(){return pe`
      <div class="parent" .title=${this.label??""}>
        ${this.img||this.icon||this.label?pe` <div style="display: flex; column-gap: 0.375rem">
              ${this.checkbox&&!this.noMark?pe`<bim-checkbox
                    style="pointer-events: none"
                    .checked=${this.checked}
                  ></bim-checkbox>`:null}
              <bim-label
                .vertical=${this.vertical}
                .label=${this.label}
                .icon=${this.icon}
                .img=${this.img}
              ></bim-label>
            </div>`:null}
        ${!this.checkbox&&!this.noMark&&this.checked?pe`<svg
              xmlns="http://www.w3.org/2000/svg"
              height="1.125rem"
              viewBox="0 0 24 24"
              width="1.125rem"
              fill="#FFFFFF"
            >
              <path d="M0 0h24v24H0z" fill="none" />
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
            </svg>`:null}
        <slot></slot>
      </div>
    `}};n0.styles=Be`
    :host {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
      display: block;
      box-sizing: border-box;
      flex: 1;
      padding: 0rem 0.5rem;
      border-radius: var(--bim-ui_size-4xs);
    }

    :host(:hover) {
      cursor: pointer;
      background-color: color-mix(
        in lab,
        var(--bim-selector--bgc, var(--bim-ui_bg-contrast-20)),
        var(--bim-ui_color-main) 10%
      );
    }

    :host([checked]) {
      --bim-label--c: color-mix(in lab, var(--bim-ui_color-main), white 30%);
    }

    :host([checked]) svg {
      fill: color-mix(in lab, var(--bim-ui_color-main), white 30%);
    }

    .parent {
      box-sizing: border-box;
      display: flex;
      justify-content: var(--bim-option--jc, space-between);
      column-gap: 0.5rem;
      align-items: center;
      min-height: 1.75rem;
      height: 100%;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_color-main));
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_color-accent));
    }

    bim-label {
      pointer-events: none;
    }
  `;let at=n0;cn([te({type:String,reflect:!0})],at.prototype,"img",2);cn([te({type:String,reflect:!0})],at.prototype,"label",2);cn([te({type:String,reflect:!0})],at.prototype,"icon",2);cn([te({type:Boolean,reflect:!0})],at.prototype,"checked",2);cn([te({type:Boolean,reflect:!0})],at.prototype,"checkbox",2);cn([te({type:Boolean,attribute:"no-mark",reflect:!0})],at.prototype,"noMark",2);cn([te({converter:{fromAttribute(s){return s&&Cl(s)}}})],at.prototype,"value",1);cn([te({type:Boolean,reflect:!0})],at.prototype,"vertical",2);var jI=Object.defineProperty,WI=Object.getOwnPropertyDescriptor,hn=(s,e,t,i)=>{for(var n=i>1?void 0:i?WI(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&jI(e,t,n),n};const s0=class extends Zn{constructor(){super(),this.multiple=!1,this.required=!1,this.vertical=!1,this._inputContainer=en(),this._listElement=en(),this._visible=!1,this._value=[],this.onValueChange=new Event("change"),this.onWindowMouseUp=s=>{this.visible&&(this.contains(s.target)||(this.visible=!1))},this.onOptionClick=s=>{const e=s.target,t=this._value.includes(e);if(!this.multiple&&!this.required&&!t)this._value=[e];else if(!this.multiple&&!this.required&&t)this._value=[];else if(!this.multiple&&this.required&&!t)this._value=[e];else if(this.multiple&&!this.required&&!t)this._value=[...this._value,e];else if(this.multiple&&!this.required&&t)this._value=this._value.filter(i=>i!==e);else if(this.multiple&&this.required&&!t)this._value=[...this._value,e];else if(this.multiple&&this.required&&t){const i=this._value.filter(n=>n!==e);i.length!==0&&(this._value=i)}this.updateOptionsState(),this.dispatchEvent(this.onValueChange)},this.useObserver=!0}set visible(s){this._visible=s,s||this.resetVisibleElements()}get visible(){return this._visible}set value(s){if(this.required&&Object.keys(s).length===0)return;const e=[];for(const t of s){const i=this.findOption(t);if(i&&(e.push(i),!this.multiple&&Object.keys(s).length>1))break}this._value=e,this.updateOptionsState(),this.dispatchEvent(this.onValueChange)}get value(){return this._value.filter(s=>s instanceof at&&s.checked).map(s=>s.value)}get _options(){const s=[...this.elements];for(const e of this.children)e instanceof at&&s.push(e);return s}onSlotChange(s){const e=s.target.assignedElements();this.observe(e);for(const t of e){if(!(t instanceof at)){t.remove();continue}t.removeEventListener("click",this.onOptionClick),t.addEventListener("click",this.onOptionClick)}}updateOptionsState(){for(const s of this._options)s instanceof at&&(this._value.includes(s)?s.checked=!0:s.checked=!1)}findOption(s){return this._options.find(e=>e instanceof at?e.label===s||e.value===s:!1)}connectedCallback(){super.connectedCallback(),window.addEventListener("mouseup",this.onWindowMouseUp)}firstUpdated(){for(const s of this.children)s instanceof at&&s.checked&&this._value.push(s)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("mouseup",this.onWindowMouseUp)}render(){let s,e,t;if(this._value.length===0)s="Select an option...";else if(this._value.length===1){const i=this._value[0];s=(i==null?void 0:i.label)||(i==null?void 0:i.value),e=i==null?void 0:i.img,t=i==null?void 0:i.icon}else s=`Multiple (${this._value.length})`;return pe`
      <bim-input
        title=${this.label??""}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        <div
          ${Ut(this._inputContainer)}
          class="input"
          @click=${()=>this.visible=!this.visible}
        >
          <bim-label
            label=${s}
            .img=${e}
            .icon=${t}
            style="overflow: hidden;"
          ></bim-label>
          <svg
            style="flex-shrink: 0"
            xmlns="http://www.w3.org/2000/svg"
            height="1.125rem"
            viewBox="0 0 24 24"
            width="1.125rem"
            fill="#9ca3af"
          >
            <path d="M0 0h24v24H0V0z" fill="none" />
            <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
          </svg>
        </div>
        <bim-context-menu ${Ut(this._listElement)} .visible=${this.visible}>
          <slot @slotchange=${this.onSlotChange}></slot>
          ${this.visibleElements.map(i=>i)}
        </bim-context-menu>
      </bim-input>
    `}};s0.styles=[Qn.scrollbar,Be`
      :host {
        --bim-input--bgc: var(
          --bim-dropdown--bgc,
          var(--bim-ui_bg-contrast-20)
        );
        --bim-input--olw: var(--bim-dropdown--olw, 2px);
        --bim-input--olc: var(--bim-dropdown--olc, transparent);
        --bim-input--bdrs: var(--bim-dropdown--bdrs, var(--bim-ui_size-4xs));
        flex: 1;
        display: block;
      }

      :host([visible]) {
        --bim-input--olc: var(
          --bim-dropdown¡focus--c,
          var(--bim-ui_color-accent)
        );
      }

      .input {
        --bim-label--fz: var(--bim-drodown--fz, var(--bim-ui_size-xs));
        --bim-label--c: var(--bim-dropdown--c, var(--bim-ui_bg-contrast-100));
        height: 100%;
        display: flex;
        flex: 1;
        overflow: hidden;
        column-gap: 0.25rem;
        outline: none;
        cursor: pointer;
        align-items: center;
        justify-content: space-between;
        padding: 0 0.5rem;
      }

      bim-label {
        pointer-events: none;
      }
    `];let Ni=s0;hn([te({type:String,reflect:!0})],Ni.prototype,"name",2);hn([te({type:String,reflect:!0})],Ni.prototype,"icon",2);hn([te({type:String,reflect:!0})],Ni.prototype,"label",2);hn([te({type:Boolean,reflect:!0})],Ni.prototype,"multiple",2);hn([te({type:Boolean,reflect:!0})],Ni.prototype,"required",2);hn([te({type:Boolean,reflect:!0})],Ni.prototype,"vertical",2);hn([te({type:Boolean,reflect:!0})],Ni.prototype,"visible",1);hn([uo()],Ni.prototype,"_value",2);var XI=Object.defineProperty,r0=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&XI(e,t,n),n};const o0=class extends Ue{constructor(){super(...arguments),this.floating=!1,this.layouts={}}getUniqueAreasFromTemplate(s){const e=s.split(`
`).map(t=>t.trim()).map(t=>t.split('"')[1]).filter(t=>t!==void 0).flatMap(t=>t.split(/\s+/));return[...new Set(e)].filter(t=>t!=="")}firstUpdated(){this._onLayoutChange=new Event("layoutchange")}render(){if(this.layout){if(this.layouts[this.layout]){this.innerHTML="";const s=this.layouts[this.layout],e=this.getUniqueAreasFromTemplate(s.template).map(t=>{const i=s.elements[t];return i&&(i.style.gridArea=t),i}).filter(t=>!!t);this.style.gridTemplate=s.template,this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange),this.append(...e)}}else this.innerHTML="",this.style.gridTemplate="",this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange);return pe`<slot></slot>`}};o0.styles=Be`
    :host {
      display: grid;
      height: 100%;
      width: 100%;
      overflow: hidden;
      box-sizing: border-box;
    }

    /* :host(:not([layout])) {
      display: none;
    } */

    :host([floating]) {
      --bim-panel--bdrs: var(--bim-ui_size-4xs);
      background-color: transparent;
      padding: 1rem;
      gap: 1rem;
      position: absolute;
      pointer-events: none;
      top: 0px;
      left: 0px;
    }

    :host(:not([floating])) {
      --bim-panel--bdrs: 0;
      background-color: var(--bim-ui_bg-contrast-20);
      gap: 1px;
    }
  `;let Cu=o0;r0([te({type:Boolean,reflect:!0})],Cu.prototype,"floating");r0([te({type:String,reflect:!0})],Cu.prototype,"layout");const Bh=class extends Ue{render(){return pe`
      <iconify-icon .icon=${this.icon} height="none"></iconify-icon>
    `}};Bh.styles=Be`
    :host {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
    }

    iconify-icon {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
      color: var(--bim-icon--c);
    }
  `,Bh.properties={icon:{type:String}};let KI=Bh;var QI=Object.defineProperty,Tl=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&QI(e,t,n),n};const a0=class extends Ue{constructor(){super(),this.onValueChange=new Event("change"),this.vertical=!1}get value(){const s={};for(const e of this.children){const t=e;"value"in t?s[t.name||t.label]=t.value:"checked"in t&&(s[t.name||t.label]=t.checked)}return s}set value(s){const e=[...this.children];for(const t in s){const i=e.find(o=>{const a=o;return a.name===t||a.label===t});if(!i)continue;const n=i,r=s[t];typeof r=="boolean"?n.checked=r:n.value=r}}render(){return pe`
      <div class="parent">
        ${this.label||this.icon?pe`<bim-label
              .label=${this.label}
              .icon=${this.icon}
            ></bim-label>`:null}
        <div class="input">
          <slot></slot>
        </div>
      </div>
    `}};a0.styles=Be`
    :host {
      flex: 1;
      display: block;
    }

    .parent {
      display: flex;
      flex-wrap: wrap;
      column-gap: 1rem;
      row-gap: 0.375rem;
      user-select: none;
      flex: 1;
    }

    :host(:not([vertical])) .parent {
      justify-content: space-between;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    .input {
      overflow: hidden;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      min-height: 1.75rem;
      min-width: 4rem;
      gap: var(--bim-input--g, var(--bim-ui_size-4xs));
      padding: var(--bim-input--p, 0);
      background-color: var(--bim-input--bgc, transparent);
      outline: var(--bim-input--olw, 2px) solid
        var(--bim-input--olc, transparent);
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
    }

    :host(:not([vertical])) .input {
      flex: 1;
      justify-content: flex-end;
    }

    :host(:not([vertical])[label]) .input {
      max-width: 13rem;
    }
  `;let go=a0;Tl([te({type:String,reflect:!0})],go.prototype,"name");Tl([te({type:String,reflect:!0})],go.prototype,"label");Tl([te({type:String,reflect:!0})],go.prototype,"icon");Tl([te({type:Boolean,reflect:!0})],go.prototype,"vertical");var ZI=Object.defineProperty,Xs=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&ZI(e,t,n),n};const l0=class extends Ue{constructor(){super(...arguments),this.labelHidden=!1,this.iconHidden=!1,this.vertical=!1}get value(){return this.label?Cl(this.label):this.label}render(){return pe`
      <div class="parent" .title=${this.label??""}>
        ${this.img?pe`<img .src=${this.img} .alt=${this.label||""} />`:null}
        ${!this.iconHidden&&this.icon?pe`<bim-icon .icon=${this.icon}></bim-icon>`:null}
        ${!this.labelHidden&&this.label?pe`<label>${this.label}</label>`:null}
      </div>
    `}};l0.styles=Be`
    :host {
      --bim-icon--c: var(--bim-label--c);
      color: var(--bim-label--c, var(--bim-ui_bg-contrast-60));
      font-size: var(--bim-label--fz, var(--bim-ui_size-xs));
      overflow: hidden;
    }

    .parent {
      display: flex;
      align-items: center;
      column-gap: 0.25rem;
      row-gap: 0.125rem;
      user-select: none;
      height: 100%;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    label {
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    }

    img {
      height: 100%;
      aspect-ratio: 1;
      border-radius: 100%;
      margin-right: 0.125rem;
    }

    :host(:not([vertical])) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 1.5)
      );
    }

    :host([vertical]) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 4)
      );
    }
  `;let qn=l0;Xs([te({type:String,reflect:!0})],qn.prototype,"label");Xs([te({type:String,reflect:!0})],qn.prototype,"img");Xs([te({type:Boolean,attribute:"label-hidden",reflect:!0})],qn.prototype,"labelHidden");Xs([te({type:String,reflect:!0})],qn.prototype,"icon");Xs([te({type:Boolean,attribute:"icon-hidden",reflect:!0})],qn.prototype,"iconHidden");Xs([te({type:Boolean,reflect:!0})],qn.prototype,"vertical");var qI=Object.defineProperty,JI=Object.getOwnPropertyDescriptor,Zt=(s,e,t,i)=>{for(var n=i>1?void 0:i?JI(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&qI(e,t,n),n};const c0=class extends Ue{constructor(){super(...arguments),this._value=0,this.vertical=!1,this.slider=!1,this._input=en(),this.onValueChange=new Event("change")}set value(s){this.setValue(s.toString())}get value(){return this._value}onChange(s){s.stopPropagation();const{value:e}=this._input;e&&this.setValue(e.value)}setValue(s){const{value:e}=this._input;let t=s;if(t=t.replace(/[^0-9.-]/g,""),t=t.replace(/(\..*)\./g,"$1"),t.endsWith(".")||(t.lastIndexOf("-")>0&&(t=t[0]+t.substring(1).replace(/-/g,"")),t==="-"||t==="-0"))return;let i=Number(t);Number.isNaN(i)||(i=this.min!==void 0?Math.max(i,this.min):i,i=this.max!==void 0?Math.min(i,this.max):i,this.value!==i&&(this._value=i,e&&(e.value=this.value.toString()),this.requestUpdate(),this.dispatchEvent(this.onValueChange)))}onBlur(){const{value:s}=this._input;s&&Number.isNaN(Number(s.value))&&(s.value=this.value.toString())}onSliderMouseDown(s){document.body.style.cursor="w-resize";const{clientX:e}=s,t=this.value;let i=!1;const n=a=>{var l;i=!0;const{clientX:h}=a,d=this.step??1,p=((l=d.toString().split(".")[1])==null?void 0:l.length)||0,f=1/(this.sensitivity??1),g=(h-e)/f;if(Math.floor(Math.abs(g))!==Math.abs(g))return;const v=t+g*d;this.setValue(v.toFixed(p))},r=()=>{this.slider=!0,this.removeEventListener("blur",r)},o=()=>{document.removeEventListener("mousemove",n),document.body.style.cursor="default",i?i=!1:(this.addEventListener("blur",r),this.slider=!1,requestAnimationFrame(()=>this.focus())),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)}onFocus(s){s.stopPropagation();const e=t=>{t.key==="Escape"&&(this.blur(),window.removeEventListener("keydown",e))};window.addEventListener("keydown",e)}connectedCallback(){super.connectedCallback(),this.min&&this.min>this.value&&(this._value=this.min),this.max&&this.max<this.value&&(this._value=this.max)}focus(){const{value:s}=this._input;s&&s.focus()}render(){const s=pe`
      ${this.pref||this.icon?pe`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            .label=${this.pref}
            .icon=${this.icon}
          ></bim-label>`:null}
      <input
        ${Ut(this._input)}
        type="text"
        aria-label=${this.label||this.name||"Number Input"}
        size="1"
        @input=${o=>o.stopPropagation()}
        @change=${this.onChange}
        @blur=${this.onBlur}
        @focus=${this.onFocus}
        .value=${this.value.toString()}
      />
      ${this.suffix?pe`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            .label=${this.suffix}
          ></bim-label>`:null}
    `,e=this.min??-1/0,t=this.max??1/0,i=100*(this.value-e)/(t-e),n=pe`
      <style>
        .slider-indicator {
          width: ${`${i}%`};
        }
      </style>
      <div class="slider" @mousedown=${this.onSliderMouseDown}>
        <div class="slider-indicator"></div>
        ${this.pref||this.icon?pe`<bim-label
              style="z-index: 1; margin-right: 0.125rem"
              .label=${`${this.pref}: `}
              .icon=${this.icon}
            ></bim-label>`:null}
        <bim-label
          style="z-index: 1;"
          .label=${this.value.toString()}
        ></bim-label>
        ${this.suffix?pe`<bim-label
              style="z-index: 1;"
              .label=${this.suffix}
            ></bim-label>`:null}
      </div>
    `,r=`${this.label||this.name||this.pref?`${this.label||this.name||this.pref}: `:""}${this.value}${this.suffix??""}`;return pe`
      <bim-input
        title=${r}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        ${this.slider?n:s}
      </bim-input>
    `}};c0.styles=Be`
    :host {
      --bim-input--bgc: var(
        --bim-number-input--bgc,
        var(--bim-ui_bg-contrast-20)
      );
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-number-input--olc, transparent);
      --bim-input--bdrs: var(--bim-number-input--bdrs, var(--bim-ui_size-4xs));
      --bim-input--p: 0 0.375rem;
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(
        --bim-number-input¡focus--c,
        var(--bim-ui_color-accent)
      );
    }

    :host(:not([slider])) bim-label {
      --bim-label--c: var(
        --bim-number-input_affixes--c,
        var(--bim-ui_bg-contrast-60)
      );
      --bim-label--fz: var(
        --bim-number-input_affixes--fz,
        var(--bim-ui_size-xs)
      );
    }

    p {
      margin: 0;
      padding: 0;
    }

    input {
      background-color: transparent;
      outline: none;
      border: none;
      padding: 0;
      flex-grow: 1;
      text-align: right;
      font-family: inherit;
      font-feature-settings: inherit;
      font-variation-settings: inherit;
      font-size: var(--bim-number-input--fz, var(--bim-ui_size-xs));
      color: var(--bim-number-input--c, var(--bim-ui_bg-contrast-100));
    }

    :host([suffix]:not([pref])) input {
      text-align: left;
    }

    :host([slider]) {
      --bim-input--p: 0;
    }

    :host([slider]) .slider {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
    }

    .slider {
      position: relative;
      display: flex;
      justify-content: center;
      width: 100%;
      height: 100%;
    }

    .slider-indicator {
      height: 100%;
      background-color: var(--bim-ui_color-main);
      position: absolute;
      top: 0;
      left: 0;
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
    }

    bim-input {
      display: flex;
    }

    bim-label {
      pointer-events: none;
    }
  `;let kt=c0;Zt([te({type:String,reflect:!0})],kt.prototype,"name",2);Zt([te({type:String,reflect:!0})],kt.prototype,"icon",2);Zt([te({type:String,reflect:!0})],kt.prototype,"label",2);Zt([te({type:String,reflect:!0})],kt.prototype,"pref",2);Zt([te({type:Number,reflect:!0})],kt.prototype,"min",2);Zt([te({type:Number,reflect:!0})],kt.prototype,"value",1);Zt([te({type:Number,reflect:!0})],kt.prototype,"step",2);Zt([te({type:Number,reflect:!0})],kt.prototype,"sensitivity",2);Zt([te({type:Number,reflect:!0})],kt.prototype,"max",2);Zt([te({type:String,reflect:!0})],kt.prototype,"suffix",2);Zt([te({type:Boolean,reflect:!0})],kt.prototype,"vertical",2);Zt([te({type:Boolean,reflect:!0})],kt.prototype,"slider",2);var $I=Object.defineProperty,eC=Object.getOwnPropertyDescriptor,xl=(s,e,t,i)=>{for(var n=i>1?void 0:i?eC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&$I(e,t,n),n};const h0=class extends Ue{constructor(){super(...arguments),this.onValueChange=new Event("change"),this._hidden=!1,this.activationButton=document.createElement("bim-button")}set hidden(s){this._hidden=s,this.activationButton.active=!s,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}get value(){return nl(this)}set value(s){const e=[...this.children];for(const t in s){const i=e.find(r=>{const o=r;return o.name===t||o.label===t});if(!i)continue;const n=i;n.value=s[t]}}connectedCallback(){super.connectedCallback(),this.activationButton.active=!this.hidden,this.activationButton.onclick=()=>this.hidden=!this.hidden}disconnectedCallback(){super.disconnectedCallback(),this.activationButton.remove()}collapseSections(){const s=this.querySelectorAll("bim-panel-section");for(const e of s)e.collapsed=!0}expandSections(){const s=this.querySelectorAll("bim-panel-section");for(const e of s)e.collapsed=!1}render(){return this.activationButton.icon=this.icon,this.activationButton.label=this.label||this.name,this.activationButton.tooltipTitle=this.label||this.name,pe`
      <div class="parent">
        ${this.label||this.name||this.icon?pe`<bim-label
              .label=${this.label||this.name}
              .icon=${this.icon}
            ></bim-label>`:null}
        <div class="sections">
          <slot></slot>
        </div>
      </div>
    `}};h0.styles=[Qn.scrollbar,Be`
      :host {
        display: flex;
        border-radius: var(--bim-ui_size-base);
        background-color: var(--bim-ui_bg-base);
        min-width: 20rem;
        overflow: auto;
      }

      :host([hidden]) {
        display: none;
      }

      .parent {
        display: flex;
        flex: 1;
        flex-direction: column;
        pointer-events: auto;
      }

      .parent bim-label {
        --bim-label--c: var(--bim-panel--c, var(--bim-ui_bg-contrast-80));
        --bim-label--fz: var(--bim-panel--fz, var(--bim-ui_size-sm));
        font-weight: 600;
        padding: 1rem;
        flex-shrink: 0;
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      .sections {
        display: flex;
        flex-direction: column;
        overflow: auto;
      }

      ::slotted(bim-panel-section:not(:last-child)) {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }
    `];let vo=h0;xl([te({type:String,reflect:!0})],vo.prototype,"icon",2);xl([te({type:String,reflect:!0})],vo.prototype,"name",2);xl([te({type:String,reflect:!0})],vo.prototype,"label",2);xl([te({type:Boolean,reflect:!0})],vo.prototype,"hidden",1);var tC=Object.defineProperty,yo=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&tC(e,t,n),n};const u0=class extends Ue{constructor(){super(...arguments),this.onValueChange=new Event("change")}get value(){return nl(this)}set value(s){const e=[...this.children];for(const t in s){const i=e.find(r=>{const o=r;return o.name===t||o.label===t});if(!i)continue;const n=i;n.value=s[t]}}onHeaderClick(){this.fixed||(this.collapsed=!this.collapsed)}render(){const s=this.label||this.icon||this.name||this.fixed,e=pe`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0V0z" fill="none" />
      <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
    </svg>`,t=pe`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0z" fill="none" />
      <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z" />
    </svg>`,i=this.collapsed?e:t,n=pe`
      <div
        class="header"
        title=${this.label??""}
        @click=${this.onHeaderClick}
      >
        ${this.label||this.icon||this.name?pe`<bim-label
              .label=${this.label||this.name}
              .icon=${this.icon}
            ></bim-label>`:null}
        ${this.fixed?null:i}
      </div>
    `;return pe`
      <div class="parent">
        ${s?n:null}
        <div class="components">
          <slot></slot>
        </div>
      </div>
    `}};u0.styles=[Qn.scrollbar,Be`
      :host {
        display: block;
        /* height: 100%; */
        pointer-events: auto;
      }

      :host(:not([fixed])) .header:hover {
        --bim-label--c: var(
          --bim-panel-section¡hover,
          var(--bim-ui_color-accent)
        );
        cursor: pointer;
        color: var(--bim-panel-section¡hover, var(--bim-ui_color-accent));
      }

      :host(:not([fixed])) .header:hover svg {
        fill: var(--bim-panel-section¡hover, var(--bim-ui_color-accent));
      }

      .header {
        --bim-label--fz: var(--bim-panel--fz, var(--bim-ui_size-sm));
        z-index: 3;
        flex-shrink: 0;
        /* position: sticky;
        top: 0; */
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        user-select: none;
        height: 1.5rem;
        padding: 0.75rem 1rem;
        /* background-color: var(--bim-panel-section--bgc, var(--bim-ui_bg-base)); */
        color: var(--bim-panel-section--c, var(--bim-ui_bg-contrast-80));
      }

      .header svg {
        fill: var(--bim-panel-section--c, var(--bim-ui_bg-contrast-80));
      }

      .title {
        display: flex;
        align-items: center;
        column-gap: 0.5rem;
      }

      .title p {
        font-size: var(--bim-panel-section--fz, var(--bim-ui_size-sm));
      }

      .components {
        display: flex;
        flex-direction: column;
        row-gap: 0.75rem;
        padding: 0.125rem 1rem 1rem;
      }

      :host(:not([fixed])[collapsed]) .components {
        display: none;
      }

      bim-label {
        pointer-events: none;
      }
    `];let Ks=u0;yo([te({type:String,reflect:!0})],Ks.prototype,"icon");yo([te({type:String,reflect:!0})],Ks.prototype,"label");yo([te({type:String,reflect:!0})],Ks.prototype,"name");yo([te({type:Boolean,reflect:!0})],Ks.prototype,"fixed");yo([te({type:Boolean,reflect:!0})],Ks.prototype,"collapsed");var iC=Object.defineProperty,Eo=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&iC(e,t,n),n};const d0=class extends Ue{constructor(){super(...arguments),this.vertical=!1,this.onValueChange=new Event("change"),this._canEmitEvents=!1,this._value=document.createElement("bim-option"),this.onOptionClick=s=>{this._value=s.target,this.dispatchEvent(this.onValueChange);for(const e of this.children)e instanceof at&&(e.checked=e===s.target)}}get _options(){return[...this.querySelectorAll("bim-option")]}set value(s){const e=this.findOption(s);if(e){for(const t of this._options)t.checked=t===e;this._value=e,this._canEmitEvents&&this.dispatchEvent(this.onValueChange)}}get value(){return this._value.value}onSlotChange(s){const e=s.target.assignedElements();for(const t of e)t instanceof at&&(t.noMark=!0,t.removeEventListener("click",this.onOptionClick),t.addEventListener("click",this.onOptionClick))}findOption(s){return this._options.find(e=>e instanceof at?e.label===s||e.value===s:!1)}firstUpdated(){const s=[...this.children].find(e=>e instanceof at&&e.checked);s&&(this._value=s)}render(){return pe`
      <bim-input
        .vertical=${this.vertical}
        .label=${this.label}
        .icon=${this.icon}
      >
        <slot @slotchange=${this.onSlotChange}></slot>
      </bim-input>
    `}};d0.styles=Be`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      --bim-input--g: 0;
      --bim-option--jc: center;
      flex: 1;
      display: block;
    }

    ::slotted(bim-option) {
      border-radius: 0;
    }

    ::slotted(bim-option[checked]) {
      --bim-label--c: white;
      background-color: var(--bim-ui_color-main);
    }
  `;let Qs=d0;Eo([te({type:String,reflect:!0})],Qs.prototype,"name");Eo([te({type:String,reflect:!0})],Qs.prototype,"icon");Eo([te({type:String,reflect:!0})],Qs.prototype,"label");Eo([te({type:Boolean,reflect:!0})],Qs.prototype,"vertical");Eo([uo()],Qs.prototype,"_value");var nC=Object.defineProperty,sC=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&nC(e,t,n),n};const p0=class extends Ue{constructor(){super(...arguments),this.rowData={}}get data(){return this.column?this.rowData[this.column]:null}render(){return pe`
      <style>
        :host {
          grid-area: ${this.column??"unset"};
        }
      </style>
      <slot></slot>
    `}};p0.styles=Be`
    :host {
      padding: 0.25rem 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    ::slotted(*) {
      --bim-input--bgc: transparent;
      --bim-input--olc: var(--bim-ui_bg-contrast-20);
      --bim-input--olw: 1px;
    }

    ::slotted(bim-input) {
      --bim-input--olw: 0;
    }
  `;let f0=p0;sC([te({type:String,reflect:!0})],f0.prototype,"column");var rC=Object.defineProperty,oC=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&rC(e,t,n),n};const m0=class extends Ue{constructor(){super(...arguments),this._groups=[],this.data=[],this.table=this.closest("bim-table")}toggleGroups(s,e=!1){for(const t of this._groups)t.childrenHidden=typeof s>"u"?!t.childrenHidden:!s,e&&t.toggleChildren(s,e)}render(){return this._groups=[],pe`
      ${this.data.map(s=>{const e=document.createElement("bim-table-group");return this._groups.push(e),e.table=this.table,e.data=s,e})}
    `}};m0.styles=Be`
    :host {
      position: relative;
      grid-area: Children;
    }

    :host([hidden]) {
      display: none;
    }
  `;let g0=m0;oC([te({type:Array,attribute:!1})],g0.prototype,"data");var aC=Object.defineProperty,lC=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&aC(e,t,n),n};const v0=class extends Ue{constructor(){super(...arguments),this.data={data:{}},this.childrenHidden=!0,this.table=this.closest("bim-table")}connectedCallback(){super.connectedCallback(),this.table&&this.table.expanded?this.childrenHidden=!1:this.childrenHidden=!0}toggleChildren(s,e=!1){this._children&&(this.childrenHidden=typeof s>"u"?!this.childrenHidden:!s,e&&this._children.toggleGroups(s,e))}render(){var s,e;const t=((s=this.table)==null?void 0:s.getGroupIndentation(this.data))??0,i=pe`
      <style>
        .branch-vertical {
          left: ${t+.5625}rem;
        }
      </style>
      <div class="branch branch-vertical"></div>
    `,n=document.createElement("div");n.classList.add("branch","branch-horizontal"),n.style.left=`${t-1+.5625}rem`;const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("height","9.5"),r.setAttribute("width","7.5"),r.setAttribute("viewBox","0 0 4.6666672 7.3333333");const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","m 1.7470835,6.9583848 2.5899999,-2.59 c 0.39,-0.39 0.39,-1.02 0,-1.41 L 1.7470835,0.36838483 c -0.63,-0.62000003 -1.71000005,-0.18 -1.71000005,0.70999997 v 5.17 c 0,0.9 1.08000005,1.34 1.71000005,0.71 z"),r.append(o);const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("height","6.5"),a.setAttribute("width","9.5"),a.setAttribute("viewBox","0 0 5.9111118 5.0175439");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M -0.33616196,1.922522 2.253838,4.5125219 c 0.39,0.39 1.02,0.39 1.41,0 L 6.2538379,1.922522 c 0.6200001,-0.63 0.18,-1.71000007 -0.7099999,-1.71000007 H 0.37383804 c -0.89999997,0 -1.33999997,1.08000007 -0.71,1.71000007 z"),a.append(l);const h=document.createElement("div");h.addEventListener("click",()=>this.toggleChildren()),h.classList.add("caret"),h.style.left=`${.125+t}rem`,this.childrenHidden?h.append(r):h.append(a);const d=document.createElement("bim-table-row");d.table=this.table,d.data=this.data.data,(e=this.table)==null||e.dispatchEvent(new CustomEvent("rowcreated",{detail:{row:d}})),this.data.children&&d.append(h),t!==0&&(!this.data.children||this.childrenHidden)&&d.append(n);let p;return this.data.children&&(p=document.createElement("bim-table-children"),this._children=p,p.table=this.table,p.data=this.data.children),pe`
      <div class="parent">
        ${this.data.children&&!this.childrenHidden?i:null}
        ${d} ${this.childrenHidden?null:p}
      </div>
    `}};v0.styles=Be`
    :host {
      position: relative;
    }

    .parent {
      display: grid;
      grid-template-areas: "Data" "Children";
    }

    .branch {
      position: absolute;
      z-index: 1;
    }

    .branch-vertical {
      top: 1rem;
      bottom: 1rem;
      border-left: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .branch-horizontal {
      top: 50%;
      width: 1rem;
      border-bottom: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .caret {
      position: absolute;
      z-index: 2;
      transform: translateY(-50%) rotate(0deg);
      top: 50%;
      display: flex;
      width: 0.95rem;
      height: 0.95rem;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }

    .caret svg {
      fill: var(--bim-ui_bg-contrast-60);
    }
  `;let y0=v0;lC([te({type:Boolean,attribute:"children-hidden",reflect:!0})],y0.prototype,"childrenHidden");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const qp=s=>ww(s)?s._$litType$.h:s.strings,cC=_g(class extends Rg{constructor(s){super(s),this.et=new WeakMap}render(s){return[s]}update(s,[e]){const t=Ap(this.it)?qp(this.it):null,i=Ap(e)?qp(e):null;if(t!==null&&(i===null||t!==i)){const n=Pp(s).pop();let r=this.et.get(t);if(r===void 0){const o=document.createDocumentFragment();r=Ja(tt,o),r.setConnected(!1),this.et.set(t,r)}Rp(r,[n]),_p(r,void 0,n)}if(i!==null){if(t===null||t!==i){const n=this.et.get(i);if(n!==void 0){const r=Pp(n).pop();Tw(s),_p(s,void 0,r),Rp(s,[r])}}this.it=e}else this.it=void 0;return this.render(e)}});var hC=Object.defineProperty,Al=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&hC(e,t,n),n};const E0=class extends Ue{constructor(){super(),this.data={},this._table=this.closest("bim-table"),this.onTableIndentationColorChange=s=>{var e;if(!this.table)return;const t=s.detail,{indentationLevel:i,color:n}=t;((e=this.table)==null?void 0:e.getRowIndentation(this.data))===i&&(this.style.backgroundColor=n)},this.onTableColumnsChange=()=>{this.table&&(this.columns=this.table.columns)},this._observer=new IntersectionObserver(s=>{this._intersecting=s[0].isIntersecting},{rootMargin:"10px"}),this.columns=[],this.isHeader=!1}get _columnNames(){return this.columns.map(s=>s.name)}get _columnWidths(){return this.columns.map(s=>s.width)}set table(s){this._table&&(this.columns=[],this._table.removeEventListener("columnschange",this.onTableColumnsChange)),this._table=s,this._table&&(this.columns=this._table.columns,this._table.addEventListener("columnschange",this.onTableColumnsChange),this._table.addEventListener("indentation",this.onTableIndentationColorChange))}get table(){return this._table}connectedCallback(){super.connectedCallback(),this._observer.observe(this)}compute(){var s,e;const t=((s=this.table)==null?void 0:s.getRowIndentation(this.data))??0,i=this.isHeader?this.data:((e=this.table)==null?void 0:e.computeRowDeclaration(this.data))??this.data,n=[];for(const r in i){const o=i[r];let a;typeof o=="string"||typeof o=="boolean"||typeof o=="number"?a=pe`<bim-label label="${o}"></bim-label>`:a=o;const l=this._columnNames.indexOf(r)===0,h=`
        ${l&&!this.isHeader?"justify-content: normal":""};
        ${l&&!this.isHeader?`margin-left: ${t+.125}rem`:""}
      `,d=pe`
        <bim-table-cell ${Ut(p=>{if(!p)return;const f=p;f.rowData=this.data,setTimeout(()=>{var g;(g=this.table)==null||g.dispatchEvent(new CustomEvent("cellcreated",{detail:{cell:f}}))})})} style="${h}" .column=${r}
          >${a}</bim-table-cell
        >
      `;n.push(d)}return pe`
      <style>
        :host {
          grid-template-areas: "${this._columnNames.join(" ")}";
          grid-template-columns: ${this._columnWidths.join(" ")};
        }
      </style>
      ${n}
      <slot></slot>
    `}render(){return pe`${cC(this._intersecting?this.compute():pe``)}`}};E0.styles=Be`
    :host {
      position: relative;
      grid-area: Data;
      display: grid;
      min-height: 2.25rem;
      /* border-bottom: 1px solid var(--bim-ui_bg-contrast-20); */
    }
  `;let bo=E0;Al([te({type:Array,attribute:!1})],bo.prototype,"columns");Al([te({type:Object,attribute:!1})],bo.prototype,"data");Al([te({type:Boolean,attribute:"is-header",reflect:!0})],bo.prototype,"isHeader");Al([uo()],bo.prototype,"_intersecting");var uC=Object.defineProperty,dC=Object.getOwnPropertyDescriptor,Jn=(s,e,t,i)=>{for(var n=i>1?void 0:i?dC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&uC(e,t,n),n};const b0=class extends Ue{constructor(){super(...arguments),this._columnsChange=new Event("columnschange"),this._filteredData=[],this.headersHidden=!1,this.minColWidth="4rem",this._columns=[],this._textDelimiters={comma:",",tab:"	"},this._queryString=null,this._data=[],this.expanded=!1,this.preserveStructureOnFilter=!1,this.indentationInText=!1,this.definition={},this._stringFilterFunction=(s,e)=>Object.values(e.data).some(t=>String(t).toLowerCase().includes(s.toLowerCase())),this._queryFilterFunction=(s,e)=>{let t=!1;const i=kh(s)??[];for(const n of i){if("queries"in n){t=!1;break}const{condition:r,value:o}=n;let{key:a}=n;if(a.startsWith("[")&&a.endsWith("]")){const l=a.replace("[","").replace("]","");a=l,t=Object.keys(e.data).filter(h=>h.includes(l)).map(h=>Zp(e.data[h],r,o)).some(h=>h)}else t=Zp(e.data[a],r,o);if(!t)break}return t}}set columns(s){const e=[];for(const t of s){const i=typeof t=="string"?{name:t,width:`minmax(${this.minColWidth}, 1fr)`}:t;e.push(i)}this._columns=e,this.computeMissingColumns(this.data),this.dispatchEvent(this._columnsChange)}get columns(){return this._columns}get _headerRowData(){const s={};for(const e of this.columns)if(typeof e=="string")s[e]=e;else{const{name:t}=e;s[t]=t}return s}get value(){return this.queryString?this._filteredData:this.data}set queryString(s){const e=s&&s.trim()!==""?s.trim():null;this._queryString=e,e?(kh(e)?(this.filterFunction=this._queryFilterFunction,this._filteredData=this.filter(e)):(this.filterFunction=this._stringFilterFunction,this._filteredData=this.filter(e)),this.preserveStructureOnFilter&&(this._expandedBeforeSearch===void 0&&(this._expandedBeforeSearch=this.expanded),this.expanded=!0)):(this.preserveStructureOnFilter&&this._expandedBeforeSearch!==void 0&&(this.expanded=this._expandedBeforeSearch,this._expandedBeforeSearch=void 0),this._filteredData=this.data)}get queryString(){return this._queryString}set data(s){this._data=s,this.computeMissingColumns(s)&&(this.columns=this._columns)}get data(){return this._data}computeMissingColumns(s){let e=!1;for(const t of s){const{children:i,data:n}=t;for(const r in n)this._columns.map(o=>typeof o=="string"?o:o.name).includes(r)||(this._columns.push({name:r,width:`minmax(${this.minColWidth}, 1fr)`}),e=!0);if(i){const r=this.computeMissingColumns(i);r&&!e&&(e=r)}}return e}generateText(s="comma",e=this.value,t="",i=!0){const n=this._textDelimiters[s];let r="";const o=this.columns.map(a=>a.name);if(i){this.indentationInText&&(r+=`Indentation${n}`);const a=`${o.join(n)}
`;r+=a}for(const[a,l]of e.entries()){const{data:h,children:d}=l,p=this.indentationInText?`${t}${a+1}${n}`:"",f=o.map(v=>h[v]??""),g=`${p}${f.join(n)}
`;r+=g,d&&(r+=this.generateText(s,l.children,`${t}${a+1}.`,!1))}return r}get csv(){return this.generateText("comma")}get tsv(){return this.generateText("tab")}computeRowDeclaration(s){const e={};for(const t in s){const i=this.definition[t];i?e[t]=i(s[t],s):e[t]=s[t]}return e}downloadData(s="BIM Table Data",e="json"){let t=null;if(e==="json"&&(t=new File([JSON.stringify(this.value,void 0,2)],`${s}.json`)),e==="csv"&&(t=new File([this.csv],`${s}.csv`)),e==="tsv"&&(t=new File([this.tsv],`${s}.tsv`)),!t)return;const i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=t.name,i.click(),URL.revokeObjectURL(i.href)}getRowIndentation(s,e=this.value,t=0){for(const i of e){if(i.data===s)return t;if(i.children){const n=this.getRowIndentation(s,i.children,t+1);if(n!==null)return n}}return null}getGroupIndentation(s,e=this.value,t=0){for(const i of e){if(i===s)return t;if(i.children){const n=this.getGroupIndentation(s,i.children,t+1);if(n!==null)return n}}return null}setIndentationColor(s,e){const t=new CustomEvent("indentation",{detail:{indentationLevel:s,color:e}});this.dispatchEvent(t)}filter(s,e=this.filterFunction??this._stringFilterFunction,t=this.data){const i=[];for(const n of t)if(e(s,n)){if(this.preserveStructureOnFilter){const r={data:n.data};if(n.children){const o=this.filter(s,e,n.children);o.length&&(r.children=o)}i.push(r)}else if(i.push({data:n.data}),n.children){const r=this.filter(s,e,n.children);i.push(...r)}}else if(n.children){const r=this.filter(s,e,n.children);this.preserveStructureOnFilter&&r.length?i.push({data:n.data,children:r}):i.push(...r)}return i}render(){const s=document.createElement("bim-table-row");s.table=this,s.isHeader=!0,s.data=this._headerRowData,s.style.gridArea="Header",s.style.position="sticky",s.style.top="0",s.style.zIndex="5";const e=document.createElement("bim-table-children");return e.table=this,e.data=this.value,e.style.gridArea="Body",e.style.backgroundColor="transparent",pe`
      <div class="parent">
        ${this.headersHidden?null:s}
        <div style="overflow-x: hidden; grid-area: Body">${e}</div>
      </div>
    `}};b0.styles=[Qn.scrollbar,Be`
      :host {
        --bim-button--bgc: transparent;
        position: relative;
        overflow: auto;
        display: block;
        pointer-events: auto;
      }

      .parent {
        display: grid;
        grid-template:
          "Header" auto
          "Body" 1fr
          "Footer" auto;
        overflow: auto;
        height: 100%;
      }

      .parent > bim-table-row[is-header] {
        color: var(--bim-table_header--c, var(--bim-ui_bg-contrast-100));
        background-color: var(
          --bim-table_header--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      .controls {
        display: flex;
        gap: 0.375rem;
        flex-wrap: wrap;
        margin-bottom: 0.5rem;
      }
    `];let un=b0;Jn([uo()],un.prototype,"_filteredData",2);Jn([te({type:Boolean,attribute:"headers-hidden",reflect:!0})],un.prototype,"headersHidden",2);Jn([te({type:String,attribute:"min-col-width",reflect:!0})],un.prototype,"minColWidth",2);Jn([te({type:Array,attribute:!1})],un.prototype,"columns",1);Jn([te({type:String,attribute:"search-string",reflect:!0})],un.prototype,"queryString",1);Jn([te({type:Array,attribute:!1})],un.prototype,"data",1);Jn([te({type:Boolean,reflect:!0})],un.prototype,"expanded",2);var pC=Object.defineProperty,fC=Object.getOwnPropertyDescriptor,Sl=(s,e,t,i)=>{for(var n=i>1?void 0:i?fC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&pC(e,t,n),n};const w0=class extends Ue{constructor(){super(...arguments),this._defaultName="__unnamed__",this.name=this._defaultName,this._hidden=!1}set hidden(s){this._hidden=s,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}connectedCallback(){super.connectedCallback();const{parentElement:s}=this;if(s&&this.name===this._defaultName){const e=[...s.children].indexOf(this);this.name=`${this._defaultName}${e}`}}render(){return pe` <slot></slot> `}};w0.styles=Be`
    :host {
      display: block;
      height: 100%;
    }

    :host([hidden]) {
      display: none;
    }
  `;let Ht=w0;Sl([te({type:String,reflect:!0})],Ht.prototype,"name",2);Sl([te({type:String,reflect:!0})],Ht.prototype,"label",2);Sl([te({type:String,reflect:!0})],Ht.prototype,"icon",2);Sl([te({type:Boolean,reflect:!0})],Ht.prototype,"hidden",1);var mC=Object.defineProperty,gC=Object.getOwnPropertyDescriptor,wo=(s,e,t,i)=>{for(var n=i>1?void 0:i?gC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&mC(e,t,n),n};const I0=class extends Ue{constructor(){super(...arguments),this._switchers=[],this.bottom=!1,this.switchersHidden=!1,this.floating=!1,this.onTabHiddenChange=s=>{const e=s.target;e instanceof Ht&&!e.hidden&&(e.removeEventListener("hiddenchange",this.onTabHiddenChange),this.tab=e.name,e.addEventListener("hiddenchange",this.onTabHiddenChange))}}set tab(s){this._tab=s;const e=[...this.children],t=e.find(i=>i instanceof Ht&&i.name===s);for(const i of e){if(!(i instanceof Ht))continue;i.hidden=t!==i;const n=this.getTabSwitcher(i.name);n&&n.toggleAttribute("data-active",!i.hidden)}}get tab(){return this._tab}getTabSwitcher(s){return this._switchers.find(e=>e.getAttribute("data-name")===s)}createSwitchers(){this._switchers=[];for(const s of this.children){if(!(s instanceof Ht))continue;const e=document.createElement("div");e.addEventListener("click",()=>{this.tab===s.name?this.toggleAttribute("tab",!1):this.tab=s.name}),e.setAttribute("data-name",s.name),e.className="switcher";const t=document.createElement("bim-label");t.label=s.label,t.icon=s.icon,e.append(t),this._switchers.push(e)}}onSlotChange(s){this.createSwitchers();const e=s.target.assignedElements(),t=e.find(i=>i instanceof Ht?this.tab?i.name===this.tab:!i.hidden:!1);t&&t instanceof Ht&&(this.tab=t.name);for(const i of e){if(!(i instanceof Ht)){i.remove();continue}i.removeEventListener("hiddenchange",this.onTabHiddenChange),t!==i&&(i.hidden=!0),i.addEventListener("hiddenchange",this.onTabHiddenChange)}}render(){return pe`
      <div class="parent">
        <div class="switchers">${this._switchers}</div>
        <div class="content">
          <slot @slotchange=${this.onSlotChange}></slot>
        </div>
      </div>
    `}};I0.styles=[Qn.scrollbar,Be`
      * {
        box-sizing: border-box;
      }

      :host {
        background-color: var(--bim-ui_bg-base);
        display: block;
        overflow: auto;
      }

      .parent {
        display: grid;
        grid-template: "switchers" auto "content" 1fr;
        height: 100%;
      }

      :host([bottom]) .parent {
        grid-template: "content" 1fr "switchers" auto;
      }

      .switchers {
        display: flex;
        height: 2.25rem;
        font-weight: 600;
        grid-area: switchers;
      }

      .switcher {
        cursor: pointer;
        pointer-events: auto;
        background-color: var(--bim-ui_bg-base);
        padding: 0rem 0.75rem;
        color: var(--bim-ui_bg-contrast-60);
      }

      .switcher:hover,
      .switcher[data-active] {
        --bim-label--c: var(--bim-ui_main-contrast);
        background-color: var(--bim-ui_color-main);
      }

      .switchers bim-label {
        pointer-events: none;
      }

      :host([switchers-hidden]) .switchers {
        display: none;
      }

      .content {
        grid-area: content;
        overflow: auto;
      }

      :host(:not([bottom])) .content {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([bottom]) .content {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host(:not([tab])) .content {
        display: none;
      }

      :host([floating]) {
        background-color: transparent;
      }

      :host([floating]) .switchers {
        justify-self: center;
        overflow: auto;
      }

      :host([floating]:not([bottom])) .switchers {
        border-radius: var(--bim-ui_size-2xs) var(--bim-ui_size-2xs) 0 0;
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]) .switchers {
        border-radius: 0 0 var(--bim-ui_size-2xs) var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]:not([tab])) .switchers {
        border-radius: var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]:not([tab])) .switchers {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]) .content {
        border: 1px solid var(--bim-ui_bg-contrast-20);
        border-radius: var(--bim-ui_size-2xs);
        background-color: var(--bim-ui_bg-base);
      }
    `];let Zs=I0;wo([uo()],Zs.prototype,"_switchers",2);wo([te({type:Boolean,reflect:!0})],Zs.prototype,"bottom",2);wo([te({type:Boolean,attribute:"switchers-hidden",reflect:!0})],Zs.prototype,"switchersHidden",2);wo([te({type:Boolean,reflect:!0})],Zs.prototype,"floating",2);wo([te({type:String,reflect:!0})],Zs.prototype,"tab",1);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const vC=s=>s??tt;var yC=Object.defineProperty,EC=Object.getOwnPropertyDescriptor,dn=(s,e,t,i)=>{for(var n=i>1?void 0:i?EC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&yC(e,t,n),n};const C0=class extends Ue{constructor(){super(...arguments),this._inputTypes=["date","datetime-local","email","month","password","search","tel","text","time","url","week"],this.value="",this.vertical=!1,this._type="text",this.onValueChange=new Event("input")}set type(s){this._inputTypes.includes(s)&&(this._type=s)}get type(){return this._type}get query(){return kh(this.value)}onInputChange(s){s.stopPropagation();const e=s.target;clearTimeout(this._debounceTimeoutID),this._debounceTimeoutID=setTimeout(()=>{this.value=e.value,this.dispatchEvent(this.onValueChange)},this.debounce)}render(){return pe`
      <bim-input
        .name=${this.name}
        .icon=${this.icon}
        .label=${this.label}
        .vertical=${this.vertical}
      >
        <input
          aria-label=${this.label||this.name||"Checkbox Input"}
          .type=${this.type}
          .value=${this.value}
          placeholder=${vC(this.placeholder)}
          @input=${this.onInputChange}
        />
      </bim-input>
    `}};C0.styles=Be`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      flex: 1;
      display: block;
    }

    input {
      background-color: transparent;
      outline: none;
      border: none;
      width: 100%;
      height: 100%;
      padding: 0 var(--bim-ui_size-3xs);
      border-radius: var(--bim-text-input--bdrs, var(--bim-ui_size-4xs));
      color: var(--bim-text-input--c, var(--bim-ui_bg-contrast-100));
    }

    :host(:focus) {
      --bim-input--olc: var(--bim-ui_color-accent);
    }

    /* :host([disabled]) {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
    } */
  `;let Ui=C0;dn([te({type:String,reflect:!0})],Ui.prototype,"icon",2);dn([te({type:String,reflect:!0})],Ui.prototype,"label",2);dn([te({type:String,reflect:!0})],Ui.prototype,"name",2);dn([te({type:String,reflect:!0})],Ui.prototype,"placeholder",2);dn([te({type:String,reflect:!0})],Ui.prototype,"value",2);dn([te({type:Boolean,reflect:!0})],Ui.prototype,"vertical",2);dn([te({type:Number,reflect:!0})],Ui.prototype,"debounce",2);dn([te({type:String,reflect:!0})],Ui.prototype,"type",1);var bC=Object.defineProperty,wC=Object.getOwnPropertyDescriptor,T0=(s,e,t,i)=>{for(var n=i>1?void 0:i?wC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&bC(e,t,n),n};const x0=class extends Ue{constructor(){super(...arguments),this.rows=2,this._vertical=!1}set vertical(s){this._vertical=s,this.updateChildren()}get vertical(){return this._vertical}updateChildren(){const s=this.children;for(const e of s)this.vertical?e.setAttribute("label-hidden",""):e.removeAttribute("label-hidden")}render(){return pe`
      <style>
        .parent {
          grid-auto-flow: ${this.vertical?"row":"column"};
          grid-template-rows: repeat(${this.rows}, 1fr);
        }
      </style>
      <div class="parent">
        <slot @slotchange=${this.updateChildren}></slot>
      </div>
    `}};x0.styles=Be`
    .parent {
      display: grid;
      gap: 0.25rem;
    }

    ::slotted(bim-button[label]:not([vertical])) {
      --bim-button--jc: flex-start;
    }
  `;let _l=x0;T0([te({type:Number,reflect:!0})],_l.prototype,"rows",2);T0([te({type:Boolean,reflect:!0})],_l.prototype,"vertical",1);var IC=Object.defineProperty,CC=Object.getOwnPropertyDescriptor,Rl=(s,e,t,i)=>{for(var n=i>1?void 0:i?CC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&IC(e,t,n),n};const A0=class extends Ue{constructor(){super(...arguments),this._vertical=!1,this._labelHidden=!1}set vertical(s){this._vertical=s,this.updateChildren()}get vertical(){return this._vertical}set labelHidden(s){this._labelHidden=s,this.updateChildren()}get labelHidden(){return this._labelHidden}updateChildren(){const s=this.children;for(const e of s)e instanceof _l&&(e.vertical=this.vertical),e.toggleAttribute("label-hidden",this.vertical)}render(){return pe`
      <div class="parent">
        <div class="children">
          <slot @slotchange=${this.updateChildren}></slot>
        </div>
        ${!this.labelHidden&&(this.label||this.icon)?pe`<bim-label
              .label=${this.label}
              .icon=${this.icon}
            ></bim-label>`:null}
      </div>
    `}};A0.styles=Be`
    :host {
      --bim-label--fz: var(--bim-ui_size-xs);
      --bim-label--c: var(--bim-ui_bg-contrast-60);
      display: block;
      flex: 1;
    }

    :host(:not([vertical])) ::slotted(bim-button[vertical]) {
      --bim-icon--fz: var(--bim-ui_size-5xl);
      min-height: 3.75rem;
    }

    .parent {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
      padding: 0.5rem;
    }

    :host([vertical]) .parent {
      flex-direction: row-reverse;
    }

    :host([vertical]) .parent > bim-label {
      writing-mode: tb;
    }

    .children {
      display: flex;
      gap: 0.25rem;
    }

    :host([vertical]) .children {
      flex-direction: column;
    }
  `;let qs=A0;Rl([te({type:String,reflect:!0})],qs.prototype,"label",2);Rl([te({type:String,reflect:!0})],qs.prototype,"icon",2);Rl([te({type:Boolean,reflect:!0})],qs.prototype,"vertical",1);Rl([te({type:Boolean,attribute:"label-hidden",reflect:!0})],qs.prototype,"labelHidden",1);const S0=class Me{static set config(e){this._config={...Me._config,...e}}static get config(){return Me._config}static addGlobalStyles(){let e=document.querySelector("style[id='bim-ui']");if(e)return;e=document.createElement("style"),e.id="bim-ui",e.textContent=Qn.globalStyles.cssText;const t=document.head.firstChild;t?document.head.insertBefore(e,t):document.head.append(e)}static defineCustomElement(e,t){customElements.get(e)||customElements.define(e,t)}static registerComponents(){Me.init()}static init(){Me.addGlobalStyles(),Me.defineCustomElement("bim-button",LI),Me.defineCustomElement("bim-checkbox",js),Me.defineCustomElement("bim-color-input",Kn),Me.defineCustomElement("bim-context-menu",i0),Me.defineCustomElement("bim-dropdown",Ni),Me.defineCustomElement("bim-grid",Cu),Me.defineCustomElement("bim-icon",KI),Me.defineCustomElement("bim-input",go),Me.defineCustomElement("bim-label",qn),Me.defineCustomElement("bim-number-input",kt),Me.defineCustomElement("bim-option",at),Me.defineCustomElement("bim-panel",vo),Me.defineCustomElement("bim-panel-section",Ks),Me.defineCustomElement("bim-selector",Qs),Me.defineCustomElement("bim-table",un),Me.defineCustomElement("bim-tabs",Zs),Me.defineCustomElement("bim-tab",Ht),Me.defineCustomElement("bim-table-cell",f0),Me.defineCustomElement("bim-table-children",g0),Me.defineCustomElement("bim-table-group",y0),Me.defineCustomElement("bim-table-row",bo),Me.defineCustomElement("bim-text-input",Ui),Me.defineCustomElement("bim-toolbar",Pl),Me.defineCustomElement("bim-toolbar-group",_l),Me.defineCustomElement("bim-toolbar-section",qs),Me.defineCustomElement("bim-viewport",P0)}static newRandomId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let i=0;i<10;i++){const n=Math.floor(Math.random()*e.length);t+=e.charAt(n)}return t}};S0._config={sectionLabelOnVerticalToolbar:!1};let zh=S0;var TC=Object.defineProperty,xC=Object.getOwnPropertyDescriptor,Tu=(s,e,t,i)=>{for(var n=i>1?void 0:i?xC(e,t):e,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=(i?o(e,t,n):o(n))||n);return i&&n&&TC(e,t,n),n};const _0=class extends Ue{constructor(){super(...arguments),this.labelsHidden=!1,this._vertical=!1,this._hidden=!1}set vertical(s){this._vertical=s,this.updateSections()}get vertical(){return this._vertical}set hidden(s){this._hidden=s,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}updateSections(){const s=this.children;for(const e of s)e instanceof qs&&(e.labelHidden=this.vertical&&!zh.config.sectionLabelOnVerticalToolbar,e.vertical=this.vertical)}render(){return pe`
      <div class="parent">
        <slot @slotchange=${this.updateSections}></slot>
      </div>
    `}};_0.styles=Be`
    :host {
      --bim-button--bgc: transparent;
      background-color: var(--bim-ui_bg-base);
      border-radius: var(--bim-ui_size-2xs);
      display: block;
    }

    :host([hidden]) {
      display: none;
    }

    .parent {
      display: flex;
      width: min-content;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    :host([vertical]) {
      width: min-content;
      border-radius: var(--bim-ui_size-2xs);
      border: 1px solid var(--bim-ui_bg-contrast-20);
    }

    ::slotted(bim-toolbar-section:not(:last-child)) {
      border-right: 1px solid var(--bim-ui_bg-contrast-20);
      border-bottom: none;
    }

    :host([vertical]) ::slotted(bim-toolbar-section:not(:last-child)) {
      border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      border-right: none;
    }
  `;let Pl=_0;Tu([te({type:String,reflect:!0})],Pl.prototype,"icon",2);Tu([te({type:Boolean,attribute:"labels-hidden",reflect:!0})],Pl.prototype,"labelsHidden",2);Tu([te({type:Boolean,reflect:!0})],Pl.prototype,"vertical",1);var AC=Object.defineProperty,SC=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&AC(e,t,n),n};const R0=class extends Ue{constructor(){super(),this._onResize=new Event("resize"),new ResizeObserver(()=>{setTimeout(()=>{this.dispatchEvent(this._onResize)})}).observe(this)}render(){return pe`
      <div class="parent">
        <slot></slot>
      </div>
    `}};R0.styles=Be`
    :host {
      display: grid;
      min-width: 0;
      min-height: 0;
      height: 100%;
    }

    .parent {
      overflow: hidden;
      position: relative;
    }
  `;let P0=R0;SC([te({type:String,reflect:!0})],P0.prototype,"name");const _C=s=>{const{components:e}=s,t=e.get(Iv);return pe`
    <bim-button
      data-ui-id="import-ifc"
      label="Load IFC"
      icon="mage:box-3d-fill"
      @click=${()=>{const i=document.createElement("input");i.type="file",i.accept=".ifc",i.onchange=async()=>{if(i.files===null||i.files.length===0)return;const n=i.files[0];i.remove();const r=await n.arrayBuffer(),o=new Uint8Array(r),a=await t.load(o);a.name=n.name.replace(".ifc","")},i.click()}}
    ></bim-button>
  `},RC=s=>Zn.create(_C,s),PC=Object.freeze(Object.defineProperty({__proto__:null,loadIfc:RC},Symbol.toStringTag,{value:"Module"}));({...PC});const FC=s=>{const{components:e}=s,t=e.get(zs),i=document.createElement("bim-table");i.columns=["Model"],i.headersHidden=!0;const n=[];for(const[,r]of t.groups){if(!r)continue;const o={data:{Model:r.name||r.uuid,Actions:r.uuid}};n.push(o)}return i.definition={Actions:r=>{if(typeof r!="string")return r;const o=t.groups.get(r);return o?pe`
        <bim-button @click=${a=>{o.visible=!o.visible;const l=a.target;l.icon=o.visible?"mdi:eye":"mdi:eye-off"}} icon="mdi:eye"></bim-button>
        <bim-button @click=${()=>t.disposeGroup(o)} icon="mdi:delete"></bim-button>
      `:r}},i.columns=["Model",{name:"Actions",width:"auto"}],i.data=n,pe`
    <div>
      ${n.length===0?pe`<bim-label label="No models has been loaded yet"></bim-label>`:i}
    </div>
  `},OC=(s,e=!0)=>{const t=Zn.create(FC,s);if(e){const{components:i}=s,n=i.get(zs),[,r]=t;n.onFragmentsLoaded.add(()=>setTimeout(()=>r())),n.onFragmentsDisposed.add(()=>r())}return t},MC=Object.freeze(Object.defineProperty({__proto__:null,modelsList:OC},Symbol.toStringTag,{value:"Module"})),F0=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",s=>s.includes("Value"),s=>s.startsWith("Material"),s=>s.startsWith("Relating"),s=>{const e=["IsGroupedBy","IsDecomposedBy"];return s.startsWith("Is")&&!e.includes(s)}];async function ka(s,e,t,i=F0,n=!1){const r=s.get(to),o=await e.getProperties(t);if(!o)return{data:{Entity:`${t} properties not found...`}};const a=r.relationMaps[e.uuid],l={data:{}};for(const h in o){const d=i.map(f=>typeof f=="string"?h===f:f(h)).includes(!0);if(!(h==="type"||d))continue;const p=o[h];if(p)if(p.type===5){l.children||(l.children=[]);const f=await ka(s,e,p.value,i,n);l.children.push(f)}else if(typeof p=="object"&&!Array.isArray(p)){const{value:f,type:g}=p;if(n)g===1||g===2||g===3||(l.data[h]=f);else{const v=typeof f=="number"?Number(f.toFixed(3)):f;l.data[h]=v}}else if(Array.isArray(p))for(const f of p){if(f.type!==5)continue;l.children||(l.children=[]);const g=await ka(s,e,f.value,i,n);l.children.push(g)}else if(h==="type"){const f=Hh[p];l.data.Entity=f}else l.data[h]=p}if(a&&a.get(o.expressID)){const h=a.get(o.expressID);for(const d of i){const p=[];if(typeof d=="string"){const f=r._inverseAttributes.indexOf(d);f!==-1&&p.push(f)}else{const f=r._inverseAttributes.filter(g=>d(g));for(const g of f){const v=r._inverseAttributes.indexOf(g);p.push(v)}}for(const f of p){const g=h.get(f);if(g)for(const v of g){const b=await ka(s,e,v,i,n);l.children||(l.children=[]),l.children.push(b)}}}}return l}const LC=s=>{const{components:e,fragmentIdMap:t,attributesToInclude:i,editable:n,tableDefinition:r}=s,o=e.get(zs);let a;return typeof i=="function"?a=i(F0):a=i,pe`<bim-table ${Ut(async l=>{if(!l)return;const h=l,d=[],p=[];for(const f in t){const g=o.list.get(f);if(!(g&&g.group))continue;const v=g.group,b=p.find(w=>w.model===v);if(b)for(const w of t[f])b.expressIDs.add(w);else{const w={model:v,expressIDs:new Set(t[f])};p.push(w)}}for(const f of p){const{model:g,expressIDs:v}=f;for(const b of v){const w=await ka(e,g,b,a,n);d.push(w)}}h.definition=r,h.data=d,h.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},DC=s=>Zn.create(LC,s),NC=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:DC},Symbol.toStringTag,{value:"Module"}));function UC(s){const e=Object.keys(s).pop();return e&&s[e].length>0?s[e][0]:""}function O0(s){return s.map(e=>{const t={data:{System:UC(e.filter)}};return e.children&&e.children.length>0&&(t.children=O0(e.children)),t})}const kC=s=>{const{components:e,classifications:t}=s,i=e.get(Cv),n=r=>{if(!r)return;const o=r;o.definition={Actions:h=>h};const a=(h,d={})=>{const p=i.list,f=h[0],g=p[f],v=[];if(!f||!g)return v;for(const b in g){const w={...d,[f]:[b]},T=i.find(w);if(Object.keys(T).length>0){const S={filter:w};S.children=a(h.slice(1),w),v.push(S)}}return v},l=[];for(const h in t){const d=t[h],p=a(d),f=O0(p);l.push({data:{System:h},children:f})}o.data=l};return pe`
  <div>
    ${Object.keys(t).length===0?pe`<bim-label label="No classifications to show"></bim-label>`:pe`<bim-table ${Ut(n)} headers-hidden expanded></bim-table>`}
  </div>
  `},BC=(s,e=!0)=>{const t=Zn.create(kC,s);if(e){const{components:i}=s,n=i.get(zs),[,r]=t;n.onFragmentsDisposed.add(()=>r())}return t},zC=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:BC},Symbol.toStringTag,{value:"Module"})),VC=["OwnerHistory","ObjectPlacement","CompositionType"],Jp=async(s,e,t)=>{const i={groupName:"Attributes",includeClass:!1,...t},{groupName:n,includeClass:r}=i,o=await s.getProperties(e)??{},a={data:{Name:n}};r&&(a.children||(a.children=[]),a.children.push({data:{Name:"Class",Value:Hh[o.type]}}));for(const l in o){if(VC.includes(l))continue;const h=o[l];if(h&&typeof h=="object"&&!Array.isArray(h)){if(h.type===$v)continue;const d={data:{Name:l,Value:h.value}};a.children||(a.children=[]),a.children.push(d)}}return a},HC=async(s,e)=>{const t={data:{Name:"Property Sets"}};for(const i of e){const n=await s.getProperties(i);if(!n)continue;const r={data:{Name:n.Name.value}};if(n.type===zr){for(const o of n.HasProperties){const{value:a}=o,l=await s.getProperties(a);if(!l)continue;const h=Object.keys(l).find(p=>p.includes("Value"));if(!(h&&l[h]))continue;const d={data:{Name:l.Name.value,Value:l[h].value}};r.children||(r.children=[]),r.children.push(d)}r.children&&(t.children||(t.children=[]),t.children.push(r))}}return t},YC=async(s,e)=>{const t={data:{Name:"Quantity Sets"}};for(const i of e){const n=await s.getProperties(i);if(!n)continue;const r={data:{Name:n.Name.value}};if(n.type===qh){for(const o of n.Quantities){const{value:a}=o,l=await s.getProperties(a);if(!l)continue;const h=Object.keys(l).find(p=>p.includes("Value"));if(!(h&&l[h]))continue;const d={data:{Name:l.Name.value,Value:l[h].value}};r.children||(r.children=[]),r.children.push(d)}r.children&&(t.children||(t.children=[]),t.children.push(r))}}return t},GC=async(s,e)=>{const t={data:{Name:"Materials"}};for(const i of e){const n=await s.getProperties(i);if(n.type===Sf){const r=n.ForLayerSet.value,o=await s.getProperties(r);for(const a of o.MaterialLayers){const{value:l}=a,h=await s.getProperties(l),d=await s.getProperties(h.Material.value),p={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:h.LayerThickness.value}},{data:{Name:"Material",Value:d.Name.value}}]};t.children||(t.children=[]),t.children.push(p)}}if(n.type===Rf)for(const r of n.Materials){const{value:o}=r,a={data:{Name:"Name",Value:(await s.getProperties(o)).Name.value}};t.children||(t.children=[]),t.children.push(a)}if(n.type===_f){const r={data:{Name:"Name",Value:(await s.getProperties(i)).Name.value}};t.children||(t.children=[]),t.children.push(r)}}return t},jC=async(s,e)=>{const t={data:{Name:"Classifications"}};for(const i of e){const n=await s.getProperties(i);if(n.type===Pf){const{value:r}=n.ReferencedSource,o={data:{Name:(await s.getProperties(r)).Name.value},children:[{data:{Name:"Identification",Value:n.Identification.value}},{data:{Name:"Name",Value:n.Name.value}}]};t.children||(t.children=[]),t.children.push(o)}}return t},WC=s=>{const{components:e,fragmentIdMap:t}=s,i=e.get(to),n=e.get(zs);return pe`<bim-table ${Ut(async r=>{var o;if(!r)return;const a=[],l=[];for(const d in t){const p=n.list.get(d);if(!(p&&p.group))continue;const f=p.group,g=l.find(v=>v.model===f);if(g)for(const v of t[d])g.expressIDs.add(v);else{const v={model:f,expressIDs:new Set(t[d])};l.push(v)}}for(const d in l){const{model:p,expressIDs:f}=l[d],g=i.relationMaps[p.uuid];if(!g)return;for(const v of f){const b=await p.getProperties(v);if(!b)continue;const w={data:{Name:(o=b.Name)==null?void 0:o.value,Value:""}};a.push(w);const T=await Jp(p,v,{includeClass:!0});if(w.children||(w.children=[]),w.children.push(T),!g.get(v))continue;const S=i.getEntityRelations(p,v,"IsDefinedBy");if(S){const P=S.filter(async W=>{const j=await p.getProperties(W);return j?j.type===zr:!1}),M=await HC(p,P);M.children&&w.children.push(M);const k=S.filter(async W=>{const j=await p.getProperties(W);return j?j.type===qh:!1}),V=await YC(p,k);V.children&&w.children.push(V)}const _=i.getEntityRelations(p,v,"HasAssociations");if(_){const P=_.filter(async W=>{const j=await p.getProperties(W);return j?j.type===Sf||j.type===qv||j.type===Jv||j.type===_f||j.type===Rf:!1}),M=await GC(p,P);M.children&&w.children.push(M);const k=_.filter(async W=>{const j=await p.getProperties(W);return j?j.type===Pf:!1}),V=await jC(p,k);V.children&&w.children.push(V)}const I=i.getEntityRelations(p,v,"ContainedInStructure");if(I){const P=I[0],M=await Jp(p,P,{groupName:"SpatialContainer"});w.children.push(M)}}}const h=r;h.columns=[{name:"Name",width:"12rem"}],h.data=a})} headers-hidden></bim-table>`},XC=s=>Zn.create(WC,s),KC=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:XC},Symbol.toStringTag,{value:"Module"})),Vh=async(s,e,t,i)=>{var n;const r=[],o=s.get(to),a=await e.getProperties(t);if(!a)return r;const{type:l}=a,h={data:{Entity:Hh[l],Name:(n=a.Name)==null?void 0:n.value}};for(const d of i){const p=o.getEntityRelations(e,t,d);if(p)for(const f of p){const g=await Vh(s,e,f,i);h.children||(h.children=[]),h.children.push(...g)}}return r.push(h),r},QC=s=>{const{components:e,models:t,inverseAttributes:i,expressID:n}=s,r=i??["IsDecomposedBy","ContainsElements"];return pe`<bim-table ${Ut(async o=>{if(!o)return;const a=e.get(to),l=[];for(const d of t){let p;if(n)p={data:{Entity:d.name!==""?d.name:d.uuid},children:await Vh(e,d,n,r)};else{const f=a.relationMaps[d.uuid],g=await d.getAllPropertiesOfType(pl);if(!(f&&g))continue;const{expressID:v}=Object.values(g)[0];p={data:{Entity:d.name!==""?d.name:d.uuid},children:await Vh(e,d,v,r)}}l.push(p)}const h=o;h.columns=["Entity","Name"],h.data=l})} headers-hidden></bim-table>`},ZC=(s,e=!0)=>{const t=Zn.create(QC,s);if(e){const[,i]=t,{components:n}=s,r=n.get(zs),o=n.get(to),a=()=>i({models:r.groups.values()});o.onRelationsIndexed.add(a),r.onFragmentsDisposed.add(a)}return t},qC=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:ZC},Symbol.toStringTag,{value:"Module"}));({...MC,...NC,...zC,...KC,...qC});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ba=globalThis,xu=Ba.ShadowRoot&&(Ba.ShadyCSS===void 0||Ba.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Au=Symbol(),$p=new WeakMap;let M0=class{constructor(s,e,t){if(this._$cssResult$=!0,t!==Au)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=s,this.t=e}get styleSheet(){let s=this.o;const e=this.t;if(xu&&s===void 0){const t=e!==void 0&&e.length===1;t&&(s=$p.get(e)),s===void 0&&((this.o=s=new CSSStyleSheet).replaceSync(this.cssText),t&&$p.set(e,s))}return s}toString(){return this.cssText}};const JC=s=>new M0(typeof s=="string"?s:s+"",void 0,Au),L0=(s,...e)=>{const t=s.length===1?s[0]:e.reduce((i,n,r)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+s[r+1],s[0]);return new M0(t,s,Au)},$C=(s,e)=>{if(xu)s.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),n=Ba.litNonce;n!==void 0&&i.setAttribute("nonce",n),i.textContent=t.cssText,s.appendChild(i)}},ef=xu?s=>s:s=>s instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return JC(t)})(s):s;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:eT,defineProperty:tT,getOwnPropertyDescriptor:iT,getOwnPropertyNames:nT,getOwnPropertySymbols:sT,getPrototypeOf:rT}=Object,Us=globalThis,tf=Us.trustedTypes,oT=tf?tf.emptyScript:"",nf=Us.reactiveElementPolyfillSupport,Br=(s,e)=>s,sl={toAttribute(s,e){switch(e){case Boolean:s=s?oT:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,e){let t=s;switch(e){case Boolean:t=s!==null;break;case Number:t=s===null?null:Number(s);break;case Object:case Array:try{t=JSON.parse(s)}catch{t=null}}return t}},Su=(s,e)=>!eT(s,e),sf={attribute:!0,type:String,converter:sl,reflect:!1,hasChanged:Su};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Us.litPropertyMetadata??(Us.litPropertyMetadata=new WeakMap);class Ts extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=sf){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(e,i,t);n!==void 0&&tT(this.prototype,e,n)}}static getPropertyDescriptor(e,t,i){const{get:n,set:r}=iT(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get(){return n==null?void 0:n.call(this)},set(o){const a=n==null?void 0:n.call(this);r.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??sf}static _$Ei(){if(this.hasOwnProperty(Br("elementProperties")))return;const e=rT(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Br("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Br("properties"))){const t=this.properties,i=[...nT(t),...sT(t)];for(const n of i)this.createProperty(n,t[n])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,n]of t)this.elementProperties.set(i,n)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const n=this._$Eu(t,i);n!==void 0&&this._$Eh.set(n,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const n of i)t.unshift(ef(n))}else e!==void 0&&t.push(ef(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return $C(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostConnected)==null?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostDisconnected)==null?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EC(e,t){var i;const n=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,n);if(r!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:sl).toAttribute(t,n.type);this._$Em=e,o==null?this.removeAttribute(r):this.setAttribute(r,o),this._$Em=null}}_$AK(e,t){var i;const n=this.constructor,r=n._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const o=n.getPropertyOptions(r),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)==null?void 0:i.fromAttribute)!==void 0?o.converter:sl;this._$Em=r,this[r]=a.fromAttribute(t,o.type),this._$Em=null}}requestUpdate(e,t,i){if(e!==void 0){if(i??(i=this.constructor.getPropertyOptions(e)),!(i.hasChanged??Su)(this[e],t))return;this.P(e,t,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,i){this._$AL.has(e)||this._$AL.set(e,t),i.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[r,o]of this._$Ep)this[r]=o;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[r,o]of n)o.wrapped!==!0||this._$AL.has(r)||this[r]===void 0||this.P(r,this[r],o)}let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostUpdate)==null?void 0:r.call(n)}),this.update(i)):this._$EU()}catch(n){throw t=!1,this._$EU(),n}t&&this._$AE(i)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(i=>{var n;return(n=i.hostUpdated)==null?void 0:n.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}}Ts.elementStyles=[],Ts.shadowRootOptions={mode:"open"},Ts[Br("elementProperties")]=new Map,Ts[Br("finalized")]=new Map,nf==null||nf({ReactiveElement:Ts}),(Us.reactiveElementVersions??(Us.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rl=globalThis,ol=rl.trustedTypes,rf=ol?ol.createPolicy("lit-html",{createHTML:s=>s}):void 0,D0="$lit$",qi=`lit$${Math.random().toFixed(9).slice(2)}$`,N0="?"+qi,aT=`<${N0}>`,Yn=document,Jr=()=>Yn.createComment(""),$r=s=>s===null||typeof s!="object"&&typeof s!="function",U0=Array.isArray,lT=s=>U0(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",Xc=`[ 	
\f\r]`,Pr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,of=/-->/g,af=/>/g,Rn=RegExp(`>|${Xc}(?:([^\\s"'>=/]+)(${Xc}*=${Xc}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),lf=/'/g,cf=/"/g,k0=/^(?:script|style|textarea|title)$/i,cT=s=>(e,...t)=>({_$litType$:s,strings:e,values:t}),B0=cT(1),ks=Symbol.for("lit-noChange"),dt=Symbol.for("lit-nothing"),hf=new WeakMap,Ln=Yn.createTreeWalker(Yn,129);function z0(s,e){if(!Array.isArray(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return rf!==void 0?rf.createHTML(e):e}const hT=(s,e)=>{const t=s.length-1,i=[];let n,r=e===2?"<svg>":"",o=Pr;for(let a=0;a<t;a++){const l=s[a];let h,d,p=-1,f=0;for(;f<l.length&&(o.lastIndex=f,d=o.exec(l),d!==null);)f=o.lastIndex,o===Pr?d[1]==="!--"?o=of:d[1]!==void 0?o=af:d[2]!==void 0?(k0.test(d[2])&&(n=RegExp("</"+d[2],"g")),o=Rn):d[3]!==void 0&&(o=Rn):o===Rn?d[0]===">"?(o=n??Pr,p=-1):d[1]===void 0?p=-2:(p=o.lastIndex-d[2].length,h=d[1],o=d[3]===void 0?Rn:d[3]==='"'?cf:lf):o===cf||o===lf?o=Rn:o===of||o===af?o=Pr:(o=Rn,n=void 0);const g=o===Rn&&s[a+1].startsWith("/>")?" ":"";r+=o===Pr?l+aT:p>=0?(i.push(h),l.slice(0,p)+D0+l.slice(p)+qi+g):l+qi+(p===-2?a:g)}return[z0(s,r+(s[t]||"<?>")+(e===2?"</svg>":"")),i]};class eo{constructor({strings:e,_$litType$:t},i){let n;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[h,d]=hT(e,t);if(this.el=eo.createElement(h,i),Ln.currentNode=this.el.content,t===2){const p=this.el.content.firstChild;p.replaceWith(...p.childNodes)}for(;(n=Ln.nextNode())!==null&&l.length<a;){if(n.nodeType===1){if(n.hasAttributes())for(const p of n.getAttributeNames())if(p.endsWith(D0)){const f=d[o++],g=n.getAttribute(p).split(qi),v=/([.?@])?(.*)/.exec(f);l.push({type:1,index:r,name:v[2],strings:g,ctor:v[1]==="."?dT:v[1]==="?"?pT:v[1]==="@"?fT:Fl}),n.removeAttribute(p)}else p.startsWith(qi)&&(l.push({type:6,index:r}),n.removeAttribute(p));if(k0.test(n.tagName)){const p=n.textContent.split(qi),f=p.length-1;if(f>0){n.textContent=ol?ol.emptyScript:"";for(let g=0;g<f;g++)n.append(p[g],Jr()),Ln.nextNode(),l.push({type:2,index:++r});n.append(p[f],Jr())}}}else if(n.nodeType===8)if(n.data===N0)l.push({type:2,index:r});else{let p=-1;for(;(p=n.data.indexOf(qi,p+1))!==-1;)l.push({type:7,index:r}),p+=qi.length-1}r++}}static createElement(e,t){const i=Yn.createElement("template");return i.innerHTML=e,i}}function Bs(s,e,t=s,i){var n,r;if(e===ks)return e;let o=i!==void 0?(n=t._$Co)==null?void 0:n[i]:t._$Cl;const a=$r(e)?void 0:e._$litDirective$;return(o==null?void 0:o.constructor)!==a&&((r=o==null?void 0:o._$AO)==null||r.call(o,!1),a===void 0?o=void 0:(o=new a(s),o._$AT(s,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=o:t._$Cl=o),o!==void 0&&(e=Bs(s,o._$AS(s,e.values),o,i)),e}class uT{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,n=((e==null?void 0:e.creationScope)??Yn).importNode(t,!0);Ln.currentNode=n;let r=Ln.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let h;l.type===2?h=new Io(r,r.nextSibling,this,e):l.type===1?h=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(h=new mT(r,this,e)),this._$AV.push(h),l=i[++a]}o!==(l==null?void 0:l.index)&&(r=Ln.nextNode(),o++)}return Ln.currentNode=Yn,n}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class Io{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,n){this.type=2,this._$AH=dt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=n,this._$Cv=(n==null?void 0:n.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Bs(this,e,t),$r(e)?e===dt||e==null||e===""?(this._$AH!==dt&&this._$AR(),this._$AH=dt):e!==this._$AH&&e!==ks&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):lT(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==dt&&$r(this._$AH)?this._$AA.nextSibling.data=e:this.T(Yn.createTextNode(e)),this._$AH=e}$(e){var t;const{values:i,_$litType$:n}=e,r=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=eo.createElement(z0(n.h,n.h[0]),this.options)),n);if(((t=this._$AH)==null?void 0:t._$AD)===r)this._$AH.p(i);else{const o=new uT(r,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(e){let t=hf.get(e.strings);return t===void 0&&hf.set(e.strings,t=new eo(e)),t}k(e){U0(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,n=0;for(const r of e)n===t.length?t.push(i=new Io(this.S(Jr()),this.S(Jr()),this,this.options)):i=t[n],i._$AI(r),n++;n<t.length&&(this._$AR(i&&i._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Fl{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,n,r){this.type=1,this._$AH=dt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=r,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=dt}_$AI(e,t=this,i,n){const r=this.strings;let o=!1;if(r===void 0)e=Bs(this,e,t,0),o=!$r(e)||e!==this._$AH&&e!==ks,o&&(this._$AH=e);else{const a=e;let l,h;for(e=r[0],l=0;l<r.length-1;l++)h=Bs(this,a[i+l],t,l),h===ks&&(h=this._$AH[l]),o||(o=!$r(h)||h!==this._$AH[l]),h===dt?e=dt:e!==dt&&(e+=(h??"")+r[l+1]),this._$AH[l]=h}o&&!n&&this.j(e)}j(e){e===dt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class dT extends Fl{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===dt?void 0:e}}class pT extends Fl{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==dt)}}class fT extends Fl{constructor(e,t,i,n,r){super(e,t,i,n,r),this.type=5}_$AI(e,t=this){if((e=Bs(this,e,t,0)??dt)===ks)return;const i=this._$AH,n=e===dt&&i!==dt||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==dt&&(i===dt||n);n&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class mT{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Bs(this,e)}}const uf=rl.litHtmlPolyfillSupport;uf==null||uf(eo,Io),(rl.litHtmlVersions??(rl.litHtmlVersions=[])).push("3.1.3");const gT=(s,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let n=i._$litPart$;if(n===void 0){const r=(t==null?void 0:t.renderBefore)??null;i._$litPart$=n=new Io(e.insertBefore(Jr(),r),r,void 0,t??{})}return n._$AI(s),n};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Rs extends Ts{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e;const t=super.createRenderRoot();return(e=this.renderOptions).renderBefore??(e.renderBefore=t.firstChild),t}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=gT(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return ks}}var df;Rs._$litElement$=!0,Rs.finalized=!0,(df=globalThis.litElementHydrateSupport)==null||df.call(globalThis,{LitElement:Rs});const pf=globalThis.litElementPolyfillSupport;pf==null||pf({LitElement:Rs});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.5");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const vT={attribute:!0,type:String,converter:sl,reflect:!1,hasChanged:Su},yT=(s=vT,e,t)=>{const{kind:i,metadata:n}=t;let r=globalThis.litPropertyMetadata.get(n);if(r===void 0&&globalThis.litPropertyMetadata.set(n,r=new Map),r.set(t.name,s),i==="accessor"){const{name:o}=t;return{set(a){const l=e.get.call(this);e.set.call(this,a),this.requestUpdate(o,l,s)},init(a){return a!==void 0&&this.P(o,void 0,s),a}}}if(i==="setter"){const{name:o}=t;return function(a){const l=this[o];e.call(this,a),this.requestUpdate(o,l,s)}}throw Error("Unsupported decorator location: "+i)};function oi(s){return(e,t)=>typeof t=="object"?yT(s,e,t):((i,n,r)=>{const o=n.hasOwnProperty(r);return n.constructor.createProperty(r,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(n,r):void 0})(s,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ET(s){return oi({...s,state:!0,attribute:!1})}class bT extends kn{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Ve(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}new F;new Ee;new Ee;new F;new F;class wT{constructor(e,t){this._group=new Fs,this._frustum=new Zv,this._frustumMat=new Ee,this._regenerateDelay=200,this._regenerateCounter=0,this.material=new Di({color:"#2e3338"}),this.numbers=new Fs,this.maxRegenerateRetrys=4,this.gridsFactor=5,this._scaleX=1,this._scaleY=1,this._camera=e,this._container=t;const i=this.newGrid(-1),n=this.newGrid(-2);this.grids={main:i,secondary:n},this._group.add(n,i,this.numbers)}set scaleX(e){this._scaleX=e,this.regenerate()}get scaleX(){return this._scaleX}set scaleY(e){this._scaleY=e,this.regenerate()}get scaleY(){return this._scaleY}get(){return this._group}dispose(){const{main:e,secondary:t}=this.grids;e.removeFromParent(),t.removeFromParent(),e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()}regenerate(){if(!this.isGridReady()){if(this._regenerateCounter++,this._regenerateCounter>this.maxRegenerateRetrys)throw new Error("Grid could not be regenerated");setTimeout(()=>this.regenerate,this._regenerateDelay);return}this._regenerateCounter=0,this._camera.updateMatrix(),this._camera.updateMatrixWorld();const e=this._frustumMat.multiplyMatrices(this._camera.projectionMatrix,this._camera.matrixWorldInverse);this._frustum.setFromProjectionMatrix(e);const{planes:t}=this._frustum,i=t[0].constant*-t[0].normal.x,n=t[1].constant*-t[1].normal.x,r=t[2].constant*-t[2].normal.y,o=t[3].constant*-t[3].normal.y,a=Math.abs(i-n),l=Math.abs(o-r),{clientWidth:h,clientHeight:d}=this._container,p=Math.max(h,d),f=Math.max(a,l)/p,g=Math.ceil(Math.log10(a/this.scaleX)),v=Math.ceil(Math.log10(l/this.scaleY)),b=10**(g-2)*this.scaleX,w=10**(v-2)*this.scaleY,T=b*this.gridsFactor,S=w*this.gridsFactor,_=Math.ceil(l/S),I=Math.ceil(a/T),P=Math.ceil(l/w),M=Math.ceil(a/b),k=b*Math.ceil(n/b),V=w*Math.ceil(r/w),W=T*Math.ceil(n/T),j=S*Math.ceil(r/S),Q=[...this.numbers.children];for(const je of Q)je.removeFromParent();this.numbers.children=[];const $=[],ne=9*f,oe=1e4,ve=Math.round(Math.abs(W/this.scaleX)*oe)/oe,re=(I-1)*T,ge=Math.round(Math.abs((W+re)/this.scaleX)*oe)/oe,me=Math.max(ve,ge).toString().length*ne;let we=Math.ceil(me/T)*T;for(let je=0;je<I;je++){let ke=W+je*T;$.push(ke,o,0,ke,r,0);const It=ke/this.scaleX;ke=Math.round(ke*oe)/oe,we=Math.round(we*oe)/oe;const He=ke%we;if(!(T<1||S<1)&&Math.abs(He)>.01)continue;const fe=this.newNumber(It),We=12*f;fe.position.set(ke,r+We,0)}for(let je=0;je<_;je++){const ke=j+je*S;$.push(n,ke,0,i,ke,0);const It=this.newNumber(ke/this.scaleY);let He=12;It.element.textContent&&(He+=4*It.element.textContent.length);const fe=He*f;It.position.set(n+fe,ke,0)}const Ge=[];for(let je=0;je<M;je++){const ke=k+je*b;Ge.push(ke,o,0,ke,r,0)}for(let je=0;je<P;je++){const ke=V+je*w;Ge.push(n,ke,0,i,ke,0)}const Pt=new gt(new Float32Array($),3),Bi=new gt(new Float32Array(Ge),3),{main:At,secondary:fn}=this.grids;At.geometry.setAttribute("position",Pt),fn.geometry.setAttribute("position",Bi)}newNumber(e){const t=document.createElement("bim-label");t.label=String(Math.round(e*100)/100);const i=new bT(t);return this.numbers.add(i),i}newGrid(e){const t=new Ne,i=new xf(t,this.material);return i.frustumCulled=!1,i.renderOrder=e,i}isGridReady(){const e=this._camera.projectionMatrix.elements;for(let t=0;t<e.length;t++){const i=e[t];if(Number.isNaN(i))return!1}return!0}}var IT=Object.defineProperty,CT=Object.getOwnPropertyDescriptor,_u=(s,e,t,i)=>{for(var n=CT(e,t),r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&IT(e,t,n),n};const V0=class extends Rs{constructor(){super(...arguments),this._grid=null,this._world=null,this.resize=()=>{this._world&&this._grid&&this._grid.regenerate()}}set gridColor(e){if(this._gridColor=e,!(e&&this._grid))return;const t=Number(e.replace("#","0x"));Number.isNaN(t)||this._grid.material.color.setHex(t)}get gridColor(){return this._gridColor}set gridScaleX(e){this._gridScaleX=e,e&&this._grid&&(this._grid.scaleX=e)}get gridScaleX(){return this._gridScaleX}set gridScaleY(e){this._gridScaleY=e,e&&this._grid&&(this._grid.scaleY=e)}get gridScaleY(){return this._gridScaleY}set components(e){this.dispose();const t=e.get(Ev).create();this._world=t,t.scene=new bv(e),t.scene.setup(),t.renderer=new Am(e,this);const i=new wv(e);t.camera=i;const n=new wT(i.threeOrtho,this);this._grid=n,t.scene.three.add(n.get()),i.controls.addEventListener("update",()=>n.regenerate()),setTimeout(async()=>{t.camera.updateAspect(),i.set("Plan"),await i.controls.setLookAt(0,0,100,0,0,0),await i.projection.set("Orthographic"),i.controls.dollySpeed=3,i.controls.draggingSmoothTime=.085,i.controls.maxZoom=1e3,i.controls.zoom(4)})}get world(){return this._world}dispose(){var e;(e=this.world)==null||e.dispose(),this._world=null,this._grid=null}connectedCallback(){super.connectedCallback(),new ResizeObserver(this.resize).observe(this)}disconnectedCallback(){super.disconnectedCallback(),this.dispose()}render(){return B0`<slot></slot>`}};V0.styles=L0`
    :host {
      position: relative;
      display: flex;
      min-width: 0px;
      height: 100%;
      background-color: var(--bim-ui_bg-base);
    }
  `;let Ol=V0;_u([oi({type:String,attribute:"grid-color",reflect:!0})],Ol.prototype,"gridColor");_u([oi({type:Number,attribute:"grid-scale-x",reflect:!0})],Ol.prototype,"gridScaleX");_u([oi({type:Number,attribute:"grid-scale-y",reflect:!0})],Ol.prototype,"gridScaleY");var TT=Object.defineProperty,pn=(s,e,t,i)=>{for(var n=void 0,r=s.length-1,o;r>=0;r--)(o=s[r])&&(n=o(e,t,n)||n);return n&&TT(e,t,n),n};const H0=class extends Rs{constructor(){super(...arguments),this._defaults={size:60},this._cssMatrix3D="",this._matrix=new Ee,this._onRightClick=new Event("rightclick"),this._onLeftClick=new Event("leftclick"),this._onTopClick=new Event("topclick"),this._onBottomClick=new Event("bottomclick"),this._onFrontClick=new Event("frontclick"),this._onBackClick=new Event("backclick"),this._camera=null,this._epsilon=e=>Math.abs(e)<1e-10?0:e}set camera(e){this._camera=e,this.updateOrientation()}get camera(){return this._camera}updateOrientation(){if(!this.camera)return;this._matrix.extractRotation(this.camera.matrixWorldInverse);const{elements:e}=this._matrix;this._cssMatrix3D=`matrix3d(
      ${this._epsilon(e[0])},
      ${this._epsilon(-e[1])},
      ${this._epsilon(e[2])},
      ${this._epsilon(e[3])},
      ${this._epsilon(e[4])},
      ${this._epsilon(-e[5])},
      ${this._epsilon(e[6])},
      ${this._epsilon(e[7])},
      ${this._epsilon(e[8])},
      ${this._epsilon(-e[9])},
      ${this._epsilon(e[10])},
      ${this._epsilon(e[11])},
      ${this._epsilon(e[12])},
      ${this._epsilon(-e[13])},
      ${this._epsilon(e[14])},
      ${this._epsilon(e[15])})
    `}render(){const e=this.size??this._defaults.size;return B0`
      <style>
        .face,
        .cube {
          width: ${e}px;
          height: ${e}px;
          transform: translateZ(-300px) ${this._cssMatrix3D};
        }

        .face-right {
          translate: ${e/2}px 0 0;
        }

        .face-left {
          translate: ${-e/2}px 0 0;
        }

        .face-top {
          translate: 0 ${e/2}px 0;
        }

        .face-bottom {
          translate: 0 ${-e/2}px 0;
        }

        .face-front {
          translate: 0 0 ${e/2}px;
        }

        .face-back {
          translate: 0 0 ${-e/2}px;
        }
      </style>
      <div class="parent">
        <div class="cube">
          <div
            class="face x-direction face-right"
            @click=${()=>this.dispatchEvent(this._onRightClick)}
          >
            ${this.rightText}
          </div>
          <div
            class="face x-direction face-left"
            @click=${()=>this.dispatchEvent(this._onLeftClick)}
          >
            ${this.leftText}
          </div>
          <div
            class="face y-direction face-top"
            @click=${()=>this.dispatchEvent(this._onTopClick)}
          >
            ${this.topText}
          </div>
          <div
            class="face y-direction face-bottom"
            @click=${()=>this.dispatchEvent(this._onBottomClick)}
          >
            ${this.bottomText}
          </div>
          <div
            class="face z-direction face-front"
            @click=${()=>this.dispatchEvent(this._onFrontClick)}
          >
            ${this.frontText}
          </div>
          <div
            class="face z-direction face-back"
            @click=${()=>this.dispatchEvent(this._onBackClick)}
          >
            ${this.backText}
          </div>
        </div>
      </div>
    `}};H0.styles=L0`
    :host {
      position: absolute;
      z-index: 999;
      bottom: 1rem;
      right: 1rem;
    }

    .parent {
      perspective: 400px;
    }

    .cube {
      position: relative;
      transform-style: preserve-3d;
    }

    .face {
      position: absolute;
      display: flex;
      justify-content: center;
      user-select: none;
      align-items: center;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
      color: var(--bim-view-cube--c, white);
      font-size: var(--bim-view-cube--fz, --bim-ui_size-2xl);
    }

    .x-direction {
      // background-color: var(--bim-view-cube_x--bgc, #c93830DD);
      background-color: var(--bim-view-cube_x--bgc, #01a6bcde);
    }

    .x-direction:hover {
      background-color: var(--bim-ui_color-accent, white);
    }

    .y-direction {
      // background-color: var(--bim-view-cube_y--bgc, #54ff19DD);
      background-color: var(--bim-view-cube_y--bgc, #8d0ec8de);
    }

    .y-direction:hover {
      background-color: var(--bim-ui_color-accent, white);
    }

    .z-direction {
      // background-color: var(--bim-view-cube_z--bgc, #3041c9DD);
      background-color: var(--bim-view-cube_z--bgc, #2718afde);
    }

    .z-direction:hover {
      background-color: var(--bim-ui_color-accent, white);
    }

    .face-front {
      transform: rotateX(180deg);
    }

    .face-back {
      transform: rotateZ(180deg);
    }

    .face-top {
      transform: rotateX(90deg);
    }

    .face-bottom {
      transform: rotateX(270deg);
    }

    .face-right {
      transform: rotateY(-270deg) rotateX(180deg);
    }

    .face-left {
      transform: rotateY(-90deg) rotateX(180deg);
    }
  `;let ki=H0;pn([oi({type:Number,reflect:!0})],ki.prototype,"size");pn([oi({type:String,attribute:"right-text",reflect:!0})],ki.prototype,"rightText");pn([oi({type:String,attribute:"left-text",reflect:!0})],ki.prototype,"leftText");pn([oi({type:String,attribute:"top-text",reflect:!0})],ki.prototype,"topText");pn([oi({type:String,attribute:"bottom-text",reflect:!0})],ki.prototype,"bottomText");pn([oi({type:String,attribute:"front-text",reflect:!0})],ki.prototype,"frontText");pn([oi({type:String,attribute:"back-text",reflect:!0})],ki.prototype,"backText");pn([ET()],ki.prototype,"_cssMatrix3D");class lx{static init(){zh.defineCustomElement("bim-view-cube",ki),zh.defineCustomElement("bim-world-2d",Ol)}}export{hd as C,lx as Z,Qc as a};
